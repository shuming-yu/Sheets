import{c as _f}from"./_commonjsHelpers-Cpj98o6Y.js";import{d as ey,m as oT,c as sT,a as aT,j as lT}from"./index-BkEWqnXD.js";var Mf={},Ki,If;function Ge(){if(If)return Ki;If=1;var t=function(e){return e&&e.Math===Math&&e};return Ki=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof _f=="object"&&_f)||t(typeof Ki=="object"&&Ki)||function(){return this}()||Function("return this")(),Ki}var Za={},Qa,Hf;function nt(){return Hf||(Hf=1,Qa=function(t){try{return!!t()}catch{return!0}}),Qa}var Ja,xf;function er(){if(xf)return Ja;xf=1;var t=nt();return Ja=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Ja}var el,Pf;function pa(){if(Pf)return el;Pf=1;var t=nt();return el=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),el}var tl,Af;function Lt(){if(Af)return tl;Af=1;var t=pa(),e=Function.prototype.call;return tl=t?e.bind(e):function(){return e.apply(e,arguments)},tl}var rl={},Nf;function uT(){if(Nf)return rl;Nf=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return rl.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,rl}var nl,Df;function wa(){return Df||(Df=1,nl=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),nl}var il,Lf;function Ve(){if(Lf)return il;Lf=1;var t=pa(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return il=t?n:function(i){return function(){return r.apply(i,arguments)}},il}var ol,kf;function Zn(){if(kf)return ol;kf=1;var t=Ve(),e=t({}.toString),r=t("".slice);return ol=function(n){return r(e(n),8,-1)},ol}var sl,Ff;function cT(){if(Ff)return sl;Ff=1;var t=Ve(),e=nt(),r=Zn(),n=Object,i=t("".split);return sl=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,sl}var al,Vf;function va(){return Vf||(Vf=1,al=function(t){return t==null}),al}var ll,Wf;function Bo(){if(Wf)return ll;Wf=1;var t=va(),e=TypeError;return ll=function(r){if(t(r))throw new e("Can't call method on "+r);return r},ll}var ul,Bf;function $o(){if(Bf)return ul;Bf=1;var t=cT(),e=Bo();return ul=function(r){return t(e(r))},ul}var cl,$f;function je(){if($f)return cl;$f=1;var t=typeof document=="object"&&document.all;return cl=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},cl}var hl,jf;function yr(){if(jf)return hl;jf=1;var t=je();return hl=function(e){return typeof e=="object"?e!==null:t(e)},hl}var dl,zf;function Ni(){if(zf)return dl;zf=1;var t=Ge(),e=je(),r=function(n){return e(n)?n:void 0};return dl=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},dl}var fl,Uf;function jo(){if(Uf)return fl;Uf=1;var t=Ve();return fl=t({}.isPrototypeOf),fl}var gl,Yf;function ya(){if(Yf)return gl;Yf=1;var t=Ge(),e=t.navigator,r=e&&e.userAgent;return gl=r?String(r):"",gl}var ml,qf;function hT(){if(qf)return ml;qf=1;var t=Ge(),e=ya(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),ml=a,ml}var pl,Gf;function Uh(){if(Gf)return pl;Gf=1;var t=hT(),e=nt(),r=Ge(),n=r.String;return pl=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),pl}var wl,Kf;function ty(){if(Kf)return wl;Kf=1;var t=Uh();return wl=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",wl}var vl,Xf;function Yh(){if(Xf)return vl;Xf=1;var t=Ni(),e=je(),r=jo(),n=ty(),i=Object;return vl=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},vl}var yl,Zf;function ba(){if(Zf)return yl;Zf=1;var t=String;return yl=function(e){try{return t(e)}catch{return"Object"}},yl}var bl,Qf;function jt(){if(Qf)return bl;Qf=1;var t=je(),e=ba(),r=TypeError;return bl=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},bl}var Sl,Jf;function zo(){if(Jf)return Sl;Jf=1;var t=jt(),e=va();return Sl=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Sl}var Cl,eg;function dT(){if(eg)return Cl;eg=1;var t=Lt(),e=je(),r=yr(),n=TypeError;return Cl=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Cl}var Rl={exports:{}},Tl,tg;function Qn(){return tg||(tg=1,Tl=!1),Tl}var El,rg;function qh(){if(rg)return El;rg=1;var t=Ge(),e=Object.defineProperty;return El=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},El}var ng;function Gh(){if(ng)return Rl.exports;ng=1;var t=Qn(),e=Ge(),r=qh(),n="__core-js_shared__",i=Rl.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.41.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Rl.exports}var Ol,ig;function ry(){if(ig)return Ol;ig=1;var t=Gh();return Ol=function(e,r){return t[e]||(t[e]=r||{})},Ol}var _l,og;function Di(){if(og)return _l;og=1;var t=Bo(),e=Object;return _l=function(r){return e(t(r))},_l}var Ml,sg;function tr(){if(sg)return Ml;sg=1;var t=Ve(),e=Di(),r=t({}.hasOwnProperty);return Ml=Object.hasOwn||function(i,o){return r(e(i),o)},Ml}var Il,ag;function ny(){if(ag)return Il;ag=1;var t=Ve(),e=0,r=Math.random(),n=t(1 .toString);return Il=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Il}var Hl,lg;function br(){if(lg)return Hl;lg=1;var t=Ge(),e=ry(),r=tr(),n=ny(),i=Uh(),o=ty(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Hl=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Hl}var xl,ug;function fT(){if(ug)return xl;ug=1;var t=Lt(),e=yr(),r=Yh(),n=zo(),i=dT(),o=br(),s=TypeError,a=o("toPrimitive");return xl=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),d;if(c){if(u===void 0&&(u="default"),d=t(c,l,u),!e(d)||r(d))return d;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},xl}var Pl,cg;function iy(){if(cg)return Pl;cg=1;var t=fT(),e=Yh();return Pl=function(r){var n=t(r,"string");return e(n)?n:n+""},Pl}var Al,hg;function Kh(){if(hg)return Al;hg=1;var t=Ge(),e=yr(),r=t.document,n=e(r)&&e(r.createElement);return Al=function(i){return n?r.createElement(i):{}},Al}var Nl,dg;function oy(){if(dg)return Nl;dg=1;var t=er(),e=nt(),r=Kh();return Nl=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Nl}var fg;function sy(){if(fg)return Za;fg=1;var t=er(),e=Lt(),r=uT(),n=wa(),i=$o(),o=iy(),s=tr(),a=oy(),l=Object.getOwnPropertyDescriptor;return Za.f=t?l:function(c,d){if(c=i(c),d=o(d),a)try{return l(c,d)}catch{}if(s(c,d))return n(!e(r.f,c,d),c[d])},Za}var Dl={},Ll,gg;function ay(){if(gg)return Ll;gg=1;var t=er(),e=nt();return Ll=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ll}var kl,mg;function Je(){if(mg)return kl;mg=1;var t=yr(),e=String,r=TypeError;return kl=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},kl}var pg;function Mn(){if(pg)return Dl;pg=1;var t=er(),e=oy(),r=ay(),n=Je(),i=iy(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Dl.f=t?r?function(f,p,w){if(n(f),p=i(p),n(w),typeof f=="function"&&p==="prototype"&&"value"in w&&c in w&&!w[c]){var v=a(f,p);v&&v[c]&&(f[p]=w.value,w={configurable:u in w?w[u]:v[u],enumerable:l in w?w[l]:v[l],writable:!1})}return s(f,p,w)}:s:function(f,p,w){if(n(f),p=i(p),n(w),e)try{return s(f,p,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(f[p]=w.value),f},Dl}var Fl,wg;function Li(){if(wg)return Fl;wg=1;var t=er(),e=Mn(),r=wa();return Fl=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Fl}var Vl={exports:{}},Wl,vg;function gT(){if(vg)return Wl;vg=1;var t=er(),e=tr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return Wl={EXISTS:i,PROPER:o,CONFIGURABLE:s},Wl}var Bl,yg;function mT(){if(yg)return Bl;yg=1;var t=Ve(),e=je(),r=Gh(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Bl=r.inspectSource,Bl}var $l,bg;function pT(){if(bg)return $l;bg=1;var t=Ge(),e=je(),r=t.WeakMap;return $l=e(r)&&/native code/.test(String(r)),$l}var jl,Sg;function Xh(){if(Sg)return jl;Sg=1;var t=ry(),e=ny(),r=t("keys");return jl=function(n){return r[n]||(r[n]=e(n))},jl}var zl,Cg;function Zh(){return Cg||(Cg=1,zl={}),zl}var Ul,Rg;function ly(){if(Rg)return Ul;Rg=1;var t=pT(),e=Ge(),r=yr(),n=Li(),i=tr(),o=Gh(),s=Xh(),a=Zh(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,d,f,p,w=function(E){return p(E)?f(E):d(E,{})},v=function(E){return function(_){var O;if(!r(_)||(O=f(_)).type!==E)throw new u("Incompatible receiver, "+E+" required");return O}};if(t||o.state){var R=o.state||(o.state=new c);R.get=R.get,R.has=R.has,R.set=R.set,d=function(E,_){if(R.has(E))throw new u(l);return _.facade=E,R.set(E,_),_},f=function(E){return R.get(E)||{}},p=function(E){return R.has(E)}}else{var y=s("state");a[y]=!0,d=function(E,_){if(i(E,y))throw new u(l);return _.facade=E,n(E,y,_),_},f=function(E){return i(E,y)?E[y]:{}},p=function(E){return i(E,y)}}return Ul={set:d,get:f,has:p,enforce:w,getterFor:v},Ul}var Tg;function uy(){if(Tg)return Vl.exports;Tg=1;var t=Ve(),e=nt(),r=je(),n=tr(),i=er(),o=gT().CONFIGURABLE,s=mT(),a=ly(),l=a.enforce,u=a.get,c=String,d=Object.defineProperty,f=t("".slice),p=t("".replace),w=t([].join),v=i&&!e(function(){return d(function(){},"length",{value:8}).length!==8}),R=String(String).split("String"),y=Vl.exports=function(E,_,O){f(c(_),0,7)==="Symbol("&&(_="["+p(c(_),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),O&&O.getter&&(_="get "+_),O&&O.setter&&(_="set "+_),(!n(E,"name")||o&&E.name!==_)&&(i?d(E,"name",{value:_,configurable:!0}):E.name=_),v&&O&&n(O,"arity")&&E.length!==O.arity&&d(E,"length",{value:O.arity});try{O&&n(O,"constructor")&&O.constructor?i&&d(E,"prototype",{writable:!1}):E.prototype&&(E.prototype=void 0)}catch{}var M=l(E);return n(M,"source")||(M.source=w(R,typeof _=="string"?_:"")),E};return Function.prototype.toString=y(function(){return r(this)&&u(this).source||s(this)},"toString"),Vl.exports}var Yl,Eg;function Qh(){if(Eg)return Yl;Eg=1;var t=je(),e=Mn(),r=uy(),n=qh();return Yl=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Yl}var ql={},Gl,Og;function wT(){if(Og)return Gl;Og=1;var t=Math.ceil,e=Math.floor;return Gl=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},Gl}var Kl,_g;function Uo(){if(_g)return Kl;_g=1;var t=wT();return Kl=function(e){var r=+e;return r!==r||r===0?0:t(r)},Kl}var Xl,Mg;function vT(){if(Mg)return Xl;Mg=1;var t=Uo(),e=Math.max,r=Math.min;return Xl=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},Xl}var Zl,Ig;function yT(){if(Ig)return Zl;Ig=1;var t=Uo(),e=Math.min;return Zl=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},Zl}var Ql,Hg;function ki(){if(Hg)return Ql;Hg=1;var t=yT();return Ql=function(e){return t(e.length)},Ql}var Jl,xg;function bT(){if(xg)return Jl;xg=1;var t=$o(),e=vT(),r=ki(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),d;if(i&&s!==s){for(;u>c;)if(d=l[c++],d!==d)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return Jl={includes:n(!0),indexOf:n(!1)},Jl}var eu,Pg;function cy(){if(Pg)return eu;Pg=1;var t=Ve(),e=tr(),r=$o(),n=bT().indexOf,i=Zh(),o=t([].push);return eu=function(s,a){var l=r(s),u=0,c=[],d;for(d in l)!e(i,d)&&e(l,d)&&o(c,d);for(;a.length>u;)e(l,d=a[u++])&&(~n(c,d)||o(c,d));return c},eu}var tu,Ag;function Jh(){return Ag||(Ag=1,tu=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),tu}var Ng;function ST(){if(Ng)return ql;Ng=1;var t=cy(),e=Jh(),r=e.concat("length","prototype");return ql.f=Object.getOwnPropertyNames||function(i){return t(i,r)},ql}var ru={},Dg;function CT(){return Dg||(Dg=1,ru.f=Object.getOwnPropertySymbols),ru}var nu,Lg;function RT(){if(Lg)return nu;Lg=1;var t=Ni(),e=Ve(),r=ST(),n=CT(),i=Je(),o=e([].concat);return nu=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},nu}var iu,kg;function hy(){if(kg)return iu;kg=1;var t=tr(),e=RT(),r=sy(),n=Mn();return iu=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var d=a[c];!t(i,d)&&!(s&&t(s,d))&&l(i,d,u(o,d))}},iu}var ou,Fg;function TT(){if(Fg)return ou;Fg=1;var t=nt(),e=je(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return ou=n,ou}var su,Vg;function Ie(){if(Vg)return su;Vg=1;var t=Ge(),e=sy().f,r=Li(),n=Qh(),i=qh(),o=hy(),s=TT();return su=function(a,l){var u=a.target,c=a.global,d=a.stat,f,p,w,v,R,y;if(c?p=t:d?p=t[u]||i(u,{}):p=t[u]&&t[u].prototype,p)for(w in l){if(R=l[w],a.dontCallGetSet?(y=e(p,w),v=y&&y.value):v=p[w],f=s(c?w:u+(d?".":"#")+w,a.forced),!f&&v!==void 0){if(typeof R==typeof v)continue;o(R,v)}(a.sham||v&&v.sham)&&r(R,"sham",!0),n(p,w,R,a)}},su}var au,Wg;function Sa(){if(Wg)return au;Wg=1;var t=pa(),e=Function.prototype,r=e.apply,n=e.call;return au=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),au}var lu,Bg;function dy(){if(Bg)return lu;Bg=1;var t=Ve(),e=jt();return lu=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},lu}var uu,$g;function ET(){if($g)return uu;$g=1;var t=yr();return uu=function(e){return t(e)||e===null},uu}var cu,jg;function OT(){if(jg)return cu;jg=1;var t=ET(),e=String,r=TypeError;return cu=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},cu}var hu,zg;function fy(){if(zg)return hu;zg=1;var t=dy(),e=yr(),r=Bo(),n=OT();return hu=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),hu}var du,Ug;function _T(){if(Ug)return du;Ug=1;var t=Mn().f;return du=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},du}var fu,Yg;function MT(){if(Yg)return fu;Yg=1;var t=je(),e=yr(),r=fy();return fu=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},fu}var gu,qg;function IT(){if(qg)return gu;qg=1;var t=br(),e=t("toStringTag"),r={};return r[e]="z",gu=String(r)==="[object z]",gu}var mu,Gg;function gy(){if(Gg)return mu;Gg=1;var t=IT(),e=je(),r=Zn(),n=br(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return mu=t?r:function(l){var u,c,d;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(d=r(u))==="Object"&&e(u.callee)?"Arguments":d},mu}var pu,Kg;function Ca(){if(Kg)return pu;Kg=1;var t=gy(),e=String;return pu=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},pu}var wu,Xg;function HT(){if(Xg)return wu;Xg=1;var t=Ca();return wu=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},wu}var vu,Zg;function xT(){if(Zg)return vu;Zg=1;var t=yr(),e=Li();return vu=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},vu}var yu,Qg;function PT(){if(Qg)return yu;Qg=1;var t=Ve(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return yu=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},yu}var bu,Jg;function AT(){if(Jg)return bu;Jg=1;var t=nt(),e=wa();return bu=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),bu}var Su,em;function NT(){if(em)return Su;em=1;var t=Li(),e=PT(),r=AT(),n=Error.captureStackTrace;return Su=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Su}var Cu,tm;function DT(){if(tm)return Cu;tm=1;var t=Ni(),e=tr(),r=Li(),n=jo(),i=fy(),o=hy(),s=_T(),a=MT(),l=HT(),u=xT(),c=NT(),d=er(),f=Qn();return Cu=function(p,w,v,R){var y="stackTraceLimit",E=R?2:1,_=p.split("."),O=_[_.length-1],M=t.apply(null,_);if(M){var H=M.prototype;if(!f&&e(H,"cause")&&delete H.cause,!v)return M;var N=t("Error"),L=w(function(G,K){var j=l(R?K:G,void 0),J=R?new M(G):new M;return j!==void 0&&r(J,"message",j),c(J,L,J.stack,2),this&&n(H,this)&&a(J,this,L),arguments.length>E&&u(J,arguments[E]),J});if(L.prototype=H,O!=="Error"?i?i(L,N):o(L,N,{name:!0}):d&&y in M&&(s(L,M,y),s(L,M,"prepareStackTrace")),o(L,M),!f)try{H.name!==O&&r(H,"name",O),H.constructor=L}catch{}return L}},Cu}var rm;function LT(){if(rm)return Mf;rm=1;var t=Ie(),e=Ge(),r=Sa(),n=DT(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var d={};d[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},d)},l=function(u,c){if(o&&o[u]){var d={};d[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},d)}};return a("Error",function(u){return function(d){return r(u,this,arguments)}}),a("EvalError",function(u){return function(d){return r(u,this,arguments)}}),a("RangeError",function(u){return function(d){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(d){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(d){return r(u,this,arguments)}}),a("TypeError",function(u){return function(d){return r(u,this,arguments)}}),a("URIError",function(u){return function(d){return r(u,this,arguments)}}),l("CompileError",function(u){return function(d){return r(u,this,arguments)}}),l("LinkError",function(u){return function(d){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(d){return r(u,this,arguments)}}),Mf}LT();var nm={},Ru,im;function my(){if(im)return Ru;im=1;var t=Zn();return Ru=Array.isArray||function(r){return t(r)==="Array"},Ru}var Tu,om;function py(){if(om)return Tu;om=1;var t=er(),e=my(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Tu=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Tu}var Eu,sm;function wy(){if(sm)return Eu;sm=1;var t=TypeError,e=9007199254740991;return Eu=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Eu}var am;function kT(){if(am)return nm;am=1;var t=Ie(),e=Di(),r=ki(),n=py(),i=wy(),o=nt(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var d=e(this),f=r(d),p=arguments.length;i(f+p);for(var w=0;w<p;w++)d[f]=arguments[w],f++;return n(d,f),f}}),nm}kT();var lm={},Ou,um;function Dr(){if(um)return Ou;um=1;var t=Ve(),e=Set.prototype;return Ou={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Ou}var _u,cm;function Jn(){if(cm)return _u;cm=1;var t=Dr().has;return _u=function(e){return t(e),e},_u}var Mu,hm;function ei(){if(hm)return Mu;hm=1;var t=Lt();return Mu=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Mu}var Iu,dm;function Yo(){if(dm)return Iu;dm=1;var t=Ve(),e=ei(),r=Dr(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Iu=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Iu}var Hu,fm;function ed(){if(fm)return Hu;fm=1;var t=Dr(),e=Yo(),r=t.Set,n=t.add;return Hu=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Hu}var xu,gm;function qo(){if(gm)return xu;gm=1;var t=dy(),e=Dr();return xu=t(e.proto,"size","get")||function(r){return r.size},xu}var Pu,mm;function In(){return mm||(mm=1,Pu=function(t){return{iterator:t,next:t.next,done:!1}}),Pu}var Au,pm;function ti(){if(pm)return Au;pm=1;var t=jt(),e=Je(),r=Lt(),n=Uo(),i=In(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,d){this.set=c,this.size=l(d,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Au=function(c){e(c);var d=+c.size;if(d!==d)throw new a(o);var f=n(d);if(f<0)throw new s(o);return new u(c,f)},Au}var Nu,wm;function FT(){if(wm)return Nu;wm=1;var t=Jn(),e=Dr(),r=ed(),n=qo(),i=ti(),o=Yo(),s=ei(),a=e.has,l=e.remove;return Nu=function(c){var d=t(this),f=i(c),p=r(d);return n(d)<=f.size?o(d,function(w){f.includes(w)&&l(p,w)}):s(f.getIterator(),function(w){a(d,w)&&l(p,w)}),p},Nu}var Du,vm;function ri(){if(vm)return Du;vm=1;var t=Ni(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Du=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Du}var ym;function VT(){if(ym)return lm;ym=1;var t=Ie(),e=FT(),r=ri(),n=!r("difference",function(i){return i.size===0});return t({target:"Set",proto:!0,real:!0,forced:n},{difference:e}),lm}VT();var bm={},Lu,Sm;function WT(){if(Sm)return Lu;Sm=1;var t=Jn(),e=Dr(),r=qo(),n=ti(),i=Yo(),o=ei(),s=e.Set,a=e.add,l=e.has;return Lu=function(c){var d=t(this),f=n(c),p=new s;return r(d)>f.size?o(f.getIterator(),function(w){l(d,w)&&a(p,w)}):i(d,function(w){f.includes(w)&&a(p,w)}),p},Lu}var Cm;function BT(){if(Cm)return bm;Cm=1;var t=Ie(),e=nt(),r=WT(),n=ri(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),bm}BT();var Rm={},ku,Tm;function Go(){if(Tm)return ku;Tm=1;var t=Lt(),e=Je(),r=zo();return ku=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},ku}var Fu,Em;function $T(){if(Em)return Fu;Em=1;var t=Jn(),e=Dr().has,r=qo(),n=ti(),i=Yo(),o=ei(),s=Go();return Fu=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(f){if(c.includes(f))return!1},!0)!==!1;var d=c.getIterator();return o(d,function(f){if(e(u,f))return s(d,"normal",!1)})!==!1},Fu}var Om;function jT(){if(Om)return Rm;Om=1;var t=Ie(),e=$T(),r=ri(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),Rm}jT();var _m={},Vu,Mm;function zT(){if(Mm)return Vu;Mm=1;var t=Jn(),e=qo(),r=Yo(),n=ti();return Vu=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Vu}var Im;function UT(){if(Im)return _m;Im=1;var t=Ie(),e=zT(),r=ri(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),_m}UT();var Hm={},Wu,xm;function YT(){if(xm)return Wu;xm=1;var t=Jn(),e=Dr().has,r=qo(),n=ti(),i=ei(),o=Go();return Wu=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(d){if(!e(l,d))return o(c,"normal",!1)})!==!1},Wu}var Pm;function qT(){if(Pm)return Hm;Pm=1;var t=Ie(),e=YT(),r=ri(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Hm}qT();var Am={},Bu,Nm;function GT(){if(Nm)return Bu;Nm=1;var t=Jn(),e=Dr(),r=ed(),n=ti(),i=ei(),o=e.add,s=e.has,a=e.remove;return Bu=function(u){var c=t(this),d=n(u).getIterator(),f=r(c);return i(d,function(p){s(c,p)?a(f,p):o(f,p)}),f},Bu}var Dm;function KT(){if(Dm)return Am;Dm=1;var t=Ie(),e=GT(),r=ri();return t({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:e}),Am}KT();var Lm={},$u,km;function XT(){if(km)return $u;km=1;var t=Jn(),e=Dr().add,r=ed(),n=ti(),i=ei();return $u=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},$u}var Fm;function ZT(){if(Fm)return Lm;Fm=1;var t=Ie(),e=XT(),r=ri();return t({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:e}),Lm}ZT();var Vm={},Wm={},ju,Bm;function QT(){if(Bm)return ju;Bm=1;var t=jo(),e=TypeError;return ju=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},ju}var zu,$m;function JT(){if($m)return zu;$m=1;var t=nt();return zu=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),zu}var Uu,jm;function vy(){if(jm)return Uu;jm=1;var t=tr(),e=je(),r=Di(),n=Xh(),i=JT(),o=n("IE_PROTO"),s=Object,a=s.prototype;return Uu=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Uu}var Yu,zm;function eE(){if(zm)return Yu;zm=1;var t=uy(),e=Mn();return Yu=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},Yu}var qu,Um;function tE(){if(Um)return qu;Um=1;var t=er(),e=Mn(),r=wa();return qu=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},qu}var Gu={},Ku,Ym;function rE(){if(Ym)return Ku;Ym=1;var t=cy(),e=Jh();return Ku=Object.keys||function(n){return t(n,e)},Ku}var qm;function nE(){if(qm)return Gu;qm=1;var t=er(),e=ay(),r=Mn(),n=Je(),i=$o(),o=rE();return Gu.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),d=c.length,f=0,p;d>f;)r.f(a,p=c[f++],u[p]);return a},Gu}var Xu,Gm;function yy(){if(Gm)return Xu;Gm=1;var t=Ni();return Xu=t("document","documentElement"),Xu}var Zu,Km;function td(){if(Km)return Zu;Km=1;var t=Je(),e=nE(),r=Jh(),n=Zh(),i=yy(),o=Kh(),s=Xh(),a=">",l="<",u="prototype",c="script",d=s("IE_PROTO"),f=function(){},p=function(E){return l+c+a+E+l+"/"+c+a},w=function(E){E.write(p("")),E.close();var _=E.parentWindow.Object;return E=null,_},v=function(){var E=o("iframe"),_="java"+c+":",O;return E.style.display="none",i.appendChild(E),E.src=String(_),O=E.contentWindow.document,O.open(),O.write(p("document.F=Object")),O.close(),O.F},R,y=function(){try{R=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&R?w(R):v():w(R);for(var E=r.length;E--;)delete y[u][r[E]];return y()};return n[d]=!0,Zu=Object.create||function(_,O){var M;return _!==null?(f[u]=t(_),M=new f,f[u]=null,M[d]=_):M=y(),O===void 0?M:e.f(M,O)},Zu}var Qu,Xm;function by(){if(Xm)return Qu;Xm=1;var t=nt(),e=je(),r=yr(),n=td(),i=vy(),o=Qh(),s=br(),a=Qn(),l=s("iterator"),u=!1,c,d,f;[].keys&&(f=[].keys(),"next"in f?(d=i(i(f)),d!==Object.prototype&&(c=d)):u=!0);var p=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return p?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Qu={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Qu}var Zm;function iE(){if(Zm)return Wm;Zm=1;var t=Ie(),e=Ge(),r=QT(),n=Je(),i=je(),o=vy(),s=eE(),a=tE(),l=nt(),u=tr(),c=br(),d=by().IteratorPrototype,f=er(),p=Qn(),w="constructor",v="Iterator",R=c("toStringTag"),y=TypeError,E=e[v],_=p||!i(E)||E.prototype!==d||!l(function(){E({})}),O=function(){if(r(this,d),o(this)===d)throw new y("Abstract class Iterator not directly constructable")},M=function(H,N){f?s(d,H,{configurable:!0,get:function(){return N},set:function(L){if(n(this),this===d)throw new y("You can't redefine this property");u(this,H)?this[H]=L:a(this,H,L)}}):d[H]=N};return u(d,R)||M(R,v),(_||!u(d,w)||d[w]===Object)&&M(w,O),O.prototype=d,t({global:!0,constructor:!0,forced:_},{Iterator:O}),Wm}var Qm;function oE(){return Qm||(Qm=1,iE()),Vm}oE();var Jm={},ep={},Ju,tp;function sE(){if(tp)return Ju;tp=1;var t=Qh();return Ju=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},Ju}var ec,rp;function aE(){return rp||(rp=1,ec=function(t,e){return{value:t,done:e}}),ec}var tc,np;function Sy(){if(np)return tc;np=1;var t=Lt(),e=td(),r=Li(),n=sE(),i=br(),o=ly(),s=zo(),a=by().IteratorPrototype,l=aE(),u=Go(),c=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",p=o.set,w=function(y){var E=o.getterFor(y?f:d);return n(e(a),{next:function(){var O=E(this);if(y)return O.nextHandler();if(O.done)return l(void 0,!0);try{var M=O.nextHandler();return O.returnHandlerResult?M:l(M,O.done)}catch(H){throw O.done=!0,H}},return:function(){var _=E(this),O=_.iterator;if(_.done=!0,y){var M=s(O,"return");return M?t(M,O):l(void 0,!0)}if(_.inner)try{u(_.inner.iterator,"normal")}catch(H){return u(O,"throw",H)}return O&&u(O,"normal"),l(void 0,!0)}})},v=w(!0),R=w(!1);return r(R,c,"Iterator Helper"),tc=function(y,E,_){var O=function(H,N){N?(N.iterator=H.iterator,N.next=H.next):N=H,N.type=E?f:d,N.returnHandlerResult=!!_,N.nextHandler=y,N.counter=0,N.done=!1,p(this,N)};return O.prototype=E?v:R,O},tc}var rc,ip;function Cy(){if(ip)return rc;ip=1;var t=Je(),e=Go();return rc=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},rc}var op;function lE(){if(op)return ep;op=1;var t=Ie(),e=Lt(),r=jt(),n=Je(),i=In(),o=Sy(),s=Cy(),a=Qn(),l=o(function(){for(var u=this.iterator,c=this.predicate,d=this.next,f,p,w;;){if(f=n(e(d,u)),p=this.done=!!f.done,p)return;if(w=f.value,s(u,c,[w,this.counter++],!0))return w}});return t({target:"Iterator",proto:!0,real:!0,forced:a},{filter:function(c){return n(this),r(c),new l(i(this),{predicate:c})}}),ep}var sp;function uE(){return sp||(sp=1,lE()),Jm}uE();var ap={},lp={},nc,up;function cE(){if(up)return nc;up=1;var t=Zn(),e=Ve();return nc=function(r){if(t(r)==="Function")return e(r)},nc}var ic,cp;function Ry(){if(cp)return ic;cp=1;var t=cE(),e=jt(),r=pa(),n=t(t.bind);return ic=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},ic}var oc,hp;function Ty(){return hp||(hp=1,oc={}),oc}var sc,dp;function hE(){if(dp)return sc;dp=1;var t=br(),e=Ty(),r=t("iterator"),n=Array.prototype;return sc=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},sc}var ac,fp;function Ey(){if(fp)return ac;fp=1;var t=gy(),e=zo(),r=va(),n=Ty(),i=br(),o=i("iterator");return ac=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},ac}var lc,gp;function dE(){if(gp)return lc;gp=1;var t=Lt(),e=jt(),r=Je(),n=ba(),i=Ey(),o=TypeError;return lc=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},lc}var uc,mp;function Ko(){if(mp)return uc;mp=1;var t=Ry(),e=Lt(),r=Je(),n=ba(),i=hE(),o=ki(),s=jo(),a=dE(),l=Ey(),u=Go(),c=TypeError,d=function(p,w){this.stopped=p,this.result=w},f=d.prototype;return uc=function(p,w,v){var R=v&&v.that,y=!!(v&&v.AS_ENTRIES),E=!!(v&&v.IS_RECORD),_=!!(v&&v.IS_ITERATOR),O=!!(v&&v.INTERRUPTED),M=t(w,R),H,N,L,G,K,j,J,ae=function(Z){return H&&u(H,"normal",Z),new d(!0,Z)},q=function(Z){return y?(r(Z),O?M(Z[0],Z[1],ae):M(Z[0],Z[1])):O?M(Z,ae):M(Z)};if(E)H=p.iterator;else if(_)H=p;else{if(N=l(p),!N)throw new c(n(p)+" is not iterable");if(i(N)){for(L=0,G=o(p);G>L;L++)if(K=q(p[L]),K&&s(f,K))return K;return new d(!1)}H=a(p,N)}for(j=E?p.next:H.next;!(J=e(j,H)).done;){try{K=q(J.value)}catch(Z){u(H,"throw",Z)}if(typeof K=="object"&&K&&s(f,K))return K}return new d(!1)},uc}var pp;function fE(){if(pp)return lp;pp=1;var t=Ie(),e=Ko(),r=jt(),n=Je(),i=In();return t({target:"Iterator",proto:!0,real:!0},{forEach:function(s){n(this),r(s);var a=i(this),l=0;e(a,function(u){s(u,l++)},{IS_RECORD:!0})}}),lp}var wp;function gE(){return wp||(wp=1,fE()),ap}gE();var vp={},yp={},cc,bp;function mE(){if(bp)return cc;bp=1;var t=Lt(),e=jt(),r=Je(),n=In(),i=Sy(),o=Cy(),s=i(function(){var a=this.iterator,l=r(t(this.next,a)),u=this.done=!!l.done;if(!u)return o(a,this.mapper,[l.value,this.counter++],!0)});return cc=function(l){return r(this),e(l),new s(n(this),{mapper:l})},cc}var Sp;function pE(){if(Sp)return yp;Sp=1;var t=Ie(),e=mE(),r=Qn();return t({target:"Iterator",proto:!0,real:!0,forced:r},{map:e}),yp}var Cp;function wE(){return Cp||(Cp=1,pE()),vp}wE();var Rp={},Tp={},hc,Ep;function rd(){if(Ep)return hc;Ep=1;var t=Ve();return hc=t([].slice),hc}var dc,Op;function Oy(){if(Op)return dc;Op=1;var t=TypeError;return dc=function(e,r){if(e<r)throw new t("Not enough arguments");return e},dc}var fc,_p;function vE(){if(_p)return fc;_p=1;var t=ya();return fc=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),fc}var gc,Mp;function _y(){if(Mp)return gc;Mp=1;var t=Ge(),e=ya(),r=Zn(),n=function(i){return e.slice(0,i.length)===i};return gc=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),gc}var mc,Ip;function yE(){if(Ip)return mc;Ip=1;var t=_y();return mc=t==="NODE",mc}var pc,Hp;function My(){if(Hp)return pc;Hp=1;var t=Ge(),e=Sa(),r=Ry(),n=je(),i=tr(),o=nt(),s=yy(),a=rd(),l=Kh(),u=Oy(),c=vE(),d=yE(),f=t.setImmediate,p=t.clearImmediate,w=t.process,v=t.Dispatch,R=t.Function,y=t.MessageChannel,E=t.String,_=0,O={},M="onreadystatechange",H,N,L,G;o(function(){H=t.location});var K=function(q){if(i(O,q)){var Z=O[q];delete O[q],Z()}},j=function(q){return function(){K(q)}},J=function(q){K(q.data)},ae=function(q){t.postMessage(E(q),H.protocol+"//"+H.host)};return(!f||!p)&&(f=function(Z){u(arguments.length,1);var Ke=n(Z)?Z:R(Z),le=a(arguments,1);return O[++_]=function(){e(Ke,void 0,le)},N(_),_},p=function(Z){delete O[Z]},d?N=function(q){w.nextTick(j(q))}:v&&v.now?N=function(q){v.now(j(q))}:y&&!c?(L=new y,G=L.port2,L.port1.onmessage=J,N=r(G.postMessage,G)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&H&&H.protocol!=="file:"&&!o(ae)?(N=ae,t.addEventListener("message",J,!1)):M in l("script")?N=function(q){s.appendChild(l("script"))[M]=function(){s.removeChild(this),K(q)}}:N=function(q){setTimeout(j(q),0)}),pc={set:f,clear:p},pc}var xp;function bE(){if(xp)return Tp;xp=1;var t=Ie(),e=Ge(),r=My().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),Tp}var Pp={},wc,Ap;function SE(){if(Ap)return wc;Ap=1;var t=Ge(),e=Sa(),r=je(),n=_y(),i=ya(),o=rd(),s=Oy(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return wc=function(u,c){var d=c?2:1;return l?function(f,p){var w=s(arguments.length,1)>d,v=r(f)?f:a(f),R=w?o(arguments,d):[],y=w?function(){e(v,this,R)}:v;return c?u(y,p):u(y)}:u},wc}var Np;function CE(){if(Np)return Pp;Np=1;var t=Ie(),e=Ge(),r=My().set,n=SE(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Pp}var Dp;function RE(){return Dp||(Dp=1,bE(),CE()),Rp}RE();/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:Iy,setPrototypeOf:Lp,isFrozen:TE,getPrototypeOf:EE,getOwnPropertyDescriptor:OE}=Object;let{freeze:bt,seal:Jt,create:Hy}=Object,{apply:fh,construct:gh}=typeof Reflect<"u"&&Reflect;bt||(bt=function(e){return e});Jt||(Jt=function(e){return e});fh||(fh=function(e,r,n){return e.apply(r,n)});gh||(gh=function(e,r){return new e(...r)});const ds=St(Array.prototype.forEach),_E=St(Array.prototype.lastIndexOf),kp=St(Array.prototype.pop),Xi=St(Array.prototype.push),ME=St(Array.prototype.splice),zs=St(String.prototype.toLowerCase),vc=St(String.prototype.toString),Fp=St(String.prototype.match),Zi=St(String.prototype.replace),IE=St(String.prototype.indexOf),HE=St(String.prototype.trim),hr=St(Object.prototype.hasOwnProperty),mt=St(RegExp.prototype.test),Qi=xE(TypeError);function St(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return fh(t,e,n)}}function xE(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return gh(t,r)}}function ie(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zs;Lp&&Lp(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(TE(e)||(e[n]=o),i=o)}t[i]=!0}return t}function PE(t){for(let e=0;e<t.length;e++)hr(t,e)||(t[e]=null);return t}function Bn(t){const e=Hy(null);for(const[r,n]of Iy(t))hr(t,r)&&(Array.isArray(n)?e[r]=PE(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Bn(n):e[r]=n);return e}function Ji(t,e){for(;t!==null;){const n=OE(t,e);if(n){if(n.get)return St(n.get);if(typeof n.value=="function")return St(n.value)}t=EE(t)}function r(){return null}return r}const Vp=bt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),yc=bt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bc=bt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),AE=bt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Sc=bt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),NE=bt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Wp=bt(["#text"]),Bp=bt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Cc=bt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$p=bt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),fs=bt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),DE=Jt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LE=Jt(/<%[\w\W]*|[\w\W]*%>/gm),kE=Jt(/\$\{[\w\W]*/gm),FE=Jt(/^data-[\-\w.\u00B7-\uFFFF]+$/),VE=Jt(/^aria-[\-\w]+$/),xy=Jt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),WE=Jt(/^(?:\w+script|data):/i),BE=Jt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Py=Jt(/^html$/i),$E=Jt(/^[a-z][.\w]*(-[.\w]+)+$/i);var jp=Object.freeze({__proto__:null,ARIA_ATTR:VE,ATTR_WHITESPACE:BE,CUSTOM_ELEMENT:$E,DATA_ATTR:FE,DOCTYPE_NAME:Py,ERB_EXPR:LE,IS_ALLOWED_URI:xy,IS_SCRIPT_OR_DATA:WE,MUSTACHE_EXPR:DE,TMPLIT_EXPR:kE});const eo={element:1,text:3,progressingInstruction:7,comment:8,document:9},jE=function(){return typeof window>"u"?null:window},zE=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},zp=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ay(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jE();const e=U=>Ay(U);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==eo.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:p}=t,w=l.prototype,v=Ji(w,"cloneNode"),R=Ji(w,"remove"),y=Ji(w,"nextSibling"),E=Ji(w,"childNodes"),_=Ji(w,"parentNode");if(typeof s=="function"){const U=r.createElement("template");U.content&&U.content.ownerDocument&&(r=U.content.ownerDocument)}let O,M="";const{implementation:H,createNodeIterator:N,createDocumentFragment:L,getElementsByTagName:G}=r,{importNode:K}=n;let j=zp();e.isSupported=typeof Iy=="function"&&typeof _=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ae,TMPLIT_EXPR:q,DATA_ATTR:Z,ARIA_ATTR:Ke,IS_SCRIPT_OR_DATA:le,ATTR_WHITESPACE:ge,CUSTOM_ELEMENT:Xe}=jp;let{IS_ALLOWED_URI:or}=jp,h=null;const g=ie({},[...Vp,...yc,...bc,...Sc,...Wp]);let m=null;const b=ie({},[...Bp,...Cc,...$p,...fs]);let C=Object.seal(Hy(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),T=null,I=null,x=!0,B=!0,V=!1,P=!0,ne=!1,fe=!0,me=!1,Ct=!1,et=!1,Re=!1,Rt=!1,ve=!1,ze=!0,Tt=!1;const Fr="user-content-";let Cr=!0,ft=!1,it={},ot=null;const hn=ie({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let dn=null;const Yi=ie({},["audio","video","img","source","image","track"]);let ii=null;const oi=ie({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Et="http://www.w3.org/1998/Math/MathML",Vr="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml";let Ut=st,Ot=!1,_t=null;const us=ie({},[Et,Vr,st],vc);let Hn=ie({},["mi","mo","mn","ms","mtext"]),cs=ie({},["annotation-xml"]);const JR=ie({},["title","style","font","a","script"]);let qi=null;const eT=["application/xhtml+xml","text/html"],tT="text/html";let Ze=null,si=null;const rT=r.createElement("form"),mf=function(S){return S instanceof RegExp||S instanceof Function},Ka=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(si&&si===S)){if((!S||typeof S!="object")&&(S={}),S=Bn(S),qi=eT.indexOf(S.PARSER_MEDIA_TYPE)===-1?tT:S.PARSER_MEDIA_TYPE,Ze=qi==="application/xhtml+xml"?vc:zs,h=hr(S,"ALLOWED_TAGS")?ie({},S.ALLOWED_TAGS,Ze):g,m=hr(S,"ALLOWED_ATTR")?ie({},S.ALLOWED_ATTR,Ze):b,_t=hr(S,"ALLOWED_NAMESPACES")?ie({},S.ALLOWED_NAMESPACES,vc):us,ii=hr(S,"ADD_URI_SAFE_ATTR")?ie(Bn(oi),S.ADD_URI_SAFE_ATTR,Ze):oi,dn=hr(S,"ADD_DATA_URI_TAGS")?ie(Bn(Yi),S.ADD_DATA_URI_TAGS,Ze):Yi,ot=hr(S,"FORBID_CONTENTS")?ie({},S.FORBID_CONTENTS,Ze):hn,T=hr(S,"FORBID_TAGS")?ie({},S.FORBID_TAGS,Ze):{},I=hr(S,"FORBID_ATTR")?ie({},S.FORBID_ATTR,Ze):{},it=hr(S,"USE_PROFILES")?S.USE_PROFILES:!1,x=S.ALLOW_ARIA_ATTR!==!1,B=S.ALLOW_DATA_ATTR!==!1,V=S.ALLOW_UNKNOWN_PROTOCOLS||!1,P=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ne=S.SAFE_FOR_TEMPLATES||!1,fe=S.SAFE_FOR_XML!==!1,me=S.WHOLE_DOCUMENT||!1,Re=S.RETURN_DOM||!1,Rt=S.RETURN_DOM_FRAGMENT||!1,ve=S.RETURN_TRUSTED_TYPE||!1,et=S.FORCE_BODY||!1,ze=S.SANITIZE_DOM!==!1,Tt=S.SANITIZE_NAMED_PROPS||!1,Cr=S.KEEP_CONTENT!==!1,ft=S.IN_PLACE||!1,or=S.ALLOWED_URI_REGEXP||xy,Ut=S.NAMESPACE||st,Hn=S.MATHML_TEXT_INTEGRATION_POINTS||Hn,cs=S.HTML_INTEGRATION_POINTS||cs,C=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&mf(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&mf(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ne&&(B=!1),Rt&&(Re=!0),it&&(h=ie({},Wp),m=[],it.html===!0&&(ie(h,Vp),ie(m,Bp)),it.svg===!0&&(ie(h,yc),ie(m,Cc),ie(m,fs)),it.svgFilters===!0&&(ie(h,bc),ie(m,Cc),ie(m,fs)),it.mathMl===!0&&(ie(h,Sc),ie(m,$p),ie(m,fs))),S.ADD_TAGS&&(h===g&&(h=Bn(h)),ie(h,S.ADD_TAGS,Ze)),S.ADD_ATTR&&(m===b&&(m=Bn(m)),ie(m,S.ADD_ATTR,Ze)),S.ADD_URI_SAFE_ATTR&&ie(ii,S.ADD_URI_SAFE_ATTR,Ze),S.FORBID_CONTENTS&&(ot===hn&&(ot=Bn(ot)),ie(ot,S.FORBID_CONTENTS,Ze)),Cr&&(h["#text"]=!0),me&&ie(h,["html","head","body"]),h.table&&(ie(h,["tbody"]),delete T.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qi('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qi('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=S.TRUSTED_TYPES_POLICY,M=O.createHTML("")}else O===void 0&&(O=zE(p,i)),O!==null&&typeof M=="string"&&(M=O.createHTML(""));bt&&bt(S),si=S}},pf=ie({},[...yc,...bc,...AE]),wf=ie({},[...Sc,...NE]),nT=function(S){let D=_(S);(!D||!D.tagName)&&(D={namespaceURI:Ut,tagName:"template"});const $=zs(S.tagName),xe=zs(D.tagName);return _t[S.namespaceURI]?S.namespaceURI===Vr?D.namespaceURI===st?$==="svg":D.namespaceURI===Et?$==="svg"&&(xe==="annotation-xml"||Hn[xe]):!!pf[$]:S.namespaceURI===Et?D.namespaceURI===st?$==="math":D.namespaceURI===Vr?$==="math"&&cs[xe]:!!wf[$]:S.namespaceURI===st?D.namespaceURI===Vr&&!cs[xe]||D.namespaceURI===Et&&!Hn[xe]?!1:!wf[$]&&(JR[$]||!pf[$]):!!(qi==="application/xhtml+xml"&&_t[S.namespaceURI]):!1},Rr=function(S){Xi(e.removed,{element:S});try{_(S).removeChild(S)}catch{R(S)}},hs=function(S,D){try{Xi(e.removed,{attribute:D.getAttributeNode(S),from:D})}catch{Xi(e.removed,{attribute:null,from:D})}if(D.removeAttribute(S),S==="is")if(Re||Rt)try{Rr(D)}catch{}else try{D.setAttribute(S,"")}catch{}},vf=function(S){let D=null,$=null;if(et)S="<remove></remove>"+S;else{const tt=Fp(S,/^[\r\n\t ]+/);$=tt&&tt[0]}qi==="application/xhtml+xml"&&Ut===st&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const xe=O?O.createHTML(S):S;if(Ut===st)try{D=new f().parseFromString(xe,qi)}catch{}if(!D||!D.documentElement){D=H.createDocument(Ut,"template",null);try{D.documentElement.innerHTML=Ot?M:xe}catch{}}const at=D.body||D.documentElement;return S&&$&&at.insertBefore(r.createTextNode($),at.childNodes[0]||null),Ut===st?G.call(D,me?"html":"body")[0]:me?D.documentElement:at},yf=function(S){return N.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Xa=function(S){return S instanceof d&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},bf=function(S){return typeof a=="function"&&S instanceof a};function Wr(U,S,D){ds(U,$=>{$.call(e,S,D,si)})}const Sf=function(S){let D=null;if(Wr(j.beforeSanitizeElements,S,null),Xa(S))return Rr(S),!0;const $=Ze(S.nodeName);if(Wr(j.uponSanitizeElement,S,{tagName:$,allowedTags:h}),S.hasChildNodes()&&!bf(S.firstElementChild)&&mt(/<[/\w]/g,S.innerHTML)&&mt(/<[/\w]/g,S.textContent)||S.nodeType===eo.progressingInstruction||fe&&S.nodeType===eo.comment&&mt(/<[/\w]/g,S.data))return Rr(S),!0;if(!h[$]||T[$]){if(!T[$]&&Rf($)&&(C.tagNameCheck instanceof RegExp&&mt(C.tagNameCheck,$)||C.tagNameCheck instanceof Function&&C.tagNameCheck($)))return!1;if(Cr&&!ot[$]){const xe=_(S)||S.parentNode,at=E(S)||S.childNodes;if(at&&xe){const tt=at.length;for(let Mt=tt-1;Mt>=0;--Mt){const Tr=v(at[Mt],!0);Tr.__removalCount=(S.__removalCount||0)+1,xe.insertBefore(Tr,y(S))}}}return Rr(S),!0}return S instanceof l&&!nT(S)||($==="noscript"||$==="noembed"||$==="noframes")&&mt(/<\/no(script|embed|frames)/i,S.innerHTML)?(Rr(S),!0):(ne&&S.nodeType===eo.text&&(D=S.textContent,ds([J,ae,q],xe=>{D=Zi(D,xe," ")}),S.textContent!==D&&(Xi(e.removed,{element:S.cloneNode()}),S.textContent=D)),Wr(j.afterSanitizeElements,S,null),!1)},Cf=function(S,D,$){if(ze&&(D==="id"||D==="name")&&($ in r||$ in rT))return!1;if(!(B&&!I[D]&&mt(Z,D))){if(!(x&&mt(Ke,D))){if(!m[D]||I[D]){if(!(Rf(S)&&(C.tagNameCheck instanceof RegExp&&mt(C.tagNameCheck,S)||C.tagNameCheck instanceof Function&&C.tagNameCheck(S))&&(C.attributeNameCheck instanceof RegExp&&mt(C.attributeNameCheck,D)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(D))||D==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&mt(C.tagNameCheck,$)||C.tagNameCheck instanceof Function&&C.tagNameCheck($))))return!1}else if(!ii[D]){if(!mt(or,Zi($,ge,""))){if(!((D==="src"||D==="xlink:href"||D==="href")&&S!=="script"&&IE($,"data:")===0&&dn[S])){if(!(V&&!mt(le,Zi($,ge,"")))){if($)return!1}}}}}}return!0},Rf=function(S){return S!=="annotation-xml"&&Fp(S,Xe)},Tf=function(S){Wr(j.beforeSanitizeAttributes,S,null);const{attributes:D}=S;if(!D||Xa(S))return;const $={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let xe=D.length;for(;xe--;){const at=D[xe],{name:tt,namespaceURI:Mt,value:Tr}=at,Gi=Ze(tt);let gt=tt==="value"?Tr:HE(Tr);if($.attrName=Gi,$.attrValue=gt,$.keepAttr=!0,$.forceKeepAttr=void 0,Wr(j.uponSanitizeAttribute,S,$),gt=$.attrValue,Tt&&(Gi==="id"||Gi==="name")&&(hs(tt,S),gt=Fr+gt),fe&&mt(/((--!?|])>)|<\/(style|title)/i,gt)){hs(tt,S);continue}if($.forceKeepAttr||(hs(tt,S),!$.keepAttr))continue;if(!P&&mt(/\/>/i,gt)){hs(tt,S);continue}ne&&ds([J,ae,q],Of=>{gt=Zi(gt,Of," ")});const Ef=Ze(S.nodeName);if(Cf(Ef,Gi,gt)){if(O&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!Mt)switch(p.getAttributeType(Ef,Gi)){case"TrustedHTML":{gt=O.createHTML(gt);break}case"TrustedScriptURL":{gt=O.createScriptURL(gt);break}}try{Mt?S.setAttributeNS(Mt,tt,gt):S.setAttribute(tt,gt),Xa(S)?Rr(S):kp(e.removed)}catch{}}}Wr(j.afterSanitizeAttributes,S,null)},iT=function U(S){let D=null;const $=yf(S);for(Wr(j.beforeSanitizeShadowDOM,S,null);D=$.nextNode();)Wr(j.uponSanitizeShadowNode,D,null),Sf(D),Tf(D),D.content instanceof o&&U(D.content);Wr(j.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(U){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=null,$=null,xe=null,at=null;if(Ot=!U,Ot&&(U="<!-->"),typeof U!="string"&&!bf(U))if(typeof U.toString=="function"){if(U=U.toString(),typeof U!="string")throw Qi("dirty is not a string, aborting")}else throw Qi("toString is not a function");if(!e.isSupported)return U;if(Ct||Ka(S),e.removed=[],typeof U=="string"&&(ft=!1),ft){if(U.nodeName){const Tr=Ze(U.nodeName);if(!h[Tr]||T[Tr])throw Qi("root node is forbidden and cannot be sanitized in-place")}}else if(U instanceof a)D=vf("<!---->"),$=D.ownerDocument.importNode(U,!0),$.nodeType===eo.element&&$.nodeName==="BODY"||$.nodeName==="HTML"?D=$:D.appendChild($);else{if(!Re&&!ne&&!me&&U.indexOf("<")===-1)return O&&ve?O.createHTML(U):U;if(D=vf(U),!D)return Re?null:ve?M:""}D&&et&&Rr(D.firstChild);const tt=yf(ft?U:D);for(;xe=tt.nextNode();)Sf(xe),Tf(xe),xe.content instanceof o&&iT(xe.content);if(ft)return U;if(Re){if(Rt)for(at=L.call(D.ownerDocument);D.firstChild;)at.appendChild(D.firstChild);else at=D;return(m.shadowroot||m.shadowrootmode)&&(at=K.call(n,at,!0)),at}let Mt=me?D.outerHTML:D.innerHTML;return me&&h["!doctype"]&&D.ownerDocument&&D.ownerDocument.doctype&&D.ownerDocument.doctype.name&&mt(Py,D.ownerDocument.doctype.name)&&(Mt="<!DOCTYPE "+D.ownerDocument.doctype.name+`>
`+Mt),ne&&ds([J,ae,q],Tr=>{Mt=Zi(Mt,Tr," ")}),O&&ve?O.createHTML(Mt):Mt},e.setConfig=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ka(U),Ct=!0},e.clearConfig=function(){si=null,Ct=!1},e.isValidAttribute=function(U,S,D){si||Ka({});const $=Ze(U),xe=Ze(S);return Cf($,xe,D)},e.addHook=function(U,S){typeof S=="function"&&Xi(j[U],S)},e.removeHook=function(U,S){if(S!==void 0){const D=_E(j[U],S);return D===-1?void 0:ME(j[U],D,1)[0]}return kp(j[U])},e.removeHooks=function(U){j[U]=[]},e.removeAllHooks=function(){j=zp()},e}var UE=Ay();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ny;function k(){return Ny.apply(null,arguments)}function YE(t){Ny=t}function pr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Un(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function he(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nd(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(he(t,e))return!1;return!0}function Pt(t){return t===void 0}function rn(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Xo(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Dy(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function bn(t,e){for(var r in e)he(e,r)&&(t[r]=e[r]);return he(e,"toString")&&(t.toString=e.toString),he(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Lr(t,e,r,n){return ib(t,e,r,n,!0).utc()}function qE(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ee(t){return t._pf==null&&(t._pf=qE()),t._pf}var mh;Array.prototype.some?mh=Array.prototype.some:mh=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function id(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=ee(t),r=mh.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Ra(t){var e=Lr(NaN);return t!=null?bn(ee(e),t):ee(e).userInvalidated=!0,e}var Up=k.momentProperties=[],Rc=!1;function od(t,e){var r,n,i,o=Up.length;if(Pt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Pt(e._i)||(t._i=e._i),Pt(e._f)||(t._f=e._f),Pt(e._l)||(t._l=e._l),Pt(e._strict)||(t._strict=e._strict),Pt(e._tzm)||(t._tzm=e._tzm),Pt(e._isUTC)||(t._isUTC=e._isUTC),Pt(e._offset)||(t._offset=e._offset),Pt(e._pf)||(t._pf=ee(e)),Pt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=Up[r],i=e[n],Pt(i)||(t[n]=i);return t}function Zo(t){od(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Rc===!1&&(Rc=!0,k.updateOffset(this),Rc=!1)}function wr(t){return t instanceof Zo||t!=null&&t._isAMomentObject!=null}function Ly(t){k.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function rr(t,e){var r=!0;return bn(function(){if(k.deprecationHandler!=null&&k.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])he(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}Ly(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var Yp={};function ky(t,e){k.deprecationHandler!=null&&k.deprecationHandler(t,e),Yp[t]||(Ly(e),Yp[t]=!0)}k.suppressDeprecationWarnings=!1;k.deprecationHandler=null;function kr(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function GE(t){var e,r;for(r in t)he(t,r)&&(e=t[r],kr(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ph(t,e){var r=bn({},t),n;for(n in e)he(e,n)&&(Un(t[n])&&Un(e[n])?(r[n]={},bn(r[n],t[n]),bn(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)he(t,n)&&!he(e,n)&&Un(t[n])&&(r[n]=bn({},r[n]));return r}function sd(t){t!=null&&this.set(t)}var wh;Object.keys?wh=Object.keys:wh=function(t){var e,r=[];for(e in t)he(t,e)&&r.push(e);return r};var KE={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function XE(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return kr(n)?n.call(e,r):n}function Nr(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var ad=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,gs=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Tc={},Ri={};function Y(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Ri[t]=i),e&&(Ri[e[0]]=function(){return Nr(i.apply(this,arguments),e[1],e[2])}),r&&(Ri[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function ZE(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function QE(t){var e=t.match(ad),r,n;for(r=0,n=e.length;r<n;r++)Ri[e[r]]?e[r]=Ri[e[r]]:e[r]=ZE(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=kr(e[s])?e[s].call(i,t):e[s];return o}}function Us(t,e){return t.isValid()?(e=Fy(e,t.localeData()),Tc[e]=Tc[e]||QE(e),Tc[e](t)):t.localeData().invalidDate()}function Fy(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(gs.lastIndex=0;r>=0&&gs.test(t);)t=t.replace(gs,n),gs.lastIndex=0,r-=1;return t}var JE={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function eO(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(ad).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var tO="Invalid date";function rO(){return this._invalidDate}var nO="%d",iO=/\d{1,2}/;function oO(t){return this._ordinal.replace("%d",t)}var sO={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function aO(t,e,r,n){var i=this._relativeTime[r];return kr(i)?i(t,e,r,n):i.replace(/%d/i,t)}function lO(t,e){var r=this._relativeTime[t>0?"future":"past"];return kr(r)?r(e):r.replace(/%s/i,e)}var qp={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function nr(t){return typeof t=="string"?qp[t]||qp[t.toLowerCase()]:void 0}function ld(t){var e={},r,n;for(n in t)he(t,n)&&(r=nr(n),r&&(e[r]=t[n]));return e}var uO={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function cO(t){var e=[],r;for(r in t)he(t,r)&&e.push({unit:r,priority:uO[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var Vy=/\d/,zt=/\d\d/,Wy=/\d{3}/,ud=/\d{4}/,Ta=/[+-]?\d{6}/,He=/\d\d?/,By=/\d\d\d\d?/,$y=/\d\d\d\d\d\d?/,Ea=/\d{1,3}/,cd=/\d{1,4}/,Oa=/[+-]?\d{1,6}/,Fi=/\d+/,_a=/[+-]?\d+/,hO=/Z|[+-]\d\d:?\d\d/gi,Ma=/Z|[+-]\d\d(?::?\d\d)?/gi,dO=/[+-]?\d+(\.\d{1,3})?/,Qo=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vi=/^[1-9]\d?/,hd=/^([1-9]\d|\d)/,ta;ta={};function F(t,e,r){ta[t]=kr(e)?e:function(n,i){return n&&r?r:e}}function fO(t,e){return he(ta,t)?ta[t](e._strict,e._locale):new RegExp(gO(t))}function gO(t){return en(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function en(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qt(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function se(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Qt(e)),r}var vh={};function we(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),rn(e)&&(n=function(o,s){s[e]=se(o)}),i=t.length,r=0;r<i;r++)vh[t[r]]=n}function Jo(t,e){we(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function mO(t,e,r){e!=null&&he(vh,t)&&vh[t](e,r._a,r,t)}function Ia(t){return t%4===0&&t%100!==0||t%400===0}var dt=0,Zr=1,Pr=2,qe=3,gr=4,Qr=5,jn=6,pO=7,wO=8;Y("Y",0,0,function(){var t=this.year();return t<=9999?Nr(t,4):"+"+t});Y(0,["YY",2],0,function(){return this.year()%100});Y(0,["YYYY",4],0,"year");Y(0,["YYYYY",5],0,"year");Y(0,["YYYYYY",6,!0],0,"year");F("Y",_a);F("YY",He,zt);F("YYYY",cd,ud);F("YYYYY",Oa,Ta);F("YYYYYY",Oa,Ta);we(["YYYYY","YYYYYY"],dt);we("YYYY",function(t,e){e[dt]=t.length===2?k.parseTwoDigitYear(t):se(t)});we("YY",function(t,e){e[dt]=k.parseTwoDigitYear(t)});we("Y",function(t,e){e[dt]=parseInt(t,10)});function _o(t){return Ia(t)?366:365}k.parseTwoDigitYear=function(t){return se(t)+(se(t)>68?1900:2e3)};var jy=Wi("FullYear",!0);function vO(){return Ia(this.year())}function Wi(t,e){return function(r){return r!=null?(zy(this,t,r),k.updateOffset(this,e),this):Ao(this,t)}}function Ao(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function zy(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Ia(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function yO(t){return t=nr(t),kr(this[t])?this[t]():this}function bO(t,e){if(typeof t=="object"){t=ld(t);var r=cO(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=nr(t),kr(this[t]))return this[t](e);return this}function SO(t,e){return(t%e+e)%e}var Fe;Array.prototype.indexOf?Fe=Array.prototype.indexOf:Fe=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function dd(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=SO(e,12);return t+=(e-r)/12,r===1?Ia(t)?29:28:31-r%7%2}Y("M",["MM",2],"Mo",function(){return this.month()+1});Y("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Y("MMMM",0,0,function(t){return this.localeData().months(this,t)});F("M",He,Vi);F("MM",He,zt);F("MMM",function(t,e){return e.monthsShortRegex(t)});F("MMMM",function(t,e){return e.monthsRegex(t)});we(["M","MM"],function(t,e){e[Zr]=se(t)-1});we(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Zr]=i:ee(r).invalidMonth=t});var CO="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Uy="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Yy=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,RO=Qo,TO=Qo;function EO(t,e){return t?pr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Yy).test(e)?"format":"standalone"][t.month()]:pr(this._months)?this._months:this._months.standalone}function OO(t,e){return t?pr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Yy.test(e)?"format":"standalone"][t.month()]:pr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _O(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Lr([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Fe.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Fe.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Fe.call(this._shortMonthsParse,s),i!==-1?i:(i=Fe.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Fe.call(this._longMonthsParse,s),i!==-1?i:(i=Fe.call(this._shortMonthsParse,s),i!==-1?i:null))}function MO(t,e,r){var n,i,o;if(this._monthsParseExact)return _O.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Lr([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function qy(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=se(e);else if(e=t.localeData().monthsParse(e),!rn(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,dd(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function Gy(t){return t!=null?(qy(this,t),k.updateOffset(this,!0),this):Ao(this,"Month")}function IO(){return dd(this.year(),this.month())}function HO(t){return this._monthsParseExact?(he(this,"_monthsRegex")||Ky.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(he(this,"_monthsShortRegex")||(this._monthsShortRegex=RO),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function xO(t){return this._monthsParseExact?(he(this,"_monthsRegex")||Ky.call(this),t?this._monthsStrictRegex:this._monthsRegex):(he(this,"_monthsRegex")||(this._monthsRegex=TO),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Ky(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Lr([2e3,i]),s=en(this.monthsShort(o,"")),a=en(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function PO(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function No(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function ra(t,e,r){var n=7+e-r,i=(7+No(t,0,n).getUTCDay()-e)%7;return-i+n-1}function Xy(t,e,r,n,i){var o=(7+r-n)%7,s=ra(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=_o(l)+a):a>_o(t)?(l=t+1,u=a-_o(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Do(t,e,r){var n=ra(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+tn(s,e,r)):i>tn(t.year(),e,r)?(o=i-tn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function tn(t,e,r){var n=ra(t,e,r),i=ra(t+1,e,r);return(_o(t)-n+i)/7}Y("w",["ww",2],"wo","week");Y("W",["WW",2],"Wo","isoWeek");F("w",He,Vi);F("ww",He,zt);F("W",He,Vi);F("WW",He,zt);Jo(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=se(t)});function AO(t){return Do(t,this._week.dow,this._week.doy).week}var NO={dow:0,doy:6};function DO(){return this._week.dow}function LO(){return this._week.doy}function kO(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function FO(t){var e=Do(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Y("d",0,"do","day");Y("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Y("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Y("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Y("e",0,0,"weekday");Y("E",0,0,"isoWeekday");F("d",He);F("e",He);F("E",He);F("dd",function(t,e){return e.weekdaysMinRegex(t)});F("ddd",function(t,e){return e.weekdaysShortRegex(t)});F("dddd",function(t,e){return e.weekdaysRegex(t)});Jo(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:ee(r).invalidWeekday=t});Jo(["d","e","E"],function(t,e,r,n){e[n]=se(t)});function VO(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function WO(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function fd(t,e){return t.slice(e,7).concat(t.slice(0,e))}var BO="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Zy="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),$O="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),jO=Qo,zO=Qo,UO=Qo;function YO(t,e){var r=pr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?fd(r,this._week.dow):t?r[t.day()]:r}function qO(t){return t===!0?fd(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function GO(t){return t===!0?fd(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function KO(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Lr([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Fe.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Fe.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Fe.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Fe.call(this._weekdaysParse,s),i!==-1||(i=Fe.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Fe.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Fe.call(this._shortWeekdaysParse,s),i!==-1||(i=Fe.call(this._weekdaysParse,s),i!==-1)?i:(i=Fe.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Fe.call(this._minWeekdaysParse,s),i!==-1||(i=Fe.call(this._weekdaysParse,s),i!==-1)?i:(i=Fe.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function XO(t,e,r){var n,i,o;if(this._weekdaysParseExact)return KO.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Lr([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function ZO(t){if(!this.isValid())return t!=null?this:NaN;var e=Ao(this,"Day");return t!=null?(t=VO(t,this.localeData()),this.add(t-e,"d")):e}function QO(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function JO(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=WO(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function e_(t){return this._weekdaysParseExact?(he(this,"_weekdaysRegex")||gd.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(he(this,"_weekdaysRegex")||(this._weekdaysRegex=jO),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function t_(t){return this._weekdaysParseExact?(he(this,"_weekdaysRegex")||gd.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(he(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zO),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function r_(t){return this._weekdaysParseExact?(he(this,"_weekdaysRegex")||gd.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(he(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=UO),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function gd(){function t(c,d){return d.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Lr([2e3,1]).day(o),a=en(this.weekdaysMin(s,"")),l=en(this.weekdaysShort(s,"")),u=en(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function md(){return this.hours()%12||12}function n_(){return this.hours()||24}Y("H",["HH",2],0,"hour");Y("h",["hh",2],0,md);Y("k",["kk",2],0,n_);Y("hmm",0,0,function(){return""+md.apply(this)+Nr(this.minutes(),2)});Y("hmmss",0,0,function(){return""+md.apply(this)+Nr(this.minutes(),2)+Nr(this.seconds(),2)});Y("Hmm",0,0,function(){return""+this.hours()+Nr(this.minutes(),2)});Y("Hmmss",0,0,function(){return""+this.hours()+Nr(this.minutes(),2)+Nr(this.seconds(),2)});function Qy(t,e){Y(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Qy("a",!0);Qy("A",!1);function Jy(t,e){return e._meridiemParse}F("a",Jy);F("A",Jy);F("H",He,hd);F("h",He,Vi);F("k",He,Vi);F("HH",He,zt);F("hh",He,zt);F("kk",He,zt);F("hmm",By);F("hmmss",$y);F("Hmm",By);F("Hmmss",$y);we(["H","HH"],qe);we(["k","kk"],function(t,e,r){var n=se(t);e[qe]=n===24?0:n});we(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});we(["h","hh"],function(t,e,r){e[qe]=se(t),ee(r).bigHour=!0});we("hmm",function(t,e,r){var n=t.length-2;e[qe]=se(t.substr(0,n)),e[gr]=se(t.substr(n)),ee(r).bigHour=!0});we("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[qe]=se(t.substr(0,n)),e[gr]=se(t.substr(n,2)),e[Qr]=se(t.substr(i)),ee(r).bigHour=!0});we("Hmm",function(t,e,r){var n=t.length-2;e[qe]=se(t.substr(0,n)),e[gr]=se(t.substr(n))});we("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[qe]=se(t.substr(0,n)),e[gr]=se(t.substr(n,2)),e[Qr]=se(t.substr(i))});function i_(t){return(t+"").toLowerCase().charAt(0)==="p"}var o_=/[ap]\.?m?\.?/i,s_=Wi("Hours",!0);function a_(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var eb={calendar:KE,longDateFormat:JE,invalidDate:tO,ordinal:nO,dayOfMonthOrdinalParse:iO,relativeTime:sO,months:CO,monthsShort:Uy,week:NO,weekdays:BO,weekdaysMin:$O,weekdaysShort:Zy,meridiemParse:o_},Pe={},to={},Lo;function l_(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function Gp(t){return t&&t.toLowerCase().replace("_","-")}function u_(t){for(var e=0,r,n,i,o;e<t.length;){for(o=Gp(t[e]).split("-"),r=o.length,n=Gp(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Ha(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&l_(o,n)>=r-1)break;r--}e++}return Lo}function c_(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Ha(t){var e=null,r;if(Pe[t]===void 0&&typeof module<"u"&&module&&module.exports&&c_(t))try{e=Lo._abbr,r=require,r("./locale/"+t),Cn(e)}catch{Pe[t]=null}return Pe[t]}function Cn(t,e){var r;return t&&(Pt(e)?r=on(t):r=pd(t,e),r?Lo=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Lo._abbr}function pd(t,e){if(e!==null){var r,n=eb;if(e.abbr=t,Pe[t]!=null)ky("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Pe[t]._config;else if(e.parentLocale!=null)if(Pe[e.parentLocale]!=null)n=Pe[e.parentLocale]._config;else if(r=Ha(e.parentLocale),r!=null)n=r._config;else return to[e.parentLocale]||(to[e.parentLocale]=[]),to[e.parentLocale].push({name:t,config:e}),null;return Pe[t]=new sd(ph(n,e)),to[t]&&to[t].forEach(function(i){pd(i.name,i.config)}),Cn(t),Pe[t]}else return delete Pe[t],null}function h_(t,e){if(e!=null){var r,n,i=eb;Pe[t]!=null&&Pe[t].parentLocale!=null?Pe[t].set(ph(Pe[t]._config,e)):(n=Ha(t),n!=null&&(i=n._config),e=ph(i,e),n==null&&(e.abbr=t),r=new sd(e),r.parentLocale=Pe[t],Pe[t]=r),Cn(t)}else Pe[t]!=null&&(Pe[t].parentLocale!=null?(Pe[t]=Pe[t].parentLocale,t===Cn()&&Cn(t)):Pe[t]!=null&&delete Pe[t]);return Pe[t]}function on(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Lo;if(!pr(t)){if(e=Ha(t),e)return e;t=[t]}return u_(t)}function d_(){return wh(Pe)}function wd(t){var e,r=t._a;return r&&ee(t).overflow===-2&&(e=r[Zr]<0||r[Zr]>11?Zr:r[Pr]<1||r[Pr]>dd(r[dt],r[Zr])?Pr:r[qe]<0||r[qe]>24||r[qe]===24&&(r[gr]!==0||r[Qr]!==0||r[jn]!==0)?qe:r[gr]<0||r[gr]>59?gr:r[Qr]<0||r[Qr]>59?Qr:r[jn]<0||r[jn]>999?jn:-1,ee(t)._overflowDayOfYear&&(e<dt||e>Pr)&&(e=Pr),ee(t)._overflowWeeks&&e===-1&&(e=pO),ee(t)._overflowWeekday&&e===-1&&(e=wO),ee(t).overflow=e),t}var f_=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,g_=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,m_=/Z|[+-]\d\d(?::?\d\d)?/,ms=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ec=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],p_=/^\/?Date\((-?\d+)/i,w_=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,v_={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function tb(t){var e,r,n=t._i,i=f_.exec(n)||g_.exec(n),o,s,a,l,u=ms.length,c=Ec.length;if(i){for(ee(t).iso=!0,e=0,r=u;e<r;e++)if(ms[e][1].exec(i[1])){s=ms[e][0],o=ms[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Ec[e][1].exec(i[3])){a=(i[2]||" ")+Ec[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(m_.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),yd(t)}else t._isValid=!1}function y_(t,e,r,n,i,o){var s=[b_(t),Uy.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function b_(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function S_(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function C_(t,e,r){if(t){var n=Zy.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return ee(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function R_(t,e,r){if(t)return v_[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function rb(t){var e=w_.exec(S_(t._i)),r;if(e){if(r=y_(e[4],e[3],e[2],e[5],e[6],e[7]),!C_(e[1],r,t))return;t._a=r,t._tzm=R_(e[8],e[9],e[10]),t._d=No.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ee(t).rfc2822=!0}else t._isValid=!1}function T_(t){var e=p_.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(tb(t),t._isValid===!1)delete t._isValid;else return;if(rb(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:k.createFromInputFallback(t)}k.createFromInputFallback=rr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function yi(t,e,r){return t??e??r}function E_(t){var e=new Date(k.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vd(t){var e,r,n=[],i,o,s;if(!t._d){for(i=E_(t),t._w&&t._a[Pr]==null&&t._a[Zr]==null&&O_(t),t._dayOfYear!=null&&(s=yi(t._a[dt],i[dt]),(t._dayOfYear>_o(s)||t._dayOfYear===0)&&(ee(t)._overflowDayOfYear=!0),r=No(s,0,t._dayOfYear),t._a[Zr]=r.getUTCMonth(),t._a[Pr]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[qe]===24&&t._a[gr]===0&&t._a[Qr]===0&&t._a[jn]===0&&(t._nextDay=!0,t._a[qe]=0),t._d=(t._useUTC?No:PO).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[qe]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ee(t).weekdayMismatch=!0)}}function O_(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=yi(e.GG,t._a[dt],Do(Me(),1,4).year),n=yi(e.W,1),i=yi(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Do(Me(),o,s),r=yi(e.gg,t._a[dt],u.year),n=yi(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>tn(r,o,s)?ee(t)._overflowWeeks=!0:l!=null?ee(t)._overflowWeekday=!0:(a=Xy(r,n,i,o,s),t._a[dt]=a.year,t._dayOfYear=a.dayOfYear)}k.ISO_8601=function(){};k.RFC_2822=function(){};function yd(t){if(t._f===k.ISO_8601){tb(t);return}if(t._f===k.RFC_2822){rb(t);return}t._a=[],ee(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=Fy(t._f,t._locale).match(ad)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(fO(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&ee(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Ri[o]?(n?ee(t).empty=!1:ee(t).unusedTokens.push(o),mO(o,n,t)):t._strict&&!n&&ee(t).unusedTokens.push(o);ee(t).charsLeftOver=a-l,e.length>0&&ee(t).unusedInput.push(e),t._a[qe]<=12&&ee(t).bigHour===!0&&t._a[qe]>0&&(ee(t).bigHour=void 0),ee(t).parsedDateParts=t._a.slice(0),ee(t).meridiem=t._meridiem,t._a[qe]=__(t._locale,t._a[qe],t._meridiem),u=ee(t).era,u!==null&&(t._a[dt]=t._locale.erasConvertYear(u,t._a[dt])),vd(t),wd(t)}function __(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function M_(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){ee(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=od({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],yd(e),id(e)&&(s=!0),o+=ee(e).charsLeftOver,o+=ee(e).unusedTokens.length*10,ee(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));bn(t,r||e)}function I_(t){if(!t._d){var e=ld(t._i),r=e.day===void 0?e.date:e.day;t._a=Dy([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),vd(t)}}function H_(t){var e=new Zo(wd(nb(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function nb(t){var e=t._i,r=t._f;return t._locale=t._locale||on(t._l),e===null||r===void 0&&e===""?Ra({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),wr(e)?new Zo(wd(e)):(Xo(e)?t._d=e:pr(r)?M_(t):r?yd(t):x_(t),id(t)||(t._d=null),t))}function x_(t){var e=t._i;Pt(e)?t._d=new Date(k.now()):Xo(e)?t._d=new Date(e.valueOf()):typeof e=="string"?T_(t):pr(e)?(t._a=Dy(e.slice(0),function(r){return parseInt(r,10)}),vd(t)):Un(e)?I_(t):rn(e)?t._d=new Date(e):k.createFromInputFallback(t)}function ib(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Un(t)&&nd(t)||pr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,H_(o)}function Me(t,e,r,n){return ib(t,e,r,n,!1)}var P_=rr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Me.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ra()}),A_=rr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Me.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ra()});function ob(t,e){var r,n;if(e.length===1&&pr(e[0])&&(e=e[0]),!e.length)return Me();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function N_(){var t=[].slice.call(arguments,0);return ob("isBefore",t)}function D_(){var t=[].slice.call(arguments,0);return ob("isAfter",t)}var L_=function(){return Date.now?Date.now():+new Date},ro=["year","quarter","month","week","day","hour","minute","second","millisecond"];function k_(t){var e,r=!1,n,i=ro.length;for(e in t)if(he(t,e)&&!(Fe.call(ro,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[ro[n]]){if(r)return!1;parseFloat(t[ro[n]])!==se(t[ro[n]])&&(r=!0)}return!0}function F_(){return this._isValid}function V_(){return Sr(NaN)}function xa(t){var e=ld(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=k_(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=on(),this._bubble()}function Ys(t){return t instanceof xa}function yh(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function W_(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)se(t[s])!==se(e[s])&&o++;return o+i}function sb(t,e){Y(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Nr(~~(r/60),2)+e+Nr(~~r%60,2)})}sb("Z",":");sb("ZZ","");F("Z",Ma);F("ZZ",Ma);we(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=bd(Ma,t)});var B_=/([\+\-]|\d\d)/gi;function bd(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(B_)||["-",0,0],o=+(i[1]*60)+se(i[2]),o===0?0:i[0]==="+"?o:-o)}function Sd(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(wr(t)||Xo(t)?t.valueOf():Me(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),k.updateOffset(r,!1),r):Me(t).local()}function bh(t){return-Math.round(t._d.getTimezoneOffset())}k.updateOffset=function(){};function $_(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=bd(Ma,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=bh(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?ub(this,Sr(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,k.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:bh(this)}function j_(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function z_(t){return this.utcOffset(0,t)}function U_(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(bh(this),"m")),this}function Y_(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=bd(hO,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function q_(t){return this.isValid()?(t=t?Me(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function G_(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function K_(){if(!Pt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return od(t,this),t=nb(t),t._a?(e=t._isUTC?Lr(t._a):Me(t._a),this._isDSTShifted=this.isValid()&&W_(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function X_(){return this.isValid()?!this._isUTC:!1}function Z_(){return this.isValid()?this._isUTC:!1}function ab(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Q_=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,J_=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Sr(t,e){var r=t,n=null,i,o,s;return Ys(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:rn(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=Q_.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:se(n[Pr])*i,h:se(n[qe])*i,m:se(n[gr])*i,s:se(n[Qr])*i,ms:se(yh(n[jn]*1e3))*i}):(n=J_.exec(t))?(i=n[1]==="-"?-1:1,r={y:xn(n[2],i),M:xn(n[3],i),w:xn(n[4],i),d:xn(n[5],i),h:xn(n[6],i),m:xn(n[7],i),s:xn(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=e0(Me(r.from),Me(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new xa(r),Ys(t)&&he(t,"_locale")&&(o._locale=t._locale),Ys(t)&&he(t,"_isValid")&&(o._isValid=t._isValid),o}Sr.fn=xa.prototype;Sr.invalid=V_;function xn(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function Kp(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function e0(t,e){var r;return t.isValid()&&e.isValid()?(e=Sd(e,t),t.isBefore(e)?r=Kp(t,e):(r=Kp(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function lb(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(ky(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=Sr(r,n),ub(this,i,t),this}}function ub(t,e,r,n){var i=e._milliseconds,o=yh(e._days),s=yh(e._months);t.isValid()&&(n=n??!0,s&&qy(t,Ao(t,"Month")+s*r),o&&zy(t,"Date",Ao(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&k.updateOffset(t,o||s))}var t0=lb(1,"add"),r0=lb(-1,"subtract");function cb(t){return typeof t=="string"||t instanceof String}function n0(t){return wr(t)||Xo(t)||cb(t)||rn(t)||o0(t)||i0(t)||t===null||t===void 0}function i0(t){var e=Un(t)&&!nd(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||he(t,o);return e&&r}function o0(t){var e=pr(t),r=!1;return e&&(r=t.filter(function(n){return!rn(n)&&cb(t)}).length===0),e&&r}function s0(t){var e=Un(t)&&!nd(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||he(t,o);return e&&r}function a0(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function l0(t,e){arguments.length===1&&(arguments[0]?n0(arguments[0])?(t=arguments[0],e=void 0):s0(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Me(),n=Sd(r,this).startOf("day"),i=k.calendarFormat(this,n)||"sameElse",o=e&&(kr(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Me(r)))}function u0(){return new Zo(this)}function c0(t,e){var r=wr(t)?t:Me(t);return this.isValid()&&r.isValid()?(e=nr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function h0(t,e){var r=wr(t)?t:Me(t);return this.isValid()&&r.isValid()?(e=nr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function d0(t,e,r,n){var i=wr(t)?t:Me(t),o=wr(e)?e:Me(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function f0(t,e){var r=wr(t)?t:Me(t),n;return this.isValid()&&r.isValid()?(e=nr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function g0(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function m0(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function p0(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=Sd(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=nr(e),e){case"year":o=qs(this,n)/12;break;case"month":o=qs(this,n);break;case"quarter":o=qs(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Qt(o)}function qs(t,e){if(t.date()<e.date())return-qs(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}k.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";k.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function w0(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function v0(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Us(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):kr(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Us(r,"Z")):Us(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function y0(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function b0(t){t||(t=this.isUtc()?k.defaultFormatUtc:k.defaultFormat);var e=Us(this,t);return this.localeData().postformat(e)}function S0(t,e){return this.isValid()&&(wr(t)&&t.isValid()||Me(t).isValid())?Sr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function C0(t){return this.from(Me(),t)}function R0(t,e){return this.isValid()&&(wr(t)&&t.isValid()||Me(t).isValid())?Sr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function T0(t){return this.to(Me(),t)}function hb(t){var e;return t===void 0?this._locale._abbr:(e=on(t),e!=null&&(this._locale=e),this)}var db=rr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function fb(){return this._locale}var na=1e3,Ti=60*na,ia=60*Ti,gb=(365*400+97)*24*ia;function Ei(t,e){return(t%e+e)%e}function mb(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-gb:new Date(t,e,r).valueOf()}function pb(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-gb:Date.UTC(t,e,r)}function E0(t){var e,r;if(t=nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?pb:mb,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ei(e+(this._isUTC?0:this.utcOffset()*Ti),ia);break;case"minute":e=this._d.valueOf(),e-=Ei(e,Ti);break;case"second":e=this._d.valueOf(),e-=Ei(e,na);break}return this._d.setTime(e),k.updateOffset(this,!0),this}function O0(t){var e,r;if(t=nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?pb:mb,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=ia-Ei(e+(this._isUTC?0:this.utcOffset()*Ti),ia)-1;break;case"minute":e=this._d.valueOf(),e+=Ti-Ei(e,Ti)-1;break;case"second":e=this._d.valueOf(),e+=na-Ei(e,na)-1;break}return this._d.setTime(e),k.updateOffset(this,!0),this}function _0(){return this._d.valueOf()-(this._offset||0)*6e4}function M0(){return Math.floor(this.valueOf()/1e3)}function I0(){return new Date(this.valueOf())}function H0(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function x0(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function P0(){return this.isValid()?this.toISOString():null}function A0(){return id(this)}function N0(){return bn({},ee(this))}function D0(){return ee(this).overflow}function L0(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Y("N",0,0,"eraAbbr");Y("NN",0,0,"eraAbbr");Y("NNN",0,0,"eraAbbr");Y("NNNN",0,0,"eraName");Y("NNNNN",0,0,"eraNarrow");Y("y",["y",1],"yo","eraYear");Y("y",["yy",2],0,"eraYear");Y("y",["yyy",3],0,"eraYear");Y("y",["yyyy",4],0,"eraYear");F("N",Cd);F("NN",Cd);F("NNN",Cd);F("NNNN",q0);F("NNNNN",G0);we(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?ee(r).era=i:ee(r).invalidEra=t});F("y",Fi);F("yy",Fi);F("yyy",Fi);F("yyyy",Fi);F("yo",K0);we(["y","yy","yyy","yyyy"],dt);we(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[dt]=r._locale.eraYearOrdinalParse(t,i):e[dt]=parseInt(t,10)});function k0(t,e){var r,n,i,o=this._eras||on("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=k(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=k(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function F0(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function V0(t,e){var r=t.since<=t.until?1:-1;return e===void 0?k(t.since).year():k(t.since).year()+(e-t.offset)*r}function W0(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function B0(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function $0(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function j0(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-k(i[t].since).year())*r+i[t].offset;return this.year()}function z0(t){return he(this,"_erasNameRegex")||Rd.call(this),t?this._erasNameRegex:this._erasRegex}function U0(t){return he(this,"_erasAbbrRegex")||Rd.call(this),t?this._erasAbbrRegex:this._erasRegex}function Y0(t){return he(this,"_erasNarrowRegex")||Rd.call(this),t?this._erasNarrowRegex:this._erasRegex}function Cd(t,e){return e.erasAbbrRegex(t)}function q0(t,e){return e.erasNameRegex(t)}function G0(t,e){return e.erasNarrowRegex(t)}function K0(t,e){return e._eraYearOrdinalRegex||Fi}function Rd(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=en(u[i].name),a=en(u[i].abbr),l=en(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Y(0,["gg",2],0,function(){return this.weekYear()%100});Y(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Pa(t,e){Y(0,[t,t.length],0,e)}Pa("gggg","weekYear");Pa("ggggg","weekYear");Pa("GGGG","isoWeekYear");Pa("GGGGG","isoWeekYear");F("G",_a);F("g",_a);F("GG",He,zt);F("gg",He,zt);F("GGGG",cd,ud);F("gggg",cd,ud);F("GGGGG",Oa,Ta);F("ggggg",Oa,Ta);Jo(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=se(t)});Jo(["gg","GG"],function(t,e,r,n){e[n]=k.parseTwoDigitYear(t)});function X0(t){return wb.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Z0(t){return wb.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Q0(){return tn(this.year(),1,4)}function J0(){return tn(this.isoWeekYear(),1,4)}function eM(){var t=this.localeData()._week;return tn(this.year(),t.dow,t.doy)}function tM(){var t=this.localeData()._week;return tn(this.weekYear(),t.dow,t.doy)}function wb(t,e,r,n,i){var o;return t==null?Do(this,n,i).year:(o=tn(t,n,i),e>o&&(e=o),rM.call(this,t,e,r,n,i))}function rM(t,e,r,n,i){var o=Xy(t,e,r,n,i),s=No(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Y("Q",0,"Qo","quarter");F("Q",Vy);we("Q",function(t,e){e[Zr]=(se(t)-1)*3});function nM(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Y("D",["DD",2],"Do","date");F("D",He,Vi);F("DD",He,zt);F("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});we(["D","DD"],Pr);we("Do",function(t,e){e[Pr]=se(t.match(He)[0])});var vb=Wi("Date",!0);Y("DDD",["DDDD",3],"DDDo","dayOfYear");F("DDD",Ea);F("DDDD",Wy);we(["DDD","DDDD"],function(t,e,r){r._dayOfYear=se(t)});function iM(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Y("m",["mm",2],0,"minute");F("m",He,hd);F("mm",He,zt);we(["m","mm"],gr);var oM=Wi("Minutes",!1);Y("s",["ss",2],0,"second");F("s",He,hd);F("ss",He,zt);we(["s","ss"],Qr);var sM=Wi("Seconds",!1);Y("S",0,0,function(){return~~(this.millisecond()/100)});Y(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Y(0,["SSS",3],0,"millisecond");Y(0,["SSSS",4],0,function(){return this.millisecond()*10});Y(0,["SSSSS",5],0,function(){return this.millisecond()*100});Y(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Y(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Y(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Y(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});F("S",Ea,Vy);F("SS",Ea,zt);F("SSS",Ea,Wy);var Sn,yb;for(Sn="SSSS";Sn.length<=9;Sn+="S")F(Sn,Fi);function aM(t,e){e[jn]=se(("0."+t)*1e3)}for(Sn="S";Sn.length<=9;Sn+="S")we(Sn,aM);yb=Wi("Milliseconds",!1);Y("z",0,0,"zoneAbbr");Y("zz",0,0,"zoneName");function lM(){return this._isUTC?"UTC":""}function uM(){return this._isUTC?"Coordinated Universal Time":""}var A=Zo.prototype;A.add=t0;A.calendar=l0;A.clone=u0;A.diff=p0;A.endOf=O0;A.format=b0;A.from=S0;A.fromNow=C0;A.to=R0;A.toNow=T0;A.get=yO;A.invalidAt=D0;A.isAfter=c0;A.isBefore=h0;A.isBetween=d0;A.isSame=f0;A.isSameOrAfter=g0;A.isSameOrBefore=m0;A.isValid=A0;A.lang=db;A.locale=hb;A.localeData=fb;A.max=A_;A.min=P_;A.parsingFlags=N0;A.set=bO;A.startOf=E0;A.subtract=r0;A.toArray=H0;A.toObject=x0;A.toDate=I0;A.toISOString=v0;A.inspect=y0;typeof Symbol<"u"&&Symbol.for!=null&&(A[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});A.toJSON=P0;A.toString=w0;A.unix=M0;A.valueOf=_0;A.creationData=L0;A.eraName=W0;A.eraNarrow=B0;A.eraAbbr=$0;A.eraYear=j0;A.year=jy;A.isLeapYear=vO;A.weekYear=X0;A.isoWeekYear=Z0;A.quarter=A.quarters=nM;A.month=Gy;A.daysInMonth=IO;A.week=A.weeks=kO;A.isoWeek=A.isoWeeks=FO;A.weeksInYear=eM;A.weeksInWeekYear=tM;A.isoWeeksInYear=Q0;A.isoWeeksInISOWeekYear=J0;A.date=vb;A.day=A.days=ZO;A.weekday=QO;A.isoWeekday=JO;A.dayOfYear=iM;A.hour=A.hours=s_;A.minute=A.minutes=oM;A.second=A.seconds=sM;A.millisecond=A.milliseconds=yb;A.utcOffset=$_;A.utc=z_;A.local=U_;A.parseZone=Y_;A.hasAlignedHourOffset=q_;A.isDST=G_;A.isLocal=X_;A.isUtcOffset=Z_;A.isUtc=ab;A.isUTC=ab;A.zoneAbbr=lM;A.zoneName=uM;A.dates=rr("dates accessor is deprecated. Use date instead.",vb);A.months=rr("months accessor is deprecated. Use month instead",Gy);A.years=rr("years accessor is deprecated. Use year instead",jy);A.zone=rr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",j_);A.isDSTShifted=rr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",K_);function cM(t){return Me(t*1e3)}function hM(){return Me.apply(null,arguments).parseZone()}function bb(t){return t}var de=sd.prototype;de.calendar=XE;de.longDateFormat=eO;de.invalidDate=rO;de.ordinal=oO;de.preparse=bb;de.postformat=bb;de.relativeTime=aO;de.pastFuture=lO;de.set=GE;de.eras=k0;de.erasParse=F0;de.erasConvertYear=V0;de.erasAbbrRegex=U0;de.erasNameRegex=z0;de.erasNarrowRegex=Y0;de.months=EO;de.monthsShort=OO;de.monthsParse=MO;de.monthsRegex=xO;de.monthsShortRegex=HO;de.week=AO;de.firstDayOfYear=LO;de.firstDayOfWeek=DO;de.weekdays=YO;de.weekdaysMin=GO;de.weekdaysShort=qO;de.weekdaysParse=XO;de.weekdaysRegex=e_;de.weekdaysShortRegex=t_;de.weekdaysMinRegex=r_;de.isPM=i_;de.meridiem=a_;function oa(t,e,r,n){var i=on(),o=Lr().set(n,e);return i[r](o,t)}function Sb(t,e,r){if(rn(t)&&(e=t,t=void 0),t=t||"",e!=null)return oa(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=oa(t,n,r,"month");return i}function Td(t,e,r,n){typeof t=="boolean"?(rn(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,rn(e)&&(r=e,e=void 0),e=e||"");var i=on(),o=t?i._week.dow:0,s,a=[];if(r!=null)return oa(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=oa(e,(s+o)%7,n,"day");return a}function dM(t,e){return Sb(t,e,"months")}function fM(t,e){return Sb(t,e,"monthsShort")}function gM(t,e,r){return Td(t,e,r,"weekdays")}function mM(t,e,r){return Td(t,e,r,"weekdaysShort")}function pM(t,e,r){return Td(t,e,r,"weekdaysMin")}Cn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=se(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});k.lang=rr("moment.lang is deprecated. Use moment.locale instead.",Cn);k.langData=rr("moment.langData is deprecated. Use moment.localeData instead.",on);var Br=Math.abs;function wM(){var t=this._data;return this._milliseconds=Br(this._milliseconds),this._days=Br(this._days),this._months=Br(this._months),t.milliseconds=Br(t.milliseconds),t.seconds=Br(t.seconds),t.minutes=Br(t.minutes),t.hours=Br(t.hours),t.months=Br(t.months),t.years=Br(t.years),this}function Cb(t,e,r,n){var i=Sr(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function vM(t,e){return Cb(this,t,e,1)}function yM(t,e){return Cb(this,t,e,-1)}function Xp(t){return t<0?Math.floor(t):Math.ceil(t)}function bM(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=Xp(Sh(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Qt(t/1e3),n.seconds=i%60,o=Qt(i/60),n.minutes=o%60,s=Qt(o/60),n.hours=s%24,e+=Qt(s/24),l=Qt(Rb(e)),r+=l,e-=Xp(Sh(l)),a=Qt(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function Rb(t){return t*4800/146097}function Sh(t){return t*146097/4800}function SM(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=nr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+Rb(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Sh(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function sn(t){return function(){return this.as(t)}}var Tb=sn("ms"),CM=sn("s"),RM=sn("m"),TM=sn("h"),EM=sn("d"),OM=sn("w"),_M=sn("M"),MM=sn("Q"),IM=sn("y"),HM=Tb;function xM(){return Sr(this)}function PM(t){return t=nr(t),this.isValid()?this[t+"s"]():NaN}function ni(t){return function(){return this.isValid()?this._data[t]:NaN}}var AM=ni("milliseconds"),NM=ni("seconds"),DM=ni("minutes"),LM=ni("hours"),kM=ni("days"),FM=ni("months"),VM=ni("years");function WM(){return Qt(this.days()/7)}var Gr=Math.round,Si={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function BM(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function $M(t,e,r,n){var i=Sr(t).abs(),o=Gr(i.as("s")),s=Gr(i.as("m")),a=Gr(i.as("h")),l=Gr(i.as("d")),u=Gr(i.as("M")),c=Gr(i.as("w")),d=Gr(i.as("y")),f=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(f=f||c<=1&&["w"]||c<r.w&&["ww",c]),f=f||u<=1&&["M"]||u<r.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+t>0,f[4]=n,BM.apply(null,f)}function jM(t){return t===void 0?Gr:typeof t=="function"?(Gr=t,!0):!1}function zM(t,e){return Si[t]===void 0?!1:e===void 0?Si[t]:(Si[t]=e,t==="s"&&(Si.ss=e-1),!0)}function UM(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Si,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Si,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=$M(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Oc=Math.abs;function ai(t){return(t>0)-(t<0)||+t}function Aa(){if(!this.isValid())return this.localeData().invalidDate();var t=Oc(this._milliseconds)/1e3,e=Oc(this._days),r=Oc(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(n=Qt(t/60),i=Qt(n/60),t%=60,n%=60,o=Qt(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ai(this._months)!==ai(a)?"-":"",c=ai(this._days)!==ai(a)?"-":"",d=ai(this._milliseconds)!==ai(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?d+i+"H":"")+(n?d+n+"M":"")+(t?d+s+"S":"")):"P0D"}var ce=xa.prototype;ce.isValid=F_;ce.abs=wM;ce.add=vM;ce.subtract=yM;ce.as=SM;ce.asMilliseconds=Tb;ce.asSeconds=CM;ce.asMinutes=RM;ce.asHours=TM;ce.asDays=EM;ce.asWeeks=OM;ce.asMonths=_M;ce.asQuarters=MM;ce.asYears=IM;ce.valueOf=HM;ce._bubble=bM;ce.clone=xM;ce.get=PM;ce.milliseconds=AM;ce.seconds=NM;ce.minutes=DM;ce.hours=LM;ce.days=kM;ce.weeks=WM;ce.months=FM;ce.years=VM;ce.humanize=UM;ce.toISOString=Aa;ce.toString=Aa;ce.toJSON=Aa;ce.locale=hb;ce.localeData=fb;ce.toIsoString=rr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Aa);ce.lang=db;Y("X",0,0,"unix");Y("x",0,0,"valueOf");F("x",_a);F("X",dO);we("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});we("x",function(t,e,r){r._d=new Date(se(t))});//! moment.js
k.version="2.30.1";YE(Me);k.fn=A;k.min=N_;k.max=D_;k.now=L_;k.utc=Lr;k.unix=cM;k.months=dM;k.isDate=Xo;k.locale=Cn;k.invalid=Ra;k.duration=Sr;k.isMoment=wr;k.weekdays=gM;k.parseZone=hM;k.localeData=on;k.isDuration=Ys;k.monthsShort=fM;k.weekdaysMin=pM;k.defineLocale=pd;k.updateLocale=h_;k.locales=d_;k.weekdaysShort=mM;k.normalizeUnits=nr;k.relativeTimeRounding=jM;k.relativeTimeThreshold=zM;k.calendarFormat=a0;k.prototype=A;k.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Eb(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function Ch(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Gs(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function ir(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(n&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ed(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function Tn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function X(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function Ob(t){return ir(t,(e,r)=>e+r,0)}function YM(t){return ir(t,(e,r)=>e>r?e:r,Array.isArray(t)?t[0]:void 0)}function qM(t){return ir(t,(e,r)=>e<r?e:r,Array.isArray(t)?t[0]:void 0)}function GM(t){return t.length?Ob(t)/t.length:0}function _b(t){return ir(t,(e,r)=>e.concat(Array.isArray(r)?_b(r):r),[])}function KM(t){const e=[];return X(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function Rh(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return X(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function XM(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return X(i,s=>{o=o.filter(a=>s.includes(a))}),o}function ZM(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e],o=new Set(n);return X(i,s=>{X(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function Th(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const $L=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:GM,arrayEach:X,arrayFilter:Ed,arrayFlatten:_b,arrayMap:Tn,arrayMax:YM,arrayMin:qM,arrayReduce:ir,arraySum:Ob,arrayUnique:KM,extendArray:Ch,getDifferenceOfArrays:Rh,getIntersectionOfArrays:XM,getUnionOfArrays:ZM,pivot:Gs,stringToArray:Th,to2dArray:Eb},Symbol.toStringTag,{value:"Module"}));function Bt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return ir(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Na(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function oe(t){return typeof t<"u"}function wt(t){return typeof t>"u"}function En(t){return t===null||t===""||wt(t)}function Mb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Co="length",Mo=t=>parseInt(t,16),Zp=t=>parseInt(t,10),sa=(t,e,r)=>t.substr(e,r),Io=t=>t.codePointAt(0)-65,Eh=t=>`${t}`.replace(/\-/g,""),QM=t=>Mo(sa(Eh(t),Mo("12"),Io("F")))/(Mo(sa(Eh(t),Io("B"),~~![][Co]))||9),JM=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Qp=!1;const Jp={invalid:()=>Bt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},ew={invalid:()=>Bt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Ib(t,e){const r=!En(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.2.0";let o,s="invalid",a="invalid";t=Eh(t||"");const l=eI(t);if(r||n||l)if(l){const u=k("19/03/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=QM(t);o=k((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(JM()&&(s="valid",a="valid"),!Qp&&s!=="valid"&&(Jp[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Jp[s]({keyValidityDate:o,hotVersion:i})),Qp=!0),a!=="valid"&&e.parentNode&&ew[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=ew[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function eI(t){let e=[][Co],r=e;if(t[Co]!==Io("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=Io(i.shift());o;o=Io(i.shift()||"A"))--o<""[Co]?r=r|(Zp(`${Zp(Mo(n)+(Mo(sa(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=sa(t,o,o?i[Co]===1?9:8:6);return r===e}const jL=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Ib,isDefined:oe,isEmpty:En,isRegExp:Mb,isUndefined:wt,stringify:Na},Symbol.toStringTag,{value:"Module"}));function es(t){return t[0].toUpperCase()+t.substr(1)}function tI(){const t=[];for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];let i=r.length;for(;i;){i-=1;const o=Na(r[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function Od(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function rI(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Hb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function nI(t){return _d(`${t}`,{ALLOWED_TAGS:[]})}function _d(t,e){return UE.sanitize(t,e)}const zL=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:tI,isPercentValue:rI,randomString:Od,sanitize:_d,stripTags:nI,substitute:Hb,toUpperCaseFirst:es},Symbol.toStringTag,{value:"Module"})),ts=t=>["tabindex",t],iI=()=>["role","treegrid"],Jr=()=>["role","presentation"],oI=()=>["role","gridcell"],sI=()=>["role","rowheader"],xb=()=>["role","rowgroup"],aI=()=>["role","columnheader"],Oh=()=>["role","row"],UL=()=>["role","menu"],YL=()=>["role","menuitem"],qL=()=>["role","menuitemcheckbox"],GL=()=>["role","combobox"],KL=()=>["role","listbox"],XL=()=>["role","option"],ZL=()=>["role","checkbox"],lI=()=>["scope","col"],uI=()=>["scope","row"],QL=()=>["type","text"],JL=t=>["aria-label",t],Pb=()=>["aria-hidden","true"],ek=()=>["aria-disabled","true"],cI=()=>["aria-multiselectable","true"],tk=t=>["aria-haspopup",t],Ab=t=>["aria-rowcount",t],Da=t=>["aria-colcount",t],Nb=t=>["aria-rowindex",t],Md=t=>["aria-colindex",t],rk=t=>["aria-expanded",t],nk=t=>["aria-sort",t],tw=()=>["aria-readonly","true"],rw=()=>["aria-invalid","true"],ik=t=>["aria-checked",t],Db=()=>["aria-selected","true"],ok=()=>["aria-autocomplete","list"],sk=t=>["aria-controls",t],ak=t=>["aria-activedescendant",t],lk=t=>["aria-live",t],uk=t=>["aria-relevant",t],ck=t=>["aria-setsize",t],hk=t=>["aria-posinset",t];function Lb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function kb(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function Fb(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ko(t){return Fb(t)&&t.parent}function hI(t){return!!Object.getPrototypeOf(t.parent)}function Id(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ro(t,e,r){const n=[];let i=t;for(;i&&(i=Id(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function Vb(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function aa(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function Wb(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function pn(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function Bb(t){return!t||!t.length?[]:t.filter(e=>!!e)}function $b(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function re(t,e){typeof e=="string"&&(e=e.split(" ")),e=Bb(e),e.length>0&&t.classList.add(...e)}function ye(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=$b(e,!0);r=Bb(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Bi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=$b(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Hd(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)Hd(e[r])}}function Hi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const jb=/(<(.*)>|&(.*);)/;function zb(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;jb.test(e)?t.innerHTML=r?_d(e):e:$i(t,e)}function $i(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Hi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function xi(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return xi(n.host.impl);if(n.host)return xi(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function Vt(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function xd(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function La(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ka(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?xd(e):t.scrollTop}function Pd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?La(e):t.scrollLeft}function Fo(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function Ub(t){return t.scrollHeight-t.clientHeight}function Yb(t){return t.scrollWidth-t.clientWidth}function Vo(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function _h(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function dI(t,e){const{selectorText:r}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&r&&(t.msMatchesSelector?n=t.msMatchesSelector(r):t.matches&&(n=t.matches(r))),n}function vt(t){return t.offsetWidth}function Dt(t){return t.offsetHeight}function Oi(t){return t.clientHeight||t.innerHeight}function Ad(t){return t.clientWidth||t.innerWidth}function fI(t,e,r){t.addEventListener(e,r,!1)}function gI(t,e,r){t.removeEventListener(e,r,!1)}function qb(t){return t.selectionStart?t.selectionStart:0}function mI(t){return t.selectionEnd?t.selectionEnd:0}function pI(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function Mh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Nd(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let _c;function wI(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function yt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return _c===void 0&&(_c=wI(t)),_c}function Gb(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Kb(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Fa(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function vI(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function rs(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ho(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Va(t){return Ho(t)&&t.hasAttribute("data-hot-input")===!1}function yI(t){const e=t.ownerDocument.activeElement;Va(e)||t.select()}function bI(t){return!t.parentNode}function Xb(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Zb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();be(t,"contenteditable",!0),r&&be(t,...Pb()),e&&re(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Qb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&ye(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function SI(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Zb(t,r),e(),Qb(t,r)}function ns(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}const dk=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:jb,addClass:re,addEvent:fI,clearTextSelection:Mh,closest:Id,closestDown:Ro,empty:Hi,fastInnerHTML:zb,fastInnerText:$i,findFirstParentWithClass:Vb,getCaretPosition:qb,getCssTransform:vI,getFrameElement:Fb,getMaximumScrollLeft:Yb,getMaximumScrollTop:Ub,getParent:Lb,getParentWindow:ko,getScrollLeft:Pd,getScrollTop:ka,getScrollableElement:Fo,getScrollbarWidth:yt,getSelectionEndPosition:mI,getSelectionText:pI,getStyle:_h,getTrimmingContainer:Vo,getWindowScrollLeft:La,getWindowScrollTop:xd,hasAccessToParentWindow:hI,hasClass:pe,hasHorizontalScrollbar:Kb,hasVerticalScrollbar:Gb,index:Wb,innerHeight:Oi,innerWidth:Ad,isChildOf:aa,isDetached:bI,isHTMLElement:ns,isInput:Ho,isInternalElement:kb,isOutsideInput:Va,isVisible:xi,makeElementContentEditableAndSelectItsContent:Zb,matchesCSSRules:dI,observeVisibilityChangeOnce:Xb,offset:Vt,outerHeight:Dt,outerWidth:vt,overlayContainsElement:pn,removeAttribute:Bi,removeClass:ye,removeContentEditableFromElementAndDeselect:Qb,removeEvent:gI,removeTextNodes:Hd,resetCssTransform:rs,runWithSelectedContendEditableElement:SI,selectElementIfAllowed:yI,setAttribute:be,setCaretPosition:Nd,setOverlayPosition:Fa},Symbol.toStringTag,{value:"Module"}));function _e(t){return typeof t=="function"}function Jb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const n={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;n.lastCallThrottled=!0,r||(r=u,c=!0);const d=e-(u-r);return c?(n.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{n.lastCallThrottled=!1,t.apply(this,a),r=0,i=void 0},d)),n}return o}function CI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const n=Jb(t,e);let i=r;function o(){i=r}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):n.apply(this,l)}return s.clearHits=o,s}function eS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function RI(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return ir(i,(u,c)=>c(u),n.apply(this,a))}}function tS(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function TI(t){const e=t.length;function r(n){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=n.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function EI(t){const e=t.length;function r(n){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=n.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function la(t,e,r,n,i,o,s,a){return oe(a)?t.call(e,r,n,i,o,s,a):oe(s)?t.call(e,r,n,i,o,s):oe(o)?t.call(e,r,n,i,o):oe(i)?t.call(e,r,n,i):oe(n)?t.call(e,r,n):oe(r)?t.call(e,r):t.call(e)}const fk=Object.freeze(Object.defineProperty({__proto__:null,curry:TI,curryRight:EI,debounce:eS,fastCall:la,isFunction:_e,partial:tS,pipe:RI,throttle:Jb,throttleAfterHits:CI},Symbol.toStringTag,{value:"Module"}));var nw={},Mc,iw;function OI(){if(iw)return Mc;iw=1;var t=Ve(),e=my(),r=je(),n=Zn(),i=Ca(),o=t([].push);return Mc=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var d=l.length,f=!0;return function(p,w){if(f)return f=!1,w;if(e(this))return w;for(var v=0;v<d;v++)if(l[v]===p)return w}}},Mc}var ow;function _I(){if(ow)return nw;ow=1;var t=Ie(),e=Ni(),r=Sa(),n=Lt(),i=Ve(),o=nt(),s=je(),a=Yh(),l=rd(),u=OI(),c=Uh(),d=String,f=e("JSON","stringify"),p=i(/./.exec),w=i("".charAt),v=i("".charCodeAt),R=i("".replace),y=i(1 .toString),E=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,O=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var G=e("Symbol")("stringify detection");return f([G])!=="[null]"||f({a:G})!=="{}"||f(Object(G))!=="{}"}),H=o(function(){return f("\uDF06\uD834")!=='"\\udf06\\ud834"'||f("\uDEAD")!=='"\\udead"'}),N=function(G,K){var j=l(arguments),J=u(K);if(!(!s(J)&&(G===void 0||a(G))))return j[1]=function(ae,q){if(s(J)&&(q=n(J,this,d(ae),q)),!a(q))return q},r(f,null,j)},L=function(G,K,j){var J=w(j,K-1),ae=w(j,K+1);return p(_,G)&&!p(O,ae)||p(O,G)&&!p(_,J)?"\\u"+y(v(G,0),16):G};return f&&t({target:"JSON",stat:!0,arity:3,forced:M||H},{stringify:function(K,j,J){var ae=l(arguments),q=r(M?N:f,null,ae);return H&&typeof q=="string"?R(q,E,L):q}}),nw}_I();function Pi(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ce(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Pi(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Pi(r[0])]:e[n]=[]:e[n]=null)})),e}function rS(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Yn(t,e,r){const n=Array.isArray(r);return Ce(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function Dd(t,e){Ce(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),Dd(t[n],e[n])):t[n]=e[n]})}function nn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function MI(t){const e={};return Ce(t,(r,n)=>{e[n]=r}),e}function De(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return X(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Ce(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const f=`_${c}`,p=w=>{let v=w;return(Array.isArray(v)||vr(v))&&(v=nn(v)),v};return function(){return this[f]===void 0&&(this[f]=p(d)),this[f]}},l=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Ld(t,e){return JSON.stringify(t)===JSON.stringify(e)}function vr(t){return Object.prototype.toString.call(t)==="[object Object]"}function an(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Ce(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function nS(t,e){const r=e.split(".");let n=t;return Ce(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Ks(t,e,r){const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(On(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function Wa(t){if(!vr(t))return 0;const e=function(r){let n=0;return vr(r)?Ce(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Nt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function On(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const gk=Object.freeze(Object.defineProperty({__proto__:null,clone:MI,createObjectPropListener:Nt,deepClone:nn,deepExtend:Dd,deepObjectSize:Wa,defineGetter:an,duckSchema:Pi,extend:Yn,getProperty:nS,hasOwnProperty:On,inherit:rS,isObject:vr,isObjectEqual:Ld,mixin:De,objectEach:Ce,setProperty:Ks},Symbol.toStringTag,{value:"Module"}));function Ih(t){return window.requestAnimationFrame(t)}function II(t){window.cancelAnimationFrame(t)}function iS(){return"ontouchstart"in window}function oS(){return typeof window<"u"}let li;function HI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return li||(typeof Intl=="object"?li=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?li=(r,n)=>`${r}`.localeCompare(n):li=(r,n)=>r===n?0:r>n?-1:1,li)}const mk=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:II,getComparisonFunction:HI,isCSR:oS,isTouchSupported:iS,requestAnimationFrame:Ih},Symbol.toStringTag,{value:"Module"})),Zt=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},ln={chrome:Zt((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Zt(t=>/CriOS/.test(t)),edge:Zt(t=>/Edge/.test(t)),edgeWebKit:Zt(t=>/EdgiOS/.test(t)),firefox:Zt(t=>/Firefox/.test(t)),firefoxWebKit:Zt(t=>/FxiOS/.test(t)),mobile:Zt(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Zt((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ji={mac:Zt(t=>/^Mac/.test(t)),win:Zt(t=>/^Win/.test(t)),linux:Zt(t=>/^Linux/.test(t)),ios:Zt(t=>/iPhone|iPad|iPod/i.test(t))};function sS(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ce(ln,r=>{let{test:n}=r;return void n(t,e)})}function aS(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ce(ji,e=>{let{test:r}=e;return void r(t)})}oS()&&(sS(),aS());function lS(){return ln.chrome.value}function uS(){return ln.chromeWebKit.value}function Xs(){return ln.firefox.value}function cS(){return ln.firefoxWebKit.value}function xI(){return ln.safari.value}function hS(){return ln.edge.value}function PI(){return ln.edgeWebKit.value}function zn(){return ln.mobile.value}function kd(){return ji.ios.value}function dS(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ji.mac.value}function AI(){return ji.win.value}function ua(){return ji.mac.value}function NI(){return ji.linux.value}const pk=Object.freeze(Object.defineProperty({__proto__:null,isChrome:lS,isChromeWebKit:uS,isEdge:hS,isEdgeWebKit:PI,isFirefox:Xs,isFirefoxWebKit:cS,isIOS:kd,isIpadOS:dS,isLinuxOS:NI,isMacOS:ua,isMobileBrowser:zn,isSafari:xI,isWindowsOS:AI,setBrowserMeta:sS,setPlatformMeta:aS},Symbol.toStringTag,{value:"Module"})),z={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Xs()?182:174,AUDIO_MUTE:Xs()?181:173,AUDIO_UP:Xs()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},DI=[z.ALT,z.ARROW_DOWN,z.ARROW_LEFT,z.ARROW_RIGHT,z.ARROW_UP,z.AUDIO_DOWN,z.AUDIO_MUTE,z.AUDIO_UP,z.BACKSPACE,z.CAPS_LOCK,z.DELETE,z.END,z.ENTER,z.ESCAPE,z.F1,z.F2,z.F3,z.F4,z.F5,z.F6,z.F7,z.F8,z.F9,z.F10,z.F11,z.F12,z.F13,z.F14,z.F15,z.F16,z.F17,z.F18,z.F19,z.HOME,z.INSERT,z.MEDIA_NEXT,z.MEDIA_PLAY_PAUSE,z.MEDIA_PREV,z.MEDIA_STOP,z.NULL,z.NUM_LOCK,z.PAGE_DOWN,z.PAGE_UP,z.PAUSE,z.SCROLL_LOCK,z.SHIFT,z.TAB];function LI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function fS(t){return DI.includes(t)}function kI(t){const e=[];return ua()?e.push(z.COMMAND_LEFT,z.COMMAND_RIGHT,z.COMMAND_FIREFOX):e.push(z.CONTROL),e.includes(t)}function gS(t){return[z.CONTROL,z.COMMAND_LEFT,z.COMMAND_RIGHT,z.COMMAND_FIREFOX].includes(t)}function mS(t,e){const r=e.split("|");let n=!1;return X(r,i=>{if(t===z[i])return n=!0,!1}),n}const wk=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:z,isCtrlKey:kI,isCtrlMetaKey:gS,isFunctionKey:fS,isKey:mS,isPrintableChar:LI},Symbol.toStringTag,{value:"Module"}));function is(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function yn(t){return t.isImmediatePropagationEnabled===!1}function ca(t){return t.button===2}function Fd(t){return t.button===0}function FI(t){return t instanceof TouchEvent}function VI(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!ns(e)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}const vk=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:yn,isLeftClick:Fd,isRightClick:ca,isTouchEvent:FI,offsetRelativeTo:VI,stopImmediatePropagation:is},Symbol.toStringTag,{value:"Module"}));function _n(){oe(console)&&console.warn(...arguments)}function WI(){oe(console)&&console.error(...arguments)}const $n=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Ic=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Hc=new Map([[]]);var sw={},xc,aw;function BI(){if(aw)return xc;aw=1;var t=ki();return xc=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},xc}var Pc,lw;function $I(){if(lw)return Pc;lw=1;var t=Ge();return Pc=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},Pc}var Ac,uw;function Vd(){if(uw)return Ac;uw=1;var t=br(),e=td(),r=Mn().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),Ac=function(o){i[n][o]=!0},Ac}var cw;function jI(){if(cw)return sw;cw=1;var t=Ie(),e=Ve(),r=jt(),n=$o(),i=BI(),o=$I(),s=Vd(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var d=n(this),f=i(a,d);return l(f,c)}}),s("toSorted"),sw}jI();var hw={},dw={},fw;function zI(){if(fw)return dw;fw=1;var t=Ie(),e=Ko(),r=jt(),n=Je(),i=In();return t({target:"Iterator",proto:!0,real:!0},{find:function(s){n(this),r(s);var a=i(this),l=0;return e(a,function(u,c){if(s(u,l++))return c(u)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),dw}var gw;function UI(){return gw||(gw=1,zI()),hw}UI();function YI(t,e){pS(t,e),e.add(t)}function Nc(t,e,r){pS(t,e),e.set(t,r)}function pS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mw(t,e,r){return t.set(ha(t,e),r),r}function rt(t,e){return t.get(ha(t,e))}function ha(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qI=100;var Ft=new WeakMap,bi=new WeakMap,Dc=new WeakMap,Lc=new WeakSet;class pw{constructor(){YI(this,Lc),Nc(this,Ft,new Map),Nc(this,bi,new Map),Nc(this,Dc,new Set),$n.forEach(e=>ha(Lc,this,ww).call(this,e))}getHooks(e){var r;return(r=rt(Ft,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};rt(Ft,this).has(e)||(ha(Lc,this,ww).call(this,e),$n.push(e));const i=rt(Ft,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=rt(Dc,this).has(e);!u&&o!==0&&(u=!0,rt(Dc,this).add(e)),u&&i.length>1&&rt(Ft,this).set(e,i.toSorted((c,d)=>c.orderIndex-d.orderIndex))}}has(e){return rt(Ft,this).has(e)&&rt(Ft,this).get(e).length>0}remove(e,r){if(!rt(Ft,this).has(e))return!1;const n=rt(Ft,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=rt(bi,this).get(e);return i.skip=!0,o+=1,o>qI&&(rt(Ft,this).set(e,n.filter(s=>!s.skip)),o=0),rt(bi,this).set(e,o),!0}return!1}destroy(){rt(Ft,this).clear(),rt(bi,this).clear(),mw(Ft,this,null),mw(bi,this,null)}}function ww(t){rt(Ft,this).set(t,[]),rt(bi,this).set(t,0)}function GI(t,e,r){return(e=KI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KI(t){var e=XI(t,"string");return typeof e=="symbol"?e:e+""}function XI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ZI=Bt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ht{constructor(){GI(this,"globalBucket",new pw)}static getSingleton(){return JI()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new pw),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?X(r,o=>this.add(e,o,n)):(Ic.has(e)&&_n(Hb(ZI,{hookName:e,removedInVersion:Ic.get(e)})),Hc.has(e)&&_n(Hc.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?X(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?X(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=la(u[d].callback,e,n,i,o,s,a,l);f!==void 0&&(n=f),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback),d+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=la(u[d].callback,e,n,i,o,s,a,l);f!==void 0&&(n=f),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback,e),d+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||$n.push(e)}deregister(e){this.isRegistered(e)&&$n.splice($n.indexOf(e),1)}isDeprecated(e){return Hc.has(e)||Ic.has(e)}isRegistered(e){return $n.indexOf(e)>=0}getRegistered(){return $n}}const QI=new ht;function JI(){return QI}const kc=new Map;function zi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";kc.has(t)||kc.set(t,new Map);const e=kc.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}const Hh=new WeakMap,{register:eH,getItem:wS,hasItem:tH,getNames:yk,getValues:bk}=zi("editors");function rH(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ht.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function nH(t,e){let r;if(typeof t=="function")Hh.get(t)||vS(null,t),r=Hh.get(t);else if(typeof t=="string")r=wS(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function vw(t){if(typeof t=="function")return t;if(!tH(t))throw Error(`No registered editor found under "${t}" name`);return wS(t).getConstructor()}function vS(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new rH(e);typeof t=="string"&&eH(t,r),Hh.set(e,r)}function iH(t,e,r){return(e=oH(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oH(t){var e=sH(t,"string");return typeof e=="symbol"?e:e+""}function sH(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Zs=0;class Ai{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;iH(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,aH(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),Zs+=1,()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Zs-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Zs-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function aH(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),is(this)},t}function Sk(){return Zs}function lH(t,e){uH(t,e),e.add(t)}function uH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,r){return(e=cH(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cH(t){var e=hH(t,"string");return typeof e=="symbol"?e:e+""}function hH(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fc=new WeakSet;class xh{constructor(e,r,n){lH(this,Fc),Pn(this,"hot",void 0),Pn(this,"tableMeta",void 0),Pn(this,"selection",void 0),Pn(this,"eventManager",void 0),Pn(this,"destroyed",!1),Pn(this,"activeEditor",void 0),Pn(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ai(e),this.hot.addHook("afterDocumentKeyDown",i=>yw(Fc,this,dH).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>yw(Fc,this,fH).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=nH(u,this.hot),this.activeEditor.prepare(n,i,c,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function dH(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||yn(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!fS(r)&&!gS(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function fH(t,e){e.isCell()&&this.openEditor(null,t,!0)}const bw=new WeakMap;xh.getInstance=function(t,e,r){let n=bw.get(t);return n||(n=new xh(t,e,r),bw.set(t,n)),n};function gH(t,e){yS(t,e),e.add(t)}function no(t,e,r){yS(t,e),e.set(t,r)}function yS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ee(t,e){return t.get(Kr(t,e))}function io(t,e,r){return t.set(Kr(t,e),r),r}function Kr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _i=Object.freeze({CELL:"cell",MIXED:"mixed"});var Ye=new WeakMap,ps=new WeakMap,ws=new WeakMap,vs=new WeakMap,ys=new WeakMap,vn=new WeakSet;class mH{constructor(e){var r=this;gH(this,vn),no(this,Ye,void 0),no(this,ps,void 0),no(this,ws,1),no(this,vs,null),no(this,ys,new Map);const n=e.getSettings();io(Ye,this,e),io(ps,this,n.imeFastEdit?_i.MIXED:_i.CELL),Ee(Ye,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Kr(vn,r,wH).call(r,...o)}),Ee(Ye,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Kr(vn,r,Sw).call(r,...o)}),Ee(Ye,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Kr(vn,r,Sw).call(r,...o)}),Ee(Ye,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Kr(vn,r,pH).call(r,...o)})}getFocusMode(){return Ee(ps,this)}setFocusMode(e){Object.values(_i).includes(e)?io(ps,this,e):_n(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ee(ws,this)}setRefocusDelay(e){io(ws,this,e)}setRefocusElementGetter(e){io(vs,this,e)}getRefocusElement(){var e;return typeof Ee(vs,this)=="function"?Ee(vs,this).call(this):(e=Ee(Ye,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Ee(Ye,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ee(Ye,this).runHooks("modifyFocusedElement",s.row,s.col,n);ns(a)||(a=n),a&&!((o=Ee(Ye,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Kr(vn,this,Wd).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee(ws,this);if(Ee(Ye,this).getSettings().imeFastEdit&&!((e=Ee(Ye,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Ee(Ye,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Ee(ys,this).has(r)||Ee(ys,this).set(r,eS(()=>{var o;(o=this.getRefocusElement())===null||o===void 0||o.select()},r)),Ee(ys,this).get(r)()}}}function Wd(t){var e;const r=(e=Ee(Ye,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Ee(Ye,this).selection.isCellVisible(r)){t(null);return}const n=Ee(Ye,this).getCell(r.row,r.col,!0);n===null?Ee(Ye,this).addHookOnce("afterScroll",()=>{t(Ee(Ye,this).getCell(r.row,r.col,!0))}):t(n)}function Sw(){Kr(vn,this,Wd).call(this,t=>{const{activeElement:e}=Ee(Ye,this).rootDocument;e&&Va(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function pH(){Kr(vn,this,Wd).call(this,t=>{this.getFocusMode()===_i.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function wH(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?_i.MIXED:_i.CELL)}var Cw={},Vc,Rw;function vH(){if(Rw)return Vc;Rw=1;var t=yr(),e=Zn(),r=br(),n=r("match");return Vc=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Vc}var Wc,Tw;function yH(){if(Tw)return Wc;Tw=1;var t=Je();return Wc=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Wc}var Bc,Ew;function bH(){if(Ew)return Bc;Ew=1;var t=Lt(),e=tr(),r=jo(),n=yH(),i=RegExp.prototype;return Bc=function(o){var s=o.flags;return s===void 0&&!("flags"in i)&&!e(o,"flags")&&r(i,o)?t(n,o):s},Bc}var $c,Ow;function SH(){if(Ow)return $c;Ow=1;var t=Ve(),e=Di(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return $c=function(l,u,c,d,f,p){var w=c+l.length,v=d.length,R=a;return f!==void 0&&(f=e(f),R=s),i(p,R,function(y,E){var _;switch(n(E,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":_=f[o(E,1,-1)];break;default:var O=+E;if(O===0)return y;if(O>v){var M=r(O/10);return M===0?y:M<=v?d[M-1]===void 0?n(E,1):d[M-1]+n(E,1):y}_=d[O-1]}return _===void 0?"":_})},$c}var _w;function CH(){if(_w)return Cw;_w=1;var t=Ie(),e=Lt(),r=Ve(),n=Bo(),i=je(),o=va(),s=vH(),a=Ca(),l=zo(),u=bH(),c=SH(),d=br(),f=Qn(),p=d("replace"),w=TypeError,v=r("".indexOf),R=r("".replace),y=r("".slice),E=Math.max;return t({target:"String",proto:!0},{replaceAll:function(O,M){var H=n(this),N,L,G,K,j,J,ae,q,Z,Ke,le=0,ge="";if(!o(O)){if(N=s(O),N&&(L=a(n(u(O))),!~v(L,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(G=l(O,p),G)return e(G,O,H,M);if(f&&N)return R(a(H),O,M)}for(K=a(H),j=a(O),J=i(M),J||(M=a(M)),ae=j.length,q=E(1,ae),Z=v(K,j);Z!==-1;)Ke=J?a(M(j,Z,K)):c(j,K,Z,[],void 0,M),ge+=y(K,le,Z)+Ke,le=Z+ae,Z=Z+q>K.length?-1:v(K,j,Z+q);return le<K.length&&(ge+=y(K,le)),ge}}),Cw}CH();var Mw={},Iw={},Hw;function RH(){if(Hw)return Iw;Hw=1;var t=Ie(),e=Ko(),r=jt(),n=Je(),i=In(),o=TypeError;return t({target:"Iterator",proto:!0,real:!0},{reduce:function(a){n(this),r(a);var l=i(this),u=arguments.length<2,c=u?void 0:arguments[1],d=0;if(e(l,function(f){u?(u=!1,c=f):c=a(c,f,d),d++},{IS_RECORD:!0}),u)throw new o("Reduce of empty iterator with no initial value");return c}}),Iw}var xw;function TH(){return xw||(xw=1,RH()),Mw}TH();const bS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},EH=new RegExp(Object.keys(bS).map(t=>`(${t})`).join("|"),"gi");function OH(t){return(t&&t.nodeName||"")==="TABLE"}function Ph(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,d=e?1:0;for(let f=0;f<o;f+=1){const p=e&&f===0,w=[];for(let R=0;R<s;R+=1){const y=!p&&r&&R===0;let E="";if(p)E=`<th>${t.getColHeader(R-c)}</th>`;else if(y)E=`<th>${t.getRowHeader(f-d)}</th>`;else{const _=i[f][R],{hidden:O,rowspan:M,colspan:H}=t.getCellMeta(f-d,R-c);if(!O){const N=[];if(M&&N.push(`rowspan="${M}"`),H&&N.push(`colspan="${H}"`),En(_))E=`<td ${N.join(" ")}></td>`;else{const L=_.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");E=`<td ${N.join(" ")}>${L}</td>`}}}w.push(E)}const v=["<tr>",...w,"</tr>"].join("");p?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function _H(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=En(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function MH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const _=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,O=>{const M=O.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,N=O.substring(M.length,O.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${N}</td>`});i.insertAdjacentHTML("afterbegin",`${_}`),o=i.querySelector("table")}if(!o||!OH(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((_,O)=>_+O.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let f=!1,p=0,w=0;if(o.tHead){const _=Array.from(o.tHead.rows).filter(O=>{const M=O.querySelector("td")!==null;return M&&d.push(O),!M});p=_.length,f=p>0,p>1?r.nestedHeaders=Array.from(_).reduce((O,M)=>{const H=Array.from(M.cells).reduce((N,L,G)=>{if(a&&G===0)return N;const{colSpan:K,innerHTML:j}=L,J=K>1?{label:j,colspan:K}:j;return N.push(J),N},[]);return O.push(H),O},[]):f&&(r.colHeaders=Array.from(_[0].children).reduce((O,M,H)=>(a&&H===0||O.push(M.innerHTML),O),[]))}d.length&&(r.fixedRowsTop=d.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...d,...Array.from(o.tBodies).reduce((_,O)=>(_.push(...Array.from(O.rows)),_),[]),...c];w=v.length;const R=new Array(w);for(let _=0;_<w;_++)R[_]=new Array(u);const y=[],E=[];for(let _=0;_<w;_++){const O=v[_],M=Array.from(O.cells),H=M.length;for(let N=0;N<H;N++){const L=M[N],{nodeName:G,innerHTML:K,rowSpan:j,colSpan:J}=L,ae=R[_].findIndex(q=>q===void 0);if(G==="TD"){if(j>1||J>1){for(let le=_;le<_+j;le++)if(le<w)for(let ge=ae;ge<ae+J;ge++)R[le][ge]=null;const Z=L.getAttribute("style");Z&&Z.includes("mso-ignore:colspan")||y.push({col:ae,row:_,rowspan:j,colspan:J})}let q="";s&&/excel/gi.test(s.content)?q=K.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):q=K.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[_][ae]=q.replace(EH,Z=>bS[Z])}else E.push(K)}}return y.length&&(r.mergeCells=y),E.length&&(r.rowHeaders=E),R.length&&(r.data=R),r}const Ck=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:_H,htmlToGridSettings:MH,instanceToHTML:Ph},Symbol.toStringTag,{value:"Module"}));function Bd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function SS(t){return Bd(t,[","])}function Wt(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function Ah(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function IH(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ae(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const Rk=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ae,isNumeric:Bd,isNumericLike:SS,rangeEach:Wt,rangeEachReverse:Ah,valueAccordingPercent:IH},Symbol.toStringTag,{value:"Module"})),Nh="asc",HH="desc",Pw=new Map([[Nh,[-1,1]],[HH,[1,-1]]]),xH=t=>`The priority '${t}' is already declared in a map.`,PH=t=>`The priority '${t}' is not a number.`;function AH(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=_e(t)?t:xH,e=_e(e)?e:PH;function n(o,s){if(!Bd(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nh;const[s,a]=Pw.get(o)||Pw.get(Nh);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const NH=t=>`The id '${t}' is already declared in a map.`;function Ba(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=_e(t)?t:NH;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[f,p]=d;return u===p?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const DH=t=>`'${t}' value is already declared in a unique set.`;function LH(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=_e(t)?t:DH;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const $d=t=>`There is already registered "${t}" plugin.`,kH=t=>`There is already registered plugin on priority "${t}".`,FH=t=>`The priority "${t}" is not a number.`,CS=AH({errorPriorityExists:kH,errorPriorityNaN:FH}),RS=LH({errorItemExists:$d}),Dh=Ba({errorIdExists:$d});function VH(){return[...CS.getItems(),...RS.getItems()]}function jd(t){const e=es(t);return Dh.getItem(e)}function Tk(t){return!!jd(t)}function Ek(t,e,r){[t,e,r]=BH(t,e,r),jd(t)===void 0&&WH(t,e,r)}function WH(t,e,r){const n=es(t);if(Dh.hasItem(n))throw new Error($d(n));r===void 0?RS.addItem(n):CS.addItem(r,n),Dh.addItem(n,e)}function BH(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:$H,getItem:jH,hasItem:zH,getNames:Ok,getValues:_k}=zi("renderers");function Aw(t){if(typeof t=="function")return t;if(!zH(t))throw Error(`No registered renderer found under "${t}" name`);return jH(t)}function UH(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),$H(t,e)}const{register:YH,getItem:qH,hasItem:GH,getNames:Mk,getValues:Ik}=zi("validators");function KH(t){if(typeof t=="function")return t;if(!GH(t))throw Error(`No registered validator found under "${t}" name`);return qH(t)}function XH(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),YH(t,e)}var Nw={},Dw;function ZH(){if(Dw)return Nw;Dw=1;var t=Ie(),e=Di(),r=ki(),n=Uo(),i=Vd();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),Nw}ZH();var Lw={},kw;function QH(){if(kw)return Lw;kw=1;var t=Ie(),e=Ve(),r=Bo(),n=Uo(),i=Ca(),o=nt(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),d=c.length,f=n(u),p=f>=0?f:d+f;return p<0||p>=d?void 0:s(c,p)}}),Lw}QH();function oo(t,e,r){return(e=JH(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JH(t){var e=ex(t,"string");return typeof e=="symbol"?e:e+""}function ex(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tx{constructor(){oo(this,"count",0),oo(this,"startColumn",null),oo(this,"endColumn",null),oo(this,"startPosition",null),oo(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const d=s>0?i+1:i,f=n+i-d,p=this.startColumn===null?0:e.getColumnWidth(this.startColumn);f<-1*o||n>u.at(-1)||-1*n-i>-1*p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function so(t,e,r){return(e=rx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rx(t){var e=nx(t,"string");return typeof e=="symbol"?e:e+""}function nx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ix{constructor(){so(this,"count",0),so(this,"startRow",null),so(this,"endRow",null),so(this,"startPosition",null),so(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=l[this.endRow]+u-l[this.startRow-1];if(f<=i-o&&(this.startRow-=1),f>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,d=this.startRow===null?0:e.getRowHeight(this.startRow);c<d||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ao(t,e,r){return(e=ox(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ox(t){var e=sx(t,"string");return typeof e=="symbol"?e:e+""}function sx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TS{constructor(){ao(this,"count",0),ao(this,"startColumn",null),ao(this,"endColumn",null),ao(this,"startPosition",null),ao(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,p>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const d=s>0?i+1:i;n+i-d<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function lo(t,e,r){return(e=ax(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ax(t){var e=lx(t,"string");return typeof e=="symbol"?e:e+""}function lx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ES{constructor(){lo(this,"count",0),lo(this,"startRow",null),lo(this,"endRow",null),lo(this,"startPosition",null),lo(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function uo(t,e,r){return(e=ux(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ux(t){var e=cx(t,"string");return typeof e=="symbol"?e:e+""}function cx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hx{constructor(){uo(this,"count",0),uo(this,"startColumn",0),uo(this,"endColumn",0),uo(this,"startPosition",0),uo(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function co(t,e,r){return(e=dx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dx(t){var e=fx(t,"string");return typeof e=="symbol"?e:e+""}function fx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gx{constructor(){co(this,"count",0),co(this,"startRow",0),co(this,"endRow",0),co(this,"startPosition",0),co(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function Fw(t,e,r){return(e=mx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mx(t){var e=px(t,"string");return typeof e=="symbol"?e:e+""}function px(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wx extends TS{constructor(){super(...arguments),Fw(this,"columnStartOffset",0),Fw(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Vw(t,e,r){return(e=vx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vx(t){var e=yx(t,"string");return typeof e=="symbol"?e:e+""}function yx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bx extends ES{constructor(){super(...arguments),Vw(this,"rowStartOffset",0),Vw(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ww(t,e,r){return(e=Sx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sx(t){var e=Cx(t,"string");return typeof e=="symbol"?e:e+""}function Cx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OS{constructor(e){Ww(this,"calculationTypes",[]),Ww(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function sr(t,e,r){return(e=Rx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rx(t){var e=Tx(t,"string");return typeof e=="symbol"?e:e+""}function Tx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _S=50;class Ex extends OS{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),sr(this,"viewportWidth",0),sr(this,"scrollOffset",0),sr(this,"zeroBasedScrollOffset",0),sr(this,"totalColumns",0),sr(this,"columnWidthFn",null),sr(this,"columnWidth",0),sr(this,"overrideFn",null),sr(this,"inlineStartOffset",0),sr(this,"totalCalculatedWidth",0),sr(this,"startPositions",[]),sr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?_S:r}}function Yt(t,e,r){return(e=Ox(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ox(t){var e=_x(t,"string");return typeof e=="symbol"?e:e+""}function _x(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mx extends OS{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Yt(this,"viewportHeight",0),Yt(this,"scrollOffset",0),Yt(this,"zeroBasedScrollOffset",0),Yt(this,"totalRows",0),Yt(this,"rowHeightFn",null),Yt(this,"rowHeight",0),Yt(this,"overrideFn",null),Yt(this,"horizontalScrollbarHeight",0),Yt(this,"innerViewportHeight",0),Yt(this,"totalCalculatedHeight",0),Yt(this,"startPositions",[]),Yt(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Ix(t,e,r){Hx(t,e),e.set(t,r)}function Hx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bw(t,e,r){return(e=xx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xx(t){var e=Px(t,"string");return typeof e=="symbol"?e:e+""}function Px(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ui(t,e){return t.get(MS(t,e))}function $w(t,e,r){return t.set(MS(t,e),r),r}function MS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $r=new WeakMap;class qn{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Bw(this,"row",null),Bw(this,"col",null),Ix(this,$r,!1),$w($r,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ui($r,this)}isSouthEastOf(e){return this.row>=e.row&&(ui($r,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ui($r,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ui($r,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ui($r,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof qn&&$w($r,this,e.isRtl()),this}clone(){return new qn(this.row,this.col,ui($r,this))}toObject(){return{row:this.row,col:this.col}}}function Ax(t,e,r){Nx(t,e),e.set(t,r)}function Nx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jc(t,e,r){return(e=Dx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dx(t){var e=Lx(t,"string");return typeof e=="symbol"?e:e+""}function Lx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qt(t,e){return t.get(IS(t,e))}function kx(t,e,r){return t.set(IS(t,e),r),r}function IS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var It=new WeakMap;class os{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;jc(this,"highlight",null),jc(this,"from",null),jc(this,"to",null),Ax(this,It,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),kx(It,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),d=Math.max(i.col,a.col),f=this._createCellCoords(l,u),p=this._createCellCoords(c,d);return this.from=f,this.to=p,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return qt(It,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return qt(It,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return qt(It,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return qt(It,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return qt(It,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return qt(It,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return qt(It,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return qt(It,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof qn))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(qt(It,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(qt(It,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new os(this.highlight,this.from,this.to,qt(It,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new qn(e,r,qt(It,this))}}function Er(t,e,r){Fx(t,e),e.set(t,r)}function Fx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W(t,e){return t.get(HS(t,e))}function fn(t,e,r){return t.set(HS(t,e),r),r}function HS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gt=new WeakMap,zc=new WeakMap,Qe=new WeakMap,ci=new WeakMap,bs=new WeakMap,ar=new WeakMap,Uc=new WeakMap,ho=new WeakMap,An=new WeakMap,Or=new WeakMap;class xS{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Er(this,Gt,void 0),Er(this,zc,void 0),Er(this,Qe,void 0),Er(this,ci,void 0),Er(this,bs,void 0),Er(this,ar,void 0),Er(this,Uc,void 0),Er(this,ho,void 0),Er(this,An,[null,null]),Er(this,Or,[null,null]),fn(Gt,this,n),fn(zc,this,r),fn(Qe,this,o),fn(ci,this,s),fn(bs,this,a),fn(ar,this,i),fn(Uc,this,e),this.registerEvents()}registerEvents(){W(ar,this).addEventListener(W(Qe,this).holder,"contextmenu",n=>this.onContextMenu(n)),W(ar,this).addEventListener(W(Qe,this).TABLE,"mouseover",n=>this.onMouseOver(n)),W(ar,this).addEventListener(W(Qe,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{W(ar,this).addEventListener(W(Qe,this).holder,"touchstart",n=>this.onTouchStart(n)),W(ar,this).addEventListener(W(Qe,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),W(ar,this).addEventListener(W(Qe,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||W(Gt,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,W(Gt,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{W(ar,this).addEventListener(W(Qe,this).holder,"mouseup",n=>this.onMouseUp(n)),W(ar,this).addEventListener(W(Qe,this).holder,"mousedown",n=>this.onMouseDown(n))};zn()?e():(iS()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(W(ho,this)&&n){const[i,o]=[n.row,W(ho,this).from.row],[s,a]=[n.col,W(ho,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=W(Qe,this).TABLE,i=Ro(e,["TD","TH"],n);return i?(r.coords=W(Qe,this).getCoords(i),r.TD=i):pe(e,"wtBorder")&&pe(e,"current")?(r.coords=W(ci,this).getFocusSelection().cellRange.highlight,r.TD=W(Qe,this).getCell(r.coords)):pe(e,"wtBorder")&&pe(e,"area")&&W(ci,this).getAreaSelection().cellRange&&(r.coords=W(ci,this).getAreaSelection().cellRange.to,r.TD=W(Qe,this).getCell(r.coords)),r}onMouseDown(e){const r=W(zc,this).rootDocument.activeElement,n=tS(Lb,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);pe(i,"corner")?W(Gt,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&W(Gt,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(W(Or,this)[0]=o.TD,clearTimeout(W(An,this)[0]),W(An,this)[0]=setTimeout(()=>{W(Or,this)[0]=null},1e3))}onContextMenu(e){if(W(Gt,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!W(Gt,this).has("onCellMouseOver"))return;const r=W(Qe,this).TABLE,n=Ro(e.target,["TD","TH"],r),i=W(bs,this)||this;n&&n!==i.lastMouseOver&&aa(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,W(Qe,this).getCoords(n),n))}onMouseOut(e){if(!W(Gt,this).has("onCellMouseOut"))return;const r=W(Qe,this).TABLE,n=Ro(e.target,["TD","TH"],r),i=Ro(e.relatedTarget,["TD","TH"],r),o=W(bs,this)||this;n&&n!==i&&aa(n,r)&&(this.callListener("onCellMouseOut",e,W(Qe,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&W(Gt,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===W(Or,this)[0]&&r.TD===W(Or,this)[1]?(pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),W(Or,this)[0]=null,W(Or,this)[1]=null):r.TD===W(Or,this)[0]&&(W(Or,this)[1]=r.TD,clearTimeout(W(An,this)[1]),W(An,this)[1]=setTimeout(()=>{W(Or,this)[1]=null},500)))}onTouchStart(e){fn(ho,this,W(ci,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=oe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&W(Gt,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];kd()&&(uS()||cS())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=W(Gt,this).getSettingPure(e);o&&o(r,n,i,W(Uc,this).call(this))}destroy(){clearTimeout(W(An,this)[0]),clearTimeout(W(An,this)[1]),W(ar,this).destroy()}}function Yc(t,e,r){return(e=Vx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vx(t){var e=Wx(t,"string");return typeof e=="symbol"?e:e+""}function Wx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bx{constructor(e,r,n){Yc(this,"offset",void 0),Yc(this,"total",void 0),Yc(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function qc(t,e,r){return(e=$x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $x(t){var e=jx(t,"string");return typeof e=="symbol"?e:e+""}function jx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zx{constructor(e,r,n){qc(this,"offset",void 0),qc(this,"total",void 0),qc(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Ss(t,e,r){return(e=Ux(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ux(t){var e=Yx(t,"string");return typeof e=="symbol"?e:e+""}function Yx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qx{constructor(){Ss(this,"currentSize",0),Ss(this,"nextSize",0),Ss(this,"currentOffset",0),Ss(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Gx=0,jw=1,Lh=2;function Gc(t,e,r){return(e=Kx(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kx(t){var e=Xx(t,"string");return typeof e=="symbol"?e:e+""}function Xx(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zx{constructor(){Gc(this,"size",new qx),Gc(this,"workingSpace",Gx),Gc(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=jw,e.workingSpace=Lh,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Lh,e.workingSpace=jw,this.sharedSize=e.getViewSize()}}var zw={},Kc,Uw;function Qx(){if(Uw)return Kc;Uw=1;var t=ba(),e=TypeError;return Kc=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},Kc}var Yw;function Jx(){if(Yw)return zw;Yw=1;var t=Ie(),e=Di(),r=ki(),n=py(),i=Qx(),o=wy(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var d=e(this),f=r(d),p=arguments.length;if(p){o(f+p);for(var w=f;w--;){var v=w+p;w in d?d[v]=d[w]:i(d,v)}for(var R=0;R<p;R++)d[R]=arguments[R]}return n(d,f+p)}}),zw}Jx();function eP(t,e,r){return(e=tP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tP(t){var e=rP(t,"string");return typeof e=="symbol"?e:e+""}function rP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qw{constructor(e,r){eP(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function nP(t,e,r){return(e=iP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iP(t){var e=oP(t,"string");return typeof e=="symbol"?e:e+""}function oP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sP{constructor(e){nP(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new qw(o,r),l=new qw(s,n),u=[];for(let c=0;c<i;c++){const d=a.get(c),f=l.get(c);if(f===-1)u.push(["remove",d]);else if(d===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Lh)?u.push(["append",f]):u.push(["prepend",f]);else if(f>d)a.has(f)&&(a.remove(f),n<=a.length&&(i-=1)),u.push(["replace",f,d]);else if(f<d){const p=a.prepend(f);u.push(["insert_before",f,d,p])}else u.push(["none",f])}return u}}function hi(t,e,r){return(e=aP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aP(t){var e=lP(t,"string");return typeof e=="symbol"?e:e+""}function lP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PS{constructor(e,r){hi(this,"rootNode",void 0),hi(this,"nodesPool",void 0),hi(this,"sizeSet",new Zx),hi(this,"collectedNodes",[]),hi(this,"viewDiffer",new sP(this.sizeSet)),hi(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class AS extends PS{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Gw(t,e,r){return(e=uP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uP(t){var e=cP(t,"string");return typeof e=="symbol"?e:e+""}function cP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hP{constructor(e){Gw(this,"nodeType",void 0),Gw(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function fo(t,e,r){return(e=dP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dP(t){var e=fP(t,"string");return typeof e=="symbol"?e:e+""}function fP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ss{constructor(e,r){fo(this,"nodesPool",null),fo(this,"nodeType",void 0),fo(this,"rootNode",void 0),fo(this,"table",null),fo(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new hP(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Kw(t,e,r){return(e=gP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gP(t){var e=mP(t,"string");return typeof e=="symbol"?e:e+""}function mP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pP extends ss{constructor(){super("TH"),Kw(this,"orderViews",new WeakMap),Kw(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new AS(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Bi(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(f,[sI(),uI(),Md(d+1),ts(-1)]),r[d](a,f,d)}u.end()}}}class wP extends ss{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Hi(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[xb()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&be(s,[Oh(),Nb(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Bi(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[Md(a+1+this.table.rowHeadersCount),ts(-1),aI(),...a>=0?[lI()]:[Oh()]]),n[r](l,u,r)}}}}let Xw=!1;class vP extends ss{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!Xw&&e>1e3&&(Xw=!0,_n(Bt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&re(n,"rowHeader")}}function yP(t,e,r){return(e=bP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bP(t){var e=SP(t,"string");return typeof e=="symbol"?e:e+""}function SP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const di={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Zw=!1;class CP extends ss{constructor(e){super("TR",e),yP(this,"orderView",void 0),this.orderView=new PS(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Zw&&e>1e3&&(Zw=!0,_n(Bt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[xb()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;be(o,[Oh(),Nb(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?pe(o,di.rowEven)||(ye(o,di.rowOdd),re(o,di.rowEven)):pe(o,di.rowOdd)||(ye(o,di.rowEven),re(o,di.rowOdd))}this.orderView.end()}}function Qw(t,e,r){return(e=RP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RP(t){var e=TP(t,"string");return typeof e=="symbol"?e:e+""}function TP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EP extends ss{constructor(){super("TD"),Qw(this,"orderViews",new WeakMap),Qw(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new AS(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(r).setOffset(0).start();for(let f=0;f<r;f++){c.render();const p=this.table.renderedColumnToSource(f),w=c.getCurrentNode();if(pe(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),Bi(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,w),this.table.isAriaEnabled()){var o,s;be(w,[...w.hasAttribute("role")?[]:[oI()],ts(-1),Md(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function We(t,e,r){return(e=OP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OP(t){var e=_P(t,"string");return typeof e=="symbol"?e:e+""}function _P(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MP{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We(this,"rootNode",void 0),We(this,"rootDocument",void 0),We(this,"rowHeaders",null),We(this,"columnHeaders",null),We(this,"colGroup",null),We(this,"rows",null),We(this,"cells",null),We(this,"rowFilter",null),We(this,"columnFilter",null),We(this,"rowUtils",null),We(this,"columnUtils",null),We(this,"rowsToRender",0),We(this,"columnsToRender",0),We(this,"rowHeaderFunctions",[]),We(this,"rowHeadersCount",0),We(this,"columnHeaderFunctions",[]),We(this,"columnHeadersCount",0),We(this,"cellRenderer",void 0),We(this,"activeOverlayName",void 0),We(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class IP{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new MP(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new pP,columnHeaders:new wP(r),colGroup:new vP(n),rows:new CP(i),cells:new EP}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Xc(t,e,r){return(e=HP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HP(t){var e=xP(t,"string");return typeof e=="symbol"?e:e+""}function xP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PP{constructor(e,r){Xc(this,"dataAccessObject",void 0),Xc(this,"wtSettings",void 0),Xc(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function Jw(t,e,r){return(e=AP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AP(t){var e=NP(t,"string");return typeof e=="symbol"?e:e+""}function NP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DP{constructor(e,r){Jw(this,"dataAccessObject",void 0),Jw(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function _r(t,e,r){return(e=LP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LP(t){var e=kP(t,"string");return typeof e=="symbol"?e:e+""}function kP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ui{constructor(e,r,n,i,o){_r(this,"wtSettings",null),_r(this,"domBindings",void 0),_r(this,"TBODY",null),_r(this,"THEAD",null),_r(this,"COLGROUP",null),_r(this,"hasTableHeight",!0),_r(this,"hasTableWidth",!0),_r(this,"isTableVisible",!1),_r(this,"tableOffset",0),_r(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Hd(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new DP(this.dataAccessObject,this.wtSettings),this.columnUtils=new PP(this.dataAccessObject,this.wtSettings),this.tableRenderer=new IP({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(n,[Jr()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(n,[Jr()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",be(n,[ts(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(n.parentNode,[Jr()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(n,[Jr()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let d=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Vt(this.holder),d=i.createCalculators(d),l&&!r.getSetting("fixedColumnsStart"))){const p=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,w!==this.correctHeaderWidth&&(d=!1)}if(d)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Vt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,w=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new zx(p,o,c),this.columnFilter=new Bx(w,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const R={};this.wtSettings.getSetting("beforeDraw",!0,R),v=R.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ar)||this.is(Rn))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ar))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Ar)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Oi(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Ar))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Id(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let o=Wb(n),s=r.cellIndex;pn(Xn,r,this.wtRootElement)||pn(Gn,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):pn(Rn,r,this.wtRootElement)||pn(Ar,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),pn(Xn,r,this.wtRootElement)||pn(Kn,r,this.wtRootElement)||pn(Rn,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=Oi(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?Dt:Oi,s=i?0:1,a=i?1:0;let l,u,c,d,f;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),d=this.getTrForRow(c),f=d.querySelector("th");const p=c===0?a:0;f?u=o(f):u=o(d)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-p||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return vt(this.TABLE)}getHeight(){return Dt(this.TABLE)}getTotalWidth(){const e=vt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Dt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return xi(this.TABLE)}_modifyRowHeaderWidth(e){let r=_e(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const FP="stickyRowsBottom",zd={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};an(zd,"MIXIN_NAME",FP,{writable:!1,enumerable:!1});const VP="stickyColumnsStart",$a={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};an($a,"MIXIN_NAME",VP,{writable:!1,enumerable:!1});class Ud extends Ui{constructor(e,r,n,i){super(e,r,n,i,Rn)}}De(Ud,zd);De(Ud,$a);const Gn="top",Ar="bottom",Kn="inline_start",Xn="top_inline_start_corner",Rn="bottom_inline_start_corner",NS=[Gn,Ar,Kn,Xn,Rn],WP=new Map([[Gn,`ht_clone_${Gn}`],[Ar,`ht_clone_${Ar}`],[Kn,`ht_clone_${Kn} ht_clone_left`],[Xn,`ht_clone_${Xn} ht_clone_top_left_corner`],[Rn,`ht_clone_${Rn} ht_clone_bottom_left_corner`]]);function BP(t,e){$P(t,e),e.add(t)}function $P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jP(t,e,r){return(e=zP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zP(t){var e=UP(t,"string");return typeof e=="symbol"?e:e+""}function UP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var go=new WeakSet;class YP{constructor(e){BP(this,go),jP(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=Nt(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let d=!1;return(l&&(e<u||e>c)||!l)&&(d=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),d}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=Nt(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),d=this.getLastVisibleRow();let f=!1;return(u&&(e<c||e>d)||!u)&&(f=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),f}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Cs(go,this,tv).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Cs(go,this,tv).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Cs(go,this,ev).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Cs(go,this,ev).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function ev(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-f)}else l=Vt(n.wtRootElement).left;const u=Math.abs(Pd(s,s));if(l>u){const c=Ad(s);let d=i.getRowHeaderWidth();for(let f=1;f<=o;f++)if(d+=r.sumCellSizes(f-1,f),l+d-u>=c){t=f-2;break}}}return t}function tv(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Vt(r.wtRootElement),a=ka(o,o);if(s.top>a){const l=Oi(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Kt(t,e,r){return(e=qP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qP(t){var e=GP(t,"string");return typeof e=="symbol"?e:e+""}function GP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yd{get eventManager(){return new Ai(this)}constructor(e,r){Kt(this,"wtTable",void 0),Kt(this,"wtScroll",void 0),Kt(this,"wtViewport",void 0),Kt(this,"wtOverlays",void 0),Kt(this,"selectionManager",void 0),Kt(this,"wtEvent",void 0),Kt(this,"guid",`wt_${Od()}`),Kt(this,"drawInterrupted",!1),Kt(this,"drawn",!1),Kt(this,"activeOverlayName","master"),Kt(this,"domBindings",void 0),Kt(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new YP(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){$i(n,e[r])}])}}createCellCoords(e,r){return new qn(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new os(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function rv(t,e,r){return(e=KP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KP(t){var e=XP(t,"string");return typeof e=="symbol"?e:e+""}function XP(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZP extends Yd{constructor(e,r,n){super(e,r),rv(this,"cloneSource",void 0),rv(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new xS(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function QP(t,e,r){return(e=JP(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JP(t){var e=eA(t,"string");return typeof e=="symbol"?e:e+""}function eA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class as{constructor(e,r,n,i,o){QP(this,"wtSettings",null),an(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Vo(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Vo(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Fo(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){_n(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+yt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(NS.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${WP.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&be(o,[Jr()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Gn||u==="vertical"&&this.type===Kn?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Fo(e.TABLE),new ZP(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class tA extends as{constructor(e,r,n,i,o,s){super(e,r,Rn,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Ud(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else rs(r),this.repositionOverlay();let n=Dt(this.clone.wtTable.TABLE);const i=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=yt(n)),i.style.bottom=`${o}px`}}const rA="calculatedColumns",ja={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};an(ja,"MIXIN_NAME",rA,{writable:!1,enumerable:!1});class qd extends Ui{constructor(e,r,n,i){super(e,r,n,i,Ar)}}De(qd,zd);De(qd,ja);function nA(t,e,r){return(e=iA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iA(t){var e=oA(t,"string");return typeof e=="symbol"?e:e+""}function oA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sA extends as{constructor(e,r,n,i){super(e,r,Ar,n,i),nA(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new qd(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=yt(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo(La(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=yt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Dt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=yt(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ka(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(re(s,"innerBorderBottom"),o=!a):(ye(s,"innerBorderBottom"),o=a)}return o}}const aA="calculatedRows",Gd={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};an(Gd,"MIXIN_NAME",aA,{writable:!1,enumerable:!1});class Kd extends Ui{constructor(e,r,n,i){super(e,r,n,i,Kn)}}De(Kd,Gd);De(Kd,$a);const lA="localHooks",un={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)la(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};an(un,"MIXIN_NAME",lA,{writable:!1,enumerable:!1});let DS=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};De(DS,un);const uA="active-header",LS="header",Xd="area",da="focus",cA="fill",hA="row",dA="column",fA="custom-selection",Zd=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var nv={},iv;function gA(){if(iv)return nv;iv=1;var t=Vd();return t("flat"),nv}gA();function mA(t,e){kS(t,e),e.add(t)}function ov(t,e,r){kS(t,e),e.set(t,r)}function kS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(xo(t,e))}function sv(t,e,r){return t.set(xo(t,e),r),r}function xo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cr=new WeakMap,ut=new WeakMap,Rs=new WeakSet;class pA{constructor(){mA(this,Rs),ov(this,cr,void 0),ov(this,ut,void 0)}setActiveOverlay(e){return sv(ut,this,e),this}setActiveSelection(e){return sv(cr,this,e),this}scan(){const e=Ne(cr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ne(cr,this).getCorners(),{wtTable:s}=Ne(ut,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<n||d>o)){for(let f=-l;f<0;f++){if(f<r||f>i)continue;const p=f+l;let w=s.getColumnHeader(d,p);const v=Ne(ut,this).getSetting("onBeforeHighlightingColumnHeader",d,p,{selectionType:Ne(cr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==d&&(w=s.getColumnHeader(v,p)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ne(cr,this).getCorners(),{wtTable:s}=Ne(ut,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<r||d>i)){for(let f=-l;f<0;f++){if(f<n||f>o)continue;const p=f+l;let w=s.getRowHeader(d,p);const v=Ne(ut,this).getSetting("onBeforeHighlightingRowHeader",d,p,{selectionType:Ne(cr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==d&&(w=s.getRowHeader(v,p)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ne(ut,this);xo(Rs,this,wA).call(this,(n,i)=>{const o=r.getCell(Ne(ut,this).createCellCoords(n,i)),s=Ne(ut,this).getSetting("onAfterDrawSelection",n,i,Ne(cr,this).settings.layerLevel);typeof s=="string"&&re(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ne(cr,this).getCorners(),{wtTable:i}=Ne(ut,this);xo(Rs,this,av).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ne(ut,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ne(cr,this).getCorners(),{wtTable:i}=Ne(ut,this);xo(Rs,this,av).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ne(ut,this).createCellCoords(o,s));e(a)}})}}function wA(t){let[e,r,n,i]=Ne(cr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ne(ut,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ne(ut,this).createCellCoords(e,r));if(!ns(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function av(t){const{wtTable:e}=Ne(ut,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class lv{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Zd(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),is(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),zn()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:r}=this.wot,n=r.getCSSVariableValue("cell-mobile-handle-size"),i=r.getCSSVariableValue("cell-mobile-handle-border-radius"),o=r.getCSSVariableValue("cell-mobile-handle-background-color"),s=r.getCSSVariableValue("cell-mobile-handle-border-width"),a=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Ce(c,(f,p)=>{this.selectionHandles.styles.bottomHitArea[p]=f,this.selectionHandles.styles.topHitArea[p]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Ce(d,(f,p)=>{this.selectionHandles.styles.bottom[p]=f,this.selectionHandles.styles.top[p]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),R=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const E=Math.min(parseInt(i+o,10),R-w-p*2),_=Math.min(parseInt(i+o-v/4,10),R-v-p*2);d[l]=`${E}px`,f[l]=`${_}px`;const O=Math.min(parseInt(n+s,10),y-w-p*2),M=Math.min(parseInt(n+s-v/4,10),y-v-p*2);d.top=`${O}px`,f.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),p=s.getLastRenderedColumn();let w;if(u){if(n=Math.max(n,f),o=Math.min(o,p),r=Math.max(r,c),i=Math.min(i,d),o<n||i<r){this.disappear();return}w=s.getCell(this.wot.createCellCoords(r,n))}else if(w=s.getCell(this.wot.createCellCoords(r,n)),!ns(w)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):w,R=Vt(w),y=u?Vt(v):R,E=Vt(s.TABLE),_=R.top,O=R.left,M=this.wot.wtSettings.getSetting("rtlMode");let H=0,N=0;if(M){const le=vt(s.TABLE),ge=vt(w),Xe=l.innerWidth-E.left-le;N=O+ge-y.left,H=l.innerWidth-O-ge-Xe-1}else N=y.left+vt(v)-O,H=O-E.left-1;if(this.isEntireColumnSelected(r,i)){const le=r,ge=this.getDimensionsFromHeader("columns",n,o,le,E);let Xe=null;ge&&([Xe,H,N]=ge),Xe&&(w=Xe)}let L=_-E.top-1,G=y.top+Dt(v)-_;if(this.isEntireRowSelected(n,o)){const le=n,ge=this.getDimensionsFromHeader("rows",r,i,le,E);let Xe=null;ge&&([Xe,L,G]=ge),Xe&&(w=Xe)}const K=l.getComputedStyle(w);parseInt(K.borderTopWidth,10)>0&&(L+=1,G=G>0?G-1:0),parseInt(K[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(H+=1,N=N>0?N-1:0);const j=M?"right":"left";this.topStyle.top=`${L}px`,this.topStyle[j]=`${H}px`,this.topStyle.width=`${N}px`,this.topStyle.display="block",this.startStyle.top=`${L}px`,this.startStyle[j]=`${H}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const J=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${L+G-J}px`,this.bottomStyle[j]=`${H}px`,this.bottomStyle.width=`${N}px`,this.bottomStyle.display="block",this.endStyle.top=`${L}px`,this.endStyle[j]=`${H+N-J}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let ae=this.settings.border.cornerVisible;ae=typeof ae=="function"?ae(this.settings.layerLevel):ae;const q=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Z,Ke]=[i,o];if(q&&Array.isArray(q)&&([,,Z,Ke]=q),zn()||!ae||this.isPartRange(Z,Ke))this.cornerStyle.display="none";else{this.cornerStyle.top=`${L+G+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[j]=`${H+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let le=Vo(s.TABLE);const ge=le===l;ge&&(le=a.documentElement);const Xe=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,or=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),h=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const g=ge?v.getBoundingClientRect().left:v.offsetLeft;let m=!1,b=0;M?(b=g-parseInt(this.cornerDefaultStyle.width,10)/2,m=b<0):(b=g+vt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,m=b>=Ad(le)),m&&(this.cornerStyle[j]=`${Math.floor(H+N+this.cornerCenterPointOffset-or-Xe)}px`,this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const b=(ge?v.getBoundingClientRect().top:v.offsetTop)+Dt(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Oi(le),C=this.wot.stylesHandler.isClassicTheme();if(b){const T=Math.floor(L+G+this.cornerCenterPointOffset-h-Xe);C?(this.cornerStyle.top=`${T}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${T-1}px`}}this.cornerStyle.display="block"}zn()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,L,H,N,G)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,f=null,p=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Dt(...arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return vt(...arguments)},c="ht__selection--columns",p="left";break}if(a.classList.contains(c)){const R=this.wot.getSetting("columnHeaders").length;if(w=l(r,R-i),v=l(n,R-i),!w||!v)return!1;const y=Vt(w),E=Vt(v);return w&&v&&(d=y[p]-o[p]-1,f=E[p]+u(v)-y[p]),[w,d,f]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?re(this[e],"hidden"):(pe(this[e],"hidden")&&ye(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?re(this[e],"hidden"):ye(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",zn()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function vA(t,e){FS(t,e),e.add(t)}function fi(t,e,r){FS(t,e),e.set(t,r)}function FS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function te(t,e){return t.get(Qd(t,e))}function uv(t,e,r){return t.set(Qd(t,e),r),r}function Qd(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ct=new WeakMap,At=new WeakMap,Zc=new WeakMap,To=new WeakMap,Qc=new WeakMap,Nn=new WeakMap,cv=new WeakSet;class yA{constructor(e){vA(this,cv),fi(this,ct,void 0),fi(this,At,void 0),fi(this,Zc,new pA),fi(this,To,new WeakMap),fi(this,Qc,new WeakSet),fi(this,Nn,new Map),uv(At,this,e)}setActiveOverlay(e){return uv(ct,this,e),te(Zc,this).setActiveOverlay(te(ct,this)),te(To,this).has(te(ct,this))||te(To,this).set(te(ct,this),new Set),this}getFocusSelection(){return te(At,this)!==null?te(At,this).getFocus():null}getAreaSelection(){return te(At,this)!==null?te(At,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(te(Nn,this).has(e)){const n=te(Nn,this).get(e);if(n.has(te(ct,this)))return n.get(te(ct,this));const i=new lv(te(ct,this),e.settings);return n.set(te(ct,this),i),i}const r=new lv(te(ct,this),e.settings);return te(Nn,this).set(e,new Map([[te(ct,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=te(Nn,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){te(Nn,this).get(e).forEach(r=>r.destroy()),te(Nn,this).delete(e)}render(e){if(te(At,this)===null)return;e&&Qd(cv,this,bA).call(this);const r=Array.from(te(At,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;te(Qc,this).has(s)||(te(Qc,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&te(Zc,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const v=n.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const f=s.getCorners();te(ct,this).getSetting("onBeforeDrawBorders",f,c),d==null||d.appear(f)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(f,p)=>`${c}-${p+1}`)]}).flat();l.forEach(u=>te(To,this).get(te(ct,this)).add(u)),re(s,l),s.nodeName==="TD"&&Array.isArray((a=te(At,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(s,te(At,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{be(o,[...i.get(o)])})}}function bA(){const t=te(To,this).get(te(ct,this)),e=te(ct,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=te(ct,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=te(At,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=te(At,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=te(At,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...te(At,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ye(o[a],r),Bi(o[a],s)}),t.clear()}class SA extends as{constructor(e,r,n,i){super(e,r,Kn,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Kd(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Fa(n,`${o}px`,"0px")):(o=this.getScrollPosition(),rs(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,xd(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=yt(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=vt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Zd(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!pe(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const d=this.wot.wtTable.getColumnWidth(e),f=this.wot.wtViewport.getViewportWidth();d>f&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=yt(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Yb(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(Pd(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?ye(n,"emptyRows"):re(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)re(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=pe(n,"innerBorderInlineStart");e?(re(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(ye(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const CA="stickyRowsTop",Jd={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};an(Jd,"MIXIN_NAME",CA,{writable:!1,enumerable:!1});class ef extends Ui{constructor(e,r,n,i){super(e,r,n,i,Xn)}}De(ef,Jd);De(ef,$a);function hv(t,e,r){return(e=RA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RA(t){var e=TA(t,"string");return typeof e=="symbol"?e:e+""}function TA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EA extends as{constructor(e,r,n,i,o,s){super(e,r,Xn,n,i),hv(this,"topOverlay",void 0),hv(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new ef(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Fa(e,`${i}px`,`${o}px`)}else rs(e);let r=Dt(this.clone.wtTable.TABLE);const n=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class tf extends Ui{constructor(e,r,n,i){super(e,r,n,i,Gn)}}De(tf,Jd);De(tf,ja);function OA(t,e,r){return(e=_A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _A(t){var e=MA(t,"string");return typeof e=="symbol"?e:e+""}function MA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IA extends as{constructor(e,r,n,i){super(e,r,Gn,n,i),OA(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new tf(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Fa(e,"0px",`${i}px`)}else i=this.getScrollPosition(),rs(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(La(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=yt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Dt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Zd(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!pe(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),d=0;if(r){const f=this.wot.wtTable.getRowHeight(e),p=this.wot.wtViewport.getViewportHeight();f>p&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(d=yt(this.domBindings.rootDocument)),r){const f=i.getSetting("fixedRowsBottom"),p=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(p-f,p),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=d,Ub(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ka(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?ye(i,"emptyColumns"):re(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const d=pe(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(re(i,"innerBorderTop"),a=!d):(ye(i,"innerBorderTop"),a=d)}}return a}}function Ts(t,e,r){HA(t,e),e.set(t,r)}function HA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jr(t,e,r){return(e=xA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xA(t){var e=PA(t,"string");return typeof e=="symbol"?e:e+""}function PA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dn(t,e,r){return t.set(VS(t,e),r),r}function zr(t,e){return t.get(VS(t,e))}function VS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gi=new WeakMap,Es=new WeakMap,mi=new WeakMap,Os=new WeakMap;class AA{constructor(e,r,n,i,o,s){jr(this,"wot",null),Ts(this,gi,[]),jr(this,"topOverlay",null),jr(this,"bottomOverlay",null),jr(this,"inlineStartOverlay",null),jr(this,"topInlineStartCornerOverlay",null),jr(this,"bottomInlineStartCornerOverlay",null),jr(this,"browserLineHeight",void 0),jr(this,"wtSettings",null),Ts(this,Es,!1),Ts(this,mi,0),Ts(this,Os,null),jr(this,"resizeObserver",new ResizeObserver(c=>{Ih(()=>{!Array.isArray(c)||!c.length||(Dn(mi,this,zr(mi,this)+1),zr(mi,this)===100&&(_n("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),zr(Os,this)!==null&&clearTimeout(zr(Os,this)),Dn(Os,this,setTimeout(()=>{Dn(mi,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=yt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Fo(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...zr(gi,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new IA(...e),this.bottomOverlay=new sA(...e),this.inlineStartOverlay=new SA(...e),this.topInlineStartCornerOverlay=new EA(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tA(...e,this.bottomOverlay,this.inlineStartOverlay),Dn(gi,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Dn(Es,this,zr(gi,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),zr(gi,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),zr(gi,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",d=>this.onTableScroll(d),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!lS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{this.eventManager.addEventListener(d.clone.wtTable.holder,"wheel",f=>this.onCloneWheel(f,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{Ih(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Dn(mi,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=mS(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!zr(Es,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Dn(Es,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Fo(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),f=r.hider.style,p=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),v=p()?1:0,R=w()?1:0;f.width=`${c+R}px`,f.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return X(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];X(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function dv(t,e,r){return(e=NA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NA(t){var e=DA(t,"string");return typeof e=="symbol"?e:e+""}function DA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LA{constructor(e){dv(this,"settings",{}),dv(this,"defaults",Object.freeze(this.getDefaults())),Ce(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);$i(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Ce(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class rf extends Ui{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Vo(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=_h(e,"height",r),o=_h(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const p=parseInt(r.getComputedStyle(f).height,10);n.removeChild(f),p===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=xi(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}De(rf,Gd);De(rf,ja);class kA{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new gx:new bx],["fullyVisible",()=>new ix],["partiallyVisible",()=>new ES]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new hx:new wx],["fullyVisible",()=>new tx],["partiallyVisible",()=>new TS]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Dt(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Vt(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Dt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=vt(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=yt(this.domBindings.rootDocument),new Mx({calculationTypes:e.map(d=>[d,this.rowsCalculatorTypes.get(d)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:d=>n.getRowHeight(d),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=yt(this.domBindings.rootDocument)),new Ex({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){Ce(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}function FA(t,e){WS(t,e),e.add(t)}function Ln(t,e,r){WS(t,e),e.set(t,r)}function WS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(fr(t,e))}function dr(t,e,r){return t.set(fr(t,e),r),r}function fr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fv=23;var Hr=new WeakMap,Xr=new WeakMap,nf=new WeakMap,kh=new WeakMap,wn=new WeakMap,Eo=new WeakMap,Wo=new WeakMap,xr=new WeakSet;class VA{constructor(e){FA(this,xr),Ln(this,Hr,void 0),Ln(this,Xr,void 0),Ln(this,nf,void 0),Ln(this,kh,void 0),Ln(this,wn,!0),Ln(this,Eo,{}),Ln(this,Wo,{}),dr(Xr,this,e.rootTable.parentElement.parentElement),dr(kh,this,e.rootDocument)}isClassicTheme(){return Oe(wn,this)}getCSSVariableValue(e){var r;if(Oe(wn,this))return null;if(Oe(Eo,this)[`--ht-${e}`])return Oe(Eo,this)[`--ht-${e}`];const n=(r=fr(xr,this,jA).call(this,`--ht-${e}`))!==null&&r!==void 0?r:fr(xr,this,BS).call(this,`--ht-${e}`);if(n!==null)return Oe(Eo,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Oe(Wo,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Oe(wn,this))return fv;const e=fr(xr,this,WA).call(this);return!e&&pe(Oe(Xr,this),"ht-wrapper")?(_n(`The "${Oe(Hr,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),dr(wn,this,!0),this.useTheme(),fv):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){fr(xr,this,gv).call(this),dr(wn,this,!0),dr(Hr,this,e||void 0);return}e&&e!==Oe(Hr,this)&&(Oe(Hr,this)&&fr(xr,this,zA).call(this),dr(Hr,this,e),dr(wn,this,!1),fr(xr,this,BA).call(this),fr(xr,this,gv).call(this))}getThemeName(){return Oe(Hr,this)}removeClassNames(){pe(Oe(Xr,this),Oe(Hr,this))&&ye(Oe(Xr,this),Oe(Hr,this))}}function WA(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function BA(){ye(Oe(Xr,this),/ht-theme-.*/g),re(Oe(Xr,this),Oe(Hr,this))}function gv(){this.isClassicTheme()||dr(nf,this,getComputedStyle(Oe(Xr,this)));const t=fr(xr,this,$A).call(this,["box-sizing","border-bottom-width"]);Oe(Wo,this).td={...Oe(Wo,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function $A(t){const e=Oe(kh,this),r=Oe(Xr,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function jA(t){const e=Math.ceil(parseFloat(fr(xr,this,BS).call(this,t)));return Number.isNaN(e)?null:e}function BS(t){const e=Oe(nf,this).getPropertyValue(t);return e===""?null:e}function zA(){dr(Wo,this,{}),dr(Eo,this,{}),dr(wn,this,!0)}class UA extends Yd{constructor(e,r){super(e,new LA(r)),this.stylesHandler=new VA(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new rf(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new kA(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new yA(this.wtSettings.getSetting("selections")),this.wtEvent=new xS(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new AA(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Ce(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),ye(this.wtTable.wtRootElement.parentNode,r),re(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!NS.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class of{constructor(e){e instanceof Yd?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new of(r);return()=>n},this._wot=new UA(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function mv(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),f=r||n&&d;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function YA(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const qA=new Map([["mousedown",mv],["mouseover",YA],["touchstart",mv]]);function pv(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:o}=e;qA.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Fd(t)||t.type==="touchstart",isRightClick:ca(t)})}const $S=new WeakMap,sf=Symbol("rootInstance");function GA(t){$S.set(t,!0)}function KA(t){return t===sf}function Qs(t){return $S.has(t)}function XA(t,e){jS(t,e),e.add(t)}function gn(t,e,r){jS(t,e),e.set(t,r)}function jS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mn(t,e,r){return(e=ZA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZA(t){var e=QA(t,"string");return typeof e=="symbol"?e:e+""}function QA(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ke(t,e){return t.get(Mi(t,e))}function Ht(t,e,r){return t.set(Mi(t,e),r),r}function Mi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Jc=new WeakMap,_s=new WeakMap,Ms=new WeakMap,Ur=new WeakMap,lr=new WeakMap,eh=new WeakMap,th=new WeakMap,pi=new WeakMap,Oo=new WeakSet;class JA{constructor(e){XA(this,Oo),mn(this,"hot",void 0),mn(this,"eventManager",void 0),mn(this,"settings",void 0),mn(this,"THEAD",void 0),mn(this,"TBODY",void 0),mn(this,"_wt",void 0),mn(this,"activeWt",void 0),gn(this,Jc,0),gn(this,_s,0),mn(this,"postponedAdjustElementsSize",!1),gn(this,Ms,!1),gn(this,Ur,void 0),gn(this,lr,void 0),gn(this,eh,0),gn(this,th,0),gn(this,pi,null),this.hot=e,this.eventManager=new Ai(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Mi(Oo,this,t1).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),re(e,"handsontable"),Ht(lr,this,r.createElement("TABLE")),re(ke(lr,this),"htCore"),this.hot.getSettings().tableClassName&&re(ke(lr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(ke(lr,this),[Jr()]),be(e,[iI(),Ab(-1),Da(this.hot.countCols()),cI()])),this.THEAD=r.createElement("THEAD"),ke(lr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),ke(lr,this).appendChild(this.TBODY),this.hot.table=ke(lr,this),this.hot.container.insertBefore(ke(lr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Ht(Ms,this,!0),this.isTextSelectionAllowed(a.target)||(Mh(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Ht(Ms,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{ke(Ms,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Mh(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{n.isInProgress()&&Fd(a)&&n.finish(),Ht(Ur,this,!1);const l=Va(r.activeElement);Ho(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ca(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{n.isInProgress()&&ca(a)&&(n.finish(),Ht(Ur,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),Ht(Ur,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let d=a.target;if(ke(Ur,this)||!e||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const w=yt(r);if(r.elementFromPoint(u+w,c)!==f||r.elementFromPoint(u,c+w)!==f)return}else for(;d!==o;){if(d===null){if(a.isTargetWebComponent)break;return}if(d===e)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=ko(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=ko(s);this.eventManager.addEventListener(ke(lr,this),"selectstart",a=>{this.settings.fragmentSelection||Ho(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&re(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&ye(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:ke(lr,this),isDataViewInstance:()=>Qs(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Ht(_s,this,o.length),this.hot.getSettings().ariaTags&&Mi(Oo,this,zS).call(this)===this.hot.countCols()&&Mi(Oo,this,e1).call(this,ke(_s,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Ht(Jc,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let d=l,f=u;Array.isArray(c)&&([d,f]=c);const p=this.hot.getCellMeta(d,f),w=this.hot.colToProp(f);let v=this.hot.getDataAtRowProp(d,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,p)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,p),this.hot.getCellRenderer(p)(this.hot,a,l,u,w,v,p),this.hot.runHooks("afterRenderer",a,l,u,w,v,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&xi(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Ht(Ur,this,!0),Ht(pi,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!yn(o)&&(pv(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Ht(Ur,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!yn(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!yn(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!yn(o)&&(ke(Ur,this)&&(!ke(pi,this)||ke(pi,this).x!==o.clientX||ke(pi,this).y!==o.clientY)&&pv(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Ht(pi,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(yn(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const p=d.peekByIndex(a??0);l=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,d=s>=0?c.getVisualFromRenderableIndex(s):s,f=o>=0?u.getVisualFromRenderableIndex(o):o,p=this.hot.runHooks("modifyGetCellCoords",f,d,a,l);if(Array.isArray(p)){const[w,v,R,y]=p;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,R>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(R,-1)):R,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,-1)):y]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(d)){const[f,p]=d;return[f>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1)):f,p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,1)):p]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new of(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Ho(e))return!0;const r=aa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return ke(Ur,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!pe(n,"relative")){Hi(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;pe(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",re(s,["relative",...o()])):(Hi(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...Jr()),be(l,...Jr())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(pe(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):pe(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?zb(e,n(r,i)):($i(e,"Â "),re(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Ht(eh,this,e),Ht(th,this,r)}getLastSize(){return{width:ke(eh,this),height:ke(th,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return ke(Jc,this)}getRowHeadersCount(){return ke(_s,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function zS(){return parseInt(this.hot.rootElement.getAttribute(Da()[0]),10)}function e1(t){const e=Mi(Oo,this,zS).call(this)+t;be(this.hot.rootElement,...Da(e))}function t1(){const t=this.hot.rootElement;this.hasVerticalScroll()?re(t,"htHasScrollY"):ye(t,"htHasScrollY"),this.hasHorizontalScroll()?re(t,"htHasScrollX"):ye(t,"htHasScrollX")}var wv={},vv={},yv;function r1(){if(yv)return vv;yv=1;var t=Ie(),e=Ko(),r=jt(),n=Je(),i=In();return t({target:"Iterator",proto:!0,real:!0},{every:function(s){n(this),r(s);var a=i(this),l=0;return!e(a,function(u,c){if(!s(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),vv}var bv;function n1(){return bv||(bv=1,r1()),wv}n1();const US="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Fh=US.length;function za(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%Fh,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/Fh,10);return r}function i1(t){let e=0;if(t)for(let r=0,n=t.length-1;r<t.length;r+=1,n-=1)e+=Fh**n*(US.indexOf(t[r])+1);return e-=1,e}function o1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const o=[];for(i=0;i<e;i++)o.push(za(i)+(n+1));r.push(o)}return r}function s1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=za(i)+(n+1);r.push(o)}return r}function a1(t,e){const r=[];let n;for(let i=0;i<t;i++){n=[];for(let o=0;o<e;o++)n.push("");r.push(n)}return r}function l1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{n.push([o+e,a,s])}):Object.keys(i).forEach(s=>{n.push([o+e,s,i[s]])})}),n}function af(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&vr(t[0])&&(e=Wa(t[0]))),e}function u1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function c1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const xk=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:af,createEmptySpreadsheetData:a1,createSpreadsheetData:o1,createSpreadsheetObjectData:s1,dataRowToChangesArray:l1,isArrayOfArrays:u1,isArrayOfObjects:c1,spreadsheetColumnIndex:i1,spreadsheetColumnLabel:za},Symbol.toStringTag,{value:"Module"}));function mo(t,e,r){return(e=h1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h1(t){var e=d1(t,"string");return typeof e=="symbol"?e:e+""}function d1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f1{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];mo(this,"hot",void 0),mo(this,"data",void 0),mo(this,"dataType","array"),mo(this,"colToProp",()=>{}),mo(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return X(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Wt(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(vr(a)||_e(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Wt(0,c,d=>{const f=this.colToProp(d);if(d>=(r||0)&&d<=(n||c)&&!Number.isInteger(f)){const p=this.getAtPhysicalCell(e,f,a);i?l.push(p):s?Ks(l,f,p):l[f]=p}})}else Ce(a,(u,c)=>{const d=this.getAtPhysicalCell(e,c,a);s?Ks(l,c,d):l[c]=d});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Nt(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Ks(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?nS(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=Nt(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Wt(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return af(this.data)}destroy(){this.data=null,this.hot=null}}var Sv={},Cv={},Rv;function g1(){if(Rv)return Cv;Rv=1;var t=Ie(),e=Ko(),r=jt(),n=Je(),i=In();return t({target:"Iterator",proto:!0,real:!0},{some:function(s){n(this),r(s);var a=i(this),l=0;return e(a,function(u,c){if(s(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Cv}var Tv;function m1(){return Tv||(Tv=1,g1()),Sv}m1();function Ev(t,e,r){return(e=p1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p1(t){var e=w1(t,"string");return typeof e=="symbol"?e:e+""}function w1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ls{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ev(this,"indexedValues",[]),Ev(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,_e(this.initValueOrFn)?Wt(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Wt(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}De(ls,un);function YS(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>_e(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function qS(t,e){return Ed(t,(r,n)=>e.includes(n)===!1)}class lf extends ls{insert(e,r){this.indexedValues=YS(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=qS(this.indexedValues,e),super.remove(e)}}class GS extends lf{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ir(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function KS(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function fa(t,e){return Ed(t,r=>e.includes(r)===!1)}function XS(t,e){return Tn(t,r=>r-e.filter(n=>n<r).length)}function ZS(t,e){const r=e[0],n=e.length;return Tn(t,i=>i>=r?i+n:i)}function v1(t,e,r){return(e=y1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y1(t){var e=b1(t,"string");return typeof e=="symbol"?e:e+""}function b1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S1 extends ls{constructor(){super(...arguments),v1(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=fa(this.orderOfIndexes,[e]),_e(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=YS(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=ZS(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=qS(this.indexedValues,e),this.orderOfIndexes=fa(this.orderOfIndexes,e),this.orderOfIndexes=XS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class QS extends lf{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ir(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class C1 extends ls{constructor(){super(e=>e)}insert(e,r){const n=ZS(this.indexedValues,r);this.indexedValues=KS(n,e,r),super.insert(e,r)}remove(e){const r=fa(this.indexedValues,e);this.indexedValues=XS(r,e),super.remove(e)}}const Ov=new Map([["hiding",GS],["index",ls],["linkedPhysicalIndexToValue",S1],["physicalIndexToValue",lf],["trimming",QS]]);function R1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Ov.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Ov.get(t))(e)}function T1(t,e,r){return(e=E1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E1(t){var e=O1(t,"string");return typeof e=="symbol"?e:e+""}function O1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Vh=0;class uf{constructor(){T1(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),Vh+=1)}unregister(e){const r=this.collection.get(e);oe(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),Vh-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return wt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}De(uf,un);function Pk(){return Vh}function rh(t,e,r){return(e=_1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _1(t){var e=M1(t,"string");return typeof e=="symbol"?e:e+""}function M1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _v extends uf{constructor(e,r){super(),rh(this,"mergedValuesCache",[]),rh(this,"aggregationFunction",void 0),rh(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Tn(this.get(),o=>o.getValues()),n=[],i=oe(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return Tn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return oe(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function I1(t,e,r){H1(t,e),e.set(t,r)}function H1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x1(t,e,r){return t.set(JS(t,e),r),r}function P1(t,e){return t.get(JS(t,e))}function JS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var nh=new WeakMap;class eC{constructor(){I1(this,nh,[])}subscribe(e){return this.addLocalHook("change",e),this._write(P1(nh,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){x1(nh,this,e)}}De(eC,un);function Mv(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function po(t,e,r){A1(t,e),e.set(t,r)}function A1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e){return t.get(tC(t,e))}function Is(t,e,r){return t.set(tC(t,e),r),r}function tC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hs=new WeakMap,wo=new WeakMap,xs=new WeakMap,Ps=new WeakMap,As=new WeakMap;class N1{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};po(this,Hs,new Set),po(this,wo,[]),po(this,xs,[]),po(this,Ps,!1),po(this,As,!1),Is(As,this,e??!1)}createObserver(){const e=new eC;return Xt(Hs,this).add(e),e.addLocalHook("unsubscribe",()=>{Xt(Hs,this).delete(e)}),e._writeInitialChanges(Mv(Xt(wo,this),Xt(xs,this))),e}emit(e){let r=Xt(xs,this);(!Xt(Ps,this)||Xt(wo,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Xt(As,this)):Is(wo,this,new Array(e.length).fill(Xt(As,this))),Xt(Ps,this)||(Is(Ps,this,!0),r=Xt(wo,this)));const n=Mv(r,e);Xt(Hs,this).forEach(i=>i._write(n)),Is(xs,this,e)}}function pt(t,e,r){return(e=D1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D1(t){var e=L1(t,"string");return typeof e=="symbol"?e:e+""}function L1(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wh{constructor(){pt(this,"indexesSequence",new C1),pt(this,"trimmingMapsCollection",new _v(e=>e.some(r=>r===!0),!1)),pt(this,"hidingMapsCollection",new _v(e=>e.some(r=>r===!0),!1)),pt(this,"variousMapsCollection",new uf),pt(this,"hidingChangesObservable",new N1({initialIndexValue:!1})),pt(this,"notTrimmedIndexesCache",[]),pt(this,"notHiddenIndexesCache",[]),pt(this,"isBatched",!1),pt(this,"indexesSequenceChanged",!1),pt(this,"indexesChangeSource",void 0),pt(this,"trimmedIndexesChanged",!1),pt(this,"hiddenIndexesChanged",!1),pt(this,"renderablePhysicalIndexesCache",[]),pt(this,"fromPhysicalToVisualIndexesCache",new Map),pt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,R1(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof QS?this.trimmingMapsCollection.register(e,r):r instanceof GS?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return oe(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return oe(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return oe(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return oe(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Tn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=fa(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(KS(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=oe(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=Tn(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}De(Wh,un);function k1(t,e){return Ce(e,(r,n)=>{wt(t[n])&&(t[n]=r)}),t}function rC(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function nC(t){oe(t)&&WI(Bt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function F1(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:V1,getValues:W1}=zi("phraseFormatters");function B1(t,e){V1(t,e)}function $1(){return W1()}B1("pluralize",F1);const iC="ContextMenu:items",Q=iC,oC=`${Q}.noItems`,sC=`${Q}.insertRowAbove`,aC=`${Q}.insertRowBelow`,lC=`${Q}.insertColumnOnTheLeft`,uC=`${Q}.insertColumnOnTheRight`,cC=`${Q}.removeRow`,hC=`${Q}.removeColumn`,dC=`${Q}.undo`,fC=`${Q}.redo`,gC=`${Q}.readOnly`,mC=`${Q}.clearColumn`,pC=`${Q}.copy`,wC=`${Q}.copyWithHeaders`,vC=`${Q}.copyWithGroupHeaders`,yC=`${Q}.copyHeadersOnly`,bC=`${Q}.cut`,SC=`${Q}.freezeColumn`,CC=`${Q}.unfreezeColumn`,RC=`${Q}.mergeCells`,TC=`${Q}.unmergeCells`,EC=`${Q}.addComment`,OC=`${Q}.editComment`,_C=`${Q}.removeComment`,MC=`${Q}.readOnlyComment`,IC=`${Q}.align`,HC=`${Q}.align.left`,xC=`${Q}.align.center`,PC=`${Q}.align.right`,AC=`${Q}.align.justify`,NC=`${Q}.align.top`,DC=`${Q}.align.middle`,LC=`${Q}.align.bottom`,kC=`${Q}.borders`,FC=`${Q}.borders.top`,VC=`${Q}.borders.right`,WC=`${Q}.borders.bottom`,BC=`${Q}.borders.left`,$C=`${Q}.borders.remove`,jC=`${Q}.nestedHeaders.insertChildRow`,zC=`${Q}.nestedHeaders.detachFromParent`,UC=`${Q}.hideColumn`,YC=`${Q}.showColumn`,qC=`${Q}.hideRow`,GC=`${Q}.showRow`,kt="Filters:",Le=`${kt}conditions`,KC=`${Le}.none`,XC=`${Le}.isEmpty`,ZC=`${Le}.isNotEmpty`,QC=`${Le}.isEqualTo`,JC=`${Le}.isNotEqualTo`,eR=`${Le}.beginsWith`,tR=`${Le}.endsWith`,rR=`${Le}.contains`,nR=`${Le}.doesNotContain`,j1=`${Le}.byValue`,iR=`${Le}.greaterThan`,oR=`${Le}.greaterThanOrEqualTo`,sR=`${Le}.lessThan`,aR=`${Le}.lessThanOrEqualTo`,lR=`${Le}.isBetween`,uR=`${Le}.isNotBetween`,cR=`${Le}.after`,hR=`${Le}.before`,dR=`${Le}.today`,fR=`${Le}.tomorrow`,gR=`${Le}.yesterday`,mR=`${kt}labels.filterByCondition`,pR=`${kt}labels.filterByValue`,wR=`${kt}labels.conjunction`,vR=`${kt}labels.disjunction`,yR=`${kt}values.blankCells`,bR=`${kt}buttons.selectAll`,SR=`${kt}buttons.clear`,CR=`${kt}buttons.ok`,RR=`${kt}buttons.cancel`,TR=`${kt}buttons.placeholder.search`,ER=`${kt}buttons.placeholder.value`,OR=`${kt}buttons.placeholder.secondValue`,cf="CheckboxRenderer:",_R=`${cf}checked`,MR=`${cf}unchecked`,z1=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:_R,CHECKBOX_RENDERER_NAMESPACE:cf,CHECKBOX_UNCHECKED:MR,CONTEXTMENU_ITEMS_ADD_COMMENT:EC,CONTEXTMENU_ITEMS_ALIGNMENT:IC,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:LC,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:xC,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:AC,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:HC,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:DC,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:PC,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:NC,CONTEXTMENU_ITEMS_BORDERS:kC,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:WC,CONTEXTMENU_ITEMS_BORDERS_LEFT:BC,CONTEXTMENU_ITEMS_BORDERS_RIGHT:VC,CONTEXTMENU_ITEMS_BORDERS_TOP:FC,CONTEXTMENU_ITEMS_CLEAR_COLUMN:mC,CONTEXTMENU_ITEMS_COPY:pC,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:yC,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:vC,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:wC,CONTEXTMENU_ITEMS_CUT:bC,CONTEXTMENU_ITEMS_EDIT_COMMENT:OC,CONTEXTMENU_ITEMS_FREEZE_COLUMN:SC,CONTEXTMENU_ITEMS_HIDE_COLUMN:UC,CONTEXTMENU_ITEMS_HIDE_ROW:qC,CONTEXTMENU_ITEMS_INSERT_LEFT:lC,CONTEXTMENU_ITEMS_INSERT_RIGHT:uC,CONTEXTMENU_ITEMS_MERGE_CELLS:RC,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:zC,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:jC,CONTEXTMENU_ITEMS_NO_ITEMS:oC,CONTEXTMENU_ITEMS_READ_ONLY:gC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:MC,CONTEXTMENU_ITEMS_REDO:fC,CONTEXTMENU_ITEMS_REMOVE_BORDERS:$C,CONTEXTMENU_ITEMS_REMOVE_COLUMN:hC,CONTEXTMENU_ITEMS_REMOVE_COMMENT:_C,CONTEXTMENU_ITEMS_REMOVE_ROW:cC,CONTEXTMENU_ITEMS_ROW_ABOVE:sC,CONTEXTMENU_ITEMS_ROW_BELOW:aC,CONTEXTMENU_ITEMS_SHOW_COLUMN:YC,CONTEXTMENU_ITEMS_SHOW_ROW:GC,CONTEXTMENU_ITEMS_UNDO:dC,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:CC,CONTEXTMENU_ITEMS_UNMERGE_CELLS:TC,CONTEXT_MENU_ITEMS_NAMESPACE:iC,FILTERS_BUTTONS_CANCEL:RR,FILTERS_BUTTONS_CLEAR:SR,FILTERS_BUTTONS_OK:CR,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:TR,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:OR,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ER,FILTERS_BUTTONS_SELECT_ALL:bR,FILTERS_CONDITIONS_AFTER:cR,FILTERS_CONDITIONS_BEFORE:hR,FILTERS_CONDITIONS_BEGINS_WITH:eR,FILTERS_CONDITIONS_BETWEEN:lR,FILTERS_CONDITIONS_BY_VALUE:j1,FILTERS_CONDITIONS_CONTAINS:rR,FILTERS_CONDITIONS_EMPTY:XC,FILTERS_CONDITIONS_ENDS_WITH:tR,FILTERS_CONDITIONS_EQUAL:QC,FILTERS_CONDITIONS_GREATER_THAN:iR,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:oR,FILTERS_CONDITIONS_LESS_THAN:sR,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:aR,FILTERS_CONDITIONS_NAMESPACE:Le,FILTERS_CONDITIONS_NONE:KC,FILTERS_CONDITIONS_NOT_BETWEEN:uR,FILTERS_CONDITIONS_NOT_CONTAIN:nR,FILTERS_CONDITIONS_NOT_EMPTY:ZC,FILTERS_CONDITIONS_NOT_EQUAL:JC,FILTERS_CONDITIONS_TODAY:dR,FILTERS_CONDITIONS_TOMORROW:fR,FILTERS_CONDITIONS_YESTERDAY:gR,FILTERS_DIVS_FILTER_BY_CONDITION:mR,FILTERS_DIVS_FILTER_BY_VALUE:pR,FILTERS_LABELS_CONJUNCTION:wR,FILTERS_LABELS_DISJUNCTION:vR,FILTERS_NAMESPACE:kt,FILTERS_VALUES_BLANK_CELLS:yR},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const IR={languageCode:"en-US",[oC]:"No available options",[sC]:"Insert row above",[aC]:"Insert row below",[lC]:"Insert column left",[uC]:"Insert column right",[cC]:["Remove row","Remove rows"],[hC]:["Remove column","Remove columns"],[dC]:"Undo",[fC]:"Redo",[gC]:"Read only",[mC]:"Clear column",[IC]:"Alignment",[HC]:"Left",[xC]:"Center",[PC]:"Right",[AC]:"Justify",[NC]:"Top",[DC]:"Middle",[LC]:"Bottom",[SC]:"Freeze column",[CC]:"Unfreeze column",[kC]:"Borders",[FC]:"Top",[VC]:"Right",[WC]:"Bottom",[BC]:"Left",[$C]:"Remove border(s)",[EC]:"Add comment",[OC]:"Edit comment",[_C]:"Delete comment",[MC]:"Read-only comment",[RC]:"Merge cells",[TC]:"Unmerge cells",[pC]:"Copy",[wC]:["Copy with header","Copy with headers"],[vC]:["Copy with group header","Copy with group headers"],[yC]:["Copy header only","Copy headers only"],[bC]:"Cut",[jC]:"Insert child row",[zC]:"Detach from parent",[UC]:["Hide column","Hide columns"],[YC]:["Show column","Show columns"],[qC]:["Hide row","Hide rows"],[GC]:["Show row","Show rows"],[KC]:"None",[XC]:"Is empty",[ZC]:"Is not empty",[QC]:"Is equal to",[JC]:"Is not equal to",[eR]:"Begins with",[tR]:"Ends with",[rR]:"Contains",[nR]:"Does not contain",[iR]:"Greater than",[oR]:"Greater than or equal to",[sR]:"Less than",[aR]:"Less than or equal to",[lR]:"Is between",[uR]:"Is not between",[cR]:"After",[hR]:"Before",[dR]:"Today",[fR]:"Tomorrow",[gR]:"Yesterday",[yR]:"Blank cells",[mR]:"Filter by condition",[pR]:"Filter by value",[wR]:"And",[vR]:"Or",[bR]:"Select all",[SR]:"Clear",[CR]:"OK",[RR]:"Cancel",[TR]:"Search",[ER]:"Value",[OR]:"Second value",[_R]:"Checked",[MR]:"Unchecked"},U1=z1,Bh=IR.languageCode,{register:Y1,getItem:HR,hasItem:q1,getValues:G1}=zi("languagesDictionaries");xR(IR);function xR(t,e){let r=t,n=e;return vr(t)&&(n=t,r=n.languageCode),K1(r,n),Y1(r,nn(n)),nn(n)}function K1(t,e){t!==Bh&&k1(e,HR(Bh))}function PR(t){return hf(t)?nn(HR(t)):null}function hf(t){return q1(t)}function X1(){return G1()}function AR(t,e,r){const n=PR(t);if(n===null)return null;const i=n[e];if(wt(i))return null;const o=Z1(i,r);return Array.isArray(o)?o[0]:o}function Z1(t,e){let r=t;return X($1(),n=>{r=n(t,e)}),r}function Q1(t){let e=rC(t);return hf(e)||(e=Bh,nC(t)),e}function J1(t,e,r){return(e=eN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eN(t){var e=tN(t,"string");return typeof e=="symbol"?e:e+""}function tN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cn extends DS{constructor(e,r){super(e,null),J1(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function ih(t){let{activeHeaderClassName:e,...r}=t;return new cn({className:e,...r,selectionType:uA})}function rN(t){let{areaCornerVisible:e,...r}=t;return new cn({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Xd})}function nN(t){let{...e}=t;return new cn({className:"highlight",...e,selectionType:Xd})}function iN(t){let{columnClassName:e,...r}=t;return new cn({className:e,...r,selectionType:dA})}function oN(t){let{cellCornerVisible:e,...r}=t;return new cn({className:"current",headerAttributes:[Db()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:da})}function sN(t){let{border:e,visualCellRange:r,...n}=t;return new cn({...e,...n,selectionType:fA},r)}function aN(t){let{...e}=t;return new cn({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:cA})}function Iv(t){let{headerClassName:e,...r}=t;return new cn({className:e,...r,selectionType:LS})}function lN(t){let{rowClassName:e,...r}=t;return new cn({className:e,...r,selectionType:hA})}function uN(t,e){cN(t,e),e.add(t)}function cN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e,r){return(e=hN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hN(t){var e=dN(t,"string");return typeof e=="symbol"?e:e+""}function dN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mr=new WeakSet;class fN{constructor(e){uN(this,Mr),xt(this,"options",void 0),xt(this,"layerLevel",0),xt(this,"focus",void 0),xt(this,"fill",void 0),xt(this,"layeredAreas",new Map),xt(this,"areas",new Map),xt(this,"rowHeaders",new Map),xt(this,"columnHeaders",new Map),xt(this,"activeRowHeaders",new Map),xt(this,"activeColumnHeaders",new Map),xt(this,"activeCornerHeaders",new Map),xt(this,"rowHighlights",new Map),xt(this,"columnHighlights",new Map),xt(this,"customSelections",[]),this.options=e,this.focus=oN(e),this.fill=aN(e)}isEnabledFor(e,r){let n=e;e===da&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Yr(Mr,this,qr).call(this,this.layeredAreas,rN)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Yr(Mr,this,qr).call(this,this.areas,nN)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Yr(Mr,this,qr).call(this,this.rowHeaders,Iv)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Yr(Mr,this,qr).call(this,this.columnHeaders,Iv)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Yr(Mr,this,qr).call(this,this.activeRowHeaders,ih)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Yr(Mr,this,qr).call(this,this.activeColumnHeaders,ih)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Yr(Mr,this,qr).call(this,this.activeCornerHeaders,ih)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Yr(Mr,this,qr).call(this,this.rowHighlights,lN)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Yr(Mr,this,qr).call(this,this.columnHighlights,iN)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(sN({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),X(this.areas.values(),e=>void e.clear()),X(this.layeredAreas.values(),e=>void e.clear()),X(this.rowHeaders.values(),e=>void e.clear()),X(this.columnHeaders.values(),e=>void e.clear()),X(this.activeRowHeaders.values(),e=>void e.clear()),X(this.activeColumnHeaders.values(),e=>void e.clear()),X(this.activeCornerHeaders.values(),e=>void e.clear()),X(this.rowHighlights.values(),e=>void e.clear()),X(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function qr(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function Hv(t,e,r){return(e=gN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gN(t){var e=mN(t,"string");return typeof e=="symbol"?e:e+""}function mN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pN{constructor(e){Hv(this,"ranges",[]),Hv(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function wN(t,e){NR(t,e),e.add(t)}function oh(t,e,r){NR(t,e),e.set(t,r)}function NR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ue(t,e){return t.get(Be(t,e))}function Ns(t,e,r){return t.set(Be(t,e),r),r}function Be(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ds=new WeakMap,Se=new WeakMap,mr=new WeakMap,Ue=new WeakSet;class $h{constructor(e,r){wN(this,Ue),oh(this,Ds,void 0),oh(this,Se,void 0),oh(this,mr,{x:0,y:0}),Ns(Ds,this,e),Ns(Se,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=ue(Se,this).createCellCoords(e,r);let o=ue(Ds,this).current().highlight;const s=ue(Se,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Be(Ue,this,DR).call(this),{row:d,col:f}=Be(Ue,this,Pv).call(this,o),p=ue(Se,this).fixedRowsBottom(),w=ue(Se,this).minSpareRows(),v=ue(Se,this).minSpareCols(),R=ue(Se,this).autoWrapRow(),y=ue(Se,this).autoWrapCol(),E=ue(Se,this).createCellCoords(d+i.row,f+i.col);if(E.row>=c){const M=Nt(n&&w>0&&p===0),H=E.col+1,N=ue(Se,this).createCellCoords(E.row-c,H>=u?H-u:H);this.runLocalHooks("beforeColumnWrap",M,Be(Ue,this,wi).call(this,N),H>=u),M.value?this.runLocalHooks("insertRowRequire",ue(Se,this).countRenderableRows()):y&&E.assign(N)}else if(E.row<0){const M=Nt(y),H=E.col-1,N=ue(Se,this).createCellCoords(c+E.row,H<0?u+H:H);this.runLocalHooks("beforeColumnWrap",M,Be(Ue,this,wi).call(this,N),H<0),y&&E.assign(N)}if(E.col>=u){const M=Nt(n&&v>0),H=E.row+1,N=ue(Se,this).createCellCoords(H>=c?H-c:H,E.col-u);this.runLocalHooks("beforeRowWrap",M,Be(Ue,this,wi).call(this,N),H>=c),M.value?this.runLocalHooks("insertColRequire",ue(Se,this).countRenderableColumns()):R&&E.assign(N)}else if(E.col<0){const M=Nt(R),H=E.row-1,N=ue(Se,this).createCellCoords(H<0?c+H:H,u+E.col);this.runLocalHooks("beforeRowWrap",M,Be(Ue,this,wi).call(this,N),H<0),R&&E.assign(N)}const{rowDir:_,colDir:O}=Be(Ue,this,xv).call(this,E);a=_,l=O,o=Be(Ue,this,wi).call(this,E)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,r){const n=ue(Se,this).createCellCoords(e,r),i=ue(Ds,this).current(),o=ue(Se,this).visualToRenderableCoords(i.highlight),s=Be(Ue,this,sh).call(this,i.to.row,i.from.row),a=Be(Ue,this,ah).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:d,col:f}=Be(Ue,this,Pv).call(this,i.highlight),p=ue(Se,this).createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),v=i.getTopEndCorner(),R=i.getBottomEndCorner();if(n.col<0&&a>=f&&p.col<f){const O=p.col-f;p.col=Be(Ue,this,ah).call(this,w.col,v.col)+O}else if(n.col>0&&a<=f&&p.col>f){const O=Be(Ue,this,ah).call(this,v.col,w.col),M=Math.max(p.col-O,1);p.col=O+M}if(n.row<0&&s>=d&&p.row<d){const O=p.row-d;p.row=Be(Ue,this,sh).call(this,w.row,R.row)+O}else if(n.row>0&&s<=d&&p.row>d){const O=Be(Ue,this,sh).call(this,R.row,w.row),M=Math.max(p.row-O,1);p.row=O+M}const{rowDir:y,colDir:E}=Be(Ue,this,xv).call(this,p);u=y,c=E;const _=Be(Ue,this,wi).call(this,p);n.row===0&&n.col!==0?l.col=_.col:n.row!==0&&n.col===0?l.row=_.row:(l.row=_.row,l.col=_.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;Ns(mr,this,{x:r,y:n})}resetOffsetSize(){Ns(mr,this,{x:0,y:0})}}function xv(t){const{width:e,height:r}=Be(Ue,this,DR).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function DR(){return{width:ue(mr,this).x+ue(Se,this).countRenderableColumns(),height:ue(mr,this).y+ue(Se,this).countRenderableRows()}}function sh(t,e){const r=ue(Se,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:ue(mr,this).y+r}function ah(t,e){const r=ue(Se,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ue(mr,this).x+r}function Pv(t){const{row:e,col:r}=ue(Se,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return ue(Se,this).createCellCoords(ue(mr,this).y+e,ue(mr,this).x+r)}function wi(t){const e=t.clone();return e.col=t.col-ue(mr,this).x,e.row=t.row-ue(mr,this).y,ue(Se,this).renderableToVisualCoords(e)}De($h,un);const Ua=0,Ya=1,LR=2,df=3,vN=[df,LR],yN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],lh=Symbol("root"),Av=Symbol("child");function qa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lh;if(e!==lh&&e!==Av)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===lh;let i=Ua;if(r){const o=t[0];t.length===0?i=Ya:n&&o instanceof os?i=df:n&&Array.isArray(o)?i=qa(o,Av):t.length>=2&&t.length<=4&&!t.some((a,l)=>!yN[l].includes(typeof a))&&(i=LR)}return i}function ff(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!vN.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===df;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),wt(u)&&(u=a),wt(c)&&(c=l),!n){const p=a,w=l,v=u,R=c;a=Math.min(p,v),l=Math.min(w,R),u=Math.max(p,v),c=Math.max(w,R)}const d=e(a,l),f=e(u,c);return r(d,d,f)}}function Ak(t){const e=qa(t.getSelected());if(e===Ua||e===Ya)return[];const r=ff(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;X(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;X(Array.from(new Array(c),(d,f)=>u+f),d=>{n.has(d)||n.add(d)})});const i=Array.from(n).sort((s,a)=>s-a);return ir(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Nk(t){const e=qa(t.getSelected());if(e===Ua||e===Ya)return[];const r=ff(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;X(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;X(Array.from(new Array(c),(d,f)=>u+f),d=>{n.has(d)||n.add(d)})});const i=Array.from(n).sort((s,a)=>s-a);return ir(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function vi(t,e,r){bN(t,e),e.set(t,r)}function bN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(t,e,r){return(e=SN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SN(t){var e=CN(t,"string");return typeof e=="symbol"?e:e+""}function CN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Te(t,e){return t.get(kR(t,e))}function Ir(t,e,r){return t.set(kR(t,e),r),r}function kR(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var lt=new WeakMap,Fn=new WeakMap,Ls=new WeakMap,vo=new WeakMap,ks=new WeakMap,yo=new WeakMap;class FR{constructor(e,r){var n=this;kn(this,"settings",void 0),kn(this,"tableProps",void 0),kn(this,"inProgress",!1),kn(this,"selectedRange",new pN((i,o,s)=>this.tableProps.createCellRange(i,o,s))),kn(this,"highlight",void 0),vi(this,lt,void 0),vi(this,Fn,void 0),kn(this,"selectedByRowHeader",new Set),kn(this,"selectedByColumnHeader",new Set),vi(this,Ls,!1),vi(this,vo,!1),vi(this,ks,"unknown"),vi(this,yo,-1),this.settings=e,this.tableProps=r,this.highlight=new fN({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Db()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Ir(lt,this,new $h(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ir(Fn,this,new $h(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Te(lt,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Te(lt,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Te(lt,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Te(lt,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Te(lt,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Te(lt,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Te(lt,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Te(lt,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Te(Fn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Te(Fn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Ir(ks,this,e)}markEndSource(){Ir(ks,this,"unknown")}getSelectionSource(){return Te(ks,this)}setExpectedLayers(e){Ir(yo,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ir(yo,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=wt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();Ir(Ls,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&wt(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(r),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Te(yo,this)===-1||this.selectedRange.size()===Te(yo,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(X(this.highlight.getAreas(),w=>void w.clear()),X(this.highlight.getLayeredAreas(),w=>void w.clear()),X(this.highlight.getRowHeaders(),w=>void w.clear()),X(this.highlight.getColumnHeaders(),w=>void w.clear()),X(this.highlight.getActiveRowHeaders(),w=>void w.clear()),X(this.highlight.getActiveColumnHeaders(),w=>void w.clear()),X(this.highlight.getActiveCornerHeaders(),w=>void w.clear()),X(this.highlight.getRowHighlights(),w=>void w.clear()),X(this.highlight.getColumnHighlights(),w=>void w.clear())),this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),d.clear(),f.clear(),p.clear(),this.highlight.isEnabledFor(Xd,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(LS,e.highlight)){if(!e.isSingleHeader()){const R=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),E=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),_=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(R).commit(),l.add(E).commit(),f.add(R).commit(),p.add(E).commit()):(a.add(R).add(y).commit(),l.add(E).add(_).commit(),f.add(R).add(y).commit(),p.add(E).add(_).commit())}const w=!Te(vo,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Te(vo,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&v&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(da,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(Ir(Ls,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Te(lt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Te(lt,this).resetOffsetSize(),this.setRangeStart(Te(lt,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Te(lt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Te(lt,this).resetOffsetSize(),this.setRangeEnd(Te(lt,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Te(Fn,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Te(Fn,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Te(Fn,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,d=u?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(Ae(i.row+d,c,a-1),i.col),p=this.tableProps.createCellCoords(Ae(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(Ae(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,d=l?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(i.row,Ae(i.col+d,c,a-1)),p=this.tableProps.createCellCoords(o.row,Ae(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(s.row,Ae(s.col+r,0,a-1))):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Nt(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Te(Ls,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:p}=i;Ir(vo,this,p),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(d=this.tableProps.createCellCoords(Ae(f.row,u,o-1),Ae(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),Ir(vo,this,!1)}selectCells(e){var r=this;const n=qa(e);if(n===Ya)return!1;if(n===Ua)throw new Error(Bt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ff(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),X(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){let p=0,w=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(p=Ae(n.row,u,s-1),w=Ae(n.col,Math.min(i,o),Math.max(i,o))):(p=Ae(n,u,s-1),w=i);const v=this.tableProps.createCellCoords(p,w),R=l===0?0:Ae(v.row,u,-1),y=s-1,E=this.tableProps.createCellCoords(R,i),_=this.tableProps.createCellCoords(y,o);this.runLocalHooks("beforeSelectColumns",E,_,v),E.row=R,_.row=y,this.setRangeStartOnly(E,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.runLocalHooks("afterSelectColumns",E,_,v),this.finish()}return f}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let d=0,f=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(d=Ae(n.row,Math.min(e,r),Math.max(e,r)),f=Ae(n.col,a,o-1)):(d=e,f=Ae(n,a,o-1));const p=this.tableProps.createCellCoords(d,f),w=s===0?0:Ae(p.col,a,-1),v=o-1,R=this.tableProps.createCellCoords(e,w),y=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",R,y,p),R.col=w,y.col=v,this.setRangeStartOnly(R,void 0,p),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",R,y,p),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=n;this.clear(),s.assign({row:Ae(s.row,-1/0,e-1),col:Ae(s.col,-1/0,r-1)}),i.assign({row:Ae(i.row,-1/0,e-1),col:Ae(i.col,-1/0,r-1)}),o.assign({row:Ae(o.row,0,e-1),col:Ae(o.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(s).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(da,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),p.commit()}this.highlight.useLayerLevel(r)}}De(FR,un);const Nv=/^(\r\n|\n\r|\r|\n)/,RN=/^[^\t\r\n]+/,Dv=/^\t/;function Dk(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(Dv))t=t.replace(Dv,""),r+=1,e[n][r]="";else if(t.match(Nv))t=t.replace(Nv,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(RN);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Lv(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Vn(t,e,r){return(e=TN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TN(t){var e=EN(t,"string");return typeof e=="symbol"?e:e+""}function EN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ci{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Vn(this,"hot",void 0),Vn(this,"metaManager",void 0),Vn(this,"tableMeta",void 0),Vn(this,"dataSource",void 0),Vn(this,"duckSchema",void 0),Vn(this,"colToPropCache",void 0),Vn(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=Wa(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(vr(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return af(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ce(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&oe(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(oe(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Pi(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=nn(this.getSchema()):(w=[],Wt(d-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},Dd(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",p,a,n),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let f=this.hot.countCols(),p=0,w=c;i==="end"&&(w=Math.min(w+1,a));const v=w;for(;p<r&&f<s;){if(typeof l!="number"||l>=f)if(d>0)for(let y=0;y<d;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<d;y++)o[y].splice(w,0,null);p+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,p),p>0&&(e==null?this.metaManager.createColumn(null,p):n!=="auto"&&this.metaManager.createColumn(v,r));const R=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",R,p,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=oe(this.tableMeta.columns)||oe(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((d,f)=>f-d);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,f=this.hot.countSourceRows();d<f;d++)c[d].splice(o[0],r),d===0&&this.metaManager.removeColumn(o[0],r);else for(let d=0,f=this.hot.countSourceRows();d<f;d++)for(let p=0;p<u;p++)c[d].splice(s[p],1),d===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Ch(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return Eb(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Ch(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&On(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,d=u.length;c<d;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=Nt(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Nt(o);this.hot.runHooks("modifyData",i,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&On(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,d;const f=r.split(".");for(c=0,d=f.length-1;c<d;c++){if(f[c]==="__proto__"||f[c]==="constructor"||f[c]==="prototype")return;typeof u[f[c]]>"u"&&(u[f[c]]={}),u=u[f[c]]}u[f[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Ci.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Ci.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=d;o++){a=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=f&&p!==null;s++)a.push(c.call(this,o,this.colToProp(s)));p!==null&&i.push(a)}return i}getText(e,r){return Lv(this.getRange(e,r,Ci.DESTINATION_RENDERER))}getCopyableText(e,r){return Lv(this.getRange(e,r,Ci.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:ON,getItem:_N,hasItem:MN,getNames:Lk,getValues:kk}=zi("cellTypes");function IN(t){if(!MN(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return _N(t)}function HN(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&vS(t,r),n&&UH(t,n),i&&XH(t,i),ON(t,e)}function xN(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!On(e,t)}function Ga(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?IN(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ce(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!vr(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ce(n,(o,s)=>{if(xN(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Yn(t,i)}function PN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}rS(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Js(t){return Number.isInteger(t)&&t>=0}function ea(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Fs(t){return t==null}const VR=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),En(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),En(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),Ld(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function kv(t,e,r){return(e=AN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AN(t){var e=NN(t,"string");return typeof e=="symbol"?e:e+""}function NN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DN(){return class{}}class LN{constructor(e){kv(this,"metaCtor",DN()),kv(this,"meta",void 0),this.meta=this.metaCtor.prototype,Yn(this.meta,VR()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Yn(this.meta,e),Ga(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function kN(t,e,r){return(e=FN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FN(t){var e=VN(t,"string");return typeof e=="symbol"?e:e+""}function VN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WN{constructor(e){kN(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Yn(this.meta,e),Ga(this.meta,e,e)}}function Vs(t,e,r){return(e=BN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BN(t){var e=$N(t,"string");return typeof e=="symbol"?e:e+""}function $N(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ga{constructor(e){Vs(this,"valueFactory",void 0),Vs(this,"data",[]),Vs(this,"index",[]),Vs(this,"holes",new Set),this.valueFactory=e}obtain(e){ea(()=>Js(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ea(()=>Js(e)||Fs(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Fs(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ea(()=>Js(e)||Fs(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Fs(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Fv(t,e,r){return(e=jN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jN(t){var e=zN(t,"string");return typeof e=="symbol"?e:e+""}function zN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UN=["data","width"];class YN{constructor(e){Fv(this,"globalMeta",void 0),Fv(this,"metas",new ga(()=>this._createMeta())),this.globalMeta=e,this.metas=new ga(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Yn(n,r),Ga(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return PN(this.globalMeta.getMetaConstructor(),UN).prototype}}function Vv(t,e,r){return(e=qN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qN(t){var e=GN(t,"string");return typeof e=="symbol"?e:e+""}function GN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KN{constructor(e){Vv(this,"columnMeta",void 0),Vv(this,"metas",new ga(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Yn(i,n),Ga(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)oe(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){ea(()=>Js(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ga(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class WR{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new LN(e),this.tableMeta=new WN(this.globalMeta),this.columnMeta=new YN(this.globalMeta),this.cellMeta=new KN(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:o}=n;const s=this.cellMeta.getMeta(e,r);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=r,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}De(WR,un);function Wv(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,d=es(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":_e(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const p=new Ci(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=p.getSchema();t=[];let v,R=0,y=0;for(R=0,y=f.startRows;R<y;R++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)v=nn(w),t.push(v);else if(i.dataType==="array")v=nn(w[0]),t.push(v);else{v=[];for(let E=0,_=f.startCols;E<_;E++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),r(p),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[Ab(-1),Da(i.countCols()+(i.view?i.countRowHeaders():0))])}function Bv(t,e,r){return(e=XN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XN(t){var e=ZN(t,"string");return typeof e=="symbol"?e:e+""}function ZN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QN{constructor(e){Bv(this,"metaManager",void 0),Bv(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),ht.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=On(e,"type")?e.type:null;let c=_e(e.cells)?e.cells(n,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function JN(t,e,r){eD(t,e),e.set(t,r)}function eD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uh(t,e,r){return(e=tD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tD(t){var e=rD(t,"string");return typeof e=="symbol"?e:e+""}function rD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nD(t,e){return t.get(iD(t,e))}function iD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $v=new WeakMap;class oD{constructor(e){uh(this,"metaManager",void 0),uh(this,"usageTracker",new Set),uh(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),JN(this,$v,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,nD($v,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const BR="gridDefault",$R="editorManager.handlingEditor",sD={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},aD="hooksRefRegisterer",jR={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){X(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ce(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};an(jR,"MIXIN_NAME",aD,{writable:!1,enumerable:!1});function ur(t,e,r){return(e=lD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lD(t){var e=uD(t,"string");return typeof e=="symbol"?e:e+""}function uD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cD="base",$e=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class gf{static get EDITOR_TYPE(){return cD}constructor(e){ur(this,"hot",void 0),ur(this,"state",$e.VIRGIN),ur(this,"_opened",!1),ur(this,"_fullEditMode",!1),ur(this,"_closeCallback",null),ur(this,"TD",null),ur(this,"row",null),ur(this,"col",null),ur(this,"prop",null),ur(this,"originalValue",null),ur(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:$e.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==$e.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=$e.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Na(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===$e.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===$e.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=$e.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=$e.FINISHED,this.discardEditor(s)}):(this.state=$e.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=$e.FINISHED,this.discardEditor()}discardEditor(e){this.state===$e.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=$e.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=$e.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===$e.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Vt(r),a=vt(r),l=Vt(this.hot.rootElement),u=vt(this.hot.rootElement),c=n.topOverlay.holder,d=n.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,p=d!==o?d.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,R=v.name,y=["master","inline_start"].includes(R)?f:0,E=["master","top","bottom"].includes(R)?p:0,_=s.top===l.top?0:1;let O=s.top-l.top-_-y,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-w-1+E:M=s.left-l.left-1-E,["top","top_inline_start_corner"].includes(R)&&(O+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(R)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),N=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),L=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),K=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&N<=0||N===K)&&(O+=1),L<=0&&(M+=1);const j=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),q=n.topOverlay.getScrollPosition(),Z=yt(this.hot.rootDocument);let Ke=r.offsetTop;if(["inline_start","master"].includes(R)&&(Ke+=j-q),["bottom","bottom_inline_start_corner"].includes(R)){const{wtViewport:x,wtTable:B}=n.bottomOverlay.clone;Ke+=x.getWorkspaceHeight()-B.getHeight()-Z}let le=r.offsetLeft;this.hot.isRtl()?(le>=0?le=v.getWidth()-r.offsetLeft:le=Math.abs(le),le+=J-ae-a):["top","master","bottom"].includes(R)&&(le+=J-ae);const ge=o.getComputedStyle(this.TD),Xe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",or=parseInt(ge[Xe],10)>0?0:1,h=parseInt(ge.borderTopWidth,10)>0?0:1,g=vt(r)+or,m=Dt(r)+h,b=Gb(c)?Z:0,C=Kb(d)?Z:0,T=this.hot.view.maximumVisibleElementWidth(le)-b+or,I=Math.max(this.hot.view.maximumVisibleElementHeight(Ke)-C+h,this.hot.view.getDefaultRowHeight());return{top:O,start:M,height:m,maxHeight:I,width:g,maxWidth:T}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}De(gf,jR);const hD={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===$e.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},dD={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},fD={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},gD={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},mD={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),is(e))}};function pD(){return[sD,hD,dD,fD,gD,mD]}const wD={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},vD={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(n!==null){const i=t._createCellCoords(n,e.col),o=e.row-t.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},yD={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},bD={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},SD={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,n.col,e)}},CD={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},RD={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}},TD={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},ED={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},OD={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},_D={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},MD={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,n.row,e)}},ID={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},HD={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(n!==null){const i=t._createCellCoords(n,e.col),o=e.row-t.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function xD(){return[wD,vD,yD,bD,SD,CD,RD,TD,ED,OD,_D,MD,ID,HD]}const PD={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},AD={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;i=i===0?1:i,n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},ND={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},DD={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},LD={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},kD={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},FD={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},VD={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},WD={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},BD={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,o))}},$D={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},jD={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},zD={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},UD={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},YD={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},qD={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;i=i===0?-1:-i,n===-r?i=-1:n+i<r&&(i=-(n+r)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function GD(){return[PD,AD,ND,DD,LD,kD,FD,VD,WD,BD,$D,jD,zD,UD,YD,qD]}const KD={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},XD={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},ZD={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},QD={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},JD={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},eL=[...pD(),...xD(),...GD(),KD,XD,ZD,QD,JD];function zR(t){const e={};return eL.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function tL(t){const e=t.getShortcutManager().addContext("editor"),r=zR(t),n={group:$R};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function rL(t){const e=t.getShortcutManager().addContext("grid"),r=zR(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return oe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:BR};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:$R,runOnlyIf:()=>oe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function nL(t){[rL,tL].forEach(e=>e(t))}function iL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=jv(t),i=jv(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function jv(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(r,[Jr(),Pb()]),r}function oL(t){const e=sL(t);let r;const{activate:n,deactivate:i}=iL(t,{onFocusFromTop(){var d;const f=(d=e(r))!==null&&d!==void 0?d:jh(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_above",f),t.selectCell(f.row,f.col)),t.listen()},onFocusFromBottom(){var d;const f=(d=e(r))!==null&&d!==void 0?d:zh(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_below",f),t.selectCell(f.row,f.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(d,f,p,w,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var R;r=(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight}}),t.addHook("beforeRowWrap",(d,f,p)=>{o.wrapped=!0,o.flipped=p});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:BR,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:d}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!d&&(s=!1),d||(l=!0)},position:"before"},{...c,callback:d=>{const{tabNavigation:f,autoWrapRow:p}=t.getSettings();if(a=!1,s=!0,!f||!t.selection.isSelected()||p&&o.wrapped&&o.flipped||!p&&o.wrapped)return p&&o.wrapped&&o.flipped&&(r=d.shiftKey?jh(t):zh(t)),u(),!1;d.preventDefault()},position:"after"}])}function jh(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function zh(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function sL(t){return e=>{if(!e)return null;const r=jh(t),n=zh(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function aL(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function lL(){return()=>{}}function uL(t){return e=>{t.scrollViewportTo(e.toObject())}}function cL(t){return e=>{t.scrollViewportTo(e.toObject())}}function hL(t){return e=>{t.scrollViewportTo(e.toObject())}}function dL(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function fL(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}function gL(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=uL(t):e.isSelectedByCorner()?s=lL():e.isSelectedByRowHeader()?s=dL(t):e.isSelectedByColumnHeader()?s=aL(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=cL(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=fL(t):e.getSelectedRange().size()>1&&(s=hL(t)),(o=s)===null||o===void 0||o(i)}}}const zv=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ws=t=>t.map(e=>{const r=e.toLowerCase();return zv.has(r)?zv.get(r):r}).sort().join("+"),mL=t=>t.split("+"),Uv=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),ch=t=>{let{which:e,key:r}=t;if(Uv.has(e))return Uv.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},UR=Symbol("shortcut-context");function YR(t){return vr(t)&&t.__kindOf===UR}const pL=t=>{const e=Ba({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:p=!0,stopPropagation:w=!1,relativeToGroup:v,position:R,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wt(c))throw new Error("You need to define the shortcut's group.");if(_e(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Bt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:p,stopPropagation:w};oe(v)&&(E.relativeToGroup=v,E.position=R),YR(y)&&(E.forwardToContext=y),l.forEach(_=>{const O=Ws(_);if(e.hasItem(O)){const H=e.getItem(O);let N=H.findIndex(L=>L.group===v);N!==-1?R==="before"?N-=1:N+=1:N=H.length,H.splice(N,0,E)}else e.addItem(O,[E])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ce(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),r(c)})},i=l=>{const u=Ws(l);e.removeItem(u)};return{__kindOf:UR,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=Ws(l),c=e.getItem(u);return oe(c)?c.slice():[]},hasShortcut:l=>{const u=Ws(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,f]=c;const p=f.filter(w=>w.group!==l);p.length===0?i(mL(d)):(f.length=0,f.push(...p))})}}};function wL(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const vL=["meta","alt","shift","control"],bo=wL(),So=[];let Bs=0;function yL(t,e,r,n,i){const o=p=>vL.includes(p),s=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return p.altKey&&v.push("alt"),w&&(p.ctrlKey||p.metaKey)?v.push("control/meta"):(p.ctrlKey&&v.push("control"),p.metaKey&&v.push("meta")),p.shiftKey&&v.push("shift"),v},a=p=>{if(e(p)===!1||r(p)===!1||p.keyCode===229||typeof p.key!="string"||yn(p))return;const v=ch(p);let R=[];o(v)||(R=s(p));const y=[v].concat(R);!i(p,y)&&(ua()&&R.includes("meta")||!ua()&&R.includes("control"))&&i(p,[v].concat(s(p,!0))),n(p)},l=p=>{if(typeof p.key=="string"){const w=ch(p);o(w)&&bo.press(w)}},u=p=>{if(typeof p.key=="string"){const w=ch(p);o(w)&&bo.release(w)}},c=()=>{bo.releaseAll()};return{mount:()=>{let p=t;for(Bs+=1;p;)Bs===1&&(p.document.documentElement.addEventListener("keydown",l),So.push({event:"keydown",listener:l}),p.document.documentElement.addEventListener("keyup",u),So.push({event:"keyup",listener:u})),p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("blur",c),p=ko(p)},unmount:()=>{let p=t;for(Bs-=1;p;){if(Bs===0){for(let w=0;w<So.length;w++){const{event:v,listener:R}=So[w];p.document.documentElement.removeEventListener(v,R)}So.length=0}p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("blur",c),p=ko(p)}},isPressed:p=>bo.isPressed(p),releasePressedKeys:()=>bo.releaseAll()}}const bL=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Ba({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const v=pL(w);return o.addItem(w,v),v},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(Bt`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let d=!1;const f=function(w,v){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=YR(R)?R:u(R);let E=!1;if(!y.hasShortcut(v))return E;const _=y.getShortcuts(v);for(let O=0;O<_.length;O++){const{callback:M,runOnlyIf:H,preventDefault:N,stopPropagation:L,captureCtrl:G,forwardToContext:K}=_[O];if(H(w)===!0){if(d=G,E=M(w,v)===!1,d=!1,N&&w.preventDefault(),L&&(is(w),w.stopPropagation()),E)break;K&&f(w,v,K)}}return E},p=yL(e,r,n,i,f);return p.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};function Yv(t){const{classNames:e}=Vb(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let hh=null;const dh=new Map;function qR(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ai(o);let a,l,u,c,d,f,p=!0;KA(i)&&GA(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=Q1(e.language);const R=new WR(o,e,[QN,oD]),y=R.getTableMeta(),E=R.getGlobalMeta(),_=Ba();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Qs(this)&&(Ib(e.licenseKey,t),re(t,"ht-wrapper")),this.guid=`ht_${Od()}`,dh.set(this.guid,this),this.columnIndexMapper=new Wh,this.rowIndexMapper=new Wh,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterRowSequenceChange",h)}),l=new f1(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const O=h=>{const{row:g,col:m}=h;return o._createCellCoords(g>=0?o.rowIndexMapper.getRenderableFromVisualIndex(g):g,m>=0?o.columnIndexMapper.getRenderableFromVisualIndex(m):m)},M=h=>{const{row:g,col:m}=h;return o._createCellCoords(g>=0?o.rowIndexMapper.getVisualFromRenderableIndex(g):g,m>=0?o.columnIndexMapper.getVisualFromRenderableIndex(m):m)},H=(h,g)=>{const m=g>h?1:-1,b=Math.min(h,g),C=Math.max(h,g),T=o.rowIndexMapper.getNearestNotHiddenIndex(h,m);return T===null||m===1&&T>C||m===-1&&T<b?null:T>=0?o.rowIndexMapper.getRenderableFromVisualIndex(T):T},N=(h,g)=>{const m=g>h?1:-1,b=Math.min(h,g),C=Math.max(h,g),T=o.columnIndexMapper.getNearestNotHiddenIndex(h,m);return T===null||m===1&&T>C||m===-1&&T<b?null:T>=0?o.columnIndexMapper.getRenderableFromVisualIndex(T):T};let L=new FR(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:h=>a.propToCol(h),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(h,g)=>o._createCellCoords(h,g),createCellRange:(h,g,m)=>o._createCellRange(h,g,m),visualToRenderableCoords:O,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:N,isDisabledCellSelection:(h,g)=>h<0||g<0?o.getSettings().disableVisualSelection:o.getCellMeta(h,g).disableVisualSelection});this.selection=L;const G=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(h,g)=>{const m=Nt(!1),b=this.selection.getSelectedRange(),{from:C,to:T}=b.current(),I=b.size()-1;this.runHooks("afterSelection",C.row,C.col,T.row,T.col,m,I),this.runHooks("afterSelectionByProp",C.row,o.colToProp(C.col),T.row,o.colToProp(T.col),m,I),g&&(!m.isTouched()||m.isTouched()&&!m.value)&&f.scrollTo(h);const x=L.isSelectedByRowHeader(),B=L.isSelectedByColumnHeader();x&&B?re(this.rootElement,["ht__selection--rows","ht__selection--columns"]):x?(ye(this.rootElement,"ht__selection--columns"),re(this.rootElement,"ht__selection--rows")):B?(ye(this.rootElement,"ht__selection--rows"),re(this.rootElement,"ht__selection--columns")):ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),L.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",h=>{this.runHooks("beforeSelectionFocusSet",h.row,h.col)}),this.selection.addLocalHook("afterSetFocus",h=>{const g=Nt(!1);this.runHooks("afterSelectionFocusSet",h.row,h.col,g),(!g.isTouched()||g.isTouched()&&!g.value)&&f.scrollTo(h),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:m,to:b}=h[g];this.runHooks("afterSelectionEnd",m.row,m.col,b.row,b.col,g),this.runHooks("afterSelectionEndByProp",m.row,o.colToProp(m.col),b.row,o.colToProp(b.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeSetRangeStart",...g)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeSetRangeStartOnly",...g)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeSetRangeEnd",...g)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeSelectColumns",...g)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("afterSelectColumns",...g)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeSelectRows",...g)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("afterSelectRows",...g)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("modifyTransformStart",...g)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("afterModifyTransformStart",...g)}).addLocalHook("beforeModifyTransformFocus",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("modifyTransformFocus",...g)}).addLocalHook("afterModifyTransformFocus",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("afterModifyTransformFocus",...g)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("modifyTransformEnd",...g)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("afterModifyTransformEnd",...g)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeRowWrap",...g)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return n.runHooks("beforeColumnWrap",...g)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),u={alter(h,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,b=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0;const T=I=>{if(I.length===0)return[];const x=[...I];return x.sort((V,P)=>{let[ne]=V,[fe]=P;return ne===fe?0:ne>fe?1:-1}),ir(x,(V,P)=>{let[ne,fe]=P;const me=V[V.length-1],[Ct,et]=me,Re=Ct+et;if(ne<=Re){const Rt=Math.max(fe-(Re-ne),0);me[1]+=Rt}else V.push([ne,fe]);return V},[x[0]])};switch(h){case"insert_row_below":case"insert_row_above":const I=o.countSourceRows();if(y.maxRows===I)return;const x=h==="insert_row_below"?"below":"above";g=g??(x==="below"?I:0);const{delta:B,startPhysicalIndex:V}=a.createRow(g,m,{source:b,mode:x});L.shiftRows(o.toVisualRow(V),B);break;case"insert_col_start":case"insert_col_end":const P=h==="insert_col_end"?"end":"start";g=g??(P==="end"?o.countSourceCols():0);const{delta:ne,startPhysicalIndex:fe}=a.createCol(g,m,{source:b,mode:P});if(ne){if(Array.isArray(y.colHeaders)){const et=[o.toVisualColumn(fe),0];et.length+=ne,Array.prototype.splice.apply(y.colHeaders,et)}L.shiftColumns(o.toVisualColumn(fe),ne)}break;case"remove_row":const me=et=>{let Re=0;X(et,Rt=>{let[ve,ze]=Rt;const Tt=En(ve)?o.countRows()-1:Math.max(ve-Re,0);if(Number.isInteger(ve)&&(ve=Math.max(ve-Re,0)),!a.removeRow(ve,ze,b))return;if(L.isSelected()){const{row:ot}=o.getSelectedRangeLast().highlight;ot>=ve&&ot<=ve+ze-1&&c.closeEditor(!0)}const Cr=o.countRows();Cr===0?L.deselect():b==="ContextMenu.removeRow"?L.refresh():L.shiftRows(ve,-ze);const ft=y.fixedRowsTop;ft>=Tt+1&&(y.fixedRowsTop-=Math.min(ze,ft-Tt));const it=y.fixedRowsBottom;it&&Tt>=Cr-it&&(y.fixedRowsBottom-=Math.min(ze,it)),Re+=ze})};Array.isArray(g)?me(T(g)):me([[g,m]]);break;case"remove_col":const Ct=et=>{let Re=0;X(et,Rt=>{let[ve,ze]=Rt;const Tt=En(ve)?o.countCols()-1:Math.max(ve-Re,0);let Fr=o.toPhysicalColumn(Tt);if(Number.isInteger(ve)&&(ve=Math.max(ve-Re,0)),!a.removeCol(ve,ze,b))return;if(L.isSelected()){const{col:ot}=o.getSelectedRangeLast().highlight;ot>=ve&&ot<=ve+ze-1&&c.closeEditor(!0)}o.countCols()===0?L.deselect():b==="ContextMenu.removeColumn"?L.refresh():L.shiftColumns(ve,-ze);const it=y.fixedColumnsStart;it>=Tt+1&&(y.fixedColumnsStart-=Math.min(ze,it-Tt)),Array.isArray(y.colHeaders)&&(typeof Fr>"u"&&(Fr=-1),y.colHeaders.splice(Fr,ze)),Re+=ze})};Array.isArray(g)?Ct(T(g)):Ct([[g,m]]);break;default:throw new Error(`There is no such action "${h}"`)}C||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const h=y.minRows,g=y.minSpareRows,m=y.minCols,b=y.minSpareCols;if(h){const C=o.countRows();C<h&&a.createRow(C,h-C,{source:"auto"})}if(g){const C=o.countEmptyRows(!0);if(C<g){const T=g-C,I=Math.min(T,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),I,{source:"auto"})}}{let C;(m||b)&&(C=o.countEmptyCols(!0));let T=o.countCols();if(m&&!y.columns&&T<m){const I=m-T;C+=I,a.createCol(T,I,{source:"auto"})}if(b&&!y.columns&&o.dataType==="array"&&C<b){T=o.countCols();const I=b-C,x=Math.min(I,y.maxCols-T);a.createCol(T,x,{source:"auto"})}}},populateFromArray(h,g,m,b,C){let T,I,x,B;const V=[],P={},ne=[],fe=h.row,me=h.col;if(I=g.length,I===0)return!1;let Ct=0,et=0;switch(vr(m)&&(Ct=m.col-me+1,et=m.row-fe+1),C){case"shift_down":const Re=Gs(g),Rt=Re.length,ve=Math.max(Rt,Ct),ze=o.getData().slice(fe),Tt=Gs(ze).slice(me,me+ve);for(x=0;x<ve;x+=1)if(x<Rt){for(T=0,I=Re[x].length;T<et-I;T+=1)Re[x].push(Re[x][T%I]);x<Tt.length?ne.push(Re[x].concat(Tt[x])):ne.push(Re[x].concat(new Array(ze.length).fill(null)))}else ne.push(Re[x%Rt].concat(Tt[x]));o.populateFromArray(fe,me,Gs(ne));break;case"shift_right":const Fr=g.length,Cr=Math.max(Fr,et),ft=o.getData().slice(fe).map(Et=>Et.slice(me));for(T=0;T<Cr;T+=1)if(T<Fr){for(x=0,B=g[T].length;x<Ct-B;x+=1)g[T].push(g[T][x%B]);if(T<ft.length)for(let Et=0;Et<ft[T].length;Et+=1)g[T].push(ft[T][Et]);else g[T].push(...new Array(ft[0].length).fill(null))}else g.push(g[T%I].slice(0,Cr).concat(ft[T]));o.populateFromArray(fe,me,g);break;case"overwrite":default:P.row=h.row,P.col=h.col;let it=0,ot=0,hn=!0,dn;const Yi=function(Vr){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ut=g[Vr%g.length];return st!==null?Ut[st%Ut.length]:Ut},ii=g.length,oi=m?m.row-h.row+1:0;for(m?I=oi:I=Math.max(ii,oi),T=0;T<I&&!(m&&P.row>m.row&&oi>ii||!y.allowInsertRow&&P.row>o.countRows()-1||P.row>=y.maxRows);T++){const Et=T-it,Vr=Yi(Et).length,st=m?m.col-h.col+1:0;if(m?B=st:B=Math.max(Vr,st),P.col=h.col,dn=o.getCellMeta(P.row,P.col),(b==="CopyPaste.paste"||b==="Autofill.fill")&&dn.skipRowOnPaste){it+=1,P.row+=1,I+=1;continue}for(ot=0,x=0;x<B&&!(m&&P.col>m.col&&st>Vr||!y.allowInsertColumn&&P.col>o.countCols()-1||P.col>=y.maxCols);x++){if(dn=o.getCellMeta(P.row,P.col),(b==="CopyPaste.paste"||b==="Autofill.fill")&&dn.skipColumnOnPaste){ot+=1,P.col+=1,B+=1;continue}if(dn.readOnly&&b!=="UndoRedo.undo"){P.col+=1;continue}const Ut=x-ot;let Ot=Yi(Et,Ut),_t=o.getDataAtCell(P.row,P.col);if(Ot!==null&&typeof Ot=="object")if(Array.isArray(Ot)&&_t===null&&(_t=[]),_t===null||typeof _t!="object")hn=!1;else{const us=Pi(Array.isArray(_t)?_t:_t[0]||_t),Hn=Pi(Array.isArray(Ot)?Ot:Ot[0]||Ot);Ld(us,Hn)||Array.isArray(us)&&Array.isArray(Hn)?Ot=nn(Ot):hn=!1}else _t!==null&&typeof _t=="object"&&(hn=!1);hn&&V.push([P.row,P.col,Ot]),hn=!0,P.col+=1}P.row+=1}o.setDataAtCell(V,null,null,b||"populateFromArray");break}}};function K(h){const g=rC(h);hf(g)?(o.runHooks("beforeLanguageChange",g),E.language=g,o.runHooks("afterLanguageChange",g)):nC(h)}function j(h,g){const m=h==="className"?o.rootElement:o.table;if(p)re(m,g);else{let b=[],C=[];E[h]&&(b=Array.isArray(E[h])?E[h]:Th(E[h])),g&&(C=Array.isArray(g)?g:Th(g));const T=Rh(b,C),I=Rh(C,b);T.length&&ye(m,T),I.length&&re(m,I)}E[h]=g}this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(zn()||dS())&&re(o.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new JA(this);const h=y.themeName||Yv(o.rootElement);o.useTheme(h),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=xh.getInstance(o,y,L),f=gL(o),d=new mH(o),Qs(this)&&oL(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&o.rootElement.offsetParent===null&&Xb(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof p=="object"&&(o.runHooks("afterChange",p[0],p[1]),p=!1),o.runHooks("afterInit")};function J(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function ae(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function q(h,g,m){if(!h.length){m();return}const b=o.getActiveEditor(),C=new J;let T=!0;C.onQueueEmpty=()=>{b&&T&&b.cancelChanges(),m()};for(let I=h.length-1;I>=0;I--){const[x,B]=h[I],V=a.propToCol(B);let P;Number.isInteger(V)?P=o.getCellMeta(x,V):P={...Object.getPrototypeOf(y),...y},o.getCellValidator(P)&&(C.addValidatorToQueue(),o.validateCell(h[I][3],P,function(ne,fe){return function(me){if(typeof me!="boolean")throw new Error("Validation error: result is not boolean");me===!1&&fe.allowInvalid===!1&&(T=!1,h.splice(ne,1),fe.valid=!0),C.removeValidatorFormQueue()}}(I,P),g))}C.checkIfQueueIsEmpty()}function Z(h,g){for(let b=h.length-1;b>=0;b--){let C=!1;if(h[b]===null){h.splice(b,1);continue}if(!((h[b][2]===null||h[b][2]===void 0)&&(h[b][3]===null||h[b][3]===void 0))){if(y.allowInsertRow)for(;h[b][0]>o.countRows()-1;){const{delta:T}=a.createRow(void 0,void 0,{source:"auto"});if(T===0){C=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(h[b][1])>o.countCols()-1;){const{delta:T}=a.createCol(void 0,void 0,{source:"auto"});if(T===0){C=!0;break}}C||a.set(h[b][0],h[b][1],h[b][3])}}const m=h.length>0;if(o.forceFullRender=!0,m){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",h,g),c.closeEditor(),o.view.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",h,g||"edit");const b=o.getActiveEditor();b&&oe(b.refreshValue)&&b.refreshValue()}else o.view.render()}this._createCellCoords=function(h,g){return o.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,m){return o.view._wt.createCellRange(h,g,m)},this.validateCell=function(h,g,m,b){let C=o.getCellValidator(g);function T(I){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){m(I);return}const B=g.visualCol,V=g.visualRow,P=o.getCell(V,B,!0);if(P&&P.nodeName!=="TH"){const ne=o.rowIndexMapper.getRenderableFromVisualIndex(V),fe=o.columnIndexMapper.getRenderableFromVisualIndex(B);o.view._wt.getSetting("cellRenderer",ne,fe,P)}m(I)}Mb(C)&&(C=function(I){return function(x,B){B(I.test(x))}}(C)),_e(C)?(h=o.runHooks("beforeValidate",h,g.visualRow,g.prop,b),o._registerImmediate(()=>{C.call(g,h,I=>{o&&(I=o.runHooks("afterValidate",I,h,g.visualRow,g.prop,b),g.valid=I,T(I),o.runHooks("postAfterValidate",I,h,g.visualRow,g.prop,b))})})):o._registerImmediate(()=>{g.valid=!0,T(g.valid,!1)})};function Ke(h,g,m){return Array.isArray(h)?h:[[h,g,m]]}function le(h,g){const m=o.runHooks("beforeChange",h,g||"edit"),b=h.filter(T=>T!==null);if(m===!1||b.length===0){var C;return(C=o.getActiveEditor())===null||C===void 0||C.cancelChanges(),[]}for(let T=b.length-1;T>=0;T--){const[I,x,,B]=b[T],V=a.propToCol(x);let P;Number.isInteger(V)?P=o.getCellMeta(I,V):P={...Object.getPrototypeOf(y),...y},P.type==="numeric"&&typeof B=="string"&&SS(B)&&(b[T][3]=ae(B))}return b}this.setDataAtCell=function(h,g,m,b){const C=Ke(h,g,m),T=[];let I=b,x,B,V;for(x=0,B=C.length;x<B;x++){if(typeof C[x]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof C[x][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");C[x][1]>=this.countCols()?V=C[x][1]:V=a.colToProp(C[x][1]),T.push([C[x][0],V,l.getAtCell(this.toPhysicalRow(C[x][0]),C[x][1]),C[x][2]])}!I&&typeof h=="object"&&(I=g);const P=le(T,I);o.runHooks("afterSetDataAtCell",P,I),q(P,I,()=>{Z(P,I)})},this.setDataAtRowProp=function(h,g,m,b){const C=Ke(h,g,m),T=[];let I=b,x,B;for(x=0,B=C.length;x<B;x++)T.push([C[x][0],C[x][1],l.getAtCell(this.toPhysicalRow(C[x][0]),C[x][1]),C[x][2]]);!I&&typeof h=="object"&&(I=g);const V=le(T,b);o.runHooks("afterSetDataAtRowProp",V,I),q(V,I,()=>{Z(V,I)})},this.listen=function(){o&&!o.isListening()&&(dh.forEach(h=>{o!==h&&h.unlisten()}),hh=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(hh=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return hh===o.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(h),o.view.render(),g&&L.isSelected()&&c.prepareEditor()},this.populateFromArray=function(h,g,m,b,C,T,I){if(!(typeof m=="object"&&typeof m[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const x=typeof b=="number"?o._createCellCoords(b,C):null;return u.populateFromArray(o._createCellCoords(h,g),m,x,T,I)},this.spliceCol=function(h,g,m){for(var b=arguments.length,C=new Array(b>3?b-3:0),T=3;T<b;T++)C[T-3]=arguments[T];return a.spliceCol(h,g,m,...C)},this.spliceRow=function(h,g,m){for(var b=arguments.length,C=new Array(b>3?b-3:0),T=3;T<b;T++)C[T-3]=arguments[T];return a.spliceRow(h,g,m,...C)},this.getSelected=function(){if(L.isSelected())return Tn(L.getSelectedRange(),h=>{let{from:g,to:m}=h;return[g.row,g.col,m.row,m.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];X(L.getSelectedRange(),m=>{if(m.isSingleHeader())return;const b=m.getTopStartCorner(),C=m.getBottomEndCorner();Wt(b.row,C.row,T=>{Wt(b.col,C.col,I=>{this.getCellMeta(T,I).readOnly||g.push([T,I,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const m=h();return this.resumeExecution(g),m},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!o.view)return;const h=o.view,{width:g,height:m}=h.getLastSize(),{width:b,height:C}=o.rootElement.getBoundingClientRect(),T=b!==g||C!==m;o.runHooks("beforeRefreshDimensions",{width:g,height:m},{width:b,height:C},T)!==!1&&((T||h._wt.wtOverlays.scrollableElement===o.rootWindow)&&(h.setLastSize(b,C),o.render(),h.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:g,height:m},{width:b,height:C},T))},this.updateData=function(h,g){Wv(h,m=>{a=m},m=>{a=m,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),L.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:g,metaManager:R,firstRun:p})},this.loadData=function(h,g){Wv(h,m=>{a=m},()=>{R.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),L.refresh(),p&&(p=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:g,metaManager:R,firstRun:p})},this.getInitialColumnCount=function(){const h=y.columns;let g=0;if(Array.isArray(h))g=h.length;else if(_e(h))if(o.dataType==="array"){const m=this.countSourceCols();for(let b=0;b<m;b+=1)h(b)&&(g+=1)}else(o.dataType==="object"||o.dataType==="function")&&(g=a.colToPropCache.length);else if(oe(y.dataSchema)){const m=a.getSchema();g=Array.isArray(m)?m.length:Wa(m)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,m,b){return wt(h)?a.getAll():a.getRange(o._createCellCoords(h,g),o._createCellCoords(m,b),a.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,m,b){return a.getCopyableText(o._createCellCoords(h,g),o._createCellCoords(m,b))},this.getCopyableData=function(h,g){return a.getCopyable(h,a.colToProp(g))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=(p?o.loadData:o.updateData).bind(this);let b=!1,C,T;if(oe(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(oe(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(oe(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(C in h)C==="data"||(C==="language"?K(h.language):C==="className"?j("className",h.className):C==="tableClassName"&&o.table?(j("tableClassName",h.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):ht.getSingleton().isRegistered(C)||ht.getSingleton().isDeprecated(C)?_e(h[C])?ht.getSingleton().addAsFixed(C,h[C],o):Array.isArray(h[C])&&ht.getSingleton().add(C,h[C],o):!g&&On(h,C)&&(E[C]=h[C]));h.data===void 0&&y.data===void 0?m(null,"updateSettings"):h.data!==void 0?m(h.data,"updateSettings"):h.columns!==void 0&&(a.createMap(),o.initIndexMappers());const I=o.countCols(),x=y.columns;if(x&&_e(x)&&(b=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&R.clearCache(),I>0)for(C=0,T=0;C<I;C++){if(x){const P=b?x(C):x[T];P&&R.updateColumnMeta(T,P)}T+=1}oe(h.cell)&&Ce(h.cell,P=>{o.setCellMetaObject(P.row,P.col,P)}),o.runHooks("afterCellMetaReset");let B=o.rootElement.style.height;B!==""&&(B=parseInt(o.rootElement.style.height,10));let V=h.height;if(_e(V)&&(V=V()),g&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),V===null){const P=o.rootElement.getAttribute("data-initialstyle");P&&(P.indexOf("height")>-1||P.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",P):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else V!==void 0&&(o.rootElement.style.height=isNaN(V)?`${V}`:`${V}px`,o.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let P=h.width;_e(P)&&(P=P()),o.rootElement.style.width=isNaN(P)?`${P}`:`${P}px`}if(!g){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const P=o.getCurrentThemeName(),ne=On(h,"themeName");P&&ne&&P!==h.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(P));const fe=ne&&h.themeName||Yv(o.rootElement);o.useTheme(fe),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",h)}u.adjustRowsAndCols(),o.view&&!p&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!g&&o.view&&(B===""||V===""||V===void 0)&&B!==V&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=o.getSelectedLast();if(y.getValue){if(_e(y.getValue))return y.getValue.call(o);if(h)return o.getData()[h[0][0]][y.getValue]}else if(h)return o.getDataAtCell(h[0],h[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,m,b,C){u.alter(h,g,m,b,C)},this.getCell=function(h,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,b=g,C=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;b=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;C=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return C===null||b===null||C===void 0||b===void 0?null:o.view.getCellAtCoords(o._createCellCoords(C,b),m)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:m,col:b}=g;let C=m,T=b;return m>=0&&(C=this.rowIndexMapper.getVisualFromRenderableIndex(m)),b>=0&&(T=this.columnIndexMapper.getVisualFromRenderableIndex(b)),o._createCellCoords(C,T)},this.colToProp=function(h){return a.colToProp(h)},this.propToCol=function(h){return a.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return a.get(h,a.colToProp(g))},this.getDataAtRowProp=function(h,g){return a.get(h,g)},this.getDataAtCol=function(h){const g=[],m=a.getRange(o._createCellCoords(0,h),o._createCellCoords(y.data.length-1,h),a.DESTINATION_RENDERER);for(let b=0;b<m.length;b+=1)for(let C=0;C<m[b].length;C+=1)g.push(m[b][C]);return g},this.getDataAtProp=function(h){const g=[],m=a.getRange(o._createCellCoords(0,a.propToCol(h)),o._createCellCoords(y.data.length-1,a.propToCol(h)),a.DESTINATION_RENDERER);for(let b=0;b<m.length;b+=1)for(let C=0;C<m[b].length;C+=1)g.push(m[b][C]);return g},this.getSourceData=function(h,g,m,b){let C;return h===void 0?C=l.getData():C=l.getByRange(o._createCellCoords(h,g),o._createCellCoords(m,b)),C},this.getSourceDataArray=function(h,g,m,b){let C;return h===void 0?C=l.getData(!0):C=l.getByRange(o._createCellCoords(h,g),o._createCellCoords(m,b),!0),C},this.getSourceDataAtCol=function(h){return l.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,m,b){const C=Ke(h,g,m),T=this.hasHook("afterSetSourceDataAtCell"),I=[];T&&X(C,B=>{let[V,P,ne]=B;I.push([V,P,l.getAtCell(V,P),ne])}),X(C,B=>{let[V,P,ne]=B;l.setAtCell(V,P,ne)}),T&&this.runHooks("afterSetSourceDataAtCell",I,b),this.render();const x=o.getActiveEditor();x&&oe(x.refreshValue)&&x.refreshValue()},this.getSourceDataAtRow=function(h){return l.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return l.getAtCell(h,g)},this.getDataAtRow=function(h){return a.getRange(o._createCellCoords(h,0),o._createCellCoords(h,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,m,b){const C=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,m,b],[T,I]=C;let[,,x,B]=C,V=null,P=null;x===void 0&&(x=T),B===void 0&&(B=I);let ne="mixed";return Wt(Math.max(Math.min(T,x),0),Math.max(T,x),fe=>{let me=!0;return Wt(Math.max(Math.min(I,B),0),Math.max(I,B),Ct=>(P=this.getCellMeta(fe,Ct).type,V?me=V===P:V=P,me)),ne=me?P:"mixed",me}),ne},this.removeCellMeta=function(h,g,m){const[b,C]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let T=R.getCellMetaKeyValue(b,C,m);o.runHooks("beforeRemoveCellMeta",h,g,m,T)!==!1&&(R.removeCellMeta(b,C,m),o.runHooks("afterRemoveCellMeta",h,g,m,T)),T=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var m=arguments.length,b=new Array(m>2?m-2:0),C=2;C<m;C++)b[C-2]=arguments[C];if(b.length>0&&!Array.isArray(b[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&R.removeRow(this.toPhysicalRow(h),g),b.length>0&&X(b.reverse(),T=>{R.createRow(this.toPhysicalRow(h)),X(T,(I,x)=>this.setCellMetaObject(h,x,I))}),o.render()},this.setCellMetaObject=function(h,g,m){typeof m=="object"&&Ce(m,(b,C)=>{this.setCellMeta(h,g,C,b)})},this.setCellMeta=function(h,g,m,b){if(o.runHooks("beforeSetCellMeta",h,g,m,b)===!1)return;let T=h,I=g;h<this.countRows()&&(T=this.toPhysicalRow(h)),g<this.countCols()&&(I=this.toPhysicalColumn(g)),R.setCellMeta(T,I,m,b),o.runHooks("afterSetCellMeta",h,g,m,b)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(h,g){let m=this.toPhysicalRow(h),b=this.toPhysicalColumn(g);return m===null&&(m=h),b===null&&(b=g),R.getCellMeta(m,b,{visualRow:h,visualColumn:g})},this.getColumnMeta=function(h){return R.getColumnMeta(this.toPhysicalColumn(h))},this.getCellMetaAtRow=function(h){return R.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(h,g){const m=typeof h=="number"?o.getCellMeta(h,g).renderer:h.renderer;return typeof m=="string"?Aw(m):wt(m)?Aw("text"):m},this.getCellEditor=function(h,g){const m=typeof h=="number"?o.getCellMeta(h,g).editor:h.editor;return typeof m=="string"?vw(m):wt(m)?vw("text"):m},this.getCellValidator=function(h,g){const m=typeof h=="number"?o.getCellMeta(h,g).validator:h.validator;return typeof m=="string"?KH(m):m},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,m){const b=new J;h&&(b.onQueueEmpty=h);let C=o.countRows()-1;for(;C>=0;){if(g!==void 0&&g.indexOf(C)===-1){C-=1;continue}let T=o.countCols()-1;for(;T>=0;){if(m!==void 0&&m.indexOf(T)===-1){T-=1;continue}b.addValidatorToQueue(),o.validateCell(o.getDataAtCell(C,T),o.getCellMeta(C,T),I=>{if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(b.valid=!1),b.removeValidatorFormQueue()},"validateCells"),T-=1}C-=1}b.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=y.rowHeaders,m=h;return m!==void 0&&(m=o.runHooks("modifyRowHeader",m)),m===void 0?(g=[],Wt(o.countRows()-1,b=>{g.push(o.getRowHeader(b))})):Array.isArray(g)&&g[m]!==void 0?g=g[m]:_e(g)?g=g(m):g&&typeof g!="string"&&typeof g!="number"&&(g=m+1),g},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let h=0,g=o.countCols();h<g;h++)if(o.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const m=o.runHooks("modifyColHeader",h);if(m===void 0){const x=[],B=o.countCols();for(let V=0;V<B;V++)x.push(o.getColHeader(V));return x}let b=y.colHeaders;const C=function(x){const B=[],V=o.countCols();let P=0;for(;P<V;P++)_e(y.columns)&&y.columns(P)&&B.push(P);return B[x]},T=o.toPhysicalColumn(m),I=C(T);return y.colHeaders===!1?b=null:y.columns&&_e(y.columns)&&y.columns(I)&&y.columns(I).title?b=y.columns(I).title:y.columns&&y.columns[T]&&y.columns[T].title?b=y.columns[T].title:Array.isArray(y.colHeaders)&&y.colHeaders[T]!==void 0?b=y.colHeaders[T]:_e(y.colHeaders)?b=y.colHeaders(T):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(b=za(m)),b=o.runHooks("modifyColumnHeaderValue",b,h,g),b},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=o.getCellMeta(0,h).width),(g===void 0||g===y.width)&&(g=y.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h,g){let m=o._getColWidthFromSettings(h);return m=o.runHooks("modifyColWidth",m,h,g),m===void 0&&(m=_S),m},this._getRowHeightFromSettings=function(h){const g=this.view.getDefaultRowHeight();let m=y.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[h];break;case"function":m=m(h);break}typeof m=="string"&&(m=parseInt(m,10))}return m!=null&&m<g?g:m},this.getRowHeight=function(h,g){let m=o._getRowHeightFromSettings(h);return m=o.runHooks("modifyRowHeight",m,h,g),m},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const h=y.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Ah(o.countRows()-1,m=>{if(o.isEmptyRow(m))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Ah(o.countCols()-1,m=>{if(o.isEmptyCol(m))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return y.isEmptyRow.call(o,h)},this.isEmptyCol=function(h){return y.isEmptyCol.call(o,h)},this.selectCell=function(h,g,m,b){let C=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return wt(h)||wt(g)?!1:this.selectCells([[h,g,m,b]],C,T)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&f.suspend();const b=L.selectCells(h);return b&&m&&o.listen(),f.resume(),b},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return L.selectColumns(h,g,m)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return L.selectRows(h,g,m)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),L.selectAll(h,g,m)};const ge=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(h){if(typeof h=="number"){var g;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(g=arguments[4])!==null&&g!==void 0?g:!0}}const{row:m,col:b,considerHiddenIndexes:C}=h??{};let T=m,I=b;if(C===void 0||C){const V=Number.isInteger(m)&&m>=0,P=Number.isInteger(b)&&b>=0,ne=V?ge(this.rowIndexMapper,m):void 0,fe=P?ge(this.columnIndexMapper,b):void 0;if(ne===null||fe===null)return!1;T=V?o.rowIndexMapper.getRenderableFromVisualIndex(ne):m,I=P?o.columnIndexMapper.getRenderableFromVisualIndex(fe):b}const x=Number.isInteger(T),B=Number.isInteger(I);return x&&T>=0&&B&&I>=0?o.view.scrollViewport(o._createCellCoords(T,I),h.horizontalSnap,h.verticalSnap):x&&T>=0&&(B&&I<0||!B)?o.view.scrollViewportVertically(T,h.verticalSnap):B&&I>=0&&(x&&T<0||!x)?o.view.scrollViewportHorizontally(I,h.horizontalSnap):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:g}=this.getSelectedRangeLast();this.scrollViewportTo(g.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),R.clearCache(),dh.delete(this.guid),Qs(o)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}Hi(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(h=>{let[,g]=h;g.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),ht.getSingleton().destroy(o),Ce(o,(h,g,m)=>{_e(h)?m[g]=Xe(g):g!=="guid"&&(m[g]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,L=null,c=null,o=null};function Xe(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(h){return _.getItem(es(h))},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(h)},this.getInstance=function(){return o},this.addHook=function(h,g,m){ht.getSingleton().add(h,g,o,m)},this.hasHook=function(h){return ht.getSingleton().has(h,o)||ht.getSingleton().has(h)},this.addHookOnce=function(h,g,m){ht.getSingleton().once(h,g,o,m)},this.removeHook=function(h,g){ht.getSingleton().remove(h,g,o)},this.runHooks=function(h,g,m,b,C,T,I){return ht.getSingleton().run(o,h,g,m,b,C,T,I)},this.getTranslatedPhrase=function(h,g){return AR(y.language,h,g)},this.toHTML=()=>Ph(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",Ph(this)),h.firstElementChild},this.timeouts=[],this.useTheme=h=>{this.view.getStylesHandler().useTheme(h),this.runHooks("afterSetTheme",h,!!p)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=h;typeof m=="function"&&(m=setTimeout(m,g)),this.timeouts.push(m)},this._clearTimeouts=function(){X(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){X(this.immediates,h=>{clearImmediate(h)})},this._getEditorManager=function(){return c};const or=bL({handleEvent(){return o.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&or.releasePressedKeys()}),this.getShortcutManager=function(){return or},this.getFocusManager=function(){return d},VH().forEach(h=>{const g=jd(h);_.addItem(h,new g(this))}),nL(o),or.setActiveContextName("grid"),ht.getSingleton().run(o,"construct")}function qv(t,e,r){t.addEventListener(e,r,!1)}function Gv(t,e,r){t.removeEventListener(e,r,!1)}function $s(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function SL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:d=>d.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var d,f;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=$s(s).fontSize,o.style.fontFamily=$s(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const p=parseInt(((d=$s(s))===null||d===void 0?void 0:d.paddingInlineStart)||0,10),w=parseInt(((f=$s(s))===null||f===void 0?void 0:f.paddingInlineEnd)||0,10),v=o.clientWidth+p+w+1;n.removeChild(o);const R=s.style;R.height=`${r.minHeight}px`,r.minWidth>v?R.width=`${r.minWidth}px`:v>r.maxWidth?R.width=`${r.maxWidth}px`:R.width=`${v}px`;const y=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>y?R.height=`${r.minHeight}px`:r.maxHeight<y?(R.height=`${r.maxHeight}px`,R.overflowY="visible"):R.height=`${y}px`}function l(){t.defaultView.setTimeout(a,0)}function u(d){if(d&&d.minHeight)if(d.minHeight==="inherit")r.minHeight=s.clientHeight;else{const f=parseInt(d.minHeight,10);isNaN(f)||(r.minHeight=f)}if(d&&d.maxHeight)if(d.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const f=parseInt(d.maxHeight,10);isNaN(f)||(r.maxHeight=f)}if(d&&d.minWidth)if(d.minWidth==="inherit")r.minWidth=s.clientWidth;else{const f=parseInt(d.minWidth,10);isNaN(f)||(r.minWidth=f)}if(d&&d.maxWidth)if(d.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const f=parseInt(d.maxWidth,10);isNaN(f)||(r.maxWidth=f)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(d,f){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=d,u(f),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),p&&(qv(s,"input",a),qv(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){Gv(s,"input",a),Gv(s,"keydown",l)}}}function Kv(t,e){const r=qb(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}Nd(e,i)}function Wn(t,e,r){return(e=CL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CL(t){var e=RL(t,"string");return typeof e=="symbol"?e:e+""}function RL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TL="ht_editor_visible",js="ht_editor_hidden",Xv="textEditor",EL="text";class OL extends gf{static get EDITOR_TYPE(){return EL}constructor(e){super(e),Wn(this,"eventManager",new Ai(this)),Wn(this,"autoResize",SL(this.hot.rootDocument)),Wn(this,"TEXTAREA",void 0),Wn(this,"textareaStyle",void 0),Wn(this,"TEXTAREA_PARENT",void 0),Wn(this,"textareaParentStyle",void 0),Wn(this,"layerClass",void 0),this.eventManager=new Ai(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),kb(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==$e.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===$e.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),Nd(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],ts(-1)]),re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),pe(this.TEXTAREA_PARENT,this.layerClass)&&ye(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,js),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){hS()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ye(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,js)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Wt(e.length-1,n=>{const i=e[n];if(pe(i,"handsontableEditor"))return r=!0,!1}),pe(this.TEXTAREA_PARENT,js)&&ye(this.TEXTAREA_PARENT,js),r?(this.layerClass=TL,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==$e.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){kd()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===$e.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===$e.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>oe(this.hot.getSelected()),group:Xv},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;Kv(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;Kv(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Xv)}}const _L="base";function GR(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&re(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(tw())):a&&c.push(tw()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(rw())):(u.push(s.invalidCellClassName),a&&c.push(rw()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),ye(e,u),re(e,l),Bi(e,c),be(e,d)}GR.RENDERER_TYPE=_L;const ML="text";function KR(t,e,r,n,i,o,s){GR.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Na(a),s.trimWhitespace&&(a=a.trim()),$i(e,a)}KR.RENDERER_TYPE=ML;const IL="text",HL={CELL_TYPE:IL,editor:OL,renderer:KR};HN(HL);$t.editors={BaseEditor:gf};function $t(t,e){const r=new qR(t,e||{},sf);return r.init(),r}$t.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new qR(t,e,sf)};$t.DefaultSettings=VR();$t.hooks=ht.getSingleton();$t.CellCoords=qn;$t.CellRange=os;$t.packageName="handsontable";$t.buildDate="19/03/2025 09:41:52";$t.version="15.2.0";$t.languages={dictionaryKeys:U1,getLanguageDictionary:PR,getLanguagesDictionaries:X1,registerLanguageDictionary:xR,getTranslatedPhrase:AR};function xL(t,e,r){return(e=NL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zv(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function PL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zv(Object(r),!0).forEach(function(n){xL(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zv(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NL(t){var e=AL(t,"string");return typeof e=="symbol"?e:e+""}function Po(t){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Po(t)}var Ii=Symbol("unassigned"),DL="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function ma(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function XR(t){var e=$t.hooks.getRegistered(),r={};Object.assign(r,$t.DefaultSettings);for(var n in r)r[n]={default:Ii};for(var i=0;i<e.length;i++)r[e[i]]={default:Ii};return r.settings={default:Ii},t==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function ZR(t){var e={},r=t.settings;if(r!==Ii)for(var n in r)ma(r,n)&&r[n]!==Ii&&(e[n]=r[n]);for(var i in t)ma(t,i)&&i!=="settings"&&t[i]!==Ii&&(e[i]=t[i]);return e}function Qv(t,e){var r=ZR(t),n=t.settings?t.settings:r,i=t.settings?r:null,o={};for(var s in n)ma(n,s)&&n[s]!==void 0&&(!(e&&s!=="data")||!Jv(e[s],n[s]))&&(o[s]=n[s]);for(var a in i)ma(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!Jv(e[a],i[a]))&&(o[a]=i[a]);return o}function Jv(t,e){var r=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(Po(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Po(t)!==Po(e)?!1:r(t)===r(e)}var LL="15.2.0",QR=ey({name:"HotTable",props:XR("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var r=Qv(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(DL),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=Qv(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=oT(new $t.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(r&&r.length!==o&&r.length<o)for(var l=r.length;l<o;l++)n.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==a&&r[0].length<a)for(var c=r[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(o-1,r.length-o),s&&r.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,r[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:LL}),kL=["id"];function FL(t,e,r,n,i,o){return aT(),sT("div",{id:t.id},[lT(t.$slots,"default")],8,kL)}QR.render=FL;QR.__file="src/HotTable.vue";var VL=ey({name:"HotColumn",props:XR("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=ZR(this.$props),r=PL({},e);e.renderer&&(r.renderer=e.renderer),e.editor&&(r.editor=e.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});VL.__file="src/HotColumn.vue";export{GR as $,QL as A,uk as B,qb as C,mI as D,$R as E,Gs as F,Tn as G,nI as H,LI as I,yt as J,z as K,gf as L,pe as M,k as N,ye as O,fS as P,Dd as Q,zn as R,$e as S,OL as T,Dt as U,SL as V,Hi as W,Pb as X,Ce as Y,zb as Z,vS as _,KS as a,fC as a$,Ai as a0,En as a1,JL as a2,ik as a3,ZL as a4,_R as a5,MR as a6,ns as a7,ht as a8,Bd as a9,Ed as aA,KM as aB,Bi as aC,$i as aD,S1 as aE,zi as aF,Bt as aG,ca as aH,C1 as aI,wt as aJ,_e as aK,nk as aL,De as aM,un as aN,eS as aO,HC as aP,xC as aQ,PC as aR,AC as aS,NC as aT,DC as aU,LC as aV,IC as aW,mC as aX,lC as aY,uC as aZ,gC as a_,Wt as aa,UH as ab,nH as ac,XH as ad,HN as ae,HL as af,an as ag,VH as ah,vr as ai,X as aj,Tk as ak,MN as al,tH as am,zH as an,GH as ao,lf as ap,rI as aq,IH as ar,_S as as,II as at,Ih as au,Vt as av,ls as aw,ZS as ax,XS as ay,_n as az,qS as b,hR as b$,Ak as b0,hC as b1,Nk as b2,cC as b3,sC as b4,aC as b5,oC as b6,dC as b7,OC as b8,EC as b9,_H as bA,_d as bB,MH as bC,Dk as bD,SI as bE,Qb as bF,Zb as bG,WC as bH,BC as bI,$C as bJ,VC as bK,FC as bL,qa as bM,ff as bN,kC as bO,MI as bP,Hb as bQ,KC as bR,XC as bS,ZC as bT,QC as bU,JC as bV,iR as bW,oR as bX,sR as bY,aR as bZ,cR as b_,_C as ba,MC as bb,Id as bc,Gb as bd,Kb as be,nn as bf,aa as bg,On as bh,Ae as bi,qL as bj,YL as bk,ts as bl,ek as bm,ko as bn,ir as bo,UL as bp,AI as bq,dS as br,pC as bs,yC as bt,vC as bu,wC as bv,bC as bw,xI as bx,Lv as by,kb as bz,YS as c,zC as c$,lR as c0,uR as c1,eR as c2,tR as c3,rR as c4,nR as c5,fR as c6,dR as c7,gR as c8,HI as c9,GS as cA,qC as cB,GC as cC,SC as cD,CC as cE,VI as cF,bI as cG,Vo as cH,Vd as cI,Lt as cJ,Je as cK,In as cL,Ey as cM,Ie as cN,jt as cO,Sy as cP,Go as cQ,Qn as cR,TC as cS,RC as cT,lS as cU,_h as cV,LS as cW,uA as cX,Fd as cY,FI as cZ,jC as c_,wR as ca,vR as cb,kt as cc,ER as cd,OR as ce,Le as cf,mS as cg,TR as ch,bR as ci,SR as cj,tS as ck,l1 as cl,yR as cm,CR as cn,RR as co,TI as cp,xi as cq,QS as cr,mR as cs,pR as ct,Ld as cu,es as cv,u1 as cw,WI as cx,UC as cy,YC as cz,is as d,c1 as d0,iS as d1,Ko as d2,tE as d3,Ek as d4,$t as d5,Sk as d6,Pk as d7,$L as d8,pk as d9,xk as da,mk as db,fk as dc,jL as dd,Rk as de,gk as df,zL as dg,wk as dh,Ck as di,dk as dj,vk as dk,IN as dl,Lk as dm,vw as dn,yk as dp,Aw as dq,Ok as dr,KH as ds,Mk as dt,jd as du,QR as dv,Yn as e,re as f,fa as g,be as h,oe as i,GL as j,tk as k,ok as l,rk as m,sk as n,Db as o,ak as p,Na as q,XL as r,Nd as s,KR as t,ck as u,hk as v,vt as w,Jr as x,KL as y,lk as z};
