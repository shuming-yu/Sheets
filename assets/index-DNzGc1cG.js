import{g as getDefaultExportFromCjs}from"./_commonjsHelpers-Cpj98o6Y.js";function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$3={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,g){(function(o,p){n.exports=p()})(jsuites,function(){var o;return function(){var p={195:function(H){(function(m,s){H.exports=s()})(this,function(){return function(Le){function s(Ne,Ce){this.highOrder=Ne,this.lowOrder=Ce}var w=[new s(1779033703,4089235720),new s(3144134277,2227873595),new s(1013904242,4271175723),new s(2773480762,1595750129),new s(1359893119,2917565137),new s(2600822924,725511199),new s(528734635,4215389547),new s(1541459225,327033209)],S=[new s(1116352408,3609767458),new s(1899447441,602891725),new s(3049323471,3964484399),new s(3921009573,2173295548),new s(961987163,4081628472),new s(1508970993,3053834265),new s(2453635748,2937671579),new s(2870763221,3664609560),new s(3624381080,2734883394),new s(310598401,1164996542),new s(607225278,1323610764),new s(1426881987,3590304994),new s(1925078388,4068182383),new s(2162078206,991336113),new s(2614888103,633803317),new s(3248222580,3479774868),new s(3835390401,2666613458),new s(4022224774,944711139),new s(264347078,2341262773),new s(604807628,2007800933),new s(770255983,1495990901),new s(1249150122,1856431235),new s(1555081692,3175218132),new s(1996064986,2198950837),new s(2554220882,3999719339),new s(2821834349,766784016),new s(2952996808,2566594879),new s(3210313671,3203337956),new s(3336571891,1034457026),new s(3584528711,2466948901),new s(113926993,3758326383),new s(338241895,168717936),new s(666307205,1188179964),new s(773529912,1546045734),new s(1294757372,1522805485),new s(1396182291,2643833823),new s(1695183700,2343527390),new s(1986661051,1014477480),new s(2177026350,1206759142),new s(2456956037,344077627),new s(2730485921,1290863460),new s(2820302411,3158454273),new s(3259730800,3505952657),new s(3345764771,106217008),new s(3516065817,3606008344),new s(3600352804,1432725776),new s(4094571909,1467031594),new s(275423344,851169720),new s(430227734,3100823752),new s(506948616,1363258195),new s(659060556,3750685593),new s(883997877,3785050280),new s(958139571,3318307427),new s(1322822218,3812723403),new s(1537002063,2003034995),new s(1747873779,3602036899),new s(1955562222,1575990012),new s(2024104815,1125592928),new s(2227730452,2716904306),new s(2361852424,442776044),new s(2428436474,593698344),new s(2756734187,3733110249),new s(3204031479,2999351573),new s(3329325298,3815920427),new s(3391569614,3928383900),new s(3515267271,566280711),new s(3940187606,3454069534),new s(4118630271,4000239992),new s(116418474,1914138554),new s(174292421,2731055270),new s(289380356,3203993006),new s(460393269,320620315),new s(685471733,587496836),new s(852142971,1086792851),new s(1017036298,365543100),new s(1126000580,2618297676),new s(1288033470,3409855158),new s(1501505948,4234509866),new s(1607167915,987167468),new s(1816402316,1246189591)],M=new Array(64),l,a,h,f,c,v,j,L,k,N,D,O,Y=8;function V(Ne){return unescape(encodeURIComponent(Ne))}function ue(Ne){for(var Ce=[],Ie=(1<<Y)-1,Ve=Ne.length*Y,We=0;We<Ve;We+=Y)Ce[We>>5]|=(Ne.charCodeAt(We/Y)&Ie)<<32-Y-We%32;return Ce}function ge(Ne){for(var Ce="0123456789abcdef",Ie="",Ve=Ne.length*4,We,Xe=0;Xe<Ve;Xe+=1)We=Ne[Xe>>2]>>(3-Xe%4)*8,Ie+=Ce.charAt(We>>4&15)+Ce.charAt(We&15);return Ie}function G(Ne,Ce){var Ie,Ve,We,Xe;return Ie=(Ne.lowOrder&65535)+(Ce.lowOrder&65535),Ve=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie>>>16),We=(Ve&65535)<<16|Ie&65535,Ie=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Ve>>>16),Ve=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie>>>16),Xe=(Ve&65535)<<16|Ie&65535,new s(Xe,We)}function ae(Ne,Ce,Ie,Ve){var We,Xe,lt,st;return We=(Ne.lowOrder&65535)+(Ce.lowOrder&65535)+(Ie.lowOrder&65535)+(Ve.lowOrder&65535),Xe=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Ve.lowOrder>>>16)+(We>>>16),lt=(Xe&65535)<<16|We&65535,We=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Ie.highOrder&65535)+(Ve.highOrder&65535)+(Xe>>>16),Xe=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie.highOrder>>>16)+(Ve.highOrder>>>16)+(We>>>16),st=(Xe&65535)<<16|We&65535,new s(st,lt)}function he(Ne,Ce,Ie,Ve,We){var Xe,lt,st,ft;return Xe=(Ne.lowOrder&65535)+(Ce.lowOrder&65535)+(Ie.lowOrder&65535)+(Ve.lowOrder&65535)+(We.lowOrder&65535),lt=(Ne.lowOrder>>>16)+(Ce.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Ve.lowOrder>>>16)+(We.lowOrder>>>16)+(Xe>>>16),st=(lt&65535)<<16|Xe&65535,Xe=(Ne.highOrder&65535)+(Ce.highOrder&65535)+(Ie.highOrder&65535)+(Ve.highOrder&65535)+(We.highOrder&65535)+(lt>>>16),lt=(Ne.highOrder>>>16)+(Ce.highOrder>>>16)+(Ie.highOrder>>>16)+(Ve.highOrder>>>16)+(We.highOrder>>>16)+(Xe>>>16),ft=(lt&65535)<<16|Xe&65535,new s(ft,st)}function ce(Ne,Ce,Ie){return new s(Ne.highOrder&Ce.highOrder^Ne.highOrder&Ie.highOrder^Ce.highOrder&Ie.highOrder,Ne.lowOrder&Ce.lowOrder^Ne.lowOrder&Ie.lowOrder^Ce.lowOrder&Ie.lowOrder)}function oe(Ne,Ce,Ie){return new s(Ne.highOrder&Ce.highOrder^~Ne.highOrder&Ie.highOrder,Ne.lowOrder&Ce.lowOrder^~Ne.lowOrder&Ie.lowOrder)}function ye(Ne,Ce){return Ce<=32?new s(Ne.highOrder>>>Ce|Ne.lowOrder<<32-Ce,Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce):new s(Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce,Ne.highOrder>>>Ce|Ne.lowOrder<<32-Ce)}function ke(Ne){var Ce=ye(Ne,28),Ie=ye(Ne,34),Ve=ye(Ne,39);return new s(Ce.highOrder^Ie.highOrder^Ve.highOrder,Ce.lowOrder^Ie.lowOrder^Ve.lowOrder)}function Pe(Ne){var Ce=ye(Ne,14),Ie=ye(Ne,18),Ve=ye(Ne,41);return new s(Ce.highOrder^Ie.highOrder^Ve.highOrder,Ce.lowOrder^Ie.lowOrder^Ve.lowOrder)}function Be(Ne){var Ce=ye(Ne,1),Ie=ye(Ne,8),Ve=W(Ne,7);return new s(Ce.highOrder^Ie.highOrder^Ve.highOrder,Ce.lowOrder^Ie.lowOrder^Ve.lowOrder)}function Ze(Ne){var Ce=ye(Ne,19),Ie=ye(Ne,61),Ve=W(Ne,6);return new s(Ce.highOrder^Ie.highOrder^Ve.highOrder,Ce.lowOrder^Ie.lowOrder^Ve.lowOrder)}function W(Ne,Ce){return Ce<=32?new s(Ne.highOrder>>>Ce,Ne.lowOrder>>>Ce|Ne.highOrder<<32-Ce):new s(0,Ne.highOrder<<32-Ce)}var Le=V(Le),Ye=Le.length*Y;Le=ue(Le),Le[Ye>>5]|=128<<24-Ye%32,Le[(Ye+128>>10<<5)+31]=Ye;for(var k=0;k<Le.length;k+=32){l=w[0],a=w[1],h=w[2],f=w[3],c=w[4],v=w[5],j=w[6],L=w[7];for(var N=0;N<80;N++)N<16?M[N]=new s(Le[N*2+k],Le[N*2+k+1]):M[N]=ae(Ze(M[N-2]),M[N-7],Be(M[N-15]),M[N-16]),D=he(L,Pe(c),oe(c,v,j),S[N],M[N]),O=G(ke(l),ce(l,a,h)),L=j,j=v,v=c,c=G(f,D),f=h,h=a,a=l,l=G(D,O);w[0]=G(l,w[0]),w[1]=G(a,w[1]),w[2]=G(h,w[2]),w[3]=G(f,w[3]),w[4]=G(c,w[4]),w[5]=G(v,w[5]),w[6]=G(j,w[6]),w[7]=G(L,w[7])}for(var ot=[],k=0;k<w.length;k++)ot.push(w[k].highOrder),ot.push(w[k].lowOrder);return ge(ot)}})}},E={};function T(H){var m=E[H];if(m!==void 0)return m.exports;var s=E[H]={exports:{}};return p[H].call(s.exports,s,s.exports,T),s.exports}(function(){T.n=function(H){var m=H&&H.__esModule?function(){return H.default}:function(){return H};return T.d(m,{a:m}),m}})(),function(){T.d=function(H,m){for(var s in m)T.o(m,s)&&!T.o(H,s)&&Object.defineProperty(H,s,{enumerable:!0,get:m[s]})}}(),function(){T.o=function(H,m){return Object.prototype.hasOwnProperty.call(H,m)}}();var X={};(function(){T.d(X,{default:function(){return Ot}});var H=function(A){document.dictionary||(document.dictionary={});var I=null,d=Object.keys(A);for(I=0;I<d.length;I++)document.dictionary[d[I]]=A[d[I]]},m=function(A){return typeof document<"u"&&document.dictionary&&document.dictionary[A]||A},s={setDictionary:H,translate:m},S=function(A,I){if(I===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(r){return r!==null}),setTimeout(function(){window.jSuitesStateControl.push(A)},0);else{var d=window.jSuitesStateControl.indexOf(A);d>=0&&window.jSuitesStateControl.splice(d,1)}},M={};M.two=function(A){return A=""+A,A.length==1&&(A="0"+A),A},M.focus=function(A){if(A.innerText.length){var I=document.createRange(),d=window.getSelection(),r=A.childNodes[A.childNodes.length-1];I.setStart(r,r.length),I.collapse(!0),d.removeAllRanges(),d.addRange(I),A.scrollLeft=A.scrollWidth}},M.isNumeric=function(A){return typeof A=="string"&&(A=A.trim()),!isNaN(A)&&A!==null&&A!==""},M.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(A){var I=Math.random()*16|0,d=A=="x"?I:I&3|8;return d.toString(16)})},M.getNode=function(){var A=document.getSelection().anchorNode;return A?A.nodeType==3?A.parentNode:A:null},M.hash=function(A){var I=0,d,r;if(A.length===0)return I;for(d=0;d<A.length;d++)r=A.charCodeAt(d),r>32&&(I=(I<<5)-I+r,I|=0);return I},M.randomColor=function(A){var I=-.25,d=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");d.length<6&&(d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);var r=[],U,re;for(re=0;re<3;re++)U=parseInt(d.substr(re*2,2),16),U=Math.round(Math.min(Math.max(0,U+U*I),255)).toString(16),r.push(("00"+U).substr(U.length));return A==!0?"#"+M.two(r[0].toString(16))+M.two(r[1].toString(16))+M.two(r[2].toString(16)):r},M.getWindowWidth=function(){var A=window,I=document,d=I.documentElement,r=I.getElementsByTagName("body")[0],U=A.innerWidth||d.clientWidth||r.clientWidth;return U},M.getWindowHeight=function(){var A=window,I=document,d=I.documentElement,r=I.getElementsByTagName("body")[0],U=A.innerHeight||d.clientHeight||r.clientHeight;return U},M.getPosition=function(A){if(A.changedTouches&&A.changedTouches[0])var I=A.changedTouches[0].pageX,d=A.changedTouches[0].pageY;else var I=window.Event?A.pageX:A.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),d=window.Event?A.pageY:A.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[I,d]},M.click=function(A){if(A.click)A.click();else{var I=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});A.dispatchEvent(I)}},M.findElement=function(A,I){var d=!1;function r(U){U&&!d&&(typeof I=="function"?d=I(U):typeof I=="string"&&U.classList&&U.classList.contains(I)&&(d=U)),U.parentNode&&!d&&r(U.parentNode)}return r(A),d};var l=M;function a(A,I,d){if(A=A.split("."),A.length){let r=this,U=null;for(;A.length>1;)if(U=A.shift(),r.hasOwnProperty(U))r=r[U];else{if(typeof I>"u")return;r[U]={},r=r[U]}if(U=A.shift(),typeof I<"u")return d===!0?delete r[U]:r[U]=I,!0;if(r)return r[U]}return!1}function h(A,I){var d={};d.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},U=null;for(var re in r)I&&I.hasOwnProperty(re)?d.options[re]=I[re]:d.options[re]=r[re];A.classList.add("jsorting"),A.addEventListener("dragstart",function(_){let q=_.target;if(q.nodeType===3)if(q.parentNode.getAttribute("draggable")==="true")q=q.parentNode;else{_.preventDefault(),_.stopPropagation();return}if(q.getAttribute("draggable")==="true"){let Z=Array.prototype.indexOf.call(q.parentNode.children,q);U={element:q,o:Z,d:Z},q.style.opacity="0.25",typeof d.options.ondragstart=="function"&&d.options.ondragstart(A,q,_),_.dataTransfer.setDragImage(q,0,0)}}),A.addEventListener("dragover",function(_){if(_.preventDefault(),U&&ne(_.target)&&_.target.getAttribute("draggable")=="true"&&U.element!=_.target){if(d.options.direction)var q=_.target.clientWidth/2>_.offsetX;else var q=_.target.clientHeight/2>_.offsetY;q?_.target.parentNode.insertBefore(U.element,_.target):_.target.parentNode.insertBefore(U.element,_.target.nextSibling),U.d=Array.prototype.indexOf.call(_.target.parentNode.children,U.element)}}),A.addEventListener("dragleave",function(_){_.preventDefault()}),A.addEventListener("dragend",function(_){_.preventDefault(),U&&(typeof d.options.ondragend=="function"&&d.options.ondragend(A,U.element,_),U.o<U.d?_.target.parentNode.insertBefore(U.element,_.target.parentNode.children[U.o]):_.target.parentNode.insertBefore(U.element,_.target.parentNode.children[U.o].nextSibling),U.element.style.opacity="",U=null)}),A.addEventListener("drop",function(_){_.preventDefault(),U&&(U.o!==U.d&&typeof d.options.ondrop=="function"&&d.options.ondrop(A,U.o,U.d,U.element,_.target,_),U.element.style.opacity="",U=null)});for(var ne=function(_){var q=!1;function Z(ie){ie.className&&ie.classList.contains("jsorting")&&(q=!0),q||Z(ie.parentNode)}return Z(_),q},R=0;R<A.children.length;R++)A.children[R].hasAttribute("draggable")||A.children[R].setAttribute("draggable","true");return A.val=function(){for(var _=null,q=[],Z=0;Z<A.children.length;Z++)(_=A.children[Z].getAttribute("data-id"))&&q.push(_);return q},A}function f(A,I){var d={};(!I.loadUp||typeof I.loadUp!="function")&&(I.loadUp=function(){return!1}),(!I.loadDown||typeof I.loadDown!="function")&&(I.loadDown=function(){return!1}),I.timer||(I.timer=100);var r=null,U=function(re){if(r==null){var ne=!1,R=A.scrollTop;A.scrollTop+A.clientHeight*2>=A.scrollHeight?I.loadDown()&&(R==A.scrollTop&&(A.scrollTop=A.scrollTop-A.clientHeight),ne=!0):A.scrollTop<=A.clientHeight&&I.loadUp()&&(R==A.scrollTop&&(A.scrollTop=A.scrollTop+A.clientHeight),ne=!0),r=setTimeout(function(){r=null},I.timer),ne&&typeof I.onupdate=="function"&&I.onupdate()}};return A.onscroll=function(re){U()},A.onwheel=function(re){U()},d}function c(){var A=function(I,d){if(Array.isArray(I)){var r={instance:[],complete:d};if(I.length>0)for(var U=0;U<I.length;U++)I[U].multiple=r,r.instance.push(A(I[U]));return r}if(I.data||(I.data={}),I.type&&(I.method=I.type),I.method||(I.method="GET"),I.dataType||(I.dataType="json"),I.data){var re=function(ie,we){var fe=[];if(ie){var ve=Object.keys(ie);if(ve.length)for(var Me=0;Me<ve.length;Me++){if(we)var Se=we+"["+ve[Me]+"]";else var Se=ve[Me];if(ie[Se]instanceof FileList)fe[Se]=ie[ve[Me]];else if(ie[ve[Me]]===null||ie[ve[Me]]===void 0)fe[Se]="";else if(typeof ie[ve[Me]]=="object")for(var Oe=re(ie[ve[Me]],Se),Ge=Object.keys(Oe),et=0;et<Ge.length;et++)fe[Ge[et]]=Oe[Ge[et]];else fe[Se]=ie[ve[Me]]}}return fe},ne=re(I.data),R=Object.keys(ne);if(I.method=="GET"){if(R.length){for(var _=[],U=0;U<R.length;U++)_.push(R[U]+"="+encodeURIComponent(ne[R[U]]));I.url.indexOf("?")<0&&(I.url+="?"),I.url+=_.join("&")}}else for(var _=new FormData,U=0;U<R.length;U++)if(ne[R[U]]instanceof FileList){if(ne[R[U]].length)for(var q=0;q<ne[R[U]].length;q++)_.append(R[U],ne[R[U]][q],ne[R[U]][q].name)}else _.append(R[U],ne[R[U]])}var Z=new XMLHttpRequest;return Z.open(I.method,I.url,!0),I.requestedWith?Z.setRequestHeader("X-Requested-With",I.requestedWith):I.requestedWith!==!1&&Z.setRequestHeader("X-Requested-With","XMLHttpRequest"),I.contentType&&Z.setRequestHeader("Content-Type",I.contentType),I.method==="POST"?Z.setRequestHeader("Accept","application/json"):I.dataType==="blob"?Z.responseType="blob":I.contentType||(I.dataType==="json"?Z.setRequestHeader("Content-Type","text/json"):I.dataType==="html"&&Z.setRequestHeader("Content-Type","text/html")),I.cache!==!0&&(Z.setRequestHeader("pragma","no-cache"),Z.setRequestHeader("cache-control","no-cache")),I.withCredentials===!0&&(Z.withCredentials=!0),typeof I.beforeSend=="function"&&I.beforeSend(Z),typeof A.beforeSend=="function"&&A.beforeSend(Z),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(Z),Z.onerror=function(){I.error&&typeof I.error=="function"&&I.error({message:"Network error: Unable to reach the server.",status:0})},Z.ontimeout=function(){I.error&&typeof I.error=="function"&&I.error({message:"Request timed out after "+Z.timeout+"ms.",status:0})},Z.onload=function(){if(Z.status>=200&&Z.status<300)if(I.dataType==="json")try{var ie=JSON.parse(Z.responseText);I.success&&typeof I.success=="function"&&I.success(ie)}catch(fe){I.error&&typeof I.error=="function"&&I.error(fe,ie)}else{if(I.dataType==="blob")var ie=Z.response;else var ie=Z.responseText;I.success&&typeof I.success=="function"&&I.success(ie)}else I.error&&typeof I.error=="function"&&I.error(Z.responseText,Z.status);if(A.queue&&A.queue.length>0&&A.send(A.queue.shift()),A.requests&&A.requests.length){var we=A.requests.indexOf(Z);if(A.requests.splice(we,1),A.requests.length||I.complete&&typeof I.complete=="function"&&I.complete(ie),I.group&&A.oncomplete&&typeof A.oncomplete[I.group]=="function"&&(A.pending(I.group)||(A.oncomplete[I.group](),A.oncomplete[I.group]=null)),I.multiple&&I.multiple.instance){var we=I.multiple.instance.indexOf(Z);I.multiple.instance.splice(we,1),I.multiple.instance.length||I.multiple.complete&&typeof I.multiple.complete=="function"&&I.multiple.complete(ie)}}},Z.options=I,Z.data=_,I.queue===!0&&A.requests.length>0?A.queue.push(Z):A.send(Z),Z};return A.send=function(I){I.data?Array.isArray(I.data)?I.send(I.data.join("&")):I.send(I.data):I.send(),A.requests.push(I)},A.exists=function(I,d){var r=new XMLHttpRequest;r.open("HEAD",I,!1),r.send(),r.status&&d(r.status)},A.pending=function(I){var d=0,r=A.requests;if(r&&r.length)for(var U=0;U<r.length;U++)(!I||I==r[U].options.group)&&d++;return d},A.oncomplete={},A.requests=[],A.queue=[],A}var v=c();function j(){const A={loading:{}};return A.loading.show=function(I){A.loading.element||(A.loading.element=document.createElement("div"),A.loading.element.className="jloading"),document.body.appendChild(A.loading.element),I>0&&setTimeout(function(){A.loading.hide()},I*1e3)},A.loading.hide=function(){A.loading.element&&A.loading.element.parentNode&&document.body.removeChild(A.loading.element)},A.slideLeft=function(I,d,r){d==!0?(I.classList.add("jslide-left-in"),setTimeout(function(){I.classList.remove("jslide-left-in"),typeof r=="function"&&r()},400)):(I.classList.add("jslide-left-out"),setTimeout(function(){I.classList.remove("jslide-left-out"),typeof r=="function"&&r()},400))},A.slideRight=function(I,d,r){d===!0?(I.classList.add("jslide-right-in"),setTimeout(function(){I.classList.remove("jslide-right-in"),typeof r=="function"&&r()},400)):(I.classList.add("jslide-right-out"),setTimeout(function(){I.classList.remove("jslide-right-out"),typeof r=="function"&&r()},400))},A.slideTop=function(I,d,r){d===!0?(I.classList.add("jslide-top-in"),setTimeout(function(){I.classList.remove("jslide-top-in"),typeof r=="function"&&r()},400)):(I.classList.add("jslide-top-out"),setTimeout(function(){I.classList.remove("jslide-top-out"),typeof r=="function"&&r()},400))},A.slideBottom=function(I,d,r){d===!0?(I.classList.add("jslide-bottom-in"),setTimeout(function(){I.classList.remove("jslide-bottom-in"),typeof r=="function"&&r()},400)):(I.classList.add("jslide-bottom-out"),setTimeout(function(){I.classList.remove("jslide-bottom-out"),typeof r=="function"&&r()},100))},A.fadeIn=function(I,d){I.style.display="",I.classList.add("jfade-in"),setTimeout(function(){I.classList.remove("jfade-in"),typeof d=="function"&&d()},2e3)},A.fadeOut=function(I,d){I.classList.add("jfade-out"),setTimeout(function(){I.style.display="none",I.classList.remove("jfade-out"),typeof d=="function"&&d()},1e3)},A}var L=j();function k(){var A={};A.now=function(ne,R){var _=null,q=null,Z=null,ie=null,we=null,fe=null;return Array.isArray(ne)?(_=ne[0],q=ne[1],Z=ne[2],ie=ne[3],we=ne[4],fe=ne[5]):(ne||(ne=new Date),_=ne.getFullYear(),q=ne.getMonth()+1,Z=ne.getDate(),ie=ne.getHours(),we=ne.getMinutes(),fe=ne.getSeconds()),R==!0?l.two(_)+"-"+l.two(q)+"-"+l.two(Z):l.two(_)+"-"+l.two(q)+"-"+l.two(Z)+" "+l.two(ie)+":"+l.two(we)+":"+l.two(fe)},A.toArray=function(ne){var _=ne.split(ne.indexOf("T")!==-1?"T":" "),R=_[1],_=_[0].split("-"),q=parseInt(_[0]),Z=parseInt(_[1]),ie=parseInt(_[2]),we=0,fe=0;return R&&(R=R.split(":"),we=parseInt(R[0]),fe=parseInt(R[1])),[q,Z,ie,we,fe,0]};var I=Date.UTC(1900,0,0),d=Date.UTC(1900,1,29),r=864e5;A.dateToNum=function(ne){typeof ne=="string"&&(ne=new Date(ne+"  GMT+0"));var R=ne.getTime();return R>=d&&(R+=r),R-=I,R/r},A.numToDate=function(ne){var R=I+ne*r;R>=d&&(R-=r);const _=new Date(R);var q=[_.getUTCFullYear(),_.getUTCMonth()+1,_.getUTCDate(),_.getUTCHours(),_.getUTCMinutes(),_.getUTCSeconds()];return A.now(q)};let U=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],re=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(A,"weekdays",{get:function(){return U.map(function(ne){return s.translate(ne)})}}),Object.defineProperty(A,"weekdaysShort",{get:function(){return U.map(function(ne){return s.translate(ne).substring(0,3)})}}),Object.defineProperty(A,"months",{get:function(){return re.map(function(ne){return s.translate(ne)})}}),Object.defineProperty(A,"monthsShort",{get:function(){return re.map(function(ne){return s.translate(ne).substring(0,3)})}}),A}var N=k();function D(){var A={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},I=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var C=0;this.date[4]&&(C=parseFloat(this.date[4]/60));var F=parseInt(this.date[3])+C;F/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?F=l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),F=l.two(this.date[0])+"-"+l.two(this.date[1])+"-"+l.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(F+=" "+l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5])));return F},d=function(){var C="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)C=parseInt(this.date[3]);else{let J=parseInt(this.date[3]);J<13&&this.values.indexOf("PM")!==-1?C=(J+12)%24:C=J%24}this.date[4]&&(C+=parseFloat(this.date[4]/60)),this.date[5]&&(C+=parseFloat(this.date[5]/3600)),C/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var F=N.now(this.date);C=N.dateToNum(F)}return isNaN(C)&&(C=""),C},r=function(C){return C===null||C===""||C===void 0},U=function(C){var F=(""+C)[0];return F=="="},re=function(C){return C==="currency"||C==="percentage"||C==="scientific"||C==="numeric"},ne=function(C){if(C&&Number(C)==C)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var F=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=F[1]}else{C||(C=this.mask);var J=new RegExp("0{1}(.{1})0+","ig"),F=J.exec(C);if(F&&F[1]&&F[1].length==1)return this.options.decimal=F[1],F[1];var J=new RegExp("#{1}(.{1})#+","ig"),F=J.exec(C);F&&F[1]&&F[1].length==1?F[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},R=function(C,F){if(C=="")return"";F||(F=ne.call(this)),C=(""+C).split(F);var J=C[0].match(/[-]+/g);if(J&&J.length?J=!0:J=!1,C[0]=C[0].match(/[0-9]+/g),C[0]?(J&&C[0].unshift("-"),C[0]=C[0].join("")):J&&(C[0]="-"),C[0]||C[1])C[1]!==void 0&&(C[1]=C[1].match(/[0-9]+/g),C[1]?C[1]=C[1].join(""):C[1]="");else return"";return C},_=function(C,F){if(C==="")return"";var J=ne.call(this),de=this.options;if(C=R.call(this,C),C==="")return"";var Q=null;if(C[0]&&(de.style==="percent"?Q=parseFloat(C[0])/100:Q=parseFloat(C[0]+".1")),(C[0]==="-"||C[0]==="-00")&&!C[1]&&F&&F.inputType=="deleteContentBackward")return"";var pe=new Intl.NumberFormat(this.locale,de).format(Q);if(pe=pe.split(J),de.style==="percent"&&pe[0].indexOf("%")!==-1&&(pe[0]=pe[0].replace("%",""),pe[2]="%"),typeof pe[1]<"u"){var xe=pe[1].replace(/[0-9]*/g,"");xe&&(pe[2]=xe)}return C[1]!==void 0?pe[1]=J+C[1]:pe[1]="",pe.join("")},q=function(C,F){var J=we.call(C);if(J){var de=_.call(this,J,F),Q=de.length-J.length,pe=ie.call(C)+Q;we.call(C,de,pe,!0)}},Z=function(C){var F=R.call(this,C);return F?(F[0]==="-"&&(F[0]="-0"),parseFloat(F.join("."))):null},ie=function(C,F){if(C===void 0)if(this.tagName=="DIV"){var J=0,de=window.getSelection();if(de&&de.rangeCount!==0){var Q=de.getRangeAt(0),pe=Q.cloneRange();pe.selectNodeContents(this),pe.setEnd(Q.endContainer,Q.endOffset),J=pe.toString().length}return J}else return this.selectionStart;else{var xe=we.call(this);if(F){for(var pe=null,_e=0;_e<xe.length;_e++)(xe[_e].match(/[\-0-9]/g)||xe[_e]==="."||xe[_e]===",")&&(pe=_e);pe===null&&(pe=xe.indexOf(" ")),C>=pe&&(C=pe+1)}if(C>xe.length&&(C=xe.length),C)if(this.tagName=="DIV"){var de=window.getSelection(),Q=document.createRange();this.childNodes[0]&&(Q.setStart(this.childNodes[0],C),de.removeAllRanges(),de.addRange(Q))}else this.selectionStart=C,this.selectionEnd=C}},we=function(C,F,J){if(this.tagName=="DIV")if(C===void 0){var C=this.innerText;return this.value&&this.value.length>C.length&&(C=this.value),C}else this.innerText!==C&&(this.innerText=C,F&&ie.call(this,F,J));else{if(C===void 0)return this.value;this.value!==C&&(this.value=C,F&&ie.call(this,F,J))}},fe=N.weekdays,ve=N.weekdaysShort,Me=N.months,Se=N.monthsShort,Oe={YEAR:function(C,F){var J=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<=10&&this.values[this.index].length<F&&(this.values[this.index]+=C),this.values[this.index].length==F){if(F==2)var J=J.substr(0,2)+this.values[this.index];else if(F==3)var J=J.substr(0,1)+this.values[this.index];else if(F==4)var J=this.values[this.index];this.date[0]=J,this.index++}},YYYY:function(C){Oe.YEAR.call(this,C,4)},YYY:function(C){Oe.YEAR.call(this,C,3)},YY:function(C){Oe.YEAR.call(this,C,2)},FIND:function(C,F){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=C;return}for(var J=0,de=0,Q=(this.values[this.index]+C).toLowerCase(),pe=0;pe<F.length;pe++)F[pe].toLowerCase().indexOf(Q)==0&&(J=pe,de++);if(de>1)this.values[this.index]+=C;else if(de==1){var xe=F[J].length-this.values[this.index].length-1;return this.position+=xe,this.values[this.index]=F[J],this.index++,J}},MMM:function(C){var F=Oe.FIND.call(this,C,Se);F!==void 0&&(this.date[1]=F+1)},MON:function(C){Oe.MMM.call(this,C)},MMMM:function(C){var F=Oe.FIND.call(this,C,Me);F!==void 0&&(this.date[1]=F+1)},MONTH:function(C){Oe.MMMM.call(this,C)},MMMMM:function(C){r(this.values[this.index])&&(this.values[this.index]="");for(var F=(this.values[this.index]+C).toLowerCase(),J=0;J<Me.length;J++)if(Me[J][0].toLowerCase().indexOf(F)==0){this.values[this.index]=Me[J][0],this.date[1]=J+1,this.index++;break}},MM:function(C){r(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(this.date[1]=this.values[this.index]="0"+C,this.index++):parseInt(C)<2&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[1]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[1]=this.values[this.index]+=C,this.index++)},M:function(C){var F=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(r(this.values[this.index]))this.values[this.index]=C,C>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(C)<3)this.date[1]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[1]=this.values[this.index]+=C,this.index++;else var F=!0;else var F=!0;if(F==!0){var J=parseInt(this.values[this.index]);J>0&&J<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(C){var F=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(r(this.values[this.index]))this.values[this.index]=C,parseInt(C)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(C)<2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[2]=this.values[this.index]+=C,this.index++;else var F=!0;else var F=!0;if(F==!0){var J=parseInt(this.values[this.index]);J>0&&J<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(C){r(this.values[this.index])?parseInt(C)>3&&parseInt(C)<10?(this.date[2]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==3&&parseInt(C)<2?(this.date[2]=this.values[this.index]+=C,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(C)<10?(this.date[2]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[2]=this.values[this.index]+=C,this.index++)},DDD:function(C){Oe.FIND.call(this,C,ve)},DY:function(C){Oe.DDD.call(this,C)},DDDD:function(C){Oe.FIND.call(this,C,fe)},DAY:function(C){Oe.DDDD.call(this,C)},HH12:function(C,F){r(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(F&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<1&&parseInt(C)<10&&(this.date[3]=this.values[this.index]+=C,this.index++)},HH24:function(C,F){parseInt(C)>=0&&parseInt(C)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>2&&parseInt(C)<10?(F&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==2&&parseInt(C)<4?(!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<2&&parseInt(C)<10&&(!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++))},HH:function(C){Oe.HH24.call(this,C,1)},H:function(C){Oe.HH24.call(this,C,0)},"\\[H\\]":function(C){this.values[this.index]==null&&(this.values[this.index]=""),C.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=C:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(C,F){this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>5&&parseInt(C)<10?(this.date[F]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):parseInt(C)<10&&(this.date[F]=this.values[this.index]+=C,this.index++)},MI:function(C){Oe.N60.call(this,C,4)},SS:function(C){Oe.N60.call(this,C,5)},"AM/PM":function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?C.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":C.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<7&&(this.values[this.index]=C),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(C){var F=ne.call(this),J=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(J=!0);var de=R.call(this,this.values[this.index],F);de&&(this.values[this.index]=de.join(F)),parseInt(C)>=0&&parseInt(C)<10?(this.values[this.index]=="0"&&C>0?this.values[this.index]="":this.values[this.index]=="-0"&&C>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||C==F)&&(this.values[this.index]+=C)):F&&C==F?this.values[this.index].indexOf(F)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=C):C=="-"&&(J=!0),J===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(C){Oe["0{1}(.{1}0+)?"].call(this,C)},"0{1}(.{1}0+)?%":function(C){Oe["0{1}(.{1}0+)?"].call(this,C),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(C){Oe["0{1}(.{1}0+)?"].call(this,C);var F=ne.call(this),J=this.tokens[this.index].substr(1,1),de=this.values[this.index][0]==="-",Q=R.call(this,this.values[this.index],F);if(Q!==""){var pe=Q[0].match(/[0-9]/g);if(pe){pe=pe.join("");for(var xe=[],_e=0,je=pe.length-1;je>=0;je--)xe.push(pe[je]),_e++,_e%3||xe.push(J);xe=xe.reverse(),Q[0]=xe.join(""),Q[0].substr(0,1)==J&&(Q[0]=Q[0].substr(1))}else Q[0]="";this.values[this.index]=Q.join(F),de&&(this.values[this.index]="-"+this.values[this.index])}},0:function(C){C.match(/[0-9]/g)&&(this.values[this.index]=C,this.index++)},"[0-9a-zA-Z$]+":function(C){r(this.values[this.index])&&(this.values[this.index]="");var F=this.tokens[this.index],J=this.values[this.index],de=J.length;F[de]==C?(this.values[this.index]+=C,this.values[this.index]==F&&this.index++):(this.values[this.index]=F,this.index++,C.match(/[\-0-9]/g)&&this.position--)},A:function(C){C.match(/[a-zA-Z]/gi)&&(this.values[this.index]=C,this.index++)},".":function(C){Oe["[0-9a-zA-Z$]+"].call(this,C)},"@":function(C){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=C}},Ge=function(C){if(this.type=="general")var F=[].concat(A.general);else var F=[].concat(A.currency,A.datetime,A.percentage,A.scientific,A.numeric,A.text,A.general);var J=new RegExp(F.join("|"),"gi");return C.match(J)},et=function(C){if(this.type)if(this.type=="text")var F=["text"];else if(this.type=="general")var F=["general"];else if(this.type=="datetime")var F=["numeric","datetime","general"];else var F=["currency","percentage","scientific","numeric","general"];else var F=Object.keys(A);for(var J=0;J<F.length;J++)for(var de=F[J],Q=0;Q<A[de].length;Q++){var pe=new RegExp(A[de][Q],"gi"),xe=C.match(pe);if(xe)return{type:de,method:A[de][Q]}}},te=function(C){for(var F=[],J=0;J<C.length;J++){var de=et.call(this,C[J]);de?F.push(de.method):F.push(null)}for(var J=0;J<F.length;J++)F[J]=="MM"&&(F[J-1]&&F[J-1].indexOf("H")>=0||F[J-2]&&F[J-2].indexOf("H")>=0||F[J+1]&&F[J+1].indexOf("S")>=0||F[J+2]&&F[J+2].indexOf("S")>=0)&&(F[J]="MI");return F},be=function(C){var F=et.call(this,C);if(F)var J=F.type;if(J){for(var de=0,Q=Ge.call(this,C),pe=0;pe<Q.length;pe++)F=et.call(this,Q[pe]),F&&re(F.type)&&de++;de>1&&(J="general")}return J},Te=function(){typeof Oe[this.methods[this.index]]=="function"?(Oe[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},z=function(C){return(""+ +C).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(F,J,de,Q,pe){return pe<0?J+"0."+Array(1-pe-de.length).join(0)+de+Q:J+de+Q+Array(pe-Q.length+1).join(0)})},ee=function(C,F,J){var de=null,Q={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof C=="object"){if(Q.input=C.target,Q.value=we.call(C.target),Q.caret=ie.call(C.target),(de=C.target.getAttribute("data-mask"))&&(Q.mask=de),(de=C.target.getAttribute("data-type"))&&(Q.type=de),C.target.mask?(C.target.mask.options&&(Q.options=C.target.mask.options),C.target.mask.locale&&(Q.locale=C.target.mask.locale)):(de=C.target.getAttribute("data-locale"))&&(Q.locale=de,Q.mask&&(Q.options.style=Q.mask)),C.target.attributes&&C.target.attributes.length)for(var pe=0;pe<C.target.attributes.length;pe++){var xe=C.target.attributes[pe].name,_e=C.target.attributes[pe].value;xe.substr(0,4)=="data"&&(Q.options[xe.substr(5)]=_e)}}else{if(typeof F=="string")Q.mask=F;else for(var xe=Object.keys(F),pe=0;pe<xe.length;pe++)Q[xe[pe]]=F[xe[pe]];typeof C=="number"&&(ne.call(Q,Q.mask),C=(""+C).replace(".",Q.options.decimal)),Q.value=C,Q.input&&(we.call(Q.input,C),l.focus(Q.input),Q.caret=ie.call(Q.input))}if(!U(Q.value)&&(Q.mask||Q.locale)){if(Q.mask){if(Q.mask=Q.mask.replace(new RegExp(/\[h]/),"|h|"),Q.mask=Q.mask.replace(new RegExp(/\[.*?\]/),""),Q.mask=Q.mask.replace(new RegExp(/\|h\|/),"[h]"),Q.mask.indexOf(";")!==-1){var de=Q.mask.split(";");Q.mask=de[0]}if(Q.mask.indexOf("##")!==-1){var je=Q.mask.split(";");je[0]&&(typeof C=="object"&&(je[0]=je[0].replace(new RegExp(/_\)/g),""),je[0]=je[0].replace(new RegExp(/_\(/g),"")),je[0]=je[0].replace("*","	"),je[0]=je[0].replace(new RegExp(/_-/g),""),je[0]=je[0].replace(new RegExp(/_/g),""),je[0]=je[0].replace(new RegExp(/"/g),""),je[0]=je[0].replace("##0.###","##0.000"),je[0]=je[0].replace("##0.##","##0.00"),je[0]=je[0].replace("##0.#","##0.0"),je[0]=je[0].replace("##0,###","##0,000"),je[0]=je[0].replace("##0,##","##0,00"),je[0]=je[0].replace("##0,#","##0,0")),Q.mask=je[0]}if(Q.mask.indexOf("\\")!==-1){var je=Q.mask.split(";");je[0]=je[0].replace(new RegExp(/\\/g),""),Q.mask=je[0]}Q.type||(Q.type=be.call(Q,Q.mask)),Q.tokens=Ge.call(Q,Q.mask)}if(typeof C!="object"||!C.inputType||!C.inputType.indexOf("insert")||!C.inputType.indexOf("delete"))if(Q.locale)if(Q.input)q.call(Q,Q.input,C);else var Fe=_.call(Q,Q.value);else{for(Q.methods=te.call(Q,Q.tokens),Q.event=C;Q.position<Q.value.length&&typeof Q.tokens[Q.index]<"u";)Te.call(Q);var Fe=Q.values.join("");if(re(Q.type)&&Fe!==""){for(;typeof Q.tokens[Q.index]<"u";){var de=et.call(Q,Q.tokens[Q.index]);de&&de.type=="general"&&(Q.values[Q.index]=Q.tokens[Q.index]),Q.index++}var He=!0}else var He=!1;if(Fe=Q.values.join(""),Q.input){if(de=Fe.length-Q.value.length,de>0)var Je=Q.caret+de;else var Je=Q.caret;we.call(Q.input,Fe,Je,He)}}if(Q.input){var se=null;if(re(Q.type)){let Ee=we.call(Q.input);Q.number=Z.call(Q,Ee),Q.type=="percentage"&&(""+Ee).indexOf("%")!==-1?se=ee.adjustPrecision(Q.number/100):se=Q.number}else Q.type=="datetime"&&(se=I.call(Q),Q.date[0]&&Q.date[1]&&Q.date[2]&&Q.input.setAttribute("data-completed",!0));se&&Q.input.setAttribute("data-value",se)}if(Fe!==void 0)return J?Q:Fe}};return ee.adjustPrecision=function(C){if(typeof C=="number"&&!Number.isInteger(C)){const F=C.toString().split(".");if(F[1]&&F[1].length>10){let J=0;const de=F[1][F[1].length-2];if(de==0||de==9){for(let Q=F[1].length-2;Q>0;Q--)if(J>=0&&F[1][Q]==de){if(J++,J>6)break}else{J=0;break}if(J)return parseFloat(parseFloat(C).toFixed(F[1].length-1))}}}return C},ee.getType=be,ee.prepare=function(C,F){return F||(F={}),Ge.call(F,C)},ee.apply=function(C){var F=we.call(C.target);C.key.length==1&&(F+=C.key),we.call(C.target,ee(F,C.target.getAttribute("data-mask")))},ee.run=function(C,F,J){return ee(C,{mask:F,decimal:J})},ee.extract=function(C,F,J){if(r(C)||typeof F!="object")return C;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var de=F.mask.split(";");F.mask=de[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}ne.call(F,F.mask);var Q=null,pe=null;if(F.type=="percent"||F.options.style=="percent"?Q="percentage":F.mask&&(Q=be.call(F,F.mask)),Q==="text"){var xe={};pe=C}else if(Q==="general"){var xe=ee(C,F,!0);pe=C}else if(Q==="datetime"){C instanceof Date&&(C=ee.getDateString(C,F.mask));var xe=ee(C,F,!0);l.isNumeric(C)?pe=C:pe=d.call(xe)}else if(Q==="scientific"){pe=C,typeof C=="string"&&(pe=Number(pe));var xe=F}else{pe=Z.call(F,C),Q==="percentage"&&(""+C).indexOf("%")!==-1&&(pe/=100);var xe=F}return xe.value=pe,!xe.type&&Q&&(xe.type=Q),J?xe:pe},ee.render=function(C,F,J,de){if(r(C)||typeof F!="object")return C;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var Q=F.mask.split(";");J||(Q[0]=Q[0].replace(new RegExp(/_\)/g),""),Q[0]=Q[0].replace(new RegExp(/_\(/g),"")),F.mask=Q[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}var pe=null;F.type=="percent"||F.options.style=="percent"?pe="percentage":F.mask?pe=be.call(F,F.mask):C instanceof Date&&(pe="datetime");var xe=!1;if(pe=="datetime"||F.type=="calendar"){var Q=ee.getDateString(C,F.mask);Q&&(C=Q),F.mask&&J&&(xe=!0)}else if(pe==="text")typeof C=="number"&&(C=C.toString());else if(typeof C=="string"&&o.isNumeric(C)&&(C=Number(C)),pe==="percentage"&&(C=ee.adjustPrecision(C*100)),typeof C=="number"){var Q=null;if(F.mask&&J){var _e=ne.call(F,F.mask);if(pe==="scientific")if(F.mask.indexOf(_e)!==-1){let Ae=F.mask.split("E");Ae=Ae[0].split(_e),Ae=""+Ae[1].match(/[0-9]+/g),Ae=Ae.length,Q=C.toExponential(Ae)}else Q=C.toExponential(0);else{if(F.mask.indexOf(_e)!==-1){_e=F.mask.split(_e),_e=""+_e[1].match(/[0-9]+/g),_e=_e.length,Q=C.toFixed(_e);let Ae=C.toString().split("."),qe=Ae[1];qe&&qe.length>_e&&qe[qe.length-1]==="5"&&(Q=parseFloat(Ae[0]+"."+qe+"1").toFixed(_e))}else Q=C.toFixed(0);(""+Q).indexOf("e")!==-1&&(Q=z(Q))}}else if(F.locale&&J){var _e=(""+C).split(".");if(F.options){typeof _e[1]>"u"&&(_e[1]="");var Fe=_e[1].length;if(F.options.minimumFractionDigits>Fe)for(var je=0;je<F.options.minimumFractionDigits-Fe;je++)_e[1]+="0"}_e[1].length?Q=_e.join("."):Q=_e[0];var Fe=_e[1].length;F.options&&F.options.maximumFractionDigits<Fe&&(Q=parseFloat(Q).toFixed(F.options.maximumFractionDigits))}else Q=z(C);Q!==null&&(C=Q,ne.call(F,F.mask),F.options.decimal&&(C=C.replace(".",F.options.decimal)))}else F.mask&&J&&(xe=!0);if(xe){var He=F.mask.length-C.length;if(He>0)for(var je=0;je<He;je++)C+=" "}if(pe==="scientific")if(!J)C=z(C);else return C;if(pe==="numeric"&&de===!1&&typeof C=="string")return C;if(C=ee(C,F),J&&pe==="numeric"){var Je=F.mask.match(new RegExp(/^[0]+$/gm));if(Je&&Je.length===1){var se=Je[0].length;if(se>3)for(C=""+C;C.length<se;)C="0"+C}}return C},ee.set=function(C,F){if(F){C.setAttribute("data-mask",F);var J=new Event("input",{bubbles:!0,cancelable:!0});C.dispatchEvent(J)}},ee.extractDateFromString=function(C,F){var J=ee(C,{mask:F},!0);if(C>0&&Number(C)==C&&(J.values.join("")!==J.value||J.type=="numeric")){var de=new Date(Math.round((C-25569)*86400*1e3));return de.getFullYear()+"-"+l.two(de.getMonth())+"-"+l.two(de.getDate())+" 00:00:00"}var Q=!1;return J.values&&J.values.length===J.tokens.length&&J.values[J.values.length-1].length>=J.tokens[J.tokens.length-1].length&&(Q=!0),J.date[0]&&J.date[1]&&(J.date[2]||Q)?(J.date[2]||(J.date[2]=1),J.date[0]+"-"+l.two(J.date[1])+"-"+l.two(J.date[2])+" "+l.two(J.date[3])+":"+l.two(J.date[4])+":"+l.two(J.date[5])):""},ee.getDateString=function(C,F){if(!F)var F={};if(F&&typeof F=="object"){if(F.format)var J=F.format;else if(F.mask)var J=F.mask}else var J=F;if(J||(J="YYYY-MM-DD"),J.indexOf("[h]")>=0){var de=0;if(C&&l.isNumeric(C)&&(de=parseFloat(24*Number(C)),J.indexOf("mm")>=0)){var Q=(""+de).split(".");if(Q[1]){var pe=60*parseFloat("0."+Q[1]);pe=parseFloat(pe.toFixed(2))}else var pe=0;de=parseInt(Q[0])+":"+l.two(pe)}return de}C instanceof Date?C=N.now(C):C&&l.isNumeric(C)&&(C=N.numToDate(C));for(var xe=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],_e=new RegExp(xe.join("|"),"gi"),je=J.match(_e),Fe=0;Fe<je.length;Fe++)je[Fe].toUpperCase()=="MM"&&(je[Fe-1]&&je[Fe-1].toUpperCase().indexOf("H")>=0||je[Fe-2]&&je[Fe-2].toUpperCase().indexOf("H")>=0||je[Fe+1]&&je[Fe+1].toUpperCase().indexOf("S")>=0||je[Fe+2]&&je[Fe+2].toUpperCase().indexOf("S")>=0)&&(je[Fe]="mi");var He={tokens:je};if(C){var pe=""+C,Je=pe.indexOf("T")!==-1?"T":" ";pe=pe.split(Je);var Q=0,se=0,Ee=0;pe[1]&&(Q=pe[1].split(":"),se=Q[1]?Q[1]:0,Ee=Q[2]?Q[2]:0,Q=Q[0]?Q[0]:0),pe=pe[0].split("-");let dt=new Date(pe[0],pe[1],0).getDate();if(pe[0]&&pe[1]&&pe[2]&&pe[0]>0&&pe[1]>0&&pe[1]<13&&pe[2]>0&&pe[2]<=dt){He.data=[pe[0],pe[1],pe[2],Q,se,Ee],He.value=[];for(var Ae=new Date(He.data[0],He.data[1]-1,He.data[2],He.data[3],He.data[4],He.data[5]),qe=function(mt){var nt=this.tokens[mt],it=nt.toUpperCase(),Qe=null;it==="YYYY"?Qe=this.data[0]:it==="YYY"?Qe=this.data[0].substring(1,4):it==="YY"?Qe=this.data[0].substring(2,4):it==="Y"?Qe=this.data[0].substring(3,4):nt==="MON"?Qe=N.months[Ae.getMonth()].substr(0,3).toUpperCase():nt==="mon"?Qe=N.months[Ae.getMonth()].substr(0,3).toLowerCase():nt==="MONTH"?Qe=N.months[Ae.getMonth()].toUpperCase():nt==="month"?Qe=N.months[Ae.getMonth()].toLowerCase():it==="MMMMM"?Qe=N.months[Ae.getMonth()].substr(0,1):it==="MMMM"||nt==="Month"?Qe=N.months[Ae.getMonth()]:it==="MMM"||nt=="Mon"?Qe=N.months[Ae.getMonth()].substr(0,3):it==="MM"?Qe=l.two(this.data[1]):it==="M"?Qe=Ae.getMonth()+1:nt==="DAY"?Qe=N.weekdays[Ae.getDay()].toUpperCase():nt==="day"?Qe=N.weekdays[Ae.getDay()].toLowerCase():it==="DDDD"||nt=="Day"?Qe=N.weekdays[Ae.getDay()]:it==="DDD"?Qe=N.weekdays[Ae.getDay()].substr(0,3):it==="DD"?Qe=l.two(this.data[2]):it==="D"?Qe=parseInt(this.data[2]):it==="Q"?Qe=Math.floor((Ae.getMonth()+3)/3):it==="HH24"||it==="HH"?(Qe=this.data[3],Qe>12&&this.tokens.indexOf("am/pm")!==-1&&(Qe-=12),Qe=l.two(Qe)):it==="HH12"?this.data[3]>12?Qe=l.two(this.data[3]-12):Qe=l.two(this.data[3]):it==="H"?(Qe=this.data[3],Qe>12&&this.tokens.indexOf("am/pm")!==-1&&(Qe-=12,Qe=l.two(Qe))):it==="MI"?Qe=l.two(this.data[4]):it==="SS"?Qe=l.two(this.data[5]):it==="MS"?Qe=Ae.getMilliseconds():it==="AM/PM"?this.data[3]>=12?Qe="PM":Qe="AM":it==="WD"&&(Qe=N.weekdays[Ae.getDay()]),Qe===null?this.value[mt]=this.tokens[mt]:this.value[mt]=Qe},Fe=0;Fe<He.tokens.length;Fe++)qe.call(He,Fe);C=He.value.join("")}else C=""}return C},ee}var O=D();function Y(){var A=function(I,d){if(I.calendar)return I.calendar.setOptions(d,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(z,ee){var C={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:N.monthsShort,monthsFull:N.months,weekdays:N.weekdays,textDone:s.translate("Done"),textReset:s.translate("Reset"),textUpdate:s.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var F in C)z&&z.hasOwnProperty(F)?r.options[F]=z[F]:(typeof r.options[F]>"u"||ee===!0)&&(r.options[F]=C[F]);if(r.options.resetButton==!1?_.style.display="none":_.style.display="",r.options.readonly?I.setAttribute("readonly","readonly"):I.removeAttribute("readonly"),r.options.placeholder?I.setAttribute("placeholder",r.options.placeholder):I.removeAttribute("placeholder"),l.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=A.numToDate(r.options.value),r.options.dataType="numeric"),_.innerHTML=r.options.textReset,q.innerHTML=r.options.textDone,et.innerHTML=r.options.textUpdate,r.options.format&&I.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var J=A.now();else var J=r.options.value;return J&&(r.options.value=null,r.setValue(J)),r},r.open=function(z){if(!R.classList.contains("jcalendar-focus")&&!R.classList.contains("jcalendar-inline")){if(A.current=r,S(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(te.value=r.date[3],be.value=r.date[4]),R.classList.add("jcalendar-focus"),l.getWindowWidth()<800||r.options.fullscreen)R.classList.add("jcalendar-fullsize"),L.slideBottom(ie,1);else{R.classList.remove("jcalendar-fullsize");var ee=I.getBoundingClientRect(),C=ie.getBoundingClientRect();if(r.options.position)Z.style.position="fixed",window.innerHeight<ee.bottom+C.height?Z.style.top=ee.top-(C.height+2)+"px":Z.style.top=ee.top+ee.height+2+"px",Z.style.left=ee.left+"px";else{if(window.innerHeight<ee.bottom+C.height){var F=-1*(ee.height+C.height+2);F+ee.top<0&&(F=-1*(ee.top+ee.height)),Z.style.top=F+"px"}else Z.style.top="2px";if(window.innerWidth<ee.left+C.width){var F=window.innerWidth-(ee.left+C.width+20);Z.style.left=F+"px"}else Z.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(I)}},r.close=function(z,ee){if(r.options.autoSelect!==!0&&typeof ee>"u"&&(ee=!1),R.classList.contains("jcalendar-focus")){if(ee!==!1){var C=R.querySelector(".jcalendar-selected");if(typeof ee=="string")var F=ee;else if(!C||C.classList.contains("jcalendar-disabled"))var F=r.options.value;else var F=r.getValue();r.setValue(F)}else{let J=r.options.value||"";r.options.value=null,r.setValue(J)}!z&&typeof r.options.onclose=="function"&&r.options.onclose(I),R.classList.remove("jcalendar-focus"),S(r,!1),A.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var z=new Date().toISOString().substr(0,10);return r.setValue(z),z},r.setValue=function(z){z||(z=""+z);var ee=z,C=r.options.value;if(C!=ee){if(ee){r.setLabel(ee,r.options);var J=ee.split(" ");J[1]||(J[1]="00:00:00");var F=J[1].split(":"),J=J[0].split("-"),de=parseInt(J[0]),Q=parseInt(J[1]),pe=parseInt(J[2]),xe=parseInt(F[0]),_e=parseInt(F[1]);r.date=[de,Q,pe,xe,_e,0];var z=r.setLabel(ee,r.options),je=A.now(new Date(de,Q-1,pe),!0);if(r.options.validRange){if(!r.options.validRange[0]||je>=r.options.validRange[0])var Fe=!0;else var Fe=!1;if(!r.options.validRange[1]||je<=r.options.validRange[1])var He=!0;else var He=!1;Fe&&He?(I.classList.remove("jcalendar_warning"),I.title=""):(I.classList.add("jcalendar_warning"),I.title=s.translate("Date outside the valid range"))}else I.classList.remove("jcalendar_warning"),I.title=""}else{r.date=null;var z="";I.classList.remove("jcalendar_warning"),I.title=""}r.options.value=ee,typeof r.options.onchange=="function"&&r.options.onchange(I,ee,C),I.value!=z&&(I.value=z,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value}))}r.date&&(r.getDays(),r.options.type=="year-month-picker"&&r.getMonths())},r.getValue=function(){return r.date?r.options.time?l.two(r.date[0])+"-"+l.two(r.date[1])+"-"+l.two(r.date[2])+" "+l.two(r.date[3])+":"+l.two(r.date[4])+":"+l.two(0):l.two(r.date[0])+"-"+l.two(r.date[1])+"-"+l.two(r.date[2])+" "+l.two(0)+":"+l.two(0)+":"+l.two(0):""},r.update=function(z,ee){if(!z.classList.contains("jcalendar-disabled")){var C=R.querySelector(".jcalendar-selected");C&&C.classList.remove("jcalendar-selected"),z.classList.add("jcalendar-selected"),z.classList.contains("jcalendar-set-month")?(r.date[1]=ee,r.date[2]=1):r.date[2]=z.innerText,r.options.time?(r.date[3]=te.value,r.date[4]=be.value):r.close(null,!0)}ne()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var xe=new Date,z=r.date&&l.isNumeric(r.date[0])?r.date[0]:parseInt(xe.getFullYear()),ee=r.date&&l.isNumeric(r.date[1])?r.date[1]:parseInt(xe.getMonth())+1,C=r.date&&l.isNumeric(r.date[2])?r.date[2]:parseInt(xe.getDate()),F=r.date&&l.isNumeric(r.date[3])?r.date[3]:parseInt(xe.getHours()),J=r.date&&l.isNumeric(r.date[4])?r.date[4]:parseInt(xe.getMinutes());r.date=[z,ee,C,F,J,0],we.innerHTML=z,fe.innerHTML=r.options.months[ee-1];var de=xe.getMonth()==ee-1&&xe.getFullYear()==z,Q=xe.getDate(),xe=new Date(z,ee,0,0,0),pe=xe.getDate(),xe=new Date(z,ee-1,0,0,0),_e=xe.getDay()+1,Je=r.options.startingDay||0;_e=_e-Je,Me.innerHTML="";var je=document.createElement("tr");je.setAttribute("align","center"),Me.appendChild(je);for(var Fe=0;Fe<7;Fe++){var He=document.createElement("td");He.classList.add("jcalendar-weekday"),He.innerHTML=r.options.weekdays[Je].substr(0,1),je.appendChild(He),Je++,Je>6&&(Je=0)}for(var Je=0,se=0,Ee=0;Ee<6;Ee++){var je=document.createElement("tr");je.setAttribute("align","center"),je.style.height="34px";for(var Fe=0;Fe<7;Fe++){var He=document.createElement("td");if(He.classList.add("jcalendar-set-day"),Je>=_e&&Je<_e+pe){se++,He.innerHTML=se,se==C&&He.classList.add("jcalendar-selected"),de&&Q==se&&(He.style.fontWeight="bold");var Ae=A.now(new Date(z,ee-1,se),!0);if(r.options.validRange){if(!r.options.validRange[0]||Ae>=r.options.validRange[0])var qe=!0;else var qe=!1;if(!r.options.validRange[1]||Ae<=r.options.validRange[1])var tt=!0;else var tt=!1;qe&&tt||He.classList.add("jcalendar-disabled")}}je.appendChild(He),Je++}Me.appendChild(je)}r.options.time?Oe.style.display="":Oe.style.display="none",ne()},r.getMonths=function(){r.options.mode="months";var z=r.options.months;r.options.value;var ee=new Date,C=parseInt(ee.getFullYear()),F=parseInt(ee.getMonth())+1,J=r.date&&l.isNumeric(r.date[0])?r.date[0]:C,de=r.date&&l.isNumeric(r.date[1])?r.date[1]:F;we.innerHTML=r.date[0],fe.innerHTML=z[de-1];var Q=document.createElement("table");Q.setAttribute("width","100%");for(var pe=null,xe=0;xe<12;xe++){if(!(xe%4)){var pe=document.createElement("tr");pe.setAttribute("align","center"),Q.appendChild(pe)}var _e=document.createElement("td");if(_e.classList.add("jcalendar-set-month"),_e.setAttribute("data-value",xe+1),_e.innerText=z[xe],r.options.validRange){var je=J+"-"+l.two(xe+1);if(!r.options.validRange[0]||je>=r.options.validRange[0].substr(0,7))var Fe=!0;else var Fe=!1;if(!r.options.validRange[1]||je<=r.options.validRange[1].substr(0,7))var He=!0;else var He=!1;Fe&&He||_e.classList.add("jcalendar-disabled")}xe+1==de&&_e.classList.add("jcalendar-selected"),C==J&&xe+1==F&&(_e.style.fontWeight="bold"),pe.appendChild(_e)}Me.innerHTML='<tr><td colspan="7"></td></tr>',Me.children[0].children[0].appendChild(Q),ne()},r.getYears=function(){r.options.mode="years";for(var z=new Date,ee=z.getFullYear(),C=r.date&&l.isNumeric(r.date[0])?r.date[0]:parseInt(z.getFullYear()),F=[],J=0;J<25;J++)F[J]=parseInt(r.date[0])+(J-12);var de=document.createElement("table");de.setAttribute("width","100%");for(var J=0;J<25;J++){if(!(J%5)){var Q=document.createElement("tr");Q.setAttribute("align","center"),de.appendChild(Q)}var pe=document.createElement("td");pe.classList.add("jcalendar-set-year"),pe.innerText=F[J],C==F[J]&&pe.classList.add("jcalendar-selected"),ee==F[J]&&(pe.style.fontWeight="bold"),Q.appendChild(pe)}Me.innerHTML='<tr><td colspan="7"></td></tr>',Me.firstChild.firstChild.appendChild(de),ne()},r.setLabel=function(z,ee){return A.getDateString(z,ee)},r.fromFormatted=function(z,ee){return A.extractDateFromString(z,ee)};var U=function(z){var ee=l.findElement(z.target,"jcalendar-container");if(ee){var C=z.target.className;if(C=="jcalendar-prev")r.prev();else if(C=="jcalendar-next")r.next();else if(C=="jcalendar-month")r.getMonths();else if(C=="jcalendar-year")r.getYears();else if(C=="jcalendar-set-year")r.date[0]=z.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(z.target.classList.contains("jcalendar-set-month")){var F=parseInt(z.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(z.target,F):(r.date[1]=F,r.getDays())}else C=="jcalendar-confirm"||C=="jcalendar-update"||C=="jcalendar-close"?r.close(null,!0):C=="jcalendar-backdrop"?r.close(!1,!1):C=="jcalendar-reset"?r.reset():z.target.classList.contains("jcalendar-set-day")&&z.target.innerText&&r.update(z.target)}else r.close(!1,!1)},re=function(z){if(z.target.value&&z.target.value.length>3){var ee=A.extractDateFromString(z.target.value,r.options.format);ee&&r.setValue(ee)}},ne=function(){var z=R.querySelector(".jcalendar-selected");z&&z.classList.contains("jcalendar-disabled")?(et.setAttribute("disabled","disabled"),te.setAttribute("disabled","disabled"),be.setAttribute("disabled","disabled")):(et.removeAttribute("disabled"),te.removeAttribute("disabled"),be.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(I,r.getValue())},R=null,_=null,q=null,Z=null,ie=null,we=null,fe=null,ve=null,Me=null,Se=null,Oe=null,Ge=null,et=null,te=null,be=null,Te=function(){I.tagName=="INPUT"&&I.value&&(d.value=I.value),_=document.createElement("div"),_.className="jcalendar-reset",q=document.createElement("div"),q.className="jcalendar-confirm",Se=document.createElement("div"),Se.className="jcalendar-controls",Se.style.borderBottom="1px solid #ddd",Se.appendChild(_),Se.appendChild(q),Z=document.createElement("div"),Z.className="jcalendar-container",ie=document.createElement("div"),ie.className="jcalendar-content",Z.appendChild(ie),I.tagName=="DIV"?(R=I,R.classList.add("jcalendar-inline")):(ie.appendChild(Se),R=document.createElement("div"),R.className="jcalendar"),R.classList.add("jcalendar-container"),R.appendChild(Z);var z=document.createElement("div");z.className="jcalendar-table",ie.appendChild(z);var ee=document.createElement("td");ee.setAttribute("colspan","2"),ee.className="jcalendar-prev",we=document.createElement("span"),we.className="jcalendar-year",fe=document.createElement("span"),fe.className="jcalendar-month";var C=document.createElement("td");C.className="jcalendar-header",C.setAttribute("colspan","3"),C.appendChild(fe),C.appendChild(we);var F=document.createElement("td");F.setAttribute("colspan","2"),F.className="jcalendar-next";var J=document.createElement("thead"),de=document.createElement("tr");de.appendChild(ee),de.appendChild(C),de.appendChild(F),J.appendChild(de),ve=document.createElement("table"),Me=document.createElement("tbody"),ve.setAttribute("cellpadding","0"),ve.setAttribute("cellspacing","0"),ve.appendChild(J),ve.appendChild(Me),z.appendChild(ve),te=document.createElement("select"),te.className="jcalendar-select",te.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(I,r.getValue())};for(var Q=0;Q<24;Q++){var pe=document.createElement("option");pe.value=Q,pe.innerHTML=l.two(Q),te.appendChild(pe)}be=document.createElement("select"),be.className="jcalendar-select",be.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(I,r.getValue())};for(var Q=0;Q<60;Q++){var pe=document.createElement("option");pe.value=Q,pe.innerHTML=l.two(Q),be.appendChild(pe)}var xe=document.createElement("div");xe.className="jcalendar-controls",Oe=document.createElement("div"),Oe.className="jcalendar-time",Oe.style.maxWidth="140px",Oe.appendChild(te),Oe.appendChild(be),et=document.createElement("button"),et.setAttribute("type","button"),et.className="jcalendar-update",Ge=document.createElement("div"),Ge.style.flexGrow="10",Ge.appendChild(et),xe.appendChild(Oe),I.tagName=="INPUT"&&xe.appendChild(Ge),ie.appendChild(xe);var _e=document.createElement("div");_e.className="jcalendar-backdrop",R.appendChild(_e),I.addEventListener("keyup",re),R.addEventListener("swipeleft",function(je){L.slideLeft(ve,0,function(){r.next(),L.slideRight(ve,1)}),je.preventDefault(),je.stopPropagation()}),R.addEventListener("swiperight",function(je){L.slideRight(ve,0,function(){r.prev(),L.slideLeft(ve,1)}),je.preventDefault(),je.stopPropagation()}),"ontouchend"in document.documentElement?(R.addEventListener("touchend",U),I.addEventListener("touchend",r.open)):(R.addEventListener("mouseup",U),I.addEventListener("mouseup",r.open)),A.hasEvents||(A.hasEvents=!0,document.addEventListener("keydown",A.keydown)),r.setOptions(d),I.tagName=="INPUT"?(I.parentNode.insertBefore(R,I.nextSibling),I.setAttribute("autocomplete","off"),I.classList.add("jcalendar-input"),I.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(te.value=r.date[3],be.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&Z.classList.add("jcalendar-hide-controls"),I.change=r.setValue,I.val=function(je){if(je===void 0)return r.getValue();r.setValue(je)},I.calendar=R.calendar=r};return Te(),r};return A.keydown=function(I){var d=null;(d=A.current)&&(I.which==13?d.close(!1,!0):I.which==27&&d.close(!1,!1))},A.prettify=function(I,d){if(!d)var d={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};I.indexOf("GMT")===-1&&I.indexOf("Z")===-1&&(I+=" GMT");var r=new Date,U=new Date(I),re=parseInt((r-U)/1e3/60);if(String.prototype.format=function(R){return this.replace("{0}",R)},re==0)var ne=d.justNow;else if(re<90)var ne=d.xMinutesAgo.format(re);else if(re<1440)var ne=d.xHoursAgo.format(Math.round(re/60));else if(re<20160)var ne=d.xDaysAgo.format(Math.round(re/1440));else if(re<43200)var ne=d.xWeeksAgo.format(Math.round(re/10080));else if(re<1036800)var ne=d.xMonthsAgo.format(Math.round(re/43200));else var ne=d.xYearsAgo.format(Math.round(re/525600));return ne},A.prettifyAll=function(){for(var I=document.querySelectorAll(".prettydate"),d=0;d<I.length;d++)I[d].getAttribute("data-date")?I[d].innerHTML=A.prettify(I[d].getAttribute("data-date")):I[d].innerHTML&&(I[d].setAttribute("title",I[d].innerHTML),I[d].setAttribute("data-date",I[d].innerHTML),I[d].innerHTML=A.prettify(I[d].innerHTML))},A.now=N.now,A.toArray=N.toArray,A.dateToNum=N.dateToNum,A.numToDate=N.numToDate,A.weekdays=N.weekdays,A.months=N.months,A.weekdaysShort=N.weekdaysShort,A.monthsShort=N.monthsShort,A.extractDateFromString=O.extractDateFromString,A.getDateString=O.getDateString,A}var V=Y();function ue(){var A={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},I=function(d){return A[d]?A[d]:A.material};return I.get=function(d){return A[d]?A[d]:A},I.set=function(d,r){A[d]=r},I}var ge=ue();function G(A,I){var d={};d.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var U in r)I&&I.hasOwnProperty(U)?d.options[U]=I[U]:d.options[U]=r[U];A.classList.add("jtabs");var re=null,ne=null,R=null;const _=function(fe){d.options.animation&&setTimeout(function(){let ve=d.headers.children[fe].getBoundingClientRect();d.options.palette==="modern"?(R.style.width=ve.width-4+"px",R.style.left=d.headers.children[fe].offsetLeft+2+"px"):(R.style.width=ve.width+"px",R.style.left=d.headers.children[fe].offsetLeft+"px"),d.options.position==="bottom"?R.style.top="0px":R.style.bottom="0px"},50)};var q=function(fe){typeof d.headers.scrollTo=="function"?d.headers.scrollTo({left:fe,behavior:"smooth"}):d.headers.scrollLeft=fe,fe<=1?re.classList.add("disabled"):re.classList.remove("disabled"),fe>=d.headers.scrollWidth-d.headers.offsetWidth?ne.classList.add("disabled"):ne.classList.remove("disabled"),d.headers.scrollWidth<=d.headers.offsetWidth?(re.style.display="none",ne.style.display="none"):(re.style.display="",ne.style.display="")};if(d.setBorder=_,d.open=function(fe){if(Array.from(d.content.children),!!d.content.children[fe]){for(var ve=null,Me=0;Me<d.headers.children.length;Me++)d.headers.children[Me].classList.contains("jtabs-selected")&&(ve=Me),d.headers.children[Me].classList.remove("jtabs-selected"),d.headers.children[Me].removeAttribute("aria-selected"),d.content.children[Me]&&d.content.children[Me].classList.remove("jtabs-selected");if(d.headers.children[fe].classList.add("jtabs-selected"),d.headers.children[fe].setAttribute("aria-selected","true"),d.content.children[fe]&&d.content.children[fe].classList.add("jtabs-selected"),ve!=fe&&typeof d.options.onchange=="function"&&d.content.children[fe]&&d.options.onchange(A,d,fe,d.headers.children[fe],d.content.children[fe]),d.options.hideHeaders==!0&&d.headers.children.length<3&&d.options.allowCreate==!1)d.headers.parentNode.style.display="none";else{d.headers.parentNode.style.display="";var Se=d.headers.children[fe].offsetLeft,Oe=Se+d.headers.children[fe].offsetWidth,Ge=d.headers.scrollLeft,et=Ge+d.headers.offsetWidth;Ge<=Se&&et>=Oe||q(Se-1),_(fe)}}},d.selectIndex=function(fe){var ve=Array.prototype.indexOf.call(d.headers.children,fe);return ve>=0&&d.open(ve),ve},d.rename=function(fe,ve){ve||(ve=prompt("New title",d.headers.children[fe].innerText)),d.headers.children[fe].innerText=ve,_(d.getActive())},d.create=function(fe,ve){if(typeof d.options.onbeforecreate=="function"){var Me=d.options.onbeforecreate(A,fe);if(Me===!1)return!1;fe=Me}var Se=d.appendElement(fe);return typeof d.options.oncreate=="function"&&d.options.oncreate(A,Se),_(d.getActive()),Se},d.remove=function(fe){return d.deleteElement(fe)},d.nextNumber=function(){for(var fe=0,ve=0;ve<d.headers.children.length;ve++){var Me=d.headers.children[ve].innerText.match(/[0-9].*/);Me>fe&&(fe=parseInt(Me))}return fe?fe++:fe=1,fe},d.deleteElement=function(fe){let ve=d.getActive();if(d.headers.children[fe])d.headers.removeChild(d.headers.children[fe]),d.content.removeChild(d.content.children[fe]);else return!1;if(ve===fe)d.open(0);else{let Me=d.getActive()||0;_(Me)}typeof d.options.ondelete=="function"&&d.options.ondelete(A,fe)},d.appendElement=function(fe,ve,Me,Se){if(!fe)var fe=prompt("Title?","");if(fe){let et=l.guid(),te=l.guid();var Oe=document.createElement("div");Oe.setAttribute("id",te),Oe.setAttribute("role","tabpanel"),Oe.setAttribute("aria-labelledby",et);var Ge=document.createElement("div");if(Ge.setAttribute("id",et),Ge.setAttribute("role","tab"),Ge.setAttribute("aria-controls",te),Ge.innerHTML=fe,Ge.content=Oe,typeof Se>"u")d.content.appendChild(Oe),d.headers.insertBefore(Ge,d.headers.lastChild);else{let be=d.content.children[Se];be?d.content.insertBefore(Oe,be):d.content.appendChild(Oe),be=d.headers.children[Se]||d.headers.lastChild,d.headers.insertBefore(Ge,be)}return d.options.allowChangePosition&&Ge.setAttribute("draggable","true"),Me!==!1&&d.selectIndex(Ge),typeof ve=="function"&&ve(Oe,Ge),Oe}},d.getActive=function(){for(var fe=0;fe<d.headers.children.length;fe++)if(d.headers.children[fe].classList.contains("jtabs-selected"))return fe;return!1},d.updateContent=function(fe,ve){if(typeof ve!="string")var Me=ve;else{var Me=document.createElement("div");Me.innerHTML=ve}d.content.children[fe].classList.contains("jtabs-selected")&&ve.classList.add("jtabs-selected"),d.content.replaceChild(ve,d.content.children[fe]),_()},d.updatePosition=function(fe,ve,Me,Se){if(fe>ve?d.content.insertBefore(d.content.children[fe],d.content.children[ve]):d.content.insertBefore(d.content.children[fe],d.content.children[ve].nextSibling),Se!==!1)d.open(ve);else{const Oe=d.getActive();ve<Oe&&d.setBorder(Oe)}!Me&&typeof d.options.onchangeposition=="function"&&d.options.onchangeposition(d.headers,fe,ve)},d.move=function(fe,ve,Me,Se){fe>ve?d.headers.insertBefore(d.headers.children[fe],d.headers.children[ve]):d.headers.insertBefore(d.headers.children[fe],d.headers.children[ve].nextSibling),d.updatePosition(fe,ve,Me,Se)},d.setBorder=_,d.init=function(){A.innerHTML="",d.headers=document.createElement("div"),d.content=document.createElement("div"),d.headers.classList.add("jtabs-headers"),d.headers.setAttribute("role","tablist"),d.content.classList.add("jtabs-content"),d.content.setAttribute("role","region"),d.content.setAttribute("aria-label","Tab Panels"),d.options.palette?A.classList.add("jtabs-modern"):A.classList.remove("jtabs-modern"),d.options.padding&&(d.content.style.padding=parseInt(d.options.padding)+"px");var fe=document.createElement("div");fe.className="jtabs-headers-container",fe.appendChild(d.headers),d.options.maxWidth&&(fe.style.maxWidth=parseInt(d.options.maxWidth)+"px");var ve=document.createElement("div");if(ve.className="jtabs-controls",ve.setAttribute("draggable","false"),fe.appendChild(ve),d.options.position=="bottom"?(A.appendChild(d.content),A.appendChild(fe)):(A.appendChild(fe),A.appendChild(d.content)),d.options.allowCreate==!0){var Me=document.createElement("div");Me.className="jtabs-add",Me.onclick=function(){d.create()},ve.appendChild(Me)}re=document.createElement("div"),re.className="jtabs-prev",re.onclick=function(){q(d.headers.scrollLeft-d.headers.offsetWidth)},ve.appendChild(re),ne=document.createElement("div"),ne.className="jtabs-next",ne.onclick=function(){q(d.headers.scrollLeft+d.headers.offsetWidth)},ve.appendChild(ne);for(var Se=0;Se<d.options.data.length;Se++){if(d.options.data[Se].titleElement)var Oe=d.options.data[Se].titleElement;else var Oe=document.createElement("div");if(d.options.data[Se].icon){var Ge=document.createElement("div"),et=document.createElement("i");et.classList.add("material-icons"),et.innerHTML=d.options.data[Se].icon,Ge.appendChild(et),Oe.appendChild(Ge)}if(d.options.data[Se].title){var te=document.createTextNode(d.options.data[Se].title);Oe.appendChild(te)}if(d.options.data[Se].width&&(Oe.style.width=d.options.data[Se].width),d.options.data[Se].contentElement)var be=d.options.data[Se].contentElement;else{var be=document.createElement("div");be.innerHTML=d.options.data[Se].content}d.headers.appendChild(Oe),d.content.appendChild(be)}R=document.createElement("div"),R.className="jtabs-border",d.headers.appendChild(R),d.options.animation&&A.classList.add("jtabs-animation"),d.headers.addEventListener("click",function(Te){if(Te.target.parentNode.classList.contains("jtabs-headers"))var z=Te.target;else if(Te.target.tagName=="I")var z=Te.target.parentNode.parentNode;else var z=Te.target.parentNode;var ee=d.selectIndex(z);typeof d.options.onclick=="function"&&d.options.onclick(A,d,ee,d.headers.children[ee],d.content.children[ee])}),d.headers.addEventListener("contextmenu",function(Te){d.selectIndex(Te.target)}),d.headers.children.length&&d.open(0),q(0),d.options.allowChangePosition==!0&&h(d.headers,{direction:1,ondrop:function(Te,z,ee){d.updatePosition(z,ee)}}),typeof d.options.onload=="function"&&d.options.onload(A,d)},A.children[0]&&A.children[0].children.length)for(var Z=0;Z<A.children[0].children.length;Z++){var ie=d.options.data&&d.options.data[Z]?d.options.data[Z]:{};A.children[1]&&A.children[1].children[Z]?(ie.titleElement=A.children[0].children[Z],ie.contentElement=A.children[1].children[Z]):ie.contentElement=A.children[0].children[Z],d.options.data[Z]=ie}var we=!1;if(d.options.data)for(var Z=0;Z<d.options.data.length;Z++)d.options.data[Z].url&&(v({url:d.options.data[Z].url,type:"GET",dataType:"text/html",index:Z,success:function(ve){d.options.data[this.index].content=ve},complete:function(){d.init()}}),we=!0);return we||d.init(),A.tabs=d,d}function ae(A,I){if(A.color)return A.color.setOptions(I,!0);var d={type:"color"};d.options={};var r=null,U=null,re=null,ne=null,R=null,_=null,q=null;d.setOptions=function(C,F){var J={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};C||(C={}),C&&!C.palette&&(C.palette=ge());for(var de in J)C&&C.hasOwnProperty(de)?d.options[de]=C[de]:(typeof d.options[de]>"u"||F===!0)&&(d.options[de]=J[de]);return ne&&(ne.innerHTML=d.options.resetLabel),R&&(R.innerHTML=d.options.doneLabel),d.options.palette&&q&&q.updateContent(0,ve()),typeof d.options.value=="string"&&(A.value=d.options.value,A.tagName==="INPUT"&&(A.style.color=A.value,A.style.backgroundColor=A.value)),d.options.placeholder?A.setAttribute("placeholder",d.options.placeholder):A.getAttribute("placeholder")&&A.removeAttribute("placeholder"),d},d.select=function(C){var F=r.querySelector(".jcolor-selected");F&&F.classList.remove("jcolor-selected"),d.values[C]&&d.values[C].classList.add("jcolor-selected"),d.options.value=C},d.open=function(){if(!r.classList.contains("jcolor-focus")){S(d,!0),r.classList.add("jcolor-focus"),d.options.value&&d.select(d.options.value),re.style.marginTop="",re.style.marginLeft="";var C=re.getBoundingClientRect(),F=l.getWindowWidth(),J=l.getWindowHeight();if(F<800||d.options.fullscreen==!0?(re.classList.add("jcolor-fullscreen"),L.slideBottom(re,1),U.style.display="block"):(re.classList.contains("jcolor-fullscreen")&&(re.classList.remove("jcolor-fullscreen"),U.style.display=""),d.options.position?re.style.position="fixed":re.style.position="",C.left+C.width>F&&(re.style.marginLeft=-1*(C.left+C.width-(F-20))+"px"),C.top+C.height>J&&(re.style.marginTop=-1*(C.top+C.height-(J-20))+"px")),typeof d.options.onopen=="function"&&d.options.onopen(A,d),q.setBorder(q.getActive()),d.options.value){var de=fe(d.options.value);be.forEach(function(Q,pe){Q.value=de[pe],Q.dispatchEvent(new Event("input"))})}}},d.close=function(C){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),U.style.display="",!C&&typeof d.options.onclose=="function"&&d.options.onclose(A,d),S(d,!1)),d.options.value},d.setValue=function(C){C||(C=""),C!=d.options.value&&(d.options.value=C,te=C,d.select(C),typeof d.options.onchange=="function"&&d.options.onchange(A,C,d),A.value!=d.options.value&&(A.value=d.options.value,A.tagName==="INPUT"&&(A.style.color=A.value,A.style.backgroundColor=A.value),typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),d.options.closeOnChange==!0&&d.close())},d.getValue=function(){return d.options.value};var Z=function(C){var F=C.toString(16);return F.length===1?"0"+F:F},ie=function(C,F,J){return"#"+Z(C)+Z(F)+Z(J)},we=function(C){return parseInt("0x"+C)},fe=function(C){return[we(C.substr(1,2)),we(C.substr(3,2)),we(C.substr(5,2))]},ve=function(){var C=document.createElement("div");C.className="jcolor-grid",d.values=[];var F=document.createElement("table");F.setAttribute("cellpadding","7"),F.setAttribute("cellspacing","0");for(var J=0;J<d.options.palette.length;J++){for(var de=document.createElement("tr"),Q=0;Q<d.options.palette[J].length;Q++){var pe=document.createElement("td"),xe=d.options.palette[J][Q];xe.length<7&&xe.substr(0,1)!=="#"&&(xe="#"+xe),pe.style.backgroundColor=xe,pe.setAttribute("data-value",xe),pe.innerHTML="",de.appendChild(pe),d.options.value==xe&&pe.classList.add("jcolor-selected"),d.values[xe]=pe}F.appendChild(de)}return C.appendChild(F),C},Me=document.createElement("canvas");Me.width=200,Me.height=160;var Se=Me.getContext("2d"),Oe=function(){var C=_.firstChild.getBoundingClientRect();Me.width=C.width-14,Ge()},Ge=function(){var C=Se.createLinearGradient(0,0,Me.width,0);C.addColorStop(0,"rgb(255,0,0)"),C.addColorStop(.15,"rgb(255,0,255)"),C.addColorStop(.33,"rgb(0,0,255)"),C.addColorStop(.49,"rgb(0,255,255)"),C.addColorStop(.67,"rgb(0,255,0)"),C.addColorStop(.84,"rgb(255,255,0)"),C.addColorStop(1,"rgb(255,0,0)"),Se.fillStyle=C,Se.fillRect(0,0,Me.width,Me.height),C=Se.createLinearGradient(0,0,0,Me.height),C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.5,"rgba(255,255,255,0)"),C.addColorStop(.5,"rgba(0,0,0,0)"),C.addColorStop(1,"rgba(0,0,0,1)"),Se.fillStyle=C,Se.fillRect(0,0,Me.width,Me.height)},et=function(){var C=document.createElement("div");C.className="jcolor-hsl";var F=document.createElement("div");F.className="jcolor-point";var J=document.createElement("div");J.appendChild(Me),J.appendChild(F),C.appendChild(J);var de=function(Q,pe,xe){if(Q===1){var _e=C.getBoundingClientRect(),je=pe-_e.left,Fe=xe-_e.top;je<0&&(je=0),Fe<0&&(Fe=0),je>_e.width&&(je=_e.width),Fe>_e.height&&(Fe=_e.height),F.style.left=je+"px",F.style.top=Fe+"px";var He=Se.getImageData(je,Fe,1,1).data;te=ie(He[0],He[1],He[2])}};return C.addEventListener("mousedown",function(Q){de(Q.buttons,Q.clientX,Q.clientY)}),C.addEventListener("mousemove",function(Q){de(Q.buttons,Q.clientX,Q.clientY)}),C.addEventListener("touchmove",function(Q){de(1,Q.changedTouches[0].clientX,Q.changedTouches[0].clientY)}),C},te="",be=[],Te=function(){if(te!=="")for(var C=0;C<be.length;C++){var F=fe(te);F[C]=0;var J="linear-gradient(90deg, rgb(";J+=F.join(", "),J+="), rgb(",F[C]=255,J+=F.join(", "),J+="))",be[C].style.backgroundImage=J}},z=function(){var C=document.createElement("div");C.className="jcolor-sliders";var F=document.createElement("div"),J=function(xe){var _e=document.createElement("div");_e.className="jcolor-sliders-input-container";var je=document.createElement("label");je.innerText=xe;var Fe=document.createElement("div");Fe.className="jcolor-sliders-input-subcontainer";var He=document.createElement("input");He.type="range",He.min=0,He.max=255,He.value=0,He.setAttribute("aria-label","Color value"),He.setAttribute("aria-valuemin","0"),He.setAttribute("aria-valuemax","255"),He.setAttribute("aria-valuenow","0"),_e.appendChild(je),Fe.appendChild(He);var Je=document.createElement("div");return Je.innerText=He.value,He.addEventListener("input",function(){Je.innerText=He.value}),Fe.appendChild(Je),_e.appendChild(Fe),F.appendChild(_e),He};be=[J("Red"),J("Green"),J("Blue")],C.appendChild(F);var de=document.createElement("div");de.className="jcolor-sliders-final-color";var Q=document.createElement("div");Q.style.visibility="hidden",Q.innerText="a",de.appendChild(Q);var pe=function(){var xe=ie(parseInt(be[0].value),parseInt(be[1].value),parseInt(be[2].value));Q.innerText=xe,Q.style.color=xe,Q.style.removeProperty("visibility"),te=xe};return be.forEach(function(xe){xe.addEventListener("input",function(){pe(),Te()})}),C.appendChild(de),C},ee=function(){d.setOptions(I),A.tagName=="INPUT"&&(A.classList.add("jcolor-input"),A.readOnly=!0),r=document.createElement("div"),r.className="jcolor",U=document.createElement("div"),U.className="jcolor-backdrop",r.appendChild(U),re=document.createElement("div"),re.className="jcolor-content";var C=document.createElement("div");C.className="jcolor-controls",re.appendChild(C),ne=document.createElement("div"),ne.className="jcolor-reset",ne.innerHTML=d.options.resetLabel,C.appendChild(ne),R=document.createElement("div"),R.className="jcolor-close",R.innerHTML=d.options.doneLabel,C.appendChild(R),_=document.createElement("div"),re.appendChild(_),q=G(_,{animation:!0,data:[{title:"Grid",contentElement:ve()},{title:"Spectrum",contentElement:et()},{title:"Sliders",contentElement:z()}],onchange:function(F,J,de){if(de===1)Oe();else{var Q=te!==""?te:d.getValue();if(de===2&&Q){var pe=fe(Q);be.forEach(function(xe,_e){xe.value=pe[_e],xe.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(re),A.tagName=="INPUT"?A.parentNode.insertBefore(r,A.nextSibling):A.appendChild(r),r.addEventListener("click",function(F){if(F.target.tagName=="TD"){var J=F.target.getAttribute("data-value");J&&d.setValue(J)}else F.target.classList.contains("jcolor-reset")?(d.setValue(""),d.close()):F.target.classList.contains("jcolor-close")?(q.getActive()>0&&d.setValue(te),d.close()):F.target.classList.contains("jcolor-backdrop")?d.close():d.open()}),A.addEventListener("mouseup",function(F){d.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&q.getActive()==1&&Oe()}),d.options.opened==!0&&d.open(),A.change=d.setValue,A.val=function(F){if(F===void 0)return d.getValue();d.setValue(F)},A.color=d,r.color=d};return d.toHex=function(C){var F=function(J){return("0"+parseInt(J).toString(16)).slice(-2)};if(C)return/^#[0-9A-F]{6}$/i.test(C)?C:(C=C.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),C&&C.length?"#"+F(C[1])+F(C[2])+F(C[3]):"")},ee(),d}function he(){var A=function(I,d){var r={type:"contextmenu"};r.options={};var U={items:null,onclick:null};for(var re in U)d&&d.hasOwnProperty(re)?r.options[re]=d[re]:r.options[re]=U[re];I.classList.add("jcontextmenu"),r.open=function(_,q){if(q&&(r.options.items=q,r.create(q)),A.current&&A.current.close(),S(r,!0),I.classList.add("jcontextmenu-focus"),A.current=r,r.options.items&&r.options.items.length>0||I.children.length){if(_.target)if(_.changedTouches&&_.changedTouches[0])Z=_.changedTouches[0].clientX,ie=_.changedTouches[0].clientY;else var Z=_.clientX,ie=_.clientY;else var Z=_.x,ie=_.y;var we=I.getBoundingClientRect();if(window.innerHeight<ie+we.height){var fe=ie-we.height;fe<0&&(fe=0),I.style.top=fe+"px"}else I.style.top=ie+"px";window.innerWidth<Z+we.width?Z-we.width>0?I.style.left=Z-we.width+"px":I.style.left="10px":I.style.left=Z+"px"}},r.isOpened=function(){return!!I.classList.contains("jcontextmenu-focus")},r.close=function(){I.classList.contains("jcontextmenu-focus")&&I.classList.remove("jcontextmenu-focus"),S(r,!1)},r.create=function(_){I.innerHTML="";var q=ne();I.appendChild(q);for(var Z=0;Z<_.length;Z++){var ie=R(_[Z]);I.appendChild(ie)}};function ne(){var _=document.createElement("div");_.classList.add("header"),_.addEventListener("click",function(ie){ie.preventDefault(),ie.stopPropagation()});var q=document.createElement("a");q.classList.add("title"),q.innerHTML=s.translate("Menu"),_.appendChild(q);var Z=document.createElement("a");return Z.classList.add("close"),Z.innerHTML=s.translate("close"),Z.addEventListener("click",function(ie){r.close()}),_.appendChild(Z),_}function R(_){if(_.type&&(_.type=="line"||_.type=="divisor"))var q=document.createElement("hr");else{var q=document.createElement("div"),Z=document.createElement("a");if(Z.innerHTML=_.title,_.tooltip&&q.setAttribute("title",_.tooltip),_.icon&&q.setAttribute("data-icon",_.icon),_.id&&(q.id=_.id),_.disabled?q.className="jcontextmenu-disabled":_.onclick&&(q.method=_.onclick,q.addEventListener("mousedown",function(Ge){Ge.preventDefault()}),q.addEventListener("mouseup",function(Ge){this.method(this,Ge)})),q.appendChild(Z),_.submenu){var ie=document.createElement("span");ie.innerHTML="&#9658;",q.appendChild(ie),q.classList.add("jcontexthassubmenu");var we=document.createElement("div");we.classList.add("jcontextmenu"),we.setAttribute("tabindex","900");for(var fe=_.submenu,ve=0;ve<fe.length;ve++){var Me=R(fe[ve]);we.appendChild(Me)}q.appendChild(we)}else if(_.shortcut){var Se=document.createElement("span");Se.innerHTML=_.shortcut,q.appendChild(Se)}}return q}return typeof r.options.onclick=="function"&&I.addEventListener("click",function(_){r.options.onclick(r,_)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),I.contextmenu=r,r};return A}var ce=he();function oe(){var A=function(I,d){if(I.dropdown)return I.dropdown.setOptions(d,!0);var r={type:"dropdown"};r.options={};var U=function(z,ee){z&&z.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?z.sort(r.options.sortResults):z.sort(re)),r.setData(z)),typeof r.options.onload=="function"&&r.options.onload(I,r,z,ee),ee&&R(ee),ee==null&&(r.options.value=""),I.value=r.options.value,r.options.opened==!0&&r.open()},re=function(z,ee){var C,F;return typeof z=="string"?C=z:z.text?C=z.text:z.name&&(C=z.name),typeof ee=="string"?F=ee:ee.text?F=ee.text:ee.name&&(F=ee.name),typeof C=="string"||typeof F=="string"?(typeof C!="string"&&(C=""+C),typeof F!="string"&&(F=""+F),C.localeCompare(F)):C-F},ne=function(){r.value={};for(var z=0;z<r.items.length;z++)r.items[z].selected==!0&&(r.items[z].element&&r.items[z].element.classList.remove("jdropdown-selected"),r.items[z].selected=null);r.options.value="",I.value=""},R=function(z){if(ne(),z!==null)if(!z)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(z)||(z=(""+z).split(";"));for(var ee=0;ee<z.length;ee++)r.value[z[ee]]=""}for(var ee=0;ee<r.items.length;ee++)typeof r.value[_(ee)]<"u"&&(r.items[ee].element&&r.items[ee].element.classList.add("jdropdown-selected"),r.items[ee].selected=!0,r.value[_(ee)]=q(ee));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},_=function(z,ee){if(r.options.format)var C="id";else var C="value";return r.items[z]?r.items[z].data[C]:""},q=function(z,ee){if(r.options.format)var C="name";else var C="text";return r.items[z]?r.items[z].data[C]:""},Z=function(){return Object.keys(r.value)},ie=function(){for(var z=[],ee=Object.keys(r.value),C=0;C<ee.length;C++)z.push(r.value[ee[C]]);return z};r.setOptions=function(z,ee){z||(z={});var C={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var F in C)z&&z.hasOwnProperty(F)?r.options[F]=z[F]:(typeof r.options[F]>"u"||ee===!0)&&(r.options[F]=C[F]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),I.classList.remove("jdropdown-searchbar"),I.classList.remove("jdropdown-picker"),I.classList.remove("jdropdown-list"),r.options.type=="searchbar"?I.classList.add("jdropdown-searchbar"):r.options.type=="list"?I.classList.add("jdropdown-list"):r.options.type=="picker"?I.classList.add("jdropdown-picker"):l.getWindowWidth()<800?r.options.autocomplete?(I.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(I.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(I.style.width=r.options.width,I.style.minWidth=r.options.width):(I.style.removeProperty("width"),I.style.removeProperty("min-width")),I.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?we.appendChild(Me):fe.insertBefore(Me,fe.firstChild),r.options.url&&!z.data?v({url:r.options.url,method:"GET",dataType:"json",success:function(J){J&&U(J,r.options.value)}}):U(r.options.data,r.options.value),r};var we=null,fe=null,ve=null,Me=null,Se=null,Oe=null,Ge=null,et=function(){if(d||(d={}),I.tagName=="SELECT"){var z=A.extractFromDom(I,d);I=z.el,d=z.options}!d.placeholder&&I.getAttribute("placeholder")&&(d.placeholder=I.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,I.classList.add("jdropdown"),we=document.createElement("div"),we.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(I)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(I)},r.header.onkeyup=function(ee){r.options.autocomplete==!0&&!Ge?(r.search!=r.header.value.trim()&&(Ge=setTimeout(function(){r.find(r.header.value.trim()),Ge=null},400)),I.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(ee.key)},A.hasEvents||(A.hasEvents=!0,document.addEventListener("keydown",A.keydown)),fe=document.createElement("div"),fe.className="jdropdown-container",ve=document.createElement("div"),ve.className="jdropdown-content",Me=document.createElement("div"),Me.className="jdropdown-close",Me.textContent="Done",Se=document.createElement("div"),Se.className="jdropdown-reset",Se.textContent="x",Se.onclick=function(){r.reset(),r.close()},Oe=document.createElement("div"),Oe.className="jdropdown-backdrop",we.appendChild(r.header),fe.appendChild(ve),I.appendChild(we),I.appendChild(fe),I.appendChild(Oe),r.setOptions(d),"ontouchsend"in document.documentElement?I.addEventListener("touchsend",A.mouseup):I.addEventListener("mouseup",A.mouseup),r.options.lazyLoading==!0&&f(ve,{loadUp:r.loadUp,loadDown:r.loadDown}),ve.onwheel=function(ee){ee.stopPropagation()},I.change=r.setValue,I.val=function(ee){if(ee===void 0)return r.getValue(!!r.options.multiple);r.setValue(ee)},I.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(z,ee){r.options.url=z,v({url:r.options.url,method:"GET",dataType:"json",success:function(C){r.setData(C),typeof ee=="function"&&ee(r)}})},r.setId=function(z,ee){if(r.options.format)var C="id";else var C="value";typeof z=="object"?z[C]=ee:r.items[z].data[C]=ee};const te=function(z,ee){if(!z){let J=r.options.autocomplete==!0?r.header.value:"";if(z=prompt(s.translate("Add A New Option"),J),!z)return!1}if(ee||(ee=l.guid()),r.options.format)var C={id:ee,name:z};else var C={value:ee,text:z};if(typeof r.options.onbeforeinsert=="function"){let J=r.options.onbeforeinsert(r,C);if(J===!1)return!1;J&&(C=J)}r.options.data.push(C);var F=r.createItem(C);return ve.appendChild(F.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,C,F),ve.style.display=="none"&&(ve.style.display=""),r.results&&r.results.push(F),C};r.add=function(z,ee){return typeof r.options.prompt=="function"?r.options.prompt.call(r,te):te(z,ee)},r.createItem=function(z,ee,C){r.options.format?(!z.id&&z.value!==void 0&&(z.id=z.value),!z.name&&z.text!==void 0&&(z.name=z.text)):(!z.value&&z.id!==void 0&&(z.value=z.id),!z.text&&z.name!==void 0&&(z.text=z.name));var F={};if(F.element=document.createElement("div"),F.element.className="jdropdown-item",F.element.indexValue=r.items.length,F.data=z,ee&&(F.group=ee),z.id&&F.element.setAttribute("id",z.id),z.disabled==!0&&F.element.setAttribute("data-disabled",!0),z.tooltip&&F.element.setAttribute("title",z.tooltip),z.image){var J=document.createElement("img");J.className="jdropdown-image",J.src=z.image,z.title||J.classList.add("jdropdown-image-small"),F.element.appendChild(J)}else if(z.icon){var de=document.createElement("span");de.className="jdropdown-icon material-icons",de.innerText=z.icon,z.title||de.classList.add("jdropdown-icon-small"),z.color&&(de.style.color=z.color),F.element.appendChild(de)}else if(z.color){var Q=document.createElement("div");Q.className="jdropdown-color",Q.style.backgroundColor=z.color,F.element.appendChild(Q)}if(r.options.format)var pe=z.name;else var pe=z.text;var xe=document.createElement("div");if(xe.className="jdropdown-description",xe.textContent=pe||"&nbsp;",z.title){var _e=document.createElement("div");_e.className="jdropdown-title",_e.innerText=z.title,xe.appendChild(_e)}if(r.options.format)var je=z.id;else var je=z.value;return r.value[je]&&(F.element.classList.add("jdropdown-selected"),F.selected=!0),r.items.push(F),F.element.appendChild(xe),F},r.appendData=function(z){if(z.length){for(var ee=[],C=[],F=0;F<z.length;F++)z[F].group?(C[z[F].group]||(C[z[F].group]=[]),C[z[F].group].push(F)):ee.push(F);var J=0,de=Object.keys(C);if(de.length>0)for(var F=0;F<de.length;F++){var Q=document.createElement("div");Q.className="jdropdown-group";var pe=document.createElement("div");pe.className="jdropdown-group-name",pe.textContent=de[F];var xe=document.createElement("i");xe.className="jdropdown-group-arrow jdropdown-group-arrow-down",pe.appendChild(xe);var _e=document.createElement("div");_e.className="jdropdown-group-items";for(var je=0;je<C[de[F]].length;je++){var Fe=r.createItem(z[C[de[F]][je]],Q,de[F]);(r.options.lazyLoading==!1||J<200)&&(_e.appendChild(Fe.element),J++)}Q.appendChild(pe),Q.appendChild(_e),r.groups.push(Q),_e.children.length>0&&ve.appendChild(Q)}if(ee.length)for(var F=0;F<ee.length;F++){var Fe=r.createItem(z[ee[F]]);(r.options.lazyLoading==!1||J<200)&&(ve.appendChild(Fe.element),J++)}}},r.setData=function(z){if(ne(),ve.textContent="",r.header.value="",r.items=[],z&&z.length){for(var ee=0;ee<z.length;ee++)typeof z[ee]!="object"&&(r.options.format?z[ee]={id:z[ee],name:z[ee]}:z[ee]={value:z[ee],text:z[ee]});r.appendData(z),r.options.data=z}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(z){for(var ee=0;ee<r.items.length;ee++)if(_(ee)==z)return ee;return!1},r.getText=function(z){var ee=ie();return z?ee:ee.join("; ")},r.getValue=function(z){var ee=Z();return z?ee:ee.join(";")};var be=function(z){I.value!=r.options.value&&(I.value=r.options.value,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value})),typeof r.options.onchange=="function"&&r.options.onchange(I,r,z,r.options.value)};r.setValue=function(z){var ee=r.getValue();Array.isArray(z)&&(z=z.join(";")),ee!==z&&(R(z),be(ee))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(C,ee){var C=parseInt(C);if(r.items&&r.items[C]&&(ee===!0||r.items[C].data.disabled!==!0))if(r.setCursor(C,!1),!r.options.multiple)r.items[C].selected?r.options.allowEmpty!==!1&&r.setValue(null):r.setValue(_(C)),r.close();else{var F=r.options.value;r.items[C].selected?(r.items[C].element.classList.remove("jdropdown-selected"),r.items[C].selected=!1,delete r.value[_(C)]):(r.items[C].element.classList.add("jdropdown-selected"),r.items[C].selected=!0,r.value[_(C)]=q(C)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ie().join("; ")),be(F)}},r.selectItem=function(z){r.selectIndex(z.indexValue)};var Te=function(z,ee){for(var C=0;C<ee.length;C++)if(r.options.format){if(ee[C].id==z)return!0}else if(ee[C].value==z)return!0;return!1};return r.find=function(z){if(r.search==z.trim())return!1;if(r.search=z,r.setCursor(),r.groups.length)for(var ee=0;ee<r.groups.length;ee++)r.groups[ee].lastChild.textContent="";if(ve.textContent="",r.options.remoteSearch==!0){r.results=null;var C=r.options.url;let _e={url:C,method:"GET",data:{q:z},dataType:"json",success:function(je){r.items=[];var Fe=Object.keys(r.value);if(Fe.length)for(var He=0;He<Fe.length;He++)Te(Fe[He],je)||(r.options.format?je.unshift({id:Fe[He],name:r.value[Fe[He]]}):je.unshift({value:Fe[He],text:r.value[Fe[He]]}));r.appendData(je),je.length?ve.style.display="":ve.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,je)}};if(typeof r.options.onbeforesearch=="function"){let je=r.options.onbeforesearch(r,_e);if(je===!1)return;typeof je=="object"&&(_e=je)}v(_e)}else{z=new RegExp(z,"gi");for(var F=[],ee=0;ee<r.items.length;ee++){var J=q(ee),de=r.items[ee].data.title||"",Q=r.items[ee].data.group||"",pe=r.items[ee].data.synonym||"";pe&&(pe=pe.join(" ")),(z==null||r.items[ee].selected==!0||J.toString().match(z)||de.match(z)||Q.match(z)||pe.match(z))&&F.push(r.items[ee])}if(!F.length)ve.style.display="none",r.results=null;else{ve.style.display="",r.results=F;var xe=F.length||0;r.options.lazyLoading==!0&&xe>200&&(xe=200);for(var ee=0;ee<xe;ee++)r.results[ee].group?(r.results[ee].group.parentNode||ve.appendChild(r.results[ee].group),r.results[ee].group.lastChild.appendChild(r.results[ee].element)):ve.appendChild(r.results[ee].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!I.classList.contains("jdropdown-focus")){A.current=r,S(r,!0),I.classList.add("jdropdown-focus"),l.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&L.slideBottom(fe,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var z=Z();if(z[0]){var ee=r.getPosition(z[0]);ee!==!1&&r.setCursor(ee)}if(!r.options.type||r.options.type=="default"){var C=I.getBoundingClientRect(),F=fe.getBoundingClientRect();r.options.position?(fe.style.position="fixed",window.innerHeight<C.bottom+F.height?(fe.style.top="",fe.style.bottom=window.innerHeight-C.top+1+"px"):(fe.style.top=C.bottom+"px",fe.style.bottom=""),fe.style.left=C.left+"px"):window.innerHeight<C.bottom+F.height?(fe.style.top="",fe.style.bottom=C.height+1+"px"):(fe.style.top="",fe.style.bottom=""),fe.style.minWidth=C.width+"px",r.options.maxWidth&&(fe.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?ve.style.display="none":ve.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(I)},r.close=function(z){return I.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!z&&typeof r.options.onclose=="function"&&r.options.onclose(I),r.header.blur&&r.header.blur(),I.classList.remove("jdropdown-focus"),S(r,!1),A.current=null),r.getValue()},r.setCursor=function(z,ee){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),z==null)r.currentIndex=null;else if(z=parseInt(z),r.items[z].element.parentNode&&(r.items[z].element.classList.add("jdropdown-cursor"),r.currentIndex=z,ee!==!1&&r.items[r.currentIndex].element)){ve.scrollTop;var C=r.items[r.currentIndex].element;ve.scrollTop=C.offsetTop-C.scrollTop+C.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var z=ve.querySelectorAll(".jdropdown-item");if(z.length){var ee=z[0].indexValue;r.setCursor(ee)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var z=ve.querySelectorAll(".jdropdown-item");if(z.length){var ee=z[z.length-1].indexValue;r.setCursor(ee)}},r.next=function(z){var ee=null;if(z){if(z.length==1){var C=r.currentIndex||-1;z=z.toLowerCase();var F=null,J=null,de=ve.querySelectorAll(".jdropdown-item");if(de.length){for(var Q=0;Q<de.length;Q++)if(de[Q].indexValue>C&&(F=r.items[de[Q].indexValue])&&(J=F.element.innerText[0])&&(J=J.toLowerCase(),z==J)){ee=de[Q].indexValue;break}r.setCursor(ee)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var pe=r.items[r.currentIndex].element,xe=pe.nextElementSibling;xe?(xe.classList.contains("jdropdown-group")&&(xe=xe.lastChild.firstChild),ee=xe.indexValue):pe.parentNode.classList.contains("jdropdown-group-items")&&((xe=pe.parentNode.parentNode.nextElementSibling)&&(xe.classList.contains("jdropdown-group")?xe=xe.lastChild.firstChild:xe.classList.contains("jdropdown-item")?ee=xe.indexValue:xe=null),xe&&(ee=xe.indexValue)),ee!==null&&r.setCursor(ee)}},r.prev=function(){var z=null;if(r.currentIndex===null)r.first();else{var ee=r.items[r.currentIndex].element,C=ee.previousElementSibling;C?(C.classList.contains("jdropdown-group")&&(C=C.lastChild.lastChild),z=C.indexValue):ee.parentNode.classList.contains("jdropdown-group-items")&&((C=ee.parentNode.parentNode.previousElementSibling)&&(C.classList.contains("jdropdown-group")?C=C.lastChild.lastChild:C.classList.contains("jdropdown-item")?z=C.indexValue:C=null),C&&(z=C.indexValue))}z!==null&&r.setCursor(z)},r.loadFirst=function(){if(r.results)var z=r.results;else var z=r.items;var ee=z.length||0;r.options.lazyLoading==!0&&ee>200&&(ee=200),ve.textContent="";for(var C=0;C<ee;C++)z[C].group?(z[C].group.parentNode||ve.appendChild(z[C].group),z[C].group.lastChild.appendChild(z[C].element)):ve.appendChild(z[C].element);ve.scrollTop=0},r.loadLast=function(){if(r.results)var z=r.results;else var z=r.items;var ee=z.length;if(ee>200){ee=ee-200,ve.textContent="";for(var C=ee;C<z.length;C++)z[C].group?(z[C].group.parentNode||ve.appendChild(z[C].group),z[C].group.lastChild.appendChild(z[C].element)):ve.appendChild(z[C].element);ve.scrollTop=ve.scrollHeight}},r.loadUp=function(){var z=!1;if(r.results)var ee=r.results;else var ee=r.items;var C=ve.querySelectorAll(".jdropdown-item"),F=C[0].indexValue;F=r.items[F];var J=ee.indexOf(F)-1;if(J>0){for(var de=0;J>0&&ee[J]&&de<200;)ee[J].group?(ee[J].group.parentNode||ve.insertBefore(ee[J].group,ve.firstChild),ee[J].group.lastChild.insertBefore(ee[J].element,ee[J].group.lastChild.firstChild)):ve.insertBefore(ee[J].element,ve.firstChild),J--,de++;z=!0}return z},r.loadDown=function(){var z=!1;if(r.results)var ee=r.results;else var ee=r.items;var C=ve.querySelectorAll(".jdropdown-item"),F=C[C.length-1].indexValue;F=r.items[F];var J=ee.indexOf(F)+1;if(J<ee.length){for(var de=0;J<ee.length&&ee[J]&&de<200;)ee[J].group?(ee[J].group.parentNode||ve.appendChild(ee[J].group),ee[J].group.lastChild.appendChild(ee[J].element)):ve.appendChild(ee[J].element),J++,de++;z=!0}return z},et(),r};return A.keydown=function(I){var d=null;if(d=A.current){if(I.which==13||I.which==9)d.header.value&&d.currentIndex==null&&d.options.newOptions?d.add():(d.currentIndex==null&&d.options.autocomplete==!0&&d.header.value!=""&&d.find(d.header.value),d.selectIndex(d.currentIndex));else if(I.which==38)d.currentIndex==null?d.first():d.currentIndex>0&&d.prev(),I.preventDefault();else if(I.which==40)d.currentIndex==null?d.first():d.currentIndex+1<d.items.length&&d.next(),I.preventDefault();else if(I.which==36)d.first(),I.target.classList.contains("jdropdown-header")||I.preventDefault();else if(I.which==35)d.last(),I.target.classList.contains("jdropdown-header")||I.preventDefault();else if(I.which==27)d.close();else if(I.which==33){if(d.currentIndex==null)d.first();else if(d.currentIndex>0)for(var r=0;r<7;r++)d.prev();I.preventDefault()}else if(I.which==34){if(d.currentIndex==null)d.first();else if(d.currentIndex+1<d.items.length)for(var r=0;r<7;r++)d.next();I.preventDefault()}}},A.mouseup=function(I){var d=l.findElement(I.target,"jdropdown");if(d){var r=d.dropdown;if(I.target.classList.contains("jdropdown-header"))if(d.classList.contains("jdropdown-focus")&&d.classList.contains("jdropdown-default")){var U=d.getBoundingClientRect();if(I.changedTouches&&I.changedTouches[0]){var re=I.changedTouches[0].clientX;I.changedTouches[0].clientY}else{var re=I.clientX;I.clientY}U.width-(re-U.left)<30?I.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(I.target.classList.contains("jdropdown-group-name")){var ne=I.target.nextSibling.children;if(I.target.nextSibling.style.display!="none")for(var R=0;R<ne.length;R++)ne[R].style.display!="none"&&r.selectItem(ne[R])}else I.target.classList.contains("jdropdown-group-arrow")?I.target.classList.contains("jdropdown-group-arrow-down")?(I.target.classList.remove("jdropdown-group-arrow-down"),I.target.classList.add("jdropdown-group-arrow-up"),I.target.parentNode.nextSibling.style.display="none"):(I.target.classList.remove("jdropdown-group-arrow-up"),I.target.classList.add("jdropdown-group-arrow-down"),I.target.parentNode.nextSibling.style.display=""):I.target.classList.contains("jdropdown-item")?r.selectItem(I.target):I.target.classList.contains("jdropdown-image")||I.target.classList.contains("jdropdown-description")?r.selectItem(I.target.parentNode):I.target.classList.contains("jdropdown-title")?r.selectItem(I.target.parentNode.parentNode):(I.target.classList.contains("jdropdown-close")||I.target.classList.contains("jdropdown-backdrop"))&&r.close()}},A.extractFromDom=function(I,d){var r=I;if(d||(d={}),I.getAttribute("multiple")&&(!d||d.multiple==null)&&(d.multiple=!0),I.getAttribute("placeholder")&&(!d||d.placeholder==null)&&(d.placeholder=I.getAttribute("placeholder")),I.getAttribute("data-autocomplete")&&(!d||d.autocomplete==null)&&(d.autocomplete=!0),(!d||d.width==null)&&(d.width=I.offsetWidth),I.value&&(!d||d.value==null)&&(d.value=I.value),!d||d.data==null){d.data=[];for(var U=0;U<I.children.length;U++)if(I.children[U].tagName=="OPTGROUP")for(var re=0;re<I.children[U].children.length;re++)d.data.push({value:I.children[U].children[re].value,text:I.children[U].children[re].textContent,group:I.children[U].getAttribute("label")});else d.data.push({value:I.children[U].value,text:I.children[U].textContent})}(!d||d.onchange==null)&&(d.onchange=function(R,_,q,Z){d.multiple==!0?obj.items[_].classList.contains("jdropdown-selected")?r.options[_].setAttribute("selected","selected"):r.options[_].removeAttribute("selected"):r.value=Z});var ne=document.createElement("div");return I.parentNode.insertBefore(ne,I),I.style.display="none",I=ne,{el:I,options:d}},A}var ye=oe();function ke(A,I){if(A.picker)return A.picker.setOptions(I,!0);var d={type:"picker"};d.options={};var r=null,U=null,re=function(_){return _ instanceof Element||_ instanceof HTMLDocument},ne=function(){U.innerHTML="";for(var _=Object.keys(d.options.data),q=0;q<_.length;q++){var Z=document.createElement("div");Z.classList.add("jpicker-item"),Z.setAttribute("role","option"),Z.k=_[q],Z.v=d.options.data[_[q]];var ie=d.getLabel(_[q],Z);re(ie)?Z.appendChild(ie):Z.innerHTML=ie,U.appendChild(Z)}};d.setOptions=function(_,q){var Z={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};_&&_.options&&(_.data=_.options);for(var ie in Z)_&&_.hasOwnProperty(ie)?d.options[ie]=_[ie]:(typeof d.options[ie]>"u"||q===!0)&&(d.options[ie]=Z[ie]);return d.options.header===!1?r.style.display="none":r.style.display="",d.options.width?r.style.width=parseInt(d.options.width)+"px":r.style.width="",d.options.height?(U.style.maxHeight=d.options.height+"px",U.style.overflow="scroll"):U.style.overflow="",d.options.columns>0&&(d.options.grid?(U.classList.add("jpicker-grid"),U.style.gridTemplateColumns="repeat("+d.options.grid+", 1fr)"):(U.classList.add("jpicker-columns"),U.style.width=d.options.width?d.options.width:36*d.options.columns+"px")),isNaN(parseInt(d.options.value))&&(d.options.value=0),ne(),d.setValue(d.options.value),d},d.getValue=function(){return d.options.value},d.setValue=function(_,q){if(d.setLabel(_),d.options.value=String(_),A.value!=d.options.value&&(A.value=d.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),U.children[_]&&U.children[_].getAttribute("type")!=="generic"&&d.close(),q&&typeof d.options.onchange=="function"){var Z=d.options.data[_];d.options.onchange(A,d,Z,Z,_,q)}},d.getLabel=function(_,q){var Z=d.options.data[_]||null;return typeof d.options.render=="function"&&(Z=d.options.render(Z,q)),Z},d.setLabel=function(_){var q;d.options.content?q='<i class="material-icons">'+d.options.content+"</i>":q=d.getLabel(_,null),re(q)?(r.innerHTML="",r.appendChild(q)):r.innerHTML=q},d.open=function(){if(!A.classList.contains("jpicker-focus")){S(d,!0),A.classList.add("jpicker-focus"),A.focus();var _=0,q=0;U.style.marginLeft="";var Z=r.getBoundingClientRect(),ie=U.getBoundingClientRect();window.innerHeight<Z.bottom+ie.height||d.options.bottom?_=-1*(ie.height+4):_=Z.height+4,d.options.right===!0&&(q=-1*ie.width+Z.width),ie.left+q<0&&(q=q+ie.left+10),ie.left+ie.width>window.innerWidth&&(q=-1*(10+ie.left+ie.width-window.innerWidth)),U.style.marginTop=parseInt(_)+"px",U.style.marginLeft=parseInt(q)+"px",typeof d.options.onopen=="function"&&d.options.onopen(A,d)}},d.close=function(){A.classList.contains("jpicker-focus")&&(A.classList.remove("jpicker-focus"),S(d,!1),typeof d.options.onclose=="function"&&d.options.onclose(A,d))};var R=function(){let _=l.guid();A.classList.add("jpicker"),A.setAttribute("role","combobox"),A.setAttribute("aria-haspopup","listbox"),A.setAttribute("aria-expanded","false"),A.setAttribute("aria-controls",_),A.setAttribute("tabindex","0"),A.onmousedown=function(q){A.classList.contains("jpicker-focus")||d.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),U=document.createElement("div"),U.setAttribute("id",_),U.setAttribute("role","listbox"),U.classList.add("jpicker-content"),U.onclick=function(q){var Z=l.findElement(q.target,"jpicker-item");Z&&Z.parentNode===U&&d.setValue(Z.k,q)},A.appendChild(r),A.appendChild(U),A.value=I.value||0,d.setOptions(I),typeof d.options.onload=="function"&&d.options.onload(A,d),A.change=d.setValue,A.val=function(q){if(q===void 0)return d.getValue();d.setValue(q)},A.picker=d};return R(),d}function Pe(A,I){var d={type:"toolbar"};d.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var U in r)I&&I.hasOwnProperty(U)?d.options[U]=I[U]:d.options[U]=r[U];!A&&I.app&&I.app.el&&(A=document.createElement("div"),I.app.el.appendChild(A));var re=document.createElement("div");re.classList.add("jtoolbar-item"),re.classList.add("jtoolbar-arrow");var ne=document.createElement("div");ne.classList.add("jtoolbar-floating"),re.appendChild(ne),d.selectItem=function(_){for(var q=R.children,Z=0;Z<q.length;Z++)_!=q[Z]&&q[Z].classList.remove("jtoolbar-selected");_.classList.add("jtoolbar-selected")},d.hide=function(){L.slideBottom(A,0,function(){A.style.display="none"})},d.show=function(){A.style.display="",L.slideBottom(A,1)},d.get=function(){return A},d.setBadge=function(_,q){R.children[_].children[1].firstChild.innerHTML=q},d.destroy=function(){toolbar.remove(),A.innerHTML=""},d.update=function(_,q){for(var Z=0;Z<R.children.length;Z++){var ie=R.children[Z];typeof ie.updateState=="function"&&ie.updateState(A,d,ie,_,q)}for(var Z=0;Z<ne.children.length;Z++){var ie=ne.children[Z];typeof ie.updateState=="function"&&ie.updateState(A,d,ie,_,q)}},d.create=function(_){R.innerHTML="";for(var q=0;q<_.length;q++){var Z=document.createElement("div");if(Z.classList.add("jtoolbar-item"),_[q].width&&(Z.style.width=parseInt(_[q].width)+"px"),_[q].k&&(Z.k=_[q].k),_[q].tooltip&&(Z.setAttribute("title",_[q].tooltip),Z.setAttribute("aria-label",_[q].tooltip)),_[q].id&&Z.setAttribute("id",_[q].id),_[q].updateState&&(Z.updateState=_[q].updateState),_[q].active&&Z.classList.add("jtoolbar-active"),_[q].disabled&&Z.classList.add("jtoolbar-disabled"),_[q].type=="select"||_[q].type=="dropdown")ke(Z,_[q]);else if(_[q].type=="divisor")Z.classList.add("jtoolbar-divisor");else if(_[q].type=="label")Z.classList.add("jtoolbar-label"),Z.innerHTML=_[q].content;else{var ie=document.createElement("i");if(typeof _[q].class>"u")ie.classList.add("material-icons");else for(var we=_[q].class.split(" "),fe=0;fe<we.length;fe++)ie.classList.add(we[fe]);if(ie.innerHTML=_[q].content?_[q].content:"",Z.setAttribute("role","button"),Z.appendChild(ie),d.options.badge==!0){var ve=document.createElement("div");ve.classList.add("jbadge");var Me=document.createElement("div");Me.innerHTML=_[q].badge?_[q].badge:"",ve.appendChild(Me),Z.appendChild(ve)}if(_[q].title)if(d.options.title==!0){var Se=document.createElement("span");Se.innerHTML=_[q].title,Z.appendChild(Se)}else Z.setAttribute("title",_[q].title);d.options.app&&_[q].route&&(Z.route=_[q].route,Z.onclick=function(){d.options.app.pages(this.route)},d.options.app.pages(_[q].route,{toolbarItem:Z,closed:!0})),typeof _[q].render=="function"&&_[q].render(Z,_[q])}_[q].onclick&&(Z.onclick=_[q].onclick.bind(_[q],A,d,Z)),R.appendChild(Z)}setTimeout(function(){d.refresh()},0)},d.open=function(){re.classList.add("jtoolbar-arrow-selected"),A.getBoundingClientRect();var _=ne.getBoundingClientRect();_.bottom>window.innerHeight||d.options.bottom?ne.style.bottom="0":ne.style.removeProperty("bottom"),ne.style.right="0",re.children[0].focus(),S(d,!0)},d.close=function(){re.classList.remove("jtoolbar-arrow-selected"),S(d,!1)},d.refresh=function(){if(d.options.responsive==!0){var _=A.parentNode.getBoundingClientRect();d.options.maxWidth||(d.options.maxWidth=_.width);var q=parseInt(d.options.maxWidth);for(re.parentNode&&re.parentNode.removeChild(re);ne.firstChild;)R.appendChild(ne.firstChild);if(q<R.offsetWidth)for(q-=50;R.lastChild&&q<R.offsetWidth;)ne.insertBefore(R.lastChild,ne.firstChild);ne.children.length>0&&R.appendChild(re)}},d.setReadonly=function(_){_=_?"add":"remove",A.classList[_]("jtoolbar-disabled")},A.onclick=function(_){var q=l.findElement(_.target,"jtoolbar-item");q&&d.selectItem(q),_.target.classList.contains("jtoolbar-arrow")&&d.open()},window.addEventListener("resize",function(){d.refresh()}),A.classList.add("jtoolbar"),A.innerHTML="",d.options.container==!0&&A.classList.add("jtoolbar-container");var R=document.createElement("div");return A.appendChild(R),d.options.app&&A.classList.add("jtoolbar-mobile"),d.create(d.options.items),A.toolbar=d,d}function Be(){var A=function(I,d){var r={type:"editor"};r.options={};var U={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var re in U)d&&d.hasOwnProperty(re)?r.options[re]=d[re]:r.options[re]=U[re];var ne=null,R=null,_=[];r.el=I,typeof r.options.onclick=="function"&&(I.onclick=function(se){r.options.onclick(I,r,se)}),I.classList.add("jeditor-container");var q=document.createElement("div");q.className="jsnippet",q.setAttribute("contenteditable",!1);var Z=document.createElement("div");if(Z.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)v({url:r.options.url,dataType:"html",success:function(se){r.editor.innerHTML=se,A.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ie=0;ie<I.children.length;ie++)r.editor.appendChild(I.children[ie]);I.innerHTML="";var we=function(se){typeof r.options.onchange=="function"&&r.options.onchange(I,r,se),r.options.value=r.getData(),I.value!=r.options.value&&(I.value=r.options.value,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value}))},fe=function(se){var Ee=document.createElement("div");Ee.innerHTML=se;var Ae=Ee.querySelectorAll("img");if(Ae.length)for(var qe=0;qe<Ae.length;qe++)r.addImage(Ae[qe].src)},ve=function(){var se=null;if(se=q.children[0]){se.classList.contains("jslider-grid")||se.classList.add("jslider-grid");var Ee=se.children.length;se.setAttribute("data-number",Ee>4?4:Ee),Ee>4?se.setAttribute("data-total",Ee-4):se.removeAttribute("data-total")}},Me=function(se){q.innerHTML||r.appendSnippet({}),q.children[0].appendChild(se),ve()};r.appendSnippet=function(se){q.innerHTML="";for(var Ee=["image","title","description","host","url"],Ae=0;Ae<Ee.length;Ae++){var qe=document.createElement("div");if(qe.className="jsnippet-"+Ee[Ae],qe.setAttribute("data-k",Ee[Ae]),q.appendChild(qe),se[Ee[Ae]])if(Ee[Ae]=="image"){Array.isArray(se.image)||(se.image=[se.image]);for(var tt=0;tt<se.image.length;tt++){var Ke=document.createElement("img");Ke.src=se.image[tt],qe.appendChild(Ke)}}else qe.innerHTML=se[Ee[Ae]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(q)},r.setData=function(se){typeof se=="object"?r.editor.innerHTML=se.content:r.editor.innerHTML=se,r.options.focus&&A.setCursor(r.editor,!0),_=[]},r.getFiles=function(){for(var se=r.editor.querySelectorAll(".jfile"),Ee=[],Ae=0;Ae<se.length;Ae++)_[se[Ae].src]&&Ee.push(_[se[Ae].src]);return Ee},r.getText=function(){return r.editor.innerText},r.getData=function(se){if(se){var Ee={content:""};if(q.innerHTML){Ee.snippet={};for(var Ae=0;Ae<q.children.length;Ae++){var qe=q.children[Ae].getAttribute("data-k");if(qe)if(qe=="image"){Ee.snippet.image||(Ee.snippet.image=[]);for(var tt=0;tt<q.children[Ae].children.length;tt++)Ee.snippet.image.push(q.children[Ae].children[tt].getAttribute("src"))}else Ee.snippet[qe]=q.children[Ae].innerHTML}}var Ke=Object.keys(_);if(Ke.length){Ee.files=[];for(var Ae=0;Ae<Ke.length;Ae++)Ee.files.push(_[Ke[Ae]])}var dt=document.createElement("div");dt.innerHTML=r.editor.innerHTML;var mt=dt.querySelector(".jsnippet");mt&&mt.remove();var nt=dt.innerHTML;nt=nt.replace(/<br>/g,`
`),nt=nt.replace(/<\/div>/g,`</div>
`),nt=nt.replace(/<(?:.|\n)*?>/gm,""),Ee.content=nt.trim(),Fe("getData",Ee)}else var Ee=r.editor.innerHTML;return Ee},r.reset=function(){r.editor.innerHTML="",q.innerHTML="",_=[]},r.addPdf=function(se){if(se.result.substr(0,4)!="data")console.error("Invalid source");else{var Ee=document.createElement("canvas");Ee.width=60,Ee.height=60;var Ae=new Image,qe=Ee.getContext("2d");qe.drawImage(Ae,0,0,Ee.width,Ee.height),Ee.toBlob(function(tt){var Ke=document.createElement("img");Ke.src=window.URL.createObjectURL(tt),Ke.title=se.name,Ke.className="jfile pdf",_[Ke.src]={file:Ke.src,extension:"pdf",content:se.result},document.execCommand("insertHtml",!1,Ke.outerHTML)})}},r.addImage=function(se,Ee){if(r.options.acceptImages)if(se||(se=""),se.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(se.substr(0,4)=="data"){var Ae=se.split(";");Ae=Ae[0].split("/"),Ae=Ae[1]}else{var Ae=se.substr(se.lastIndexOf(".")+1);se=r.options.remoteParser+se}var qe=new Image;qe.onload=function(){var Ke=document.createElement("canvas");Ke.width=qe.width,Ke.height=qe.height;var dt=Ke.getContext("2d");dt.drawImage(qe,0,0,Ke.width,Ke.height),Ke.toBlob(function(mt){var nt=document.createElement("img");nt.src=window.URL.createObjectURL(mt),nt.classList.add("jfile"),nt.setAttribute("tabindex","900"),nt.setAttribute("width",qe.width),nt.setAttribute("height",qe.height),_[nt.src]={file:nt.src,extension:Ae,content:Ke.toDataURL()},r.options.dropAsSnippet||Ee?(Me(nt),_[nt.src].snippet=!0):document.execCommand("insertHtml",!1,nt.outerHTML),we()})},qe.src=se}},r.addFile=function(se){for(var Ee=[],Ae=0;Ae<se.length;Ae++)if(se[Ae].size>r.options.maxFileSize)alert("The file is too big");else{var qe=se[Ae].type.split("/");qe[0]=="image"?qe=1:qe[1]=="pdf"?qe=2:qe=0,qe?(Ee[Ae]=new FileReader,Ee[Ae].index=Ae,Ee[Ae].type=qe,Ee[Ae].name=se[Ae].name,Ee[Ae].date=se[Ae].lastModified,Ee[Ae].size=se[Ae].size,Ee[Ae].addEventListener("load",function(tt){tt.target.type==2?r.options.acceptFiles==!0&&r.addPdf(tt.target):r.addImage(tt.target.result)},!1),Ee[Ae].readAsDataURL(se[Ae])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",xe),r.editor.removeEventListener("mousedown",_e),r.editor.removeEventListener("mousemove",je),r.editor.removeEventListener("keyup",Q),r.editor.removeEventListener("keydown",pe),r.editor.removeEventListener("dragstart",z),r.editor.removeEventListener("dragenter",ee),r.editor.removeEventListener("dragover",C),r.editor.removeEventListener("drop",F),r.editor.removeEventListener("paste",Te),r.editor.removeEventListener("blur",J),r.editor.removeEventListener("focus",de),I.editor=null,I.classList.remove("jeditor-container"),Z.remove(),q.remove(),r.editor.remove()},r.upload=function(){l.click(r.file)};const Se=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Oe=["width","height","align","border","src","tabindex"],Ge=["color","font-weight","font-size","background","background-color","margin"],et=function(se){if(se.tagName&&Se.indexOf(se.tagName.toLowerCase())===-1&&se.innerText&&(se.innerHTML=se.innerText),se.attributes&&se.attributes.length){let Ee=null,Ae=se.getAttribute("style");if(Ae){Ee=[];let tt=Ae.split(";");for(let Ke=0;Ke<tt.length;Ke++){let dt=tt[Ke].trim().split(":");if(Ge.indexOf(dt[0].trim())>=0){let mt=dt.shift();dt=dt.join(":"),Ee.push(mt+":"+dt)}}}se.tagName.toUpperCase()==="IMG"&&(!r.options.acceptImages||!se.src?se.parentNode.removeChild(se):(se.setAttribute("tabindex","900"),r.addImage(se.src)));let qe=[];for(let tt=0;tt<se.attributes.length;tt++)qe.push(se.attributes[tt].name);qe.length&&qe.forEach(function(tt){Oe.indexOf(tt)===-1?se.removeAttribute(tt):se.attributes&&se.attributes[ie]&&se.attributes[ie].value.indexOf("<")!==-1&&se.attributes[ie].value.replace("<","&#60;")}),se.style="",Ee&&Ee.length&&se.setAttribute("style",Ee.join(";"))}if(se.children.length)for(let Ee=se.children.length;Ee>0;Ee--)et(se.children[Ee-1])};var te=function(se){var Ee=window.getSelection(),Ae=document.createRange();Ae.selectNode(se),Ee.addRange(Ae)},be=function(se){se&&(se=se.replace(new RegExp("<!--(.*?)-->","gsi"),""));var Ee=new DOMParser,Ae=Ee.parseFromString(se,"text/html");et(Ae);var qe=document.createElement("div");return qe.innerHTML=Ae.firstChild.innerHTML,qe},Te=function(se){if(r.options.filterPaste==!0){if(se.clipboardData||se.originalEvent.clipboardData)var Ee=(se.originalEvent||se).clipboardData.getData("text/html"),Ae=(se.originalEvent||se).clipboardData.getData("text/plain"),qe=(se.originalEvent||se).clipboardData.files;else if(window.clipboardData)var Ee=window.clipboardData.getData("Html"),Ae=window.clipboardData.getData("Text"),qe=window.clipboardData.files;if(qe.length)r.addFile(qe);else if(!Ee)Ee=Ae.split(`\r
`),se.target.innerText?(Ee=Ee.map(function(Ke){return"<div>"+Ke+"</div>"}),document.execCommand("insertText",!1,Ee.join(""))):Ee.map(function(Ke){var dt=document.createElement("div");dt.innerText=Ke,r.editor.appendChild(dt)});else{var tt=be(Ee);document.execCommand("insertHtml",!1,tt.innerHTML)}se.preventDefault()}},z=function(se){R&&R.e&&se.preventDefault()},ee=function(se){R||r.options.dropZone==!1||(I.classList.add("jeditor-dragging"),se.preventDefault())},C=function(se){R||r.options.dropZone==!1||(ne&&clearTimeout(ne),ne=setTimeout(function(){I.classList.remove("jeditor-dragging")},100),se.preventDefault())},F=function(se){if(!(R||r.options.dropZone==!1)){var Ee=null;document.caretRangeFromPoint?Ee=document.caretRangeFromPoint(se.clientX,se.clientY):se.rangeParent&&(Ee=document.createRange(),Ee.setStart(se.rangeParent,se.rangeOffset));var Ae=window.getSelection();Ae.removeAllRanges(),Ae.addRange(Ee),Ae.anchorNode.parentNode.focus();var qe=(se.originalEvent||se).dataTransfer.getData("text/html"),tt=(se.originalEvent||se).dataTransfer.getData("text/plain"),Ke=(se.originalEvent||se).dataTransfer.files;Ke.length?r.addFile(Ke):tt&&fe(qe),I.classList.remove("jeditor-dragging"),se.preventDefault()}},J=function(se){Fe("onevent",se),we(se),typeof r.options.onblur=="function"&&r.options.onblur(I,r,se)},de=function(se){typeof r.options.onfocus=="function"&&r.options.onfocus(I,r,se)},Q=function(se){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(I,r,se)},pe=function(se){if(Fe("onevent",se),se.key=="Delete"&&se.target.tagName=="IMG"){var Ee=se.target.parentNode;te(se.target),Ee.classList.contains("jsnippet-image")&&ve()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(I,r,se)},xe=function(se){if(R&&R.e&&(R.e.classList.remove("resizing"),R.e.changed==!0)){var Ee=R.e.cloneNode();Ee.width=parseInt(R.e.style.width)||R.e.getAttribute("width"),Ee.height=parseInt(R.e.style.height)||R.e.getAttribute("height"),R.e.style.width="",R.e.style.height="",te(R.e),document.execCommand("insertHtml",!1,Ee.outerHTML)}R=!1},_e=function(se){var Ee=function(Ke){var dt=Ke.getBoundingClientRect();dt.width-(se.clientX-dt.left)<40&&se.clientY-dt.top<40&&(Ke.innerHTML="",Ke.remove())};if(se.target.tagName=="IMG")if(se.target.style.cursor){var Ae=se.target.getBoundingClientRect();R={e:se.target,x:se.clientX,y:se.clientY,w:Ae.width,h:Ae.height,d:se.target.style.cursor},se.target.getAttribute("width")||se.target.setAttribute("width",Ae.width),se.target.getAttribute("height")||se.target.setAttribute("height",Ae.height);var qe=window.getSelection();if(qe.rangeCount)for(var tt=0;tt<qe.rangeCount;tt++)qe.removeRange(qe.getRangeAt(tt));se.target.classList.add("resizing")}else R=!0;else se.target.classList.contains("jsnippet")?Ee(se.target):se.target.parentNode.classList.contains("jsnippet")&&Ee(se.target.parentNode),R=!0},je=function(se){if(se.target.tagName=="IMG"&&!se.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&se.target.getAttribute("tabindex")){var Ee=se.target.getBoundingClientRect();se.clientY-Ee.top<5?Ee.width-(se.clientX-Ee.left)<5?se.target.style.cursor="ne-resize":se.clientX-Ee.left<5?se.target.style.cursor="nw-resize":se.target.style.cursor="n-resize":Ee.height-(se.clientY-Ee.top)<5?Ee.width-(se.clientX-Ee.left)<5?se.target.style.cursor="se-resize":se.clientX-Ee.left<5?se.target.style.cursor="sw-resize":se.target.style.cursor="s-resize":Ee.width-(se.clientX-Ee.left)<5?se.target.style.cursor="e-resize":se.clientX-Ee.left<5?se.target.style.cursor="w-resize":se.target.style.cursor=""}if(se.which==1&&R&&R.d){if(R.d=="e-resize"||R.d=="ne-resize"||R.d=="se-resize")if(R.e.style.width=R.w+(se.clientX-R.x),se.shiftKey){var Ae=(se.clientX-R.x)*(R.h/R.w);R.e.style.height=R.h+Ae}else var Ae=null;Ae||(R.d=="s-resize"||R.d=="se-resize"||R.d=="sw-resize")&&(se.shiftKey||(R.e.style.height=R.h+(se.clientY-R.y))),R.e.changed=!0}},Fe=function(se,Ee){if(r.options.extensions){var Ae=Object.keys(r.options.extensions);if(Ae.length)for(var qe=0;qe<Ae.length;qe++)r.options.extensions[Ae[qe]]&&typeof r.options.extensions[Ae[qe]][se]=="function"&&r.options.extensions[Ae[qe]][se].call(r,Ee)}},He=function(){if(r.options.extensions){var se=Object.keys(r.options.extensions);if(se.length)for(var Ee=0;Ee<se.length;Ee++)r.options.extensions[se[Ee]]&&typeof r.options.extensions[se[Ee]]=="function"&&(r.options.extensions[se[Ee]]=r.options.extensions[se[Ee]](I,r))}};if(document.addEventListener("mouseup",xe),document.addEventListener("mousemove",je),r.editor.addEventListener("mousedown",_e),r.editor.addEventListener("keyup",Q),r.editor.addEventListener("keydown",pe),r.editor.addEventListener("dragstart",z),r.editor.addEventListener("dragenter",ee),r.editor.addEventListener("dragover",C),r.editor.addEventListener("drop",F),r.editor.addEventListener("paste",Te),r.editor.addEventListener("focus",de),r.editor.addEventListener("blur",J),I.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var Je={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var Je={container:!0,responsive:!0,items:[]};else var Je=r.options.toolbar;Je.items&&Je.items.length||(Je.items=A.getDefaultToolbar(r)),r.options.toolbarOnTop?(I.classList.add("toolbar-on-top"),I.insertBefore(Z,I.firstChild)):(r.editor.style.padding="15px",I.appendChild(Z)),Pe(Z,Je),Z.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},I.appendChild(r.file),r.options.focus&&A.setCursor(r.editor,r.options.focus=="initial"),I.change=r.setData,I.val=function(se){if(se===void 0){var Ee=I.getAttribute("data-html")!=="true";return r.getData(Ee)}else r.setData(se)},He(),I.editor=r,typeof r.options.onload=="function"&&r.options.onload(I,r,r.editor),r};return A.setCursor=function(I,d){I.focus(),document.execCommand("selectAll");var r=window.getSelection(),U=r.getRangeAt(0);if(d==!0)var re=U.startContainer,ne=0;else var re=U.endContainer,ne=re.length;U.setStart(re,ne),U.setEnd(re,ne),r.removeAllRanges(),r.addRange(U)},A.getDefaultToolbar=function(I){var d=function(U,re,ne){ne.color||(ae(ne,{onchange:function(R,_){ne.k==="color"?document.execCommand("foreColor",!1,_):document.execCommand("backColor",!1,_)}}),ne.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),I.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(U){return'<span style="font-family:'+U+'">'+U+"</span>"},onchange:function(U,re,ne,R,_){document.execCommand("fontName",!1,R)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(U){return'<span style="font-size:'+U+'">'+U+"</span>"},onchange:function(U,re,ne,R,_){document.execCommand("fontSize",!1,parseInt(_)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(U){return'<i class="material-icons">'+U+"</i>"},onchange:function(U,re,ne,R,_){var q=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(q[_])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:d}),r.push({content:"format_color_fill",k:"background-color",onclick:d})),r.push({content:"format_bold",onclick:function(U,re,ne){document.execCommand("bold"),document.queryCommandState("bold")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(U,re,ne){document.execCommand("italic"),document.queryCommandState("italic")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(U,re,ne){document.execCommand("underline"),document.queryCommandState("underline")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(U,re,ne){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(U,re,ne){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(U,re,ne){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ne.classList.add("selected"):ne.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),I.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){I.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(U,re){re&&(re.onmouseover=this.onmouseover,U=U.split("x"),re.setAttribute("data-x",U[0]),re.setAttribute("data-y",U[1]));var ne=document.createElement("div");return re.style.margin="1px",re.style.border="1px solid #ddd",ne},onmouseover:function(U){for(var re=parseInt(U.target.getAttribute("data-x")),ne=parseInt(U.target.getAttribute("data-y")),R=0;R<U.target.parentNode.children.length;R++){var _=U.target.parentNode.children[R],q=parseInt(_.getAttribute("data-x")),Z=parseInt(_.getAttribute("data-y"));q<=re&&Z<=ne?(_.style.backgroundColor="#cae1fc",_.style.borderColor="#2977ff"):(_.style.backgroundColor="",_.style.borderColor="#ddd")}},onchange:function(U,re,ne){ne=ne.split("x");for(var R=document.createElement("table"),_=document.createElement("tbody"),q=0;q<=ne[1];q++){for(var Z=document.createElement("tr"),ie=0;ie<=ne[0];ie++){var we=document.createElement("td");we.innerHTML="",Z.appendChild(we)}_.appendChild(Z)}R.appendChild(_),R.setAttribute("width","100%"),R.setAttribute("cellpadding","6"),R.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,R.outerHTML)}})),r},A}var Ze=Be();function W(){var A=function(I,d){var r={};r.options={};var U={type:"big",title:"Untitled",width:510,height:472};for(var re in U)d&&d.hasOwnProperty(re)?r.options[re]=d[re]:r.options[re]=U[re];var ne=function(){for(var q=document.createElement("div");I.children[0];)q.appendChild(I.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=I.innerHTML;q.children[0];)r.content.appendChild(q.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),I.innerHTML="",I.appendChild(r.container)},R=function(){r.container&&r.container.addEventListener("click",function(q){var Z=q.target.getBoundingClientRect();if(q.target.classList.contains("jfloating")){if(q.changedTouches&&q.changedTouches[0])var ie=q.changedTouches[0].clientX,we=q.changedTouches[0].clientY;else var ie=q.clientX,we=q.clientY;Z.width-(ie-Z.left)<50&&we-Z.top<50?setTimeout(function(){r.close()},100):r.setState()}})},_=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(A.elements.indexOf(r.container),1),r.updatePosition(),I.remove()},r.updatePosition=function(){for(var q=0;q<A.elements.length;q++){var Z=A.elements[q],ie=A.elements[q-1];Z.style.right=q*(ie?ie.offsetWidth:Z.offsetWidth)*1.01+"px"}},r.init=function(){ne(),R(),_(),A.elements.push(r.container),r.updatePosition(),I.floating=r},r.init(),r};return A.elements=[],A}var Le=W();function Ye(){const A=function(R){return!isNaN(R)&&R!==null&&(typeof R!="string"||R.trim()!=="")},I={between:function(R,_){return R>=_[0]&&R<=_[1]},"not between":function(R,_){return R<_[0]||R>_[1]},"<":function(R,_){return R<_[0]},"<=":function(R,_){return R<=_[0]},">":function(R,_){return R>_[0]},">=":function(R,_){return R>=_[0]},"=":function(R,_){return R==_[0]},"!=":function(R,_){return R!=_[0]}},d={"valid date":function(){return!0},"=":function(R,_){return R===_[0]},"!=":function(R,_){return R!==_[0]},"<":function(R,_){return R<_[0]},"<=":function(R,_){return R<=_[0]},">":function(R,_){return R>_[0]},">=":function(R,_){return R>=_[0]},between:function(R,_){return R>=_[0]&&R<=_[1]},"not between":function(R,_){return R<_[0]||R>_[1]}},r={contains:function(R,_){return R.includes(_[0])},"not contains":function(R,_){return!R.includes(_[0])},"begins with":function(R,_){return R.startsWith(_[0])},"ends with":function(R,_){return R.endsWith(_[0])},"=":function(R,_){return R===_[0]},"!=":function(R,_){return R!==_[0]},"valid email":function(R){var _=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return _.test(R)},"valid url":function(R){var _=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return _.test(R)}},U=function(R,_){return typeof U[_.type]=="function"?_.allowBlank&&(typeof R>"u"||R===""||R===null)?!0:U[_.type].call(this,R,_):null};U.url=function(R){var _=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!_.test(R)},U.email=function(R){var _=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(R&&_.test(R))},U.required=function(R){return!!(R&&R.trim())},U.empty=function(R){return typeof R>"u"||R===null||typeof R=="string"&&!R.toString().trim()},U["not exist"]=U.empty,U.notEmpty=function(R){return!U.empty(R)},U.exist=U.notEmpty,U.number=function(R,_){if(!A(R))return!1;if(!_||!_.criteria)return!0;if(!I[_.criteria])return!1;let q=_.value.map(function(Z){return parseFloat(Z)});return I[_.criteria](R,q)},U.login=function(R){let _=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(R&&_.test(R))},U.list=function(R,_){let q=typeof R;if(q!=="string"&&q!=="number")return!1;let Z;return typeof _.value[0]=="string"?_.source?Z=_.source:Z=_.value[0].split(","):Z=_.value[0],Array.isArray(Z)?Z.findIndex(function(we){return we==R})>-1:!1};const re=function(){let R=new Date;return R.setHours(0,0,0,0),R},ne={"one year ago":function(){let R=re();return R.setFullYear(R.getFullYear()-1),R},"one month ago":function(){let R=re();return R.setMonth(R.getMonth()-1),R},"one week ago":function(){let R=re();return R.setDate(R.getDate()-7),R},yesterday:function(){let R=re();return R.setDate(R.getDate()-1),R},today:re,tomorrow:function(){let R=re();return R.setDate(R.getDate()+1),R}};return U.date=function(R,_){if(A(R)&&R>0&&R<1e6&&(R=N.numToDate(R)),new Date(R)=="Invalid Date")return!1;if(!_||!_.criteria)return!0;if(!d[_.criteria])return!1;let q=_.value.map(function(Z){return typeof Z=="string"&&ne[Z]?ne[Z]().getTime():new Date(Z).getTime()});return d[_.criteria](new Date(R).getTime(),q)},U.text=function(R,_){if(typeof R>"u"||R===null)R="";else if(typeof R!="string")return!1;return!_||!_.criteria?!0:r[_.criteria]?r[_.criteria](R,_.value):!1},U.textLength=function(R,_){let q;return typeof R=="string"?q=R.length:typeof R<"u"&&R!==null&&typeof R.toString=="function"?q=R.toString().length:q=0,U.number(q,_)},U}var ot=Ye();function Ne(){var A=function(I,d){var r={};r.options={};var U={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(_,q){alert(q)}};for(var re in U)d&&d.hasOwnProperty(re)?r.options[re]=d[re]:r.options[re]=U[re];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=I.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=ot.email),r.options.validations.length||(r.options.validations.length=ot.length),r.options.validations.required||(r.options.validations.required=ot.required),r.setUrl=function(_){r.options.url=_},r.load=function(){v({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(_){if(typeof r.options.onbeforeload=="function"){var q=r.options.onbeforeload(I,_);q&&(_=q)}A.setElements(I,_),typeof r.options.onload=="function"&&r.options.onload(I,_)}})},r.save=function(){var _=r.validate();if(_)r.options.onerror(I,_);else{var q=A.getElements(I,!0);if(typeof r.options.onbeforesave=="function"){var q=r.options.onbeforesave(I,q);if(q===!1)return}v({url:r.options.url,method:"POST",dataType:"json",data:q,success:function(Z){typeof r.options.onsave=="function"&&r.options.onsave(I,q,Z)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var _=r.options.onbeforeremove(I,r);if(_===!1)return!1}v({url:r.options.url,method:"DELETE",dataType:"json",success:function(q){typeof r.options.onremove=="function"&&r.options.onremove(I,r,q),r.reset()}})};var ne=function(_){_.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var q=_.getAttribute("data-error")||"There is an error in the form";return _.setAttribute("title",q),q},R=function(_){var q=!1;_.classList.remove("error"),_.removeAttribute("title");for(var Z=I.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<Z.length;ie++)Z[ie].getAttribute("data-validation")&&Z[ie].classList.contains("error")&&(q=!0);r.options.submitButton&&(q?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(_){var q=!1,Z=A.getValue(_),ie=_.getAttribute("data-validation");return typeof r.options.validations[ie]=="function"&&!r.options.validations[ie](Z,_)?q=ne(_):_.classList.contains("error")&&R(_),q},r.reset=function(){for(var _=I.querySelectorAll("input, select, textarea, div[name]"),q=0;q<_.length;q++)_[q].getAttribute("name")&&(_[q].type=="checkbox"||_[q].type=="radio"?_[q].checked=!1:typeof _[q].val=="function"?_[q].val(""):_[q].value="")},r.validate=function(){for(var _=[],q=I.querySelectorAll("input, select, textarea, div[name]"),Z=0;Z<q.length;Z++)if(q[Z].getAttribute("data-validation")){var ie=r.validateElement(q[Z]);ie&&_.push(ie)}return _.length>0?_.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(A.getElements(I))},r.getHash=function(_){var q=0,Z,ie;if(_.length===0)return q;for(Z=0;Z<_.length;Z++)ie=_.charCodeAt(Z),q=(q<<5)-q+ie,q|=0;return q},r.isChanged=function(){var _=r.setHash();return r.options.currentHash!=_},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(_){r.options.ignore=!!_},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),I.addEventListener("keyup",function(_){_.target.getAttribute("data-validation")&&r.validateElement(_.target)}),A.hasEvents||(window.addEventListener("beforeunload",function(_){if(r.isChanged()&&r.options.ignore==!1){var q=r.options.message?r.options.message:"o/";return q?(typeof _>"u"&&(_=window.event),_&&(_.returnValue=q),q):void 0}}),A.hasEvents=!0),I.form=r,r};return A.getValue=function(I){var d=null;if(I.type=="checkbox")I.checked==!0&&(d=I.value||!0);else if(I.type=="radio")I.checked==!0&&(d=I.value);else if(I.type=="file")d=I.files;else if(I.tagName=="select"&&I.multiple==!0){d=[];for(var r=I.querySelectorAll("options[selected]"),U=0;U<r.length;U++)d.push(r[U].value)}else typeof I.val=="function"?d=I.val():d=I.value||"";return d},A.getElements=function(I,d){for(var r={},U=null,re=I.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<re.length;ne++)(U=re[ne].getAttribute("name"))&&(r[U]=A.getValue(re[ne])||"");return d==!0?r:JSON.stringify(r)},A.setElements=function(I,d){for(var r=null,U=null,re=I.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<re.length;ne++){var R=re[ne].getAttribute("type");if(r=re[ne].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),U=null,r.match(/\./)){var _=a.call(d,r)||"";typeof _<"u"&&(U=_)}else typeof d[r]<"u"&&(U=d[r]);U!==null&&(R=="checkbox"||R=="radio"?re[ne].checked=!!U:R=="file"||(typeof re[ne].val=="function"?re[ne].val(U):re[ne].value=U))}}},A}var Ce=Ne();function Ie(){var A=function(){var d=null,r=function(R){if(R.which==27)for(var _=document.querySelectorAll(".jmodal"),q=0;q<_.length;q++)_[q].parentNode.modal.close()},U=function(R){let _=R.composedPath();var q=l.findElement(_[0],"jmodal");if(q){var Z=q.getBoundingClientRect();if(R.changedTouches&&R.changedTouches[0])var ie=R.changedTouches[0].clientX,we=R.changedTouches[0].clientY;else var ie=R.clientX,we=R.clientY;Z.width-(ie-Z.left)<50&&we-Z.top<50&&q.parentNode.modal.close()}d&&(d.element.style.cursor="auto",d=null)},re=function(R){let _=R.composedPath();var q=l.findElement(_[0],"jmodal");if(q){var Z=q.getBoundingClientRect();if(R.changedTouches&&R.changedTouches[0])var ie=R.changedTouches[0].clientX,we=R.changedTouches[0].clientY;else var ie=R.clientX,we=R.clientY;Z.width-(ie-Z.left)<50&&we-Z.top<50||we-Z.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),d={left:Z.left,top:Z.top,x:R.clientX,y:R.clientY,width:Z.width,height:Z.height,element:q})}},ne=function(R){if(d){if(R=R||window.event,R.buttons)var _=R.buttons;else if(R.button)var _=R.button;else var _=R.which;_?(d.element.style.top=d.top+(R.clientY-d.y)+d.height/2+"px",d.element.style.left=d.left+(R.clientX-d.x)+d.width/2+"px",d.element.style.cursor="move"):d.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",U),document.addEventListener("mousedown",re),document.addEventListener("mousemove",ne)},I=function(d,r){var U={};U.options={};var re={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ne in re)r&&r.hasOwnProperty(ne)?U.options[ne]=r[ne]:U.options[ne]=re[ne];!U.options.title&&d.getAttribute("title")&&(U.options.title=d.getAttribute("title"));for(var R=document.createElement("div");d.children[0];)R.appendChild(d.children[0]);for(U.title=document.createElement("div"),U.title.className="jmodal_title",U.options.icon&&U.title.setAttribute("data-icon",U.options.icon),U.content=document.createElement("div"),U.content.className="jmodal_content",U.content.innerHTML=d.innerHTML;R.children[0];)U.content.appendChild(R.children[0]);if(U.container=document.createElement("div"),U.container.className="jmodal",U.container.appendChild(U.title),U.container.appendChild(U.content),U.options.padding&&(U.content.style.padding=U.options.padding),U.options.width&&(U.container.style.width=U.options.width),U.options.height&&(U.container.style.height=U.options.height),U.options.title){var _=document.createElement("h4");_.innerText=U.options.title,U.title.appendChild(_)}if(d.innerHTML="",d.style.display="none",d.appendChild(U.container),U.options.backdrop){var q=document.createElement("div");q.className="jmodal_backdrop",q.onclick=function(){U.close()},d.appendChild(q)}return U.open=function(){d.style.display="block";var Z=U.container.getBoundingClientRect();l.getWindowWidth()<Z.width?(U.container.style.top="",U.container.style.left="",U.container.classList.add("jmodal_fullscreen"),L.slideBottom(U.container,1)):U.options.backdrop&&(q.style.display="block"),typeof U.options.onopen=="function"&&U.options.onopen(d,U)},U.resetPosition=function(){U.container.style.top="",U.container.style.left=""},U.isOpen=function(){return d.style.display!="none"},U.close=function(){U.isOpen()&&(d.style.display="none",U.options.backdrop&&(q.style.display=""),U.container.classList.remove("jmodal_fullscreen"),typeof U.options.onclose=="function"&&U.options.onclose(d,U))},U.options.url?v({url:U.options.url,method:"GET",dataType:"text/html",success:function(Z){U.content.innerHTML=Z,U.options.closed||U.open(),typeof U.options.onload=="function"&&U.options.onload(U)}}):(U.options.closed||U.open(),typeof U.options.onload=="function"&&U.options.onload(U)),d.modal=U,A(),A=function(){},U};return I}var Ve=Ie();function We(){var A=function(I){var d={};d.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var U in r)I&&I.hasOwnProperty(U)?d.options[U]=I[U]:d.options[U]=r[U];var re=document.createElement("div");re.className="jnotification",d.options.error&&re.classList.add("jnotification-error");var ne=document.createElement("div");ne.className="jnotification-container",re.appendChild(ne);var R=document.createElement("div");R.className="jnotification-header",ne.appendChild(R);var _=document.createElement("div");if(_.className="jnotification-image",R.appendChild(_),d.options.icon){var q=document.createElement("img");q.src=d.options.icon,_.appendChild(q)}var Z=document.createElement("div");if(Z.className="jnotification-name",Z.innerHTML=d.options.name,R.appendChild(Z),d.options.closeable==!0){var ie=document.createElement("div");ie.className="jnotification-close",ie.onclick=function(){d.hide()},R.appendChild(ie)}var we=document.createElement("div");we.className="jnotification-date",R.appendChild(we);var fe=document.createElement("div");if(fe.className="jnotification-content",ne.appendChild(fe),d.options.title){var ve=document.createElement("div");ve.className="jnotification-title",ve.innerHTML=d.options.title,fe.appendChild(ve)}var Me=document.createElement("div");if(Me.className="jnotification-message",Me.innerHTML=d.options.message,fe.appendChild(Me),d.show=function(){document.body.appendChild(re),l.getWindowWidth()>800?L.fadeIn(re):L.slideTop(re,1)},d.hide=function(){l.getWindowWidth()>800?L.fadeOut(re,function(){re.parentNode&&(re.parentNode.removeChild(re),Se&&clearTimeout(Se))}):L.slideTop(re,0,function(){re.parentNode&&(re.parentNode.removeChild(re),Se&&clearTimeout(Se))})},d.show(),d.options.autoHide==!0)var Se=setTimeout(function(){d.hide()},d.options.timeout);return l.getWindowWidth()<800&&re.addEventListener("swipeup",function(Oe){d.hide(),Oe.preventDefault(),Oe.stopPropagation()}),d};return A.isVisible=function(){var I=document.querySelector(".jnotification");return!!(I&&I.parentNode)},A}var Xe=We();function lt(A,I){var d={};d.options={};var r={value:0,onchange:null,width:null};for(var U in r)I&&I.hasOwnProperty(U)?d.options[U]=I[U]:d.options[U]=r[U];A.classList.add("jprogressbar"),A.setAttribute("tabindex",1),A.setAttribute("data-value",d.options.value);var re=document.createElement("div");re.style.width=d.options.value+"%",re.style.color="#fff",A.appendChild(re),d.options.width&&(A.style.width=d.options.width),d.setValue=function(R){R=parseInt(R),d.options.value=R,re.style.width=R+"%",A.setAttribute("data-value",R+"%"),R<6?A.style.color="#000":A.style.color="#fff",d.options.value=R,typeof d.options.onchange=="function"&&d.options.onchange(A,R),A.value!=d.options.value&&(A.value=d.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},d.getValue=function(){return d.options.value};var ne=function(R){if(R.which){var _=A.getBoundingClientRect();if(R.changedTouches&&R.changedTouches[0]){var q=R.changedTouches[0].clientX;R.changedTouches[0].clientY}else{var q=R.clientX;R.clientY}d.setValue(Math.round((q-_.left)/_.width*100))}};return"touchstart"in document.documentElement?(A.addEventListener("touchstart",ne),A.addEventListener("touchend",ne)):(A.addEventListener("mousedown",ne),A.addEventListener("mousemove",ne)),A.change=d.setValue,A.val=function(R){if(R===void 0)return d.getValue();d.setValue(R)},A.progressbar=d,d}function st(A,I){if(A.rating)return A.rating.setOptions(I,!0);var d={};d.options={},d.setOptions=function(U,re){var ne={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var R in ne)U&&U.hasOwnProperty(R)?d.options[R]=U[R]:(typeof d.options[R]>"u"||re===!0)&&(d.options[R]=ne[R]);A.innerHTML="";for(var _=0;_<d.options.number;_++){var q=document.createElement("div");q.setAttribute("data-index",_+1),q.setAttribute("title",d.options.tooltip[_]),A.appendChild(q)}if(d.options.value)for(var _=0;_<d.options.number;_++)_<d.options.value&&A.children[_].classList.add("jrating-selected");return d},d.setValue=function(U){for(var re=0;re<d.options.number;re++)re<U?A.children[re].classList.add("jrating-selected"):(A.children[re].classList.remove("jrating-over"),A.children[re].classList.remove("jrating-selected"));d.options.value=U,typeof d.options.onchange=="function"&&d.options.onchange(A,U),A.value!=d.options.value&&(A.value=d.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},d.getValue=function(){return d.options.value};var r=function(){d.setOptions(I),A.classList.add("jrating"),A.addEventListener("click",function(U){var re=U.target.getAttribute("data-index");re!=null&&(re==d.options.value?d.setValue(0):d.setValue(re))}),A.addEventListener("mouseover",function(U){for(var re=U.target.getAttribute("data-index"),ne=0;ne<d.options.number;ne++)ne<re?A.children[ne].classList.add("jrating-over"):A.children[ne].classList.remove("jrating-over")}),A.addEventListener("mouseout",function(U){for(var re=0;re<d.options.number;re++)A.children[re].classList.remove("jrating-over")}),A.change=d.setValue,A.val=function(U){if(U===void 0)return d.getValue();d.setValue(U)},A.rating=d};return r(),d}function ft(A,I){if(A.search)return A.search;var d=null,r=function(q){if(q.target.classList.contains("jsearch_item"))var Z=q.target;else var Z=q.target.parentNode;R.selectIndex(Z),q.preventDefault()},U=function(q){if(typeof R.options.onsearch=="function"){var Z=R.options.onsearch(R,q);Z&&(q=Z)}if(_.innerHTML="",!q.length)A.style.display="";else{A.style.display="block";for(var ie=q.length<11?q.length:10,we=0;we<ie;we++){if(typeof q[we]=="string")var fe=q[we],ve=q[we];else{var fe=q[we].text;!fe&&q[we].name&&(fe=q[we].name);var ve=q[we].value;!ve&&q[we].id&&(ve=q[we].id)}var Me=document.createElement("div");Me.setAttribute("data-value",ve),Me.setAttribute("data-text",fe),Me.className="jsearch_item",q[we].id&&Me.setAttribute("id",q[we].id),R.options.forceSelect&&we==0&&Me.classList.add("selected");var Se=document.createElement("img");q[we].image?Se.src=q[we].image:Se.style.display="none",Me.appendChild(Se);var Oe=document.createElement("div");Oe.innerHTML=fe,Me.appendChild(Oe),_.appendChild(Me)}}},re=function(q){if(q!=R.terms)if(R.terms=q,R.options.forceSelect?d=0:d=null,Array.isArray(R.options.data)){var Z=function(we){if(typeof we=="string"){if((""+we).toLowerCase().search(q.toLowerCase())>=0)return!0}else for(var fe in we){var ve=we[fe];if((""+ve).toLowerCase().search(q.toLowerCase())>=0)return!0}return!1},ie=R.options.data.filter(function(we){return Z(we)});U(ie)}else v({url:R.options.data+q,method:"GET",dataType:"json",success:function(we){U(we)}})},ne=null,R=function(q){ne&&clearTimeout(ne),ne=setTimeout(function(){re(q)},500)};I.forceSelect===null&&(I.forceSelect=!0),R.options={data:I.data||null,input:I.input||null,searchByNode:I.searchByNode||null,onselect:I.onselect||null,forceSelect:I.forceSelect,onsearch:I.onsearch||null,onbeforesearch:I.onbeforesearch||null},R.selectIndex=function(q){var Z=q.getAttribute("id"),ie=q.getAttribute("data-text"),we=q.getAttribute("data-value"),fe=q.children[0].src||"";typeof R.options.onselect=="function"&&R.options.onselect(R,ie,we,Z,fe),R.close()},R.open=function(){A.style.display="block"},R.close=function(){ne&&clearTimeout(ne),R.terms="",_.innerHTML="",A.style.display=""},R.isOpened=function(){return!!A.style.display},R.keydown=function(q){R.isOpened()&&(q.key=="Enter"?d!==null&&_.children[d]?(R.selectIndex(_.children[d]),q.preventDefault()):R.close():q.key==="ArrowUp"?(d!==null&&_.children[0]&&(_.children[d].classList.remove("selected"),!R.options.forceSelect&&d===0?d=null:(d=Math.max(0,d-1),_.children[d].classList.add("selected"))),q.preventDefault()):q.key==="ArrowDown"&&(d==null?d=-1:_.children[d].classList.remove("selected"),d<9&&_.children[d+1]&&d++,_.children[d].classList.add("selected"),q.preventDefault()))},R.keyup=function(q){if(!R.options.searchByNode&&R.options.input)if(R.options.input.tagName==="DIV")var Z=R.options.input.innerText;else var Z=R.options.input.value;else{var ie=l.getNode();if(ie)var Z=ie.innerText}if(typeof R.options.onbeforesearch=="function"){var we=R.options.onbeforesearch(R,Z);if(we)Z=we;else if(we===!1)return}R(Z)},R.blur=function(q){R.close()},R.options.input&&(R.options.input.addEventListener("keyup",R.keyup),R.options.input.addEventListener("keydown",R.keydown),R.options.input.addEventListener("blur",R.blur));var _=document.createElement("div");return _.classList.add("jsearch_container"),_.onmousedown=r,A.appendChild(_),A.classList.add("jsearch"),A.search=R,R}function vt(A,I){var d={};if(d.options={},d.currentImage=null,I&&(d.options=I),A.setAttribute("tabindex","900"),d.options.items=[],!A.classList.contains("jslider")){if(A.classList.add("jslider"),A.classList.add("unselectable"),d.options.height&&(A.style.minHeight=parseInt(d.options.height)+"px"),d.options.width&&(A.style.width=parseInt(d.options.width)+"px"),d.options.grid){A.classList.add("jslider-grid");var r=A.children.length;r>4&&A.setAttribute("data-total",r-4),A.setAttribute("data-number",r>4?4:r)}var U=document.createElement("div");if(U.classList.add("jslider-counter"),A.children.length>0)for(var re=0;re<A.children.length;re++){d.options.items.push(A.children[re]);var ne=document.createElement("div");ne.onclick=function(){var ie=Array.prototype.slice.call(U.children).indexOf(this);d.show(d.currentImage=d.options.items[ie])},U.appendChild(ne)}var R=document.createElement("div");R.className="jslider-caption";var _=document.createElement("div"),q=document.createElement("div");q.className="jslider-close",q.innerHTML="",q.onclick=function(){d.close()},_.appendChild(R),_.appendChild(q)}d.updateCounter=function(ie){for(var we=0;we<U.children.length;we++)if(U.children[we].classList.contains("jslider-counter-focus")){U.children[we].classList.remove("jslider-counter-focus");break}U.children[ie].classList.add("jslider-counter-focus")},d.show=function(ie){if(!ie)var ie=A.children[0];A.classList.add("jslider-focus"),A.classList.remove("jslider-grid"),A.appendChild(_),A.appendChild(U);var we=d.options.items.indexOf(ie);d.updateCounter(we);for(var fe=0;fe<A.children.length;fe++)A.children[fe].style.display="";ie.style.display="block",ie.previousElementSibling?A.classList.add("jslider-left"):A.classList.remove("jslider-left"),ie.nextElementSibling&&ie.nextElementSibling.tagName=="IMG"?A.classList.add("jslider-right"):A.classList.remove("jslider-right"),d.currentImage=ie,d.currentImage.offsetHeight>d.currentImage.offsetWidth&&d.currentImage.classList.add("jslider-vertical"),_.children[0].innerText=d.currentImage.getAttribute("title")},d.open=function(){d.show(),typeof d.options.onopen=="function"&&d.options.onopen(A)},d.close=function(){A.classList.remove("jslider-focus"),A.classList.remove("jslider-left"),A.classList.remove("jslider-right"),d.options.grid&&A.classList.add("jslider-grid");for(var ie=0;ie<A.children.length;ie++)A.children[ie].style.display="";U.remove(),_.remove(),d.currentImage=null,typeof d.options.onclose=="function"&&d.options.onclose(A)},d.reset=function(){A.innerHTML=""},d.next=function(){var ie=d.currentImage.nextElementSibling;ie&&ie.tagName==="IMG"&&d.show(d.currentImage.nextElementSibling)},d.prev=function(){d.currentImage.previousElementSibling&&d.show(d.currentImage.previousElementSibling)};var Z=function(ie){if(ie.target.tagName=="IMG")d.show(ie.target);else if(!ie.target.classList.contains("jslider-close")&&!(ie.target.parentNode.classList.contains("jslider-counter")||ie.target.classList.contains("jslider-counter"))){var we=ie.offsetX||ie.changedTouches[0].clientX;ie.target.clientWidth-we<40?d.next():we<40&&d.prev()}};return"ontouchend"in document.documentElement?A.addEventListener("touchend",Z):A.addEventListener("mouseup",Z),A.addEventListener("swipeleft",function(ie){d.next(),ie.preventDefault(),ie.stopPropagation()}),A.addEventListener("swiperight",function(ie){d.prev(),ie.preventDefault(),ie.stopPropagation()}),A.addEventListener("keydown",function(ie){ie.which==27&&d.close()}),A.slider=d,d}function yt(A,I){if(A.tags)return A.tags.setOptions(I,!0);var d={type:"tags"};d.options={};var r=function(){return!!(d.options.limit&&A.children.length>=d.options.limit)},U=null,re=null;d.setOptions=function(te,be){var Te={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var z in Te)te&&te.hasOwnProperty(z)?d.options[z]=te[z]:(typeof d.options[z]>"u"||be===!0)&&(d.options[z]=Te[z]);return d.options.placeholder?A.setAttribute("data-placeholder",d.options.placeholder):A.removeAttribute("data-placeholder"),A.placeholder=d.options.placeholder,d.setValue(d.options.value),q(),d.options.search?re||(re=document.createElement("div"),A.parentNode.insertBefore(re,A.nextSibling),U=ft(re,{data:d.options.search,onselect:function(ee,C,F){d.selectIndex(C,F)}})):re&&(U=null,re.remove(),re=null),d},d.add=function(te,be){if(typeof d.options.onbeforechange=="function"){var Te=d.options.onbeforechange(A,d,d.options.value,te);if(Te===!1)return!1;Te!=null&&(te=Te)}if(U&&U.close(),r())typeof d.options.onlimit=="function"?d.options.onlimit(d,d.options.limit):alert(s.translate("You reach the limit number of entries")+" "+d.options.limit);else{var z=l.getNode();if(z&&z.parentNode&&z.parentNode.classList.contains("jtags")&&z.nextSibling&&!(z.nextSibling.innerText&&z.nextSibling.innerText.trim()))ee=z.nextSibling;else{if(A.lastChild&&(A.lastChild.innerText.trim()||A.removeChild(A.lastChild)),!te||typeof te=="string")var ee=R(te,te,z);else for(var C=0;C<=te.length;C++)if(!r()){if(!te[C]||typeof te[C]=="string")var F=te[C]||"",J=null;else var F=te[C].text,J=te[C].value;var ee=R(F,J)}_()}be&&ne(ee)}},d.setLimit=function(te){for(d.options.limit=te,A.children.length-te;A.children.length>te;)A.removeChild(A.lastChild)},d.remove=function(te){te.parentNode.removeChild(te),A.children.length?_():d.add("",!0),typeof d.options.onremoveitem=="function"&&d.options.onremoveitem(A,d,te)},d.getData=function(){for(var te=[],be=0;be<A.children.length;be++){var Te=A.children[be].innerText.replace(`
`,""),z=A.children[be].getAttribute("data-value");z||(z=Te),(Te||z)&&te.push({text:Te,value:z})}return te},d.getValue=function(te){var be=null;if(te!=null)be=A.children[te].getAttribute("data-value"),be||(be=A.children[te].innerText.replace(`
`,""));else{for(var Te=[],z=0;z<A.children.length;z++)be=A.children[z].innerText.replace(`
`,""),be&&Te.push(d.getValue(z));be=Te.join(",")}return be},d.setValue=function(te){if(!te)d.reset();else if(A.value!=te)if(Array.isArray(te))d.add(te);else{var be=(""+te).trim(),Te=ie(be);A.innerHTML="",d.add(Te)}},d.reset=function(){A.classList.add("jtags-empty"),A.innerHTML="<div></div>",_()},d.isValid=function(){for(var te=0,be=0;be<A.children.length;be++)A.children[be].classList.contains("jtags_error")&&te++;return te==0},d.selectIndex=function(te,be){var Te=l.getNode();Te&&(Te.innerText=te,be&&Te.setAttribute("data-value",be),Te.classList.remove("jtags_error"),r()||d.add("",!0))},d.search=function(te){te.innerText},d.destroy=function(){A.removeEventListener("mouseup",Se),A.removeEventListener("keydown",fe),A.removeEventListener("keyup",ve),A.removeEventListener("paste",Me),A.removeEventListener("focus",Oe),A.removeEventListener("blur",Ge),A.parentNode.removeChild(A)};var ne=function(te){if(A.children.length){var be=document.createRange(),Te=window.getSelection();if(!te)var te=A.childNodes[A.childNodes.length-1];be.setStart(te,te.length),be.collapse(!0),Te.removeAllRanges(),Te.addRange(be),A.scrollLeft=A.scrollWidth}},R=function(te,be,Te){var z=document.createElement("div");return z.textContent=te||"",be&&z.setAttribute("data-value",be),Te&&Te.parentNode.classList.contains("jtags")?A.insertBefore(z,Te.nextSibling):A.appendChild(z),z},_=function(){var te=d.getValue();te!=d.options.value&&(d.options.value=te,typeof d.options.onchange=="function"&&d.options.onchange(A,d,d.options.value),A.value!=d.options.value&&(A.value=d.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))),q()},q=function(){for(var te=0;te<A.children.length;te++)A.children[te].tagName==="DIV"&&(d.getValue(te)?(A.children[te].classList.add("jtags_label"),typeof d.options.validation=="function"&&d.getValue(te)?d.options.validation(A.children[te],A.children[te].innerText,A.children[te].getAttribute("data-value"))?A.children[te].classList.remove("jtags_error"):A.children[te].classList.add("jtags_error"):A.children[te].classList.remove("jtags_error")):A.children[te].classList.remove("jtags_label"));Z()},Z=function(){A.innerText.trim()?A.classList.remove("jtags-empty"):(!A.children.length||A.children[0].tagName==="BR")&&(A.innerHTML="",ne(R()))},ie=function(te){var be=[],Te="";if(te=te.trim(),te){for(var z=0;z<te.length;z++)te[z]==","||te[z]==";"||te[z]==`
`?Te&&(be.push(Te.trim()),Te=""):Te+=te[z];Te&&be.push(Te)}return be},we=0,fe=function(te){if(we=window.getSelection().anchorOffset,Z(),te.key==="Tab"||te.key===";"||te.key===","){var be=window.getSelection().anchorOffset;be>1&&(r()?typeof d.options.onlimit=="function"&&d.options.onlimit(d,d.options.limit):d.add("",!0)),te.preventDefault()}else if(te.key=="Enter"){if(!U||!U.isOpened()){var be=window.getSelection().anchorOffset;be>1&&(r()||d.add("",!0)),te.preventDefault()}}else te.key=="Backspace"&&A.children.length==1&&window.getSelection().anchorOffset<1&&te.preventDefault();U&&U.keydown(te),Z()},ve=function(te){if(te.which==39){var be=window.getSelection().anchorOffset;be>1&&be==we&&d.add("",!0)}else te.which==13||te.which==38||te.which==40?te.preventDefault():U&&U.keyup(te);q()},Me=function(te){if(te.clipboardData||te.originalEvent.clipboardData)var be=(te.originalEvent||te).clipboardData.getData("text/plain");else if(window.clipboardData)var be=window.clipboardData.getData("Text");var Te=ie(be);if(typeof d.options.onbeforepaste=="function"){var z=d.options.onbeforepaste(A,d,Te);if(z===!1)return te.preventDefault(),!1;z&&(Te=z)}Te.length>1?(d.add(Te,!0),te.preventDefault()):Te[0]&&(document.execCommand("insertText",!1,Te[0]),te.preventDefault())},Se=function(te){if(te.target.parentNode&&te.target.parentNode.classList.contains("jtags")&&(te.target.classList.contains("jtags_label")||te.target.classList.contains("jtags_error"))){var be=te.target.getBoundingClientRect();be.width-(te.clientX-be.left)<16&&d.remove(te.target)}te.target==A&&ne()},Oe=function(){A.classList.contains("jtags-focus")||((!A.children.length||d.getValue(A.children.length-1))&&(r()||R("")),typeof d.options.onfocus=="function"&&d.options.onfocus(A,d,d.getValue()),A.classList.add("jtags-focus"))},Ge=function(){if(A.classList.contains("jtags-focus")){U&&U.close();for(var te=0;te<A.children.length-1;te++)d.getValue(te)||A.removeChild(A.children[te]);_(),A.classList.remove("jtags-focus"),typeof d.options.onblur=="function"&&d.options.onblur(A,d,d.getValue())}},et=function(){"touchend"in document.documentElement?A.addEventListener("touchend",Se):A.addEventListener("mouseup",Se),A.addEventListener("keydown",fe),A.addEventListener("keyup",ve),A.addEventListener("paste",Me),A.addEventListener("focus",Oe),A.addEventListener("blur",Ge),A.setAttribute("contenteditable",!0),A.classList.add("jtags"),d.setOptions(I),typeof d.options.onload=="function"&&d.options.onload(A,d),A.change=d.setValue,A.val=function(te){if(te===void 0)return d.getValue();d.setValue(te)},A.tags=d};return et(),d}function Tt(A,I){var d={};d.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var U in r)I&&I.hasOwnProperty(U)?d.options[U]=I[U]:d.options[U]=r[U];d.options.multiple==!0&&A.setAttribute("data-multiple",!0),A.content=[],A.classList.add("jupload"),d.options.input==!0&&A.classList.add("input"),d.add=function(_){if(d.options.multiple==!1&&(A.content=[],A.innerText=""),d.options.type=="image"){var q=document.createElement("img");q.setAttribute("src",_.file),q.setAttribute("tabindex",-1),A.getAttribute("name")||(q.className="jfile",q.content=_),A.appendChild(q)}else{if(_.name)var Z=_.name;else var Z=_.file;var ie=document.createElement("div");ie.innerText=Z||d.options.type,ie.classList.add("jupload-item"),ie.setAttribute("tabindex",-1),A.appendChild(ie)}_.content&&(_.file=l.guid()),A.content.push(_),typeof d.options.onchange=="function"&&d.options.onchange(A,_)},d.addFromFile=function(_){var q=_.type.split("/");if(q[0]==d.options.type){var Z=new FileReader;Z.addEventListener("load",function(ie){var we={file:ie.srcElement.result,extension:_.name.substr(_.name.lastIndexOf(".")+1),name:_.name,size:_.size,lastmodified:_.lastModified,content:ie.srcElement.result};d.add(we)}),Z.readAsDataURL(_)}else alert(s.translate("This extension is not allowed"))},d.addFromUrl=function(_){if(_.substr(0,4)!="data"&&!d.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(_.substr(0,4)=="data"){var q=_.split(";");q=q[0].split("/");var Z=q[0].replace("data:","");if(Z==d.options.type){var ie={file:_,name:"",extension:q[1],content:_};d.add(ie)}else alert(d.options.text.extensionNotAllowed)}else{var q=_.substr(_.lastIndexOf(".")+1);_=d.options.remoteParser+_,v({url:_,type:"GET",dataType:"blob",success:function(fe){}})}};var re=d.options.type+"/"+d.options.extension,ne=document.createElement("input");ne.type="file",ne.setAttribute("accept",re),ne.onchange=function(){for(var _=0;_<this.files.length;_++)d.addFromFile(this.files[_])},d.options.multiple==!0&&ne.setAttribute("multiple",!0);var R=null;return A.addEventListener("click",function(_){R=null,!A.children.length||_.target===A?l.click(ne):_.target.parentNode==A&&(R=_.target)}),A.addEventListener("dblclick",function(_){l.click(ne)}),A.addEventListener("dragenter",function(_){A.style.border="1px dashed #000"}),A.addEventListener("dragleave",function(_){A.style.border="1px solid #eee"}),A.addEventListener("dragstop",function(_){A.style.border="1px solid #eee"}),A.addEventListener("dragover",function(_){_.preventDefault()}),A.addEventListener("keydown",function(_){if(R&&_.which==46){var q=Array.prototype.indexOf.call(A.children,R);q>=0&&(A.content.splice(q,1),R.remove(),R=null)}}),A.addEventListener("drop",function(_){_.preventDefault(),_.stopPropagation();var q=(_.originalEvent||_).dataTransfer.getData("text/html"),Z=(_.originalEvent||_).dataTransfer.files;if(Z.length)for(var ie=0;ie<_.dataTransfer.files.length;ie++)d.addFromFile(_.dataTransfer.files[ie]);else if(q){d.options.multiple==!1&&(A.innerText="");var we=document.createElement("div");we.innerHTML=q;var fe=we.querySelectorAll("img");if(fe.length)for(var ie=0;ie<fe.length;ie++)d.addFromUrl(fe[ie].src)}return A.style.border="1px solid #eee",!1}),A.val=function(_){if(_===void 0)return A.content&&A.content.length?A.content:null;if(A.innerText="",A.content=[],_)if(Array.isArray(_))for(var q=0;q<_.length;q++)typeof _[q]=="string"?d.add({file:_[q]}):d.add(_[q]);else typeof _=="string"&&d.add({file:_})},A.upload=A.image=d,d}var St=T(195),It=T.n(St),gt={...s,...l,version:"5.9.2",setExtensions:function(A){if(typeof A=="object")for(var I=Object.keys(A),d=0;d<I.length;d++)gt[I[d]]=A[I[d]]},tracking:S,path:a,sorting:h,lazyLoading:f,ajax:v,animation:L,calendar:V,color:ae,contextmenu:ce,dropdown:ye,editor:Ze,floating:Le,form:Ce,mask:O,modal:Ve,notification:Xe,palette:ge,picker:ke,progressbar:lt,rating:st,search:ft,slider:vt,tabs:G,tags:yt,toolbar:Pe,upload:Tt,validations:ot};gt.image=Tt,gt.image.create=function(A){var I=document.createElement("img");return I.setAttribute("src",A.file),I.className="jfile",I.setAttribute("tabindex",-1),I.content=A,I},gt.tracker=Ce,gt.loading=L.loading,gt.sha512=It(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const A=function(te,be){return te[be.type]&&te[be.type]==be||te.component&&te.component==be?!0:te.parentNode?A(te.parentNode,be):!1},I=function(te){let be=window.jSuitesStateControl;if(be&&be.length>0)for(let Te=0;Te<be.length;Te++)be[Te]&&!A(te,be[Te])&&be[Te].close()};let d=15,r=!1,U={x:null,y:null},re=document.createElement("div");re.classList.add("jtooltip");const ne=function(te){return te&&(te.shadowRoot||te.tagName&&te.tagName.includes("-"))},R=function(te){let be,Te,z=te.path||te.composedPath&&te.composedPath();return z?(Te=z[0],Te&&ne(Te)&&!Te.shadowRoot&&te.toElement&&(Te=te.toElement)):(te.target&&ne(te.target)?be=te.target.shadowRoot:be=document,Te=be.elementFromPoint(x,y)),Te},_=function(te){if(te.changedTouches&&te.changedTouches[0])var be=te.changedTouches[0].clientX,Te=te.changedTouches[0].clientY;else var be=te.clientX,Te=te.clientY;let z=R(te),ee=z&&z.tagName==="DIV"&&z.getAttribute("contentEditable"),C=gt.findElement(z,"jpanel");if(C&&!C.classList.contains("readonly")&&!ee){let F=C.getBoundingClientRect(),J=0;C.style.rotate&&(J=parseFloat(C.style.rotate));let de="move";z.getAttribute("data-action")?de=z.getAttribute("data-action"):C.style.cursor?de="resize":C.style.cursor="move",r={action:de,a:J,e:C,x:be,y:Te,l:F.left,t:F.top,b:F.bottom,r:F.right,w:F.width,h:F.height,d:C.style.cursor,actioned:!1},C.style.width||(C.style.width=F.width+"px"),C.style.height||(C.style.height=F.height+"px")}else r=!1;I(z),ve(te)},q=function(te,be,Te,z,ee,C){const F=Te-te,J=z-be,de=ee-te,Q=C-be;let pe=Math.atan2(J,F),_e=Math.atan2(Q,de)-pe;return _e=_e*(180/Math.PI),_e<0&&(_e+=360),_e},Z=function(te){r&&r.e&&(typeof r.e.refresh=="function"&&U.actioned&&r.e.refresh(),r.e.style.cursor=""),U={x:null,y:null},r=!1},ie=function(te){if(r){let C=te.clientX||te.pageX,F=te.clientY||te.pageY;if(U.x==null&&U.y==null&&(U.x=C,U.y=F),r.action==="move"){var be=C-U.x,Te=F-U.y,z=r.e.offsetTop+Te,ee=r.e.offsetLeft+be;r.e.style.top=z+"px",r.e.style.left=ee+"px",typeof r.e.refresh=="function"&&(U.actioned=!0,r.e.refresh("position",z,ee))}else if(r.action==="rotate"){let J=r.l+r.w/2,de=r.t+r.h/2,Q=q(J,de,r.x,r.y,C,F);Q=Q+r.a%360,Q=Math.round(Q/2)*2,r.e.style.rotate=`${Q}deg`,typeof r.e.refresh=="function"&&(U.actioned=!0,r.e.refresh("rotate",Q))}else if(r.action==="resize"){let J=null,de=null,Q=null,pe=null;r.d=="e-resize"||r.d=="ne-resize"||r.d=="se-resize"?(Q=r.e.offsetWidth+(C-U.x),te.shiftKey&&(pe=r.e.offsetHeight+(C-U.x)*(r.e.offsetHeight/r.e.offsetWidth))):(r.d==="w-resize"||r.d=="nw-resize"||r.d=="sw-resize")&&(de=r.e.offsetLeft+(C-U.x),Q=r.e.offsetLeft+r.e.offsetWidth-de,te.shiftKey&&(pe=r.e.offsetHeight-(C-U.x)*(r.e.offsetHeight/r.e.offsetWidth))),r.d=="s-resize"||r.d=="se-resize"||r.d=="sw-resize"?pe||(pe=r.e.offsetHeight+(F-U.y)):(r.d==="n-resize"||r.d=="ne-resize"||r.d=="nw-resize")&&(J=r.e.offsetTop+(F-U.y),pe=r.e.offsetTop+r.e.offsetHeight-J),J&&(r.e.style.top=J+"px"),de&&(r.e.style.left=de+"px"),Q&&(r.e.style.width=Q+"px"),pe&&(r.e.style.height=pe+"px"),typeof r.e.refresh=="function"&&(U.actioned=!0,r.e.refresh("dimensions",Q,pe))}U.x=C,U.y=F}else{let C=R(te),F=gt.findElement(C,"jpanel");if(F){if(F.classList.contains("jpanel-controls")){let de=C.getAttribute("data-position");de?F.style.cursor=de:F.style.cursor=""}else if(F.getAttribute("tabindex")){let de=F.getBoundingClientRect();te.clientY-de.top<d?de.width-(te.clientX-de.left)<d?F.style.cursor="ne-resize":te.clientX-de.left<d?F.style.cursor="nw-resize":F.style.cursor="n-resize":de.height-(te.clientY-de.top)<d?de.width-(te.clientX-de.left)<d?F.style.cursor="se-resize":te.clientX-de.left<d?F.style.cursor="sw-resize":F.style.cursor="s-resize":de.width-(te.clientX-de.left)<d?F.style.cursor="e-resize":te.clientX-de.left<d?F.style.cursor="w-resize":F.style.cursor=""}}}};let we=["n","ne","e","se","s","sw","w","nw","rotate"];we.forEach(function(te,be){we[be]=document.createElement("div"),we[be].classList.add("jpanel-action"),te==="rotate"?we[be].setAttribute("data-action","rotate"):(we[be].setAttribute("data-action","resize"),we[be].setAttribute("data-position",te+"-resize"))});let fe;const ve=function(te){let be=R(te),Te=gt.findElement(be,"jpanel");Te&&!Te.classList.contains("readonly")&&Te.classList.contains("jpanel-controls")?(Te.append(...we),Te.classList.contains("jpanel-rotate")||we[we.length-1].remove(),fe=Te):Me()},Me=function(te){fe&&(we.forEach(function(be){be.remove()}),fe=null)},Se=function(te){var Te=R(te).getAttribute("data-tooltip");if(Te){if(re.innerText=Te,te.changedTouches&&te.changedTouches[0])var z=te.changedTouches[0].clientX,ee=te.changedTouches[0].clientY;else var z=te.clientX,ee=te.clientY;re.style.top=ee+"px",re.style.left=z+"px",document.body.appendChild(re)}else re.innerText&&(re.innerText="",document.body.removeChild(re))},Oe=function(te){var be=document.activeElement;if(be&&typeof be.contextmenu=="function")be.contextmenu(te),te.preventDefault(),te.stopImmediatePropagation();else if(be=gt.findElement(te.target,function(z){return z.tagName&&z.getAttribute("aria-contextmenu-id")}),be){var Te=document.querySelector("#"+be);Te?(Te.contextmenu.open(te),te.preventDefault(),te.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+be)}},Ge=function(te){let be=document.activeElement;be&&te.key==="Delete"&&typeof be.delete=="function"&&(be.delete(),te.preventDefault(),te.stopImmediatePropagation());let Te=window.jSuitesStateControl;Te&&Te.length>0&&(be=Te[Te.length-1],be&&te.key==="Escape"&&typeof be.isOpened=="function"&&typeof be.close=="function"&&be.isOpened()&&(be.close(),te.preventDefault(),te.stopImmediatePropagation()))},et=function(te){(te.target.getAttribute("data-mask")||te.target.mask)&&gt.mask(te)};document.addEventListener("focusin",ve),document.addEventListener("mouseup",Z),document.addEventListener("mousedown",_),document.addEventListener("mousemove",ie),document.addEventListener("mouseover",Se),document.addEventListener("keydown",Ge),document.addEventListener("contextmenu",Oe),document.addEventListener("input",et)}();var Ot=gt})(),o=X.default}(),o})}(jsuites$1)),jsuites$1.exports}var dist$2={exports:{}},dist$1=dist$2.exports,hasRequiredDist$1;function requireDist$1(){return hasRequiredDist$1||(hasRequiredDist$1=1,function(n,g){(function(o,p){n.exports=p()})(dist$1,function(){var o;return function(){var p={765:function(H,m){var s;s=function(w){w.version="1.0.2";var S=Math;function M(ce,oe){for(var ye=0,ke=0;ye<ce.length;++ye)ke=oe*ke+ce[ye];return ke}function l(ce,oe,ye,ke,Pe){if(oe===0)return ye;if(oe===1)return ke;for(var Be=2/ce,Ze=ke,W=1;W<oe;++W)Ze=ke*W*Be+Pe*ye,ye=ke,ke=Ze;return Ze}function a(ce,oe,ye,ke,Pe){return function(Be,Ze){if(ke){if(Be===0)return ke==1?-1/0:1/0;if(Be<0)return NaN}return Ze===0?ce(Be):Ze===1?oe(Be):Ze<0?NaN:l(Be,Ze|=0,ce(Be),oe(Be),Pe)}}var h,f,c,v,j,L,k,N,D,O,Y,V,ue,ge=function(){var ce=.636619772,oe=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),ye=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),ke=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Pe=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Be(Ne){var Ce=0,Ie=0,Ve=0,We=Ne*Ne;if(Ne<8)Ce=(Ie=M(oe,We))/(Ve=M(ye,We));else{var Xe=Ne-.785398164;Ie=M(ke,We=64/We),Ve=M(Pe,We),Ce=S.sqrt(ce/Ne)*(S.cos(Xe)*Ie-S.sin(Xe)*Ve*8/Ne)}return Ce}var Ze=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),W=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ye=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function ot(Ne){var Ce=0,Ie=0,Ve=0,We=Ne*Ne,Xe=S.abs(Ne)-2.356194491;return Math.abs(Ne)<8?Ce=(Ie=Ne*M(Ze,We))/(Ve=M(W,We)):(Ie=M(Le,We=64/We),Ve=M(Ye,We),Ce=S.sqrt(ce/S.abs(Ne))*(S.cos(Xe)*Ie-S.sin(Xe)*Ve*8/S.abs(Ne)),Ne<0&&(Ce=-Ce)),Ce}return function Ne(Ce,Ie){if(Ie=Math.round(Ie),!isFinite(Ce))return isNaN(Ce)?Ce:0;if(Ie<0)return(Ie%2?-1:1)*Ne(Ce,-Ie);if(Ce<0)return(Ie%2?-1:1)*Ne(-Ce,Ie);if(Ie===0)return Be(Ce);if(Ie===1)return ot(Ce);if(Ce===0)return 0;var Ve=0;if(Ce>Ie)Ve=l(Ce,Ie,Be(Ce),ot(Ce),-1);else{for(var We=!1,Xe=0,lt=0,st=1,ft=0,vt=2/Ce,yt=2*S.floor((Ie+S.floor(S.sqrt(40*Ie)))/2);yt>0;yt--)ft=yt*vt*st-Xe,Xe=st,st=ft,S.abs(st)>1e10&&(st*=1e-10,Xe*=1e-10,Ve*=1e-10,lt*=1e-10),We&&(lt+=st),We=!We,yt==Ie&&(Ve=Xe);Ve/=lt=2*lt-st}return Ve}}(),G=(h=.636619772,f=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),c=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),v=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),j=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),L=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),k=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),N=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),D=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),a(function(ce){var oe=0,ye=0,ke=0,Pe=ce*ce,Be=ce-.785398164;return ce<8?oe=(ye=M(f,Pe))/(ke=M(c,Pe))+h*ge(ce,0)*S.log(ce):(ye=M(v,Pe=64/Pe),ke=M(j,Pe),oe=S.sqrt(h/ce)*(S.sin(Be)*ye+S.cos(Be)*ke*8/ce)),oe},function(ce){var oe=0,ye=0,ke=0,Pe=ce*ce,Be=ce-2.356194491;return ce<8?oe=(ye=ce*M(L,Pe))/(ke=M(k,Pe))+h*(ge(ce,1)*S.log(ce)-1/ce):(ye=M(N,Pe=64/Pe),ke=M(D,Pe),oe=S.sqrt(h/ce)*(S.sin(Be)*ye+S.cos(Be)*ke*8/ce)),oe},0,1,-1)),ae=(O=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Y=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),V=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ue=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ce(oe,ye){if((ye=Math.round(ye))===0)return function(Ye){return Ye<=3.75?M(O,Ye*Ye/14.0625):S.exp(S.abs(Ye))/S.sqrt(S.abs(Ye))*M(Y,3.75/S.abs(Ye))}(oe);if(ye===1)return function(Ye){return Ye<3.75?Ye*M(V,Ye*Ye/14.0625):(Ye<0?-1:1)*S.exp(S.abs(Ye))/S.sqrt(S.abs(Ye))*M(ue,3.75/S.abs(Ye))}(oe);if(ye<0)return NaN;if(S.abs(oe)===0)return 0;if(oe==1/0)return 1/0;var ke,Pe=0,Be=2/S.abs(oe),Ze=0,W=1,Le=0;for(ke=2*S.round((ye+S.round(S.sqrt(40*ye)))/2);ke>0;ke--)Le=ke*Be*W+Ze,Ze=W,W=Le,S.abs(W)>1e10&&(W*=1e-10,Ze*=1e-10,Pe*=1e-10),ke==ye&&(Pe=Ze);return Pe*=ce(oe,0)/W,oe<0&&ye%2?-Pe:Pe}),he=function(){var ce=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),oe=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),ye=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),ke=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return a(function(Pe){return Pe<=2?-S.log(Pe/2)*ae(Pe,0)+M(ce,Pe*Pe/4):S.exp(-Pe)/S.sqrt(Pe)*M(oe,2/Pe)},function(Pe){return Pe<=2?S.log(Pe/2)*ae(Pe,1)+1/Pe*M(ye,Pe*Pe/4):S.exp(-Pe)/S.sqrt(Pe)*M(ke,2/Pe)},0,2,1)}();w.besselj=ge,w.bessely=G,w.besseli=ae,w.besselk=he},s(typeof DO_NOT_EXPORT_BESSEL>"u"?m:{})},162:function(H){var m;H.exports=(m=function(s,w){var S=Array.prototype.concat,M=Array.prototype.slice,l=Object.prototype.toString;function a(D,O){var Y=D>O?D:O;return s.pow(10,17-~~(s.log(Y>0?Y:-Y)*s.LOG10E))}var h=Array.isArray||function(D){return l.call(D)==="[object Array]"};function f(D){return l.call(D)==="[object Function]"}function c(D){return typeof D=="number"&&D-D==0}function v(){return new v._init(arguments)}function j(){return 0}function L(){return 1}function k(D,O){return D===O?1:0}v.fn=v.prototype,v._init=function(D){if(h(D[0]))if(h(D[0][0])){f(D[1])&&(D[0]=v.map(D[0],D[1]));for(var O=0;O<D[0].length;O++)this[O]=D[0][O];this.length=D[0].length}else this[0]=f(D[1])?v.map(D[0],D[1]):D[0],this.length=1;else if(c(D[0]))this[0]=v.seq.apply(null,D),this.length=1;else{if(D[0]instanceof v)return v(D[0].toArray());this[0]=[],this.length=1}return this},v._init.prototype=v.prototype,v._init.constructor=v,v.utils={calcRdx:a,isArray:h,isFunction:f,isNumber:c,toVector:function(D){return S.apply([],D)}},v._random_fn=s.random,v.setRandom=function(D){if(typeof D!="function")throw new TypeError("fn is not a function");v._random_fn=D},v.extend=function(D){var O,Y;if(arguments.length===1){for(Y in D)v[Y]=D[Y];return this}for(O=1;O<arguments.length;O++)for(Y in arguments[O])D[Y]=arguments[O][Y];return D},v.rows=function(D){return D.length||1},v.cols=function(D){return D[0].length||1},v.dimensions=function(D){return{rows:v.rows(D),cols:v.cols(D)}},v.row=function(D,O){return h(O)?O.map(function(Y){return v.row(D,Y)}):D[O]},v.rowa=function(D,O){return v.row(D,O)},v.col=function(D,O){if(h(O)){var Y=v.arange(D.length).map(function(){return new Array(O.length)});return O.forEach(function(ge,G){v.arange(D.length).forEach(function(ae){Y[ae][G]=D[ae][ge]})}),Y}for(var V=new Array(D.length),ue=0;ue<D.length;ue++)V[ue]=[D[ue][O]];return V},v.cola=function(D,O){return v.col(D,O).map(function(Y){return Y[0]})},v.diag=function(D){for(var O=v.rows(D),Y=new Array(O),V=0;V<O;V++)Y[V]=[D[V][V]];return Y},v.antidiag=function(D){for(var O=v.rows(D)-1,Y=new Array(O),V=0;O>=0;O--,V++)Y[V]=[D[V][O]];return Y},v.transpose=function(D){var O,Y,V,ue,ge,G=[];for(h(D[0])||(D=[D]),Y=D.length,V=D[0].length,ge=0;ge<V;ge++){for(O=new Array(Y),ue=0;ue<Y;ue++)O[ue]=D[ue][ge];G.push(O)}return G.length===1?G[0]:G},v.map=function(D,O,Y){var V,ue,ge,G,ae;for(h(D[0])||(D=[D]),ue=D.length,ge=D[0].length,G=Y?D:new Array(ue),V=0;V<ue;V++)for(G[V]||(G[V]=new Array(ge)),ae=0;ae<ge;ae++)G[V][ae]=O(D[V][ae],V,ae);return G.length===1?G[0]:G},v.cumreduce=function(D,O,Y){var V,ue,ge,G,ae;for(h(D[0])||(D=[D]),ue=D.length,ge=D[0].length,G=Y?D:new Array(ue),V=0;V<ue;V++)for(G[V]||(G[V]=new Array(ge)),ge>0&&(G[V][0]=D[V][0]),ae=1;ae<ge;ae++)G[V][ae]=O(G[V][ae-1],D[V][ae]);return G.length===1?G[0]:G},v.alter=function(D,O){return v.map(D,O,!0)},v.create=function(D,O,Y){var V,ue,ge=new Array(D);for(f(O)&&(Y=O,O=D),V=0;V<D;V++)for(ge[V]=new Array(O),ue=0;ue<O;ue++)ge[V][ue]=Y(V,ue);return ge},v.zeros=function(D,O){return c(O)||(O=D),v.create(D,O,j)},v.ones=function(D,O){return c(O)||(O=D),v.create(D,O,L)},v.rand=function(D,O){return c(O)||(O=D),v.create(D,O,v._random_fn)},v.identity=function(D,O){return c(O)||(O=D),v.create(D,O,k)},v.symmetric=function(D){var O,Y,V=D.length;if(D.length!==D[0].length)return!1;for(O=0;O<V;O++)for(Y=0;Y<V;Y++)if(D[Y][O]!==D[O][Y])return!1;return!0},v.clear=function(D){return v.alter(D,j)},v.seq=function(D,O,Y,V){f(V)||(V=!1);var ue,ge=[],G=a(D,O),ae=(O*G-D*G)/((Y-1)*G),he=D;for(ue=0;he<=O&&ue<Y;he=(D*G+ae*G*++ue)/G)ge.push(V?V(he,ue):he);return ge},v.arange=function(D,O,Y){var V,ue=[];if(Y=Y||1,O===w&&(O=D,D=0),D===O||Y===0)return[];if(D<O&&Y<0)return[];if(D>O&&Y>0)return[];if(Y>0)for(V=D;V<O;V+=Y)ue.push(V);else for(V=D;V>O;V+=Y)ue.push(V);return ue},v.slice=function(){function D(O,Y,V,ue){var ge,G=[],ae=O.length;if(Y===w&&V===w&&ue===w)return v.copy(O);if(ue=ue||1,(Y=(Y=Y||0)>=0?Y:ae+Y)===(V=(V=V||O.length)>=0?V:ae+V)||ue===0)return[];if(Y<V&&ue<0)return[];if(Y>V&&ue>0)return[];if(ue>0)for(ge=Y;ge<V;ge+=ue)G.push(O[ge]);else for(ge=Y;ge>V;ge+=ue)G.push(O[ge]);return G}return function(O,Y){var V,ue;return c((Y=Y||{}).row)?c(Y.col)?O[Y.row][Y.col]:D(v.rowa(O,Y.row),(V=Y.col||{}).start,V.end,V.step):c(Y.col)?D(v.cola(O,Y.col),(ue=Y.row||{}).start,ue.end,ue.step):(ue=Y.row||{},V=Y.col||{},D(O,ue.start,ue.end,ue.step).map(function(ge){return D(ge,V.start,V.end,V.step)}))}}(),v.sliceAssign=function(D,O,Y){var V,ue;if(c(O.row)){if(c(O.col))return D[O.row][O.col]=Y;O.col=O.col||{},O.col.start=O.col.start||0,O.col.end=O.col.end||D[0].length,O.col.step=O.col.step||1,V=v.arange(O.col.start,s.min(D.length,O.col.end),O.col.step);var ge=O.row;return V.forEach(function(ae,he){D[ge][ae]=Y[he]}),D}if(c(O.col)){O.row=O.row||{},O.row.start=O.row.start||0,O.row.end=O.row.end||D.length,O.row.step=O.row.step||1,ue=v.arange(O.row.start,s.min(D[0].length,O.row.end),O.row.step);var G=O.col;return ue.forEach(function(ae,he){D[ae][G]=Y[he]}),D}return Y[0].length===w&&(Y=[Y]),O.row.start=O.row.start||0,O.row.end=O.row.end||D.length,O.row.step=O.row.step||1,O.col.start=O.col.start||0,O.col.end=O.col.end||D[0].length,O.col.step=O.col.step||1,ue=v.arange(O.row.start,s.min(D.length,O.row.end),O.row.step),V=v.arange(O.col.start,s.min(D[0].length,O.col.end),O.col.step),ue.forEach(function(ae,he){V.forEach(function(ce,oe){D[ae][ce]=Y[he][oe]})}),D},v.diagonal=function(D){var O=v.zeros(D.length,D.length);return D.forEach(function(Y,V){O[V][V]=Y}),O},v.copy=function(D){return D.map(function(O){return c(O)?O:O.map(function(Y){return Y})})};var N=v.prototype;return N.length=0,N.push=Array.prototype.push,N.sort=Array.prototype.sort,N.splice=Array.prototype.splice,N.slice=Array.prototype.slice,N.toArray=function(){return this.length>1?M.call(this):M.call(this)[0]},N.map=function(D,O){return v(v.map(this,D,O))},N.cumreduce=function(D,O){return v(v.cumreduce(this,D,O))},N.alter=function(D){return v.alter(this,D),this},function(D){for(var O=0;O<D.length;O++)(function(Y){N[Y]=function(V){var ue,ge=this;return V?(setTimeout(function(){V.call(ge,N[Y].call(ge))}),this):(ue=v[Y](this),h(ue)?v(ue):ue)}})(D[O])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(D){for(var O=0;O<D.length;O++)(function(Y){N[Y]=function(V,ue){var ge=this;return ue?(setTimeout(function(){ue.call(ge,N[Y].call(ge,V))}),this):v(v[Y](this,V))}})(D[O])}("row col".split(" ")),function(D){for(var O=0;O<D.length;O++)(function(Y){N[Y]=function(){return v(v[Y].apply(null,arguments))}})(D[O])}("create zeros ones rand identity".split(" ")),v}(Math),function(s,w){var S=s.utils.isFunction;function M(h,f){return h-f}function l(h,f,c){return w.max(f,w.min(h,c))}s.sum=function(h){for(var f=0,c=h.length;--c>=0;)f+=h[c];return f},s.sumsqrd=function(h){for(var f=0,c=h.length;--c>=0;)f+=h[c]*h[c];return f},s.sumsqerr=function(h){for(var f,c=s.mean(h),v=0,j=h.length;--j>=0;)v+=(f=h[j]-c)*f;return v},s.sumrow=function(h){for(var f=0,c=h.length;--c>=0;)f+=h[c];return f},s.product=function(h){for(var f=1,c=h.length;--c>=0;)f*=h[c];return f},s.min=function(h){for(var f=h[0],c=0;++c<h.length;)h[c]<f&&(f=h[c]);return f},s.max=function(h){for(var f=h[0],c=0;++c<h.length;)h[c]>f&&(f=h[c]);return f},s.unique=function(h){for(var f={},c=[],v=0;v<h.length;v++)f[h[v]]||(f[h[v]]=!0,c.push(h[v]));return c},s.mean=function(h){return s.sum(h)/h.length},s.meansqerr=function(h){return s.sumsqerr(h)/h.length},s.geomean=function(h){var f=h.map(w.log),c=s.mean(f);return w.exp(c)},s.median=function(h){var f=h.length,c=h.slice().sort(M);return 1&f?c[f/2|0]:(c[f/2-1]+c[f/2])/2},s.cumsum=function(h){return s.cumreduce(h,function(f,c){return f+c})},s.cumprod=function(h){return s.cumreduce(h,function(f,c){return f*c})},s.diff=function(h){var f,c=[],v=h.length;for(f=1;f<v;f++)c.push(h[f]-h[f-1]);return c},s.rank=function(h){var f,c=[],v={};for(f=0;f<h.length;f++)v[N=h[f]]?v[N]++:(v[N]=1,c.push(N));var j=c.sort(M),L={},k=1;for(f=0;f<j.length;f++){var N,D=v[N=j[f]],O=(k+(k+D-1))/2;L[N]=O,k+=D}return h.map(function(Y){return L[Y]})},s.mode=function(h){var f,c=h.length,v=h.slice().sort(M),j=1,L=0,k=0,N=[];for(f=0;f<c;f++)v[f]===v[f+1]?j++:(j>L?(N=[v[f]],L=j,k=0):j===L&&(N.push(v[f]),k++),j=1);return k===0?N[0]:N},s.range=function(h){return s.max(h)-s.min(h)},s.variance=function(h,f){return s.sumsqerr(h)/(h.length-(f?1:0))},s.pooledvariance=function(h){return h.reduce(function(f,c){return f+s.sumsqerr(c)},0)/(h.reduce(function(f,c){return f+c.length},0)-h.length)},s.deviation=function(h){for(var f=s.mean(h),c=h.length,v=new Array(c),j=0;j<c;j++)v[j]=h[j]-f;return v},s.stdev=function(h,f){return w.sqrt(s.variance(h,f))},s.pooledstdev=function(h){return w.sqrt(s.pooledvariance(h))},s.meandev=function(h){for(var f=s.mean(h),c=[],v=h.length-1;v>=0;v--)c.push(w.abs(h[v]-f));return s.mean(c)},s.meddev=function(h){for(var f=s.median(h),c=[],v=h.length-1;v>=0;v--)c.push(w.abs(h[v]-f));return s.median(c)},s.coeffvar=function(h){return s.stdev(h)/s.mean(h)},s.quartiles=function(h){var f=h.length,c=h.slice().sort(M);return[c[w.round(f/4)-1],c[w.round(f/2)-1],c[w.round(3*f/4)-1]]},s.quantiles=function(h,f,c,v){var j,L,k,N,D,O=h.slice().sort(M),Y=[f.length],V=h.length;for(c===void 0&&(c=.375),v===void 0&&(v=.375),j=0;j<f.length;j++)k=V*(L=f[j])+(c+L*(1-c-v)),N=w.floor(l(k,1,V-1)),D=l(k-N,0,1),Y[j]=(1-D)*O[N-1]+D*O[N];return Y},s.percentile=function(h,f,c){var v=h.slice().sort(M),j=f*(v.length+(c?1:-1))+(c?0:1),L=parseInt(j),k=j-L;return L+1<v.length?v[L-1]+k*(v[L]-v[L-1]):v[L-1]},s.percentileOfScore=function(h,f,c){var v,j,L=0,k=h.length,N=!1;for(c==="strict"&&(N=!0),j=0;j<k;j++)v=h[j],(N&&v<f||!N&&v<=f)&&L++;return L/k},s.histogram=function(h,f){f=f||4;var c,v=s.min(h),j=(s.max(h)-v)/f,L=h.length,k=[];for(c=0;c<f;c++)k[c]=0;for(c=0;c<L;c++)k[w.min(w.floor((h[c]-v)/j),f-1)]+=1;return k},s.covariance=function(h,f){var c,v=s.mean(h),j=s.mean(f),L=h.length,k=new Array(L);for(c=0;c<L;c++)k[c]=(h[c]-v)*(f[c]-j);return s.sum(k)/(L-1)},s.corrcoeff=function(h,f){return s.covariance(h,f)/s.stdev(h,1)/s.stdev(f,1)},s.spearmancoeff=function(h,f){return h=s.rank(h),f=s.rank(f),s.corrcoeff(h,f)},s.stanMoment=function(h,f){for(var c=s.mean(h),v=s.stdev(h),j=h.length,L=0,k=0;k<j;k++)L+=w.pow((h[k]-c)/v,f);return L/h.length},s.skewness=function(h){return s.stanMoment(h,3)},s.kurtosis=function(h){return s.stanMoment(h,4)-3};var a=s.prototype;(function(h){for(var f=0;f<h.length;f++)(function(c){a[c]=function(v,j){var L=[],k=0,N=this;if(S(v)&&(j=v,v=!1),j)return setTimeout(function(){j.call(N,a[c].call(N,v))}),this;if(this.length>1){for(N=v===!0?this:this.transpose();k<N.length;k++)L[k]=s[c](N[k]);return L}return s[c](this[0],v)}})(h[f])})("cumsum cumprod".split(" ")),function(h){for(var f=0;f<h.length;f++)(function(c){a[c]=function(v,j){var L=[],k=0,N=this;if(S(v)&&(j=v,v=!1),j)return setTimeout(function(){j.call(N,a[c].call(N,v))}),this;if(this.length>1){for(c!=="sumrow"&&(N=v===!0?this:this.transpose());k<N.length;k++)L[k]=s[c](N[k]);return v===!0?s[c](s.utils.toVector(L)):L}return s[c](this[0],v)}})(h[f])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(h){for(var f=0;f<h.length;f++)(function(c){a[c]=function(){var v,j=[],L=0,k=this,N=Array.prototype.slice.call(arguments);if(S(N[N.length-1])){v=N[N.length-1];var D=N.slice(0,N.length-1);return setTimeout(function(){v.call(k,a[c].apply(k,D))}),this}v=void 0;var O=function(Y){return s[c].apply(k,[Y].concat(N))};if(this.length>1){for(k=k.transpose();L<k.length;L++)j[L]=O(k[L]);return j}return O(this[0])}})(h[f])}("quantiles percentileOfScore".split(" "))}(m,Math),function(s,w){s.gammaln=function(S){var M,l,a,h=0,f=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015;for(a=(l=M=S)+5.5,a-=(M+.5)*w.log(a);h<6;h++)c+=f[h]/++l;return w.log(2.5066282746310007*c/M)-a},s.loggam=function(S){var M,l,a,h,f,c,v,j=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(M=S,v=0,S==1||S==2)return 0;for(S<=7&&(M=S+(v=w.floor(7-S))),l=1/(M*M),a=2*w.PI,f=j[9],c=8;c>=0;c--)f*=l,f+=j[c];if(h=f/M+.5*w.log(a)+(M-.5)*w.log(M)-M,S<=7)for(c=1;c<=v;c++)h-=w.log(M-1),M-=1;return h},s.gammafn=function(S){var M,l,a,h,f=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],v=!1,j=0,L=0,k=0,N=S;if(S>171.6243769536076)return 1/0;if(N<=0){if(!(h=N%1+36e-17))return 1/0;v=(1&N?-1:1)*w.PI/w.sin(w.PI*h),N=1-N}for(a=N,l=N<1?N++:(N-=j=(0|N)-1)-1,M=0;M<8;++M)k=(k+f[M])*l,L=L*l+c[M];if(h=k/L+1,a<N)h/=a;else if(a>N)for(M=0;M<j;++M)h*=N,N++;return v&&(h=v/h),h},s.gammap=function(S,M){return s.lowRegGamma(S,M)*s.gammafn(S)},s.lowRegGamma=function(S,M){var l,a=s.gammaln(S),h=S,f=1/S,c=f,v=M+1-S,j=1/1e-30,L=1/v,k=L,N=1,D=-~(8.5*w.log(S>=1?S:1/S)+.4*S+17);if(M<0||S<=0)return NaN;if(M<S+1){for(;N<=D;N++)f+=c*=M/++h;return f*w.exp(-M+S*w.log(M)-a)}for(;N<=D;N++)k*=(L=1/(L=(l=-N*(N-S))*L+(v+=2)))*(j=v+l/j);return 1-k*w.exp(-M+S*w.log(M)-a)},s.factorialln=function(S){return S<0?NaN:s.gammaln(S+1)},s.factorial=function(S){return S<0?NaN:s.gammafn(S+1)},s.combination=function(S,M){return S>170||M>170?w.exp(s.combinationln(S,M)):s.factorial(S)/s.factorial(M)/s.factorial(S-M)},s.combinationln=function(S,M){return s.factorialln(S)-s.factorialln(M)-s.factorialln(S-M)},s.permutation=function(S,M){return s.factorial(S)/s.factorial(S-M)},s.betafn=function(S,M){if(!(S<=0||M<=0))return S+M>170?w.exp(s.betaln(S,M)):s.gammafn(S)*s.gammafn(M)/s.gammafn(S+M)},s.betaln=function(S,M){return s.gammaln(S)+s.gammaln(M)-s.gammaln(S+M)},s.betacf=function(S,M,l){var a,h,f,c,v=1e-30,j=1,L=M+l,k=M+1,N=M-1,D=1,O=1-L*S/k;for(w.abs(O)<v&&(O=v),c=O=1/O;j<=100&&(O=1+(h=j*(l-j)*S/((N+(a=2*j))*(M+a)))*O,w.abs(O)<v&&(O=v),D=1+h/D,w.abs(D)<v&&(D=v),c*=(O=1/O)*D,O=1+(h=-(M+j)*(L+j)*S/((M+a)*(k+a)))*O,w.abs(O)<v&&(O=v),D=1+h/D,w.abs(D)<v&&(D=v),c*=f=(O=1/O)*D,!(w.abs(f-1)<3e-7));j++);return c},s.gammapinv=function(S,M){var l,a,h,f,c,v,j=0,L=M-1,k=s.gammaln(M);if(S>=1)return w.max(100,M+100*w.sqrt(M));if(S<=0)return 0;for(M>1?(c=w.log(L),v=w.exp(L*(c-1)-k),f=S<.5?S:1-S,l=(2.30753+.27061*(a=w.sqrt(-2*w.log(f))))/(1+a*(.99229+.04481*a))-a,S<.5&&(l=-l),l=w.max(.001,M*w.pow(1-1/(9*M)-l/(3*w.sqrt(M)),3))):l=S<(a=1-M*(.253+.12*M))?w.pow(S/a,1/M):1-w.log(1-(S-a)/(1-a));j<12;j++){if(l<=0)return 0;if((l-=a=(h=(s.lowRegGamma(M,l)-S)/(a=M>1?v*w.exp(-(l-L)+L*(w.log(l)-c)):w.exp(-l+L*w.log(l)-k)))/(1-.5*w.min(1,h*((M-1)/l-1))))<=0&&(l=.5*(l+a)),w.abs(a)<1e-8*l)break}return l},s.erf=function(S){var M,l,a,h,f=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=f.length-1,v=!1,j=0,L=0;for(S<0&&(S=-S,v=!0),l=4*(M=2/(2+S))-2;c>0;c--)a=j,j=l*j-L+f[c],L=a;return h=M*w.exp(-S*S+.5*(f[0]+l*j)-L),v?h-1:1-h},s.erfc=function(S){return 1-s.erf(S)},s.erfcinv=function(S){var M,l,a,h,f=0;if(S>=2)return-100;if(S<=0)return 100;for(h=S<1?S:2-S,M=-.70711*((2.30753+.27061*(a=w.sqrt(-2*w.log(h/2))))/(1+a*(.99229+.04481*a))-a);f<2;f++)M+=(l=s.erfc(M)-h)/(1.1283791670955126*w.exp(-M*M)-M*l);return S<1?M:-M},s.ibetainv=function(S,M,l){var a,h,f,c,v,j,L,k,N,D,O=M-1,Y=l-1,V=0;if(S<=0)return 0;if(S>=1)return 1;for(M>=1&&l>=1?(f=S<.5?S:1-S,j=(2.30753+.27061*(c=w.sqrt(-2*w.log(f))))/(1+c*(.99229+.04481*c))-c,S<.5&&(j=-j),L=(j*j-3)/6,k=2/(1/(2*M-1)+1/(2*l-1)),N=j*w.sqrt(L+k)/k-(1/(2*l-1)-1/(2*M-1))*(L+.8333333333333334-2/(3*k)),j=M/(M+l*w.exp(2*N))):(a=w.log(M/(M+l)),h=w.log(l/(M+l)),j=S<(c=w.exp(M*a)/M)/(N=c+(v=w.exp(l*h)/l))?w.pow(M*N*S,1/M):1-w.pow(l*N*(1-S),1/l)),D=-s.gammaln(M)-s.gammaln(l)+s.gammaln(M+l);V<10;V++){if(j===0||j===1)return j;if((j-=c=(v=(s.ibeta(j,M,l)-S)/(c=w.exp(O*w.log(j)+Y*w.log(1-j)+D)))/(1-.5*w.min(1,v*(O/j-Y/(1-j)))))<=0&&(j=.5*(j+c)),j>=1&&(j=.5*(j+c+1)),w.abs(c)<1e-8*j&&V>0)break}return j},s.ibeta=function(S,M,l){var a=S===0||S===1?0:w.exp(s.gammaln(M+l)-s.gammaln(M)-s.gammaln(l)+M*w.log(S)+l*w.log(1-S));return!(S<0||S>1)&&(S<(M+1)/(M+l+2)?a*s.betacf(S,M,l)/M:1-a*s.betacf(1-S,l,M)/l)},s.randn=function(S,M){var l,a,h,f,c;if(M||(M=S),S)return s.create(S,M,function(){return s.randn()});do l=s._random_fn(),a=1.7156*(s._random_fn()-.5),c=(h=l-.449871)*h+(f=w.abs(a)+.386595)*(.196*f-.25472*h);while(c>.27597&&(c>.27846||a*a>-4*w.log(l)*l*l));return a/l},s.randg=function(S,M,l){var a,h,f,c,v,j,L=S;if(l||(l=M),S||(S=1),M)return(j=s.zeros(M,l)).alter(function(){return s.randg(S)}),j;S<1&&(S+=1),a=S-.3333333333333333,h=1/w.sqrt(9*a);do{do c=1+h*(v=s.randn());while(c<=0);c*=c*c,f=s._random_fn()}while(f>1-.331*w.pow(v,4)&&w.log(f)>.5*v*v+a*(1-c+w.log(c)));if(S==L)return a*c;do f=s._random_fn();while(f===0);return w.pow(f,1/L)*a*c},function(S){for(var M=0;M<S.length;M++)(function(l){s.fn[l]=function(){return s(s.map(this,function(a){return s[l](a)}))}})(S[M])}("gammaln gammafn factorial factorialln".split(" ")),function(S){for(var M=0;M<S.length;M++)(function(l){s.fn[l]=function(){return s(s[l].apply(null,arguments))}})(S[M])}("randn".split(" "))}(m,Math),function(s,w){function S(l,a,h,f){for(var c,v=0,j=1,L=1,k=1,N=0,D=0;w.abs((L-D)/L)>f;)D=L,j=k+(c=-(a+N)*(a+h+N)*l/(a+2*N)/(a+2*N+1))*j,L=(v=L+c*v)+(c=(N+=1)*(h-N)*l/(a+2*N-1)/(a+2*N))*L,v/=k=j+c*k,j/=k,L/=k,k=1;return L/a}function M(l,a,h){var f=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],c=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],v=.5*l;if(v>=8)return 1;var j,L=2*s.normal.cdf(v,0,1,1,0)-1;L=L>=w.exp(-50/h)?w.pow(L,h):0;for(var k=v,N=(8-v)/(j=l>3?2:3),D=k+N,O=0,Y=h-1,V=1;V<=j;V++){for(var ue=0,ge=.5*(D+k),G=.5*(D-k),ae=1;ae<=12;ae++){var he,ce=ge+G*(6<ae?f[(he=12-ae+1)-1]:-f[(he=ae)-1]),oe=ce*ce;if(oe>60)break;var ye=2*s.normal.cdf(ce,0,1,1,0)*.5-2*s.normal.cdf(ce,l,1,1,0)*.5;ye>=w.exp(-30/Y)&&(ue+=ye=c[he-1]*w.exp(-.5*oe)*w.pow(ye,Y))}O+=ue*=2*G*h/w.sqrt(2*w.PI),k=D,D+=N}return(L+=O)<=w.exp(-30/a)?0:(L=w.pow(L,a))>=1?1:L}(function(l){for(var a=0;a<l.length;a++)(function(h){s[h]=function f(c,v,j){return this instanceof f?(this._a=c,this._b=v,this._c=j,this):new f(c,v,j)},s.fn[h]=function(f,c,v){var j=s[h](f,c,v);return j.data=this,j},s[h].prototype.sample=function(f){var c=this._a,v=this._b,j=this._c;return f?s.alter(f,function(){return s[h].sample(c,v,j)}):s[h].sample(c,v,j)},function(f){for(var c=0;c<f.length;c++)(function(v){s[h].prototype[v]=function(j){var L=this._a,k=this._b,N=this._c;return j||j===0||(j=this.data),typeof j!="number"?s.fn.map.call(j,function(D){return s[h][v](D,L,k,N)}):s[h][v](j,L,k,N)}})(f[c])}("pdf cdf inv".split(" ")),function(f){for(var c=0;c<f.length;c++)(function(v){s[h].prototype[v]=function(){return s[h][v](this._a,this._b,this._c)}})(f[c])}("mean median mode variance".split(" "))})(l[a])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),s.extend(s.beta,{pdf:function(l,a,h){return l>1||l<0?0:a==1&&h==1?1:a<512&&h<512?w.pow(l,a-1)*w.pow(1-l,h-1)/s.betafn(a,h):w.exp((a-1)*w.log(l)+(h-1)*w.log(1-l)-s.betaln(a,h))},cdf:function(l,a,h){return l>1||l<0?1*(l>1):s.ibeta(l,a,h)},inv:function(l,a,h){return s.ibetainv(l,a,h)},mean:function(l,a){return l/(l+a)},median:function(l,a){return s.ibetainv(.5,l,a)},mode:function(l,a){return(l-1)/(l+a-2)},sample:function(l,a){var h=s.randg(l);return h/(h+s.randg(a))},variance:function(l,a){return l*a/(w.pow(l+a,2)*(l+a+1))}}),s.extend(s.centralF,{pdf:function(l,a,h){var f;return l<0?0:a<=2?l===0&&a<2?1/0:l===0&&a===2?1:1/s.betafn(a/2,h/2)*w.pow(a/h,a/2)*w.pow(l,a/2-1)*w.pow(1+a/h*l,-(a+h)/2):(f=a*l/(h+l*a),a*(h/(h+l*a))/2*s.binomial.pdf((a-2)/2,(a+h-2)/2,f))},cdf:function(l,a,h){return l<0?0:s.ibeta(a*l/(a*l+h),a/2,h/2)},inv:function(l,a,h){return h/(a*(1/s.ibetainv(l,a/2,h/2)-1))},mean:function(l,a){return a>2?a/(a-2):void 0},mode:function(l,a){return l>2?a*(l-2)/(l*(a+2)):void 0},sample:function(l,a){return 2*s.randg(l/2)/l/(2*s.randg(a/2)/a)},variance:function(l,a){if(!(a<=4))return 2*a*a*(l+a-2)/(l*(a-2)*(a-2)*(a-4))}}),s.extend(s.cauchy,{pdf:function(l,a,h){return h<0?0:h/(w.pow(l-a,2)+w.pow(h,2))/w.PI},cdf:function(l,a,h){return w.atan((l-a)/h)/w.PI+.5},inv:function(l,a,h){return a+h*w.tan(w.PI*(l-.5))},median:function(l){return l},mode:function(l){return l},sample:function(l,a){return s.randn()*w.sqrt(1/(2*s.randg(.5)))*a+l}}),s.extend(s.chisquare,{pdf:function(l,a){return l<0?0:l===0&&a===2?.5:w.exp((a/2-1)*w.log(l)-l/2-a/2*w.log(2)-s.gammaln(a/2))},cdf:function(l,a){return l<0?0:s.lowRegGamma(a/2,l/2)},inv:function(l,a){return 2*s.gammapinv(l,.5*a)},mean:function(l){return l},median:function(l){return l*w.pow(1-2/(9*l),3)},mode:function(l){return l-2>0?l-2:0},sample:function(l){return 2*s.randg(l/2)},variance:function(l){return 2*l}}),s.extend(s.exponential,{pdf:function(l,a){return l<0?0:a*w.exp(-a*l)},cdf:function(l,a){return l<0?0:1-w.exp(-a*l)},inv:function(l,a){return-w.log(1-l)/a},mean:function(l){return 1/l},median:function(l){return 1/l*w.log(2)},mode:function(){return 0},sample:function(l){return-1/l*w.log(s._random_fn())},variance:function(l){return w.pow(l,-2)}}),s.extend(s.gamma,{pdf:function(l,a,h){return l<0?0:l===0&&a===1?1/h:w.exp((a-1)*w.log(l)-l/h-s.gammaln(a)-a*w.log(h))},cdf:function(l,a,h){return l<0?0:s.lowRegGamma(a,l/h)},inv:function(l,a,h){return s.gammapinv(l,a)*h},mean:function(l,a){return l*a},mode:function(l,a){if(l>1)return(l-1)*a},sample:function(l,a){return s.randg(l)*a},variance:function(l,a){return l*a*a}}),s.extend(s.invgamma,{pdf:function(l,a,h){return l<=0?0:w.exp(-(a+1)*w.log(l)-h/l-s.gammaln(a)+a*w.log(h))},cdf:function(l,a,h){return l<=0?0:1-s.lowRegGamma(a,h/l)},inv:function(l,a,h){return h/s.gammapinv(1-l,a)},mean:function(l,a){return l>1?a/(l-1):void 0},mode:function(l,a){return a/(l+1)},sample:function(l,a){return a/s.randg(l)},variance:function(l,a){if(!(l<=2))return a*a/((l-1)*(l-1)*(l-2))}}),s.extend(s.kumaraswamy,{pdf:function(l,a,h){return l===0&&a===1?h:l===1&&h===1?a:w.exp(w.log(a)+w.log(h)+(a-1)*w.log(l)+(h-1)*w.log(1-w.pow(l,a)))},cdf:function(l,a,h){return l<0?0:l>1?1:1-w.pow(1-w.pow(l,a),h)},inv:function(l,a,h){return w.pow(1-w.pow(1-l,1/h),1/a)},mean:function(l,a){return a*s.gammafn(1+1/l)*s.gammafn(a)/s.gammafn(1+1/l+a)},median:function(l,a){return w.pow(1-w.pow(2,-1/a),1/l)},mode:function(l,a){if(l>=1&&a>=1&&l!==1&&a!==1)return w.pow((l-1)/(l*a-1),1/l)},variance:function(){throw new Error("variance not yet implemented")}}),s.extend(s.lognormal,{pdf:function(l,a,h){return l<=0?0:w.exp(-w.log(l)-.5*w.log(2*w.PI)-w.log(h)-w.pow(w.log(l)-a,2)/(2*h*h))},cdf:function(l,a,h){return l<0?0:.5+.5*s.erf((w.log(l)-a)/w.sqrt(2*h*h))},inv:function(l,a,h){return w.exp(-1.4142135623730951*h*s.erfcinv(2*l)+a)},mean:function(l,a){return w.exp(l+a*a/2)},median:function(l){return w.exp(l)},mode:function(l,a){return w.exp(l-a*a)},sample:function(l,a){return w.exp(s.randn()*a+l)},variance:function(l,a){return(w.exp(a*a)-1)*w.exp(2*l+a*a)}}),s.extend(s.noncentralt,{pdf:function(l,a,h){return w.abs(h)<1e-14?s.studentt.pdf(l,a):w.abs(l)<1e-14?w.exp(s.gammaln((a+1)/2)-h*h/2-.5*w.log(w.PI*a)-s.gammaln(a/2)):a/l*(s.noncentralt.cdf(l*w.sqrt(1+2/a),a+2,h)-s.noncentralt.cdf(l,a,h))},cdf:function(l,a,h){var f=1e-14;if(w.abs(h)<f)return s.studentt.cdf(l,a);var c=!1;l<0&&(c=!0,h=-h);for(var v=s.normal.cdf(-h,0,1),j=f+1,L=j,k=l*l/(l*l+a),N=0,D=w.exp(-h*h/2),O=w.exp(-h*h/2-.5*w.log(2)-s.gammaln(1.5))*h;N<200||L>f||j>f;)L=j,N>0&&(D*=h*h/(2*N),O*=h*h/(2*(N+.5))),v+=.5*(j=D*s.beta.cdf(k,N+.5,a/2)+O*s.beta.cdf(k,N+1,a/2)),N++;return c?1-v:v}}),s.extend(s.normal,{pdf:function(l,a,h){return w.exp(-.5*w.log(2*w.PI)-w.log(h)-w.pow(l-a,2)/(2*h*h))},cdf:function(l,a,h){return .5*(1+s.erf((l-a)/w.sqrt(2*h*h)))},inv:function(l,a,h){return-1.4142135623730951*h*s.erfcinv(2*l)+a},mean:function(l){return l},median:function(l){return l},mode:function(l){return l},sample:function(l,a){return s.randn()*a+l},variance:function(l,a){return a*a}}),s.extend(s.pareto,{pdf:function(l,a,h){return l<a?0:h*w.pow(a,h)/w.pow(l,h+1)},cdf:function(l,a,h){return l<a?0:1-w.pow(a/l,h)},inv:function(l,a,h){return a/w.pow(1-l,1/h)},mean:function(l,a){if(!(a<=1))return a*w.pow(l,a)/(a-1)},median:function(l,a){return l*(a*w.SQRT2)},mode:function(l){return l},variance:function(l,a){if(!(a<=2))return l*l*a/(w.pow(a-1,2)*(a-2))}}),s.extend(s.studentt,{pdf:function(l,a){return a=a>1e100?1e100:a,1/(w.sqrt(a)*s.betafn(.5,a/2))*w.pow(1+l*l/a,-(a+1)/2)},cdf:function(l,a){var h=a/2;return s.ibeta((l+w.sqrt(l*l+a))/(2*w.sqrt(l*l+a)),h,h)},inv:function(l,a){var h=s.ibetainv(2*w.min(l,1-l),.5*a,.5);return h=w.sqrt(a*(1-h)/h),l>.5?h:-h},mean:function(l){return l>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(l){return s.randn()*w.sqrt(l/(2*s.randg(l/2)))},variance:function(l){return l>2?l/(l-2):l>1?1/0:void 0}}),s.extend(s.weibull,{pdf:function(l,a,h){return l<0||a<0||h<0?0:h/a*w.pow(l/a,h-1)*w.exp(-w.pow(l/a,h))},cdf:function(l,a,h){return l<0?0:1-w.exp(-w.pow(l/a,h))},inv:function(l,a,h){return a*w.pow(-w.log(1-l),1/h)},mean:function(l,a){return l*s.gammafn(1+1/a)},median:function(l,a){return l*w.pow(w.log(2),1/a)},mode:function(l,a){return a<=1?0:l*w.pow((a-1)/a,1/a)},sample:function(l,a){return l*w.pow(-w.log(s._random_fn()),1/a)},variance:function(l,a){return l*l*s.gammafn(1+2/a)-w.pow(s.weibull.mean(l,a),2)}}),s.extend(s.uniform,{pdf:function(l,a,h){return l<a||l>h?0:1/(h-a)},cdf:function(l,a,h){return l<a?0:l<h?(l-a)/(h-a):1},inv:function(l,a,h){return a+l*(h-a)},mean:function(l,a){return .5*(l+a)},median:function(l,a){return s.mean(l,a)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,a){return l/2+a/2+(a/2-l/2)*(2*s._random_fn()-1)},variance:function(l,a){return w.pow(a-l,2)/12}}),s.extend(s.binomial,{pdf:function(l,a,h){return h===0||h===1?a*h===l?1:0:s.combination(a,l)*w.pow(h,l)*w.pow(1-h,a-l)},cdf:function(l,a,h){var f,c=1e-10;if(l<0)return 0;if(l>=a)return 1;if(h<0||h>1||a<=0)return NaN;var v=h,j=(l=w.floor(l))+1,L=a-l,k=j+L,N=w.exp(s.gammaln(k)-s.gammaln(L)-s.gammaln(j)+j*w.log(v)+L*w.log(1-v));return f=v<(j+1)/(k+2)?N*S(v,j,L,c):1-N*S(1-v,L,j,c),w.round(1/c*(1-f))/(1/c)}}),s.extend(s.negbin,{pdf:function(l,a,h){return l===l>>>0&&(l<0?0:s.combination(l+a-1,a-1)*w.pow(1-h,l)*w.pow(h,a))},cdf:function(l,a,h){var f=0,c=0;if(l<0)return 0;for(;c<=l;c++)f+=s.negbin.pdf(c,a,h);return f}}),s.extend(s.hypgeom,{pdf:function(l,a,h,f){if(l!=l|0)return!1;if(l<0||l<h-(a-f)||l>f||l>h)return 0;if(2*h>a)return 2*f>a?s.hypgeom.pdf(a-h-f+l,a,a-h,a-f):s.hypgeom.pdf(f-l,a,a-h,f);if(2*f>a)return s.hypgeom.pdf(h-l,a,h,a-f);if(h<f)return s.hypgeom.pdf(l,a,f,h);for(var c=1,v=0,j=0;j<l;j++){for(;c>1&&v<f;)c*=1-h/(a-v),v++;c*=(f-j)*(h-j)/((j+1)*(a-h-f+j+1))}for(;v<f;v++)c*=1-h/(a-v);return w.min(1,w.max(0,c))},cdf:function(l,a,h,f){if(l<0||l<h-(a-f))return 0;if(l>=f||l>=h)return 1;if(2*h>a)return 2*f>a?s.hypgeom.cdf(a-h-f+l,a,a-h,a-f):1-s.hypgeom.cdf(f-l-1,a,a-h,f);if(2*f>a)return 1-s.hypgeom.cdf(h-l-1,a,h,a-f);if(h<f)return s.hypgeom.cdf(l,a,f,h);for(var c=1,v=1,j=0,L=0;L<l;L++){for(;c>1&&j<f;){var k=1-h/(a-j);v*=k,c*=k,j++}c+=v*=(f-L)*(h-L)/((L+1)*(a-h-f+L+1))}for(;j<f;j++)c*=1-h/(a-j);return w.min(1,w.max(0,c))}}),s.extend(s.poisson,{pdf:function(l,a){return a<0||l%1!=0||l<0?0:w.pow(a,l)*w.exp(-a)/s.factorial(l)},cdf:function(l,a){var h=[],f=0;if(l<0)return 0;for(;f<=l;f++)h.push(s.poisson.pdf(f,a));return s.sum(h)},mean:function(l){return l},variance:function(l){return l},sampleSmall:function(l){var a=1,h=0,f=w.exp(-l);do h++,a*=s._random_fn();while(a>f);return h-1},sampleLarge:function(l){var a,h,f,c,v,j,L,k,N,D,O=l;for(c=w.sqrt(O),v=w.log(O),j=.02483*(L=.931+2.53*c)-.059,k=1.1239+1.1328/(L-3.4),N=.9277-3.6224/(L-2);;)if(h=w.random()-.5,f=w.random(),D=.5-w.abs(h),a=w.floor((2*j/D+L)*h+O+.43),D>=.07&&f<=N||!(a<0||D<.013&&f>D)&&w.log(f)+w.log(k)-w.log(j/(D*D)+L)<=a*v-O-s.loggam(a+1))return a},sample:function(l){return l<10?this.sampleSmall(l):this.sampleLarge(l)}}),s.extend(s.triangular,{pdf:function(l,a,h,f){return h<=a||f<a||f>h?NaN:l<a||l>h?0:l<f?2*(l-a)/((h-a)*(f-a)):l===f?2/(h-a):2*(h-l)/((h-a)*(h-f))},cdf:function(l,a,h,f){return h<=a||f<a||f>h?NaN:l<=a?0:l>=h?1:l<=f?w.pow(l-a,2)/((h-a)*(f-a)):1-w.pow(h-l,2)/((h-a)*(h-f))},inv:function(l,a,h,f){return h<=a||f<a||f>h?NaN:l<=(f-a)/(h-a)?a+(h-a)*w.sqrt(l*((f-a)/(h-a))):a+(h-a)*(1-w.sqrt((1-l)*(1-(f-a)/(h-a))))},mean:function(l,a,h){return(l+a+h)/3},median:function(l,a,h){return h<=(l+a)/2?a-w.sqrt((a-l)*(a-h))/w.sqrt(2):h>(l+a)/2?l+w.sqrt((a-l)*(h-l))/w.sqrt(2):void 0},mode:function(l,a,h){return h},sample:function(l,a,h){var f=s._random_fn();return f<(h-l)/(a-l)?l+w.sqrt(f*(a-l)*(h-l)):a-w.sqrt((1-f)*(a-l)*(a-h))},variance:function(l,a,h){return(l*l+a*a+h*h-l*a-l*h-a*h)/18}}),s.extend(s.arcsine,{pdf:function(l,a,h){return h<=a?NaN:l<=a||l>=h?0:2/w.PI*w.pow(w.pow(h-a,2)-w.pow(2*l-a-h,2),-.5)},cdf:function(l,a,h){return l<a?0:l<h?2/w.PI*w.asin(w.sqrt((l-a)/(h-a))):1},inv:function(l,a,h){return a+(.5-.5*w.cos(w.PI*l))*(h-a)},mean:function(l,a){return a<=l?NaN:(l+a)/2},median:function(l,a){return a<=l?NaN:(l+a)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,a){return(l+a)/2+(a-l)/2*w.sin(2*w.PI*s.uniform.sample(0,1))},variance:function(l,a){return a<=l?NaN:w.pow(a-l,2)/8}}),s.extend(s.laplace,{pdf:function(l,a,h){return h<=0?0:w.exp(-w.abs(l-a)/h)/(2*h)},cdf:function(l,a,h){return h<=0?0:l<a?.5*w.exp((l-a)/h):1-.5*w.exp(-(l-a)/h)},mean:function(l){return l},median:function(l){return l},mode:function(l){return l},variance:function(l,a){return 2*a*a},sample:function(l,a){var h,f=s._random_fn()-.5;return l-a*((h=f)/w.abs(h))*w.log(1-2*w.abs(f))}}),s.extend(s.tukey,{cdf:function(l,a,h){var f=a,c=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],v=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(l<=0)return 0;if(h<2||f<2)return NaN;if(!Number.isFinite(l))return 1;if(h>25e3)return M(l,1,f);var j,L=.5*h,k=L*w.log(h)-h*w.log(2)-s.gammaln(L),N=L-1,D=.25*h;j=h<=100?1:h<=800?.5:h<=5e3?.25:.125,k+=w.log(j);for(var O=0,Y=1;Y<=50;Y++){for(var V=0,ue=(2*Y-1)*j,ge=1;ge<=16;ge++){var G,ae;8<ge?(G=ge-8-1,ae=k+N*w.log(ue+c[G]*j)-(c[G]*j+ue)*D):(G=ge-1,ae=k+N*w.log(ue-c[G]*j)+(c[G]*j-ue)*D),ae>=-30&&(V+=M(8<ge?l*w.sqrt(.5*(c[G]*j+ue)):l*w.sqrt(.5*(-c[G]*j+ue)),1,f)*v[G]*w.exp(ae))}if(Y*j>=1&&V<=1e-14)break;O+=V}if(V>1e-14)throw new Error("tukey.cdf failed to converge");return O>1&&(O=1),O},inv:function(l,a,h){if(h<2||a<2)return NaN;if(l<0||l>1)return NaN;if(l===0)return 0;if(l===1)return 1/0;var f,c=function(N,D,O){var Y=.5-.5*N,V=w.sqrt(w.log(1/(Y*Y))),ue=V+((((-453642210148e-16*V-.204231210125)*V-.342242088547)*V-1)*V+.322232421088)/((((.0038560700634*V+.10353775285)*V+.531103462366)*V+.588581570495)*V+.099348462606);O<120&&(ue+=(ue*ue*ue+ue)/O/4);var ge=.8832-.2368*ue;return O<120&&(ge+=-1.214/O+1.208*ue/O),ue*(ge*w.log(D-1)+1.4142)}(l,a,h),v=s.tukey.cdf(c,a,h)-l;f=v>0?w.max(0,c-1):c+1;for(var j,L=s.tukey.cdf(f,a,h)-l,k=1;k<50;k++)if(j=f-L*(f-c)/(L-v),v=L,c=f,j<0&&(j=0,L=-l),L=s.tukey.cdf(j,a,h)-l,f=j,w.abs(f-c)<1e-4)return j;throw new Error("tukey.inv failed to converge")}})}(m,Math),function(s,w){var S,M,l=Array.prototype.push,a=s.utils.isArray;function h(f){return a(f)||f instanceof s}s.extend({add:function(f,c){return h(c)?(h(c[0])||(c=[c]),s.map(f,function(v,j,L){return v+c[j][L]})):s.map(f,function(v){return v+c})},subtract:function(f,c){return h(c)?(h(c[0])||(c=[c]),s.map(f,function(v,j,L){return v-c[j][L]||0})):s.map(f,function(v){return v-c})},divide:function(f,c){return h(c)?(h(c[0])||(c=[c]),s.multiply(f,s.inv(c))):s.map(f,function(v){return v/c})},multiply:function(f,c){var v,j,L,k,N,D,O,Y;if(f.length===void 0&&c.length===void 0)return f*c;if(N=f.length,D=f[0].length,O=s.zeros(N,L=h(c)?c[0].length:D),Y=0,h(c)){for(;Y<L;Y++)for(v=0;v<N;v++){for(k=0,j=0;j<D;j++)k+=f[v][j]*c[j][Y];O[v][Y]=k}return N===1&&Y===1?O[0][0]:O}return s.map(f,function(V){return V*c})},outer:function(f,c){return s.multiply(f.map(function(v){return[v]}),[c])},dot:function(f,c){h(f[0])||(f=[f]),h(c[0])||(c=[c]);for(var v,j,L=f[0].length===1&&f.length!==1?s.transpose(f):f,k=c[0].length===1&&c.length!==1?s.transpose(c):c,N=[],D=0,O=L.length,Y=L[0].length;D<O;D++){for(N[D]=[],v=0,j=0;j<Y;j++)v+=L[D][j]*k[D][j];N[D]=v}return N.length===1?N[0]:N},pow:function(f,c){return s.map(f,function(v){return w.pow(v,c)})},exp:function(f){return s.map(f,function(c){return w.exp(c)})},log:function(f){return s.map(f,function(c){return w.log(c)})},abs:function(f){return s.map(f,function(c){return w.abs(c)})},norm:function(f,c){var v=0,j=0;for(isNaN(c)&&(c=2),h(f[0])&&(f=f[0]);j<f.length;j++)v+=w.pow(w.abs(f[j]),c);return w.pow(v,1/c)},angle:function(f,c){return w.acos(s.dot(f,c)/(s.norm(f)*s.norm(c)))},aug:function(f,c){var v,j=[];for(v=0;v<f.length;v++)j.push(f[v].slice());for(v=0;v<j.length;v++)l.apply(j[v],c[v]);return j},inv:function(f){for(var c,v=f.length,j=f[0].length,L=s.identity(v,j),k=s.gauss_jordan(f,L),N=[],D=0;D<v;D++)for(N[D]=[],c=j;c<k[0].length;c++)N[D][c-j]=k[D][c];return N},det:function f(c){if(c.length===2)return c[0][0]*c[1][1]-c[0][1]*c[1][0];for(var v=0,j=0;j<c.length;j++){for(var L=[],k=1;k<c.length;k++){L[k-1]=[];for(var N=0;N<c.length;N++)N<j?L[k-1][N]=c[k][N]:N>j&&(L[k-1][N-1]=c[k][N])}var D=j%2?-1:1;v+=f(L)*c[0][j]*D}return v},gauss_elimination:function(f,c){var v,j,L,k,N=0,D=0,O=f.length,Y=f[0].length,V=1,ue=0,ge=[];for(v=(f=s.aug(f,c))[0].length,N=0;N<O;N++){for(j=f[N][N],D=N,k=N+1;k<Y;k++)j<w.abs(f[k][N])&&(j=f[k][N],D=k);if(D!=N)for(k=0;k<v;k++)L=f[N][k],f[N][k]=f[D][k],f[D][k]=L;for(D=N+1;D<O;D++)for(V=f[D][N]/f[N][N],k=N;k<v;k++)f[D][k]=f[D][k]-V*f[N][k]}for(N=O-1;N>=0;N--){for(ue=0,D=N+1;D<=O-1;D++)ue+=ge[D]*f[N][D];ge[N]=(f[N][v-1]-ue)/f[N][N]}return ge},gauss_jordan:function(f,c){var v,j,L,k=s.aug(f,c),N=k.length,D=k[0].length,O=0;for(j=0;j<N;j++){var Y=j;for(L=j+1;L<N;L++)w.abs(k[L][j])>w.abs(k[Y][j])&&(Y=L);var V=k[j];for(k[j]=k[Y],k[Y]=V,L=j+1;L<N;L++)for(O=k[L][j]/k[j][j],v=j;v<D;v++)k[L][v]-=k[j][v]*O}for(j=N-1;j>=0;j--){for(O=k[j][j],L=0;L<j;L++)for(v=D-1;v>j-1;v--)k[L][v]-=k[j][v]*k[L][j]/O;for(k[j][j]/=O,v=N;v<D;v++)k[j][v]/=O}return k},triaUpSolve:function(f,c){var v,j=f[0].length,L=s.zeros(1,j)[0],k=!1;return c[0].length!=null&&(c=c.map(function(N){return N[0]}),k=!0),s.arange(j-1,-1,-1).forEach(function(N){v=s.arange(N+1,j).map(function(D){return L[D]*f[N][D]}),L[N]=(c[N]-s.sum(v))/f[N][N]}),k?L.map(function(N){return[N]}):L},triaLowSolve:function(f,c){var v,j=f[0].length,L=s.zeros(1,j)[0],k=!1;return c[0].length!=null&&(c=c.map(function(N){return N[0]}),k=!0),s.arange(j).forEach(function(N){v=s.arange(N).map(function(D){return f[N][D]*L[D]}),L[N]=(c[N]-s.sum(v))/f[N][N]}),k?L.map(function(N){return[N]}):L},lu:function(f){var c,v=f.length,j=s.identity(v),L=s.zeros(f.length,f[0].length);return s.arange(v).forEach(function(k){L[0][k]=f[0][k]}),s.arange(1,v).forEach(function(k){s.arange(k).forEach(function(N){c=s.arange(N).map(function(D){return j[k][D]*L[D][N]}),j[k][N]=(f[k][N]-s.sum(c))/L[N][N]}),s.arange(k,v).forEach(function(N){c=s.arange(k).map(function(D){return j[k][D]*L[D][N]}),L[k][N]=f[c.length][N]-s.sum(c)})}),[j,L]},cholesky:function(f){var c,v=f.length,j=s.zeros(f.length,f[0].length);return s.arange(v).forEach(function(L){c=s.arange(L).map(function(k){return w.pow(j[L][k],2)}),j[L][L]=w.sqrt(f[L][L]-s.sum(c)),s.arange(L+1,v).forEach(function(k){c=s.arange(L).map(function(N){return j[L][N]*j[k][N]}),j[k][L]=(f[L][k]-s.sum(c))/j[L][L]})}),j},gauss_jacobi:function(f,c,v,j){for(var L,k,N,D,O=0,Y=0,V=f.length,ue=[],ge=[],G=[];O<V;O++)for(ue[O]=[],ge[O]=[],G[O]=[],Y=0;Y<V;Y++)O>Y?(ue[O][Y]=f[O][Y],ge[O][Y]=G[O][Y]=0):O<Y?(ge[O][Y]=f[O][Y],ue[O][Y]=G[O][Y]=0):(G[O][Y]=f[O][Y],ue[O][Y]=ge[O][Y]=0);for(N=s.multiply(s.multiply(s.inv(G),s.add(ue,ge)),-1),k=s.multiply(s.inv(G),c),L=v,D=s.add(s.multiply(N,v),k),O=2;w.abs(s.norm(s.subtract(D,L)))>j;)L=D,D=s.add(s.multiply(N,L),k),O++;return D},gauss_seidel:function(f,c,v,j){for(var L,k,N,D,O,Y=0,V=f.length,ue=[],ge=[],G=[];Y<V;Y++)for(ue[Y]=[],ge[Y]=[],G[Y]=[],L=0;L<V;L++)Y>L?(ue[Y][L]=f[Y][L],ge[Y][L]=G[Y][L]=0):Y<L?(ge[Y][L]=f[Y][L],ue[Y][L]=G[Y][L]=0):(G[Y][L]=f[Y][L],ue[Y][L]=ge[Y][L]=0);for(D=s.multiply(s.multiply(s.inv(s.add(G,ue)),ge),-1),N=s.multiply(s.inv(s.add(G,ue)),c),k=v,O=s.add(s.multiply(D,v),N),Y=2;w.abs(s.norm(s.subtract(O,k)))>j;)k=O,O=s.add(s.multiply(D,k),N),Y+=1;return O},SOR:function(f,c,v,j,L){for(var k,N,D,O,Y,V=0,ue=f.length,ge=[],G=[],ae=[];V<ue;V++)for(ge[V]=[],G[V]=[],ae[V]=[],k=0;k<ue;k++)V>k?(ge[V][k]=f[V][k],G[V][k]=ae[V][k]=0):V<k?(G[V][k]=f[V][k],ge[V][k]=ae[V][k]=0):(ae[V][k]=f[V][k],ge[V][k]=G[V][k]=0);for(O=s.multiply(s.inv(s.add(ae,s.multiply(ge,L))),s.subtract(s.multiply(ae,1-L),s.multiply(G,L))),D=s.multiply(s.multiply(s.inv(s.add(ae,s.multiply(ge,L))),c),L),N=v,Y=s.add(s.multiply(O,v),D),V=2;w.abs(s.norm(s.subtract(Y,N)))>j;)N=Y,Y=s.add(s.multiply(O,N),D),V++;return Y},householder:function(f){for(var c,v,j,L,k=f.length,N=f[0].length,D=0,O=[],Y=[];D<k-1;D++){for(c=0,L=D+1;L<N;L++)c+=f[L][D]*f[L][D];for(c=(f[D+1][D]>0?-1:1)*w.sqrt(c),v=w.sqrt((c*c-f[D+1][D]*c)/2),(O=s.zeros(k,1))[D+1][0]=(f[D+1][D]-c)/(2*v),j=D+2;j<k;j++)O[j][0]=f[j][D]/(2*v);Y=s.subtract(s.identity(k,N),s.multiply(s.multiply(O,s.transpose(O)),2)),f=s.multiply(Y,s.multiply(f,Y))}return f},QR:(S=s.sum,M=s.arange,function(f){var c,v,j,L=f.length,k=f[0].length,N=s.zeros(k,k);for(f=s.copy(f),v=0;v<k;v++){for(N[v][v]=w.sqrt(S(M(L).map(function(D){return f[D][v]*f[D][v]}))),c=0;c<L;c++)f[c][v]=f[c][v]/N[v][v];for(j=v+1;j<k;j++)for(N[v][j]=S(M(L).map(function(D){return f[D][v]*f[D][j]})),c=0;c<L;c++)f[c][j]=f[c][j]-f[c][v]*N[v][j]}return[f,N]}),lstsq:function(f,c){var v=!1;c[0].length===void 0&&(c=c.map(function(ue){return[ue]}),v=!0);var j=s.QR(f),L=j[0],k=j[1],N=f[0].length,D=s.slice(L,{col:{end:N}}),O=function(ue){var ge=(ue=s.copy(ue)).length,G=s.identity(ge);return s.arange(ge-1,-1,-1).forEach(function(ae){s.sliceAssign(G,{row:ae},s.divide(s.slice(G,{row:ae}),ue[ae][ae])),s.sliceAssign(ue,{row:ae},s.divide(s.slice(ue,{row:ae}),ue[ae][ae])),s.arange(ae).forEach(function(he){var ce=s.multiply(ue[he][ae],-1),oe=s.slice(ue,{row:he}),ye=s.multiply(s.slice(ue,{row:ae}),ce);s.sliceAssign(ue,{row:he},s.add(oe,ye));var ke=s.slice(G,{row:he}),Pe=s.multiply(s.slice(G,{row:ae}),ce);s.sliceAssign(G,{row:he},s.add(ke,Pe))})}),G}(s.slice(k,{row:{end:N}})),Y=s.transpose(D);Y[0].length===void 0&&(Y=[Y]);var V=s.multiply(s.multiply(O,Y),c);return V.length===void 0&&(V=[[V]]),v?V.map(function(ue){return ue[0]}):V},jacobi:function(f){for(var c,v,j,L,k,N,D,O=1,Y=f.length,V=s.identity(Y,Y),ue=[];O===1;){for(k=f[0][1],j=0,L=1,c=0;c<Y;c++)for(v=0;v<Y;v++)c!=v&&k<w.abs(f[c][v])&&(k=w.abs(f[c][v]),j=c,L=v);for(N=f[j][j]===f[L][L]?f[j][L]>0?w.PI/4:-w.PI/4:w.atan(2*f[j][L]/(f[j][j]-f[L][L]))/2,(D=s.identity(Y,Y))[j][j]=w.cos(N),D[j][L]=-w.sin(N),D[L][j]=w.sin(N),D[L][L]=w.cos(N),V=s.multiply(V,D),f=s.multiply(s.multiply(s.inv(D),f),D),O=0,c=1;c<Y;c++)for(v=1;v<Y;v++)c!=v&&w.abs(f[c][v])>.001&&(O=1)}for(c=0;c<Y;c++)ue.push(f[c][c]);return[V,ue]},rungekutta:function(f,c,v,j,L,k){var N,D,O;if(k===2)for(;j<=v;)L+=((N=c*f(j,L))+(D=c*f(j+c,L+N)))/2,j+=c;if(k===4)for(;j<=v;)L+=((N=c*f(j,L))+2*(D=c*f(j+c/2,L+N/2))+2*(O=c*f(j+c/2,L+D/2))+c*f(j+c,L+O))/6,j+=c;return L},romberg:function(f,c,v,j){for(var L,k,N,D,O,Y=0,V=(v-c)/2,ue=[],ge=[],G=[];Y<j/2;){for(O=f(c),N=c,D=0;N<=v;N+=V,D++)ue[D]=N;for(L=ue.length,N=1;N<L-1;N++)O+=(N%2!=0?4:2)*f(ue[N]);O=V/3*(O+f(v)),G[Y]=O,V/=2,Y++}for(k=G.length,L=1;k!==1;){for(N=0;N<k-1;N++)ge[N]=(w.pow(4,L)*G[N+1]-G[N])/(w.pow(4,L)-1);k=ge.length,G=ge,ge=[],L++}return G},richardson:function(f,c,v,j){function L(ae,he){for(var ce,oe=0,ye=ae.length;oe<ye;oe++)ae[oe]===he&&(ce=oe);return ce}for(var k,N,D,O,Y,V=w.abs(v-f[L(f,v)+1]),ue=0,ge=[],G=[];j>=V;)k=L(f,v+j),N=L(f,v),ge[ue]=(c[k]-2*c[N]+c[2*N-k])/(j*j),j/=2,ue++;for(O=ge.length,D=1;O!=1;){for(Y=0;Y<O-1;Y++)G[Y]=(w.pow(4,D)*ge[Y+1]-ge[Y])/(w.pow(4,D)-1);O=G.length,ge=G,G=[],D++}return ge},simpson:function(f,c,v,j){for(var L,k=(v-c)/j,N=f(c),D=[],O=c,Y=0,V=1;O<=v;O+=k,Y++)D[Y]=O;for(L=D.length;V<L-1;V++)N+=(V%2!=0?4:2)*f(D[V]);return k/3*(N+f(v))},hermite:function(f,c,v,j){for(var L,k=f.length,N=0,D=0,O=[],Y=[],V=[],ue=[];D<k;D++){for(O[D]=1,L=0;L<k;L++)D!=L&&(O[D]*=(j-f[L])/(f[D]-f[L]));for(Y[D]=0,L=0;L<k;L++)D!=L&&(Y[D]+=1/(f[D]-f[L]));V[D]=(1-2*(j-f[D])*Y[D])*(O[D]*O[D]),ue[D]=(j-f[D])*(O[D]*O[D]),N+=V[D]*c[D]+ue[D]*v[D]}return N},lagrange:function(f,c,v){for(var j,L,k=0,N=0,D=f.length;N<D;N++){for(L=c[N],j=0;j<D;j++)N!=j&&(L*=(v-f[j])/(f[N]-f[j]));k+=L}return k},cubic_spline:function(f,c,v){for(var j,L,k=f.length,N=0,D=[],O=[],Y=[],V=[],ue=[],ge=[];N<k-1;N++)V[N]=f[N+1]-f[N];for(Y[0]=0,N=1;N<k-1;N++)Y[N]=3/V[N]*(c[N+1]-c[N])-3/V[N-1]*(c[N]-c[N-1]);for(N=1;N<k-1;N++)D[N]=[],O[N]=[],D[N][N-1]=V[N-1],D[N][N]=2*(V[N-1]+V[N]),D[N][N+1]=V[N],O[N][0]=Y[N];for(L=s.multiply(s.inv(D),O),j=0;j<k-1;j++)ue[j]=(c[j+1]-c[j])/V[j]-V[j]*(L[j+1][0]+2*L[j][0])/3,ge[j]=(L[j+1][0]-L[j][0])/(3*V[j]);for(j=0;j<k&&!(f[j]>v);j++);return c[j-=1]+(v-f[j])*ue[j]+s.sq(v-f[j])*L[j]+(v-f[j])*s.sq(v-f[j])*ge[j]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var c,v,j,L,k,N=f.length,D=f[0].length,O=0,Y=[],V=[],ue=[],ge=[],G=[],ae=[],he=[];for(O=0;O<N;O++)Y[O]=s.sum(f[O])/D;for(O=0;O<D;O++)for(G[O]=[],c=0;c<N;c++)G[O][c]=f[c][O]-Y[c];for(G=s.transpose(G),O=0;O<N;O++)for(ae[O]=[],c=0;c<N;c++)ae[O][c]=s.dot([G[O]],[G[c]])/(D-1);for(k=(j=s.jacobi(ae))[0],V=j[1],he=s.transpose(k),O=0;O<V.length;O++)for(c=O;c<V.length;c++)V[O]<V[c]&&(v=V[O],V[O]=V[c],V[c]=v,ue=he[O],he[O]=he[c],he[c]=ue);for(L=s.transpose(G),O=0;O<N;O++)for(ge[O]=[],c=0;c<L.length;c++)ge[O][c]=s.dot([he[O]],[L[c]]);return[f,V,he,ge]}}),function(f){for(var c=0;c<f.length;c++)(function(v){s.fn[v]=function(j,L){var k=this;return L?(setTimeout(function(){L.call(k,s.fn[v].call(k,j))},15),this):typeof s[v](this,j)=="number"?s[v](this,j):s(s[v](this,j))}})(f[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(m,Math),function(s,w){var S=[].slice,M=s.utils.isNumber,l=s.utils.isArray;function a(h,f,c,v){if(h>1||c>1||h<=0||c<=0)throw new Error("Proportions should be greater than 0 and less than 1");var j=(h*f+c*v)/(f+v);return(h-c)/w.sqrt(j*(1-j)*(1/f+1/v))}s.extend({zscore:function(){var h=S.call(arguments);return M(h[1])?(h[0]-h[1])/h[2]:(h[0]-s.mean(h[1]))/s.stdev(h[1],h[2])},ztest:function(){var h,f=S.call(arguments);return l(f[1])?(h=s.zscore(f[0],f[1],f[3]),f[2]===1?s.normal.cdf(-w.abs(h),0,1):2*s.normal.cdf(-w.abs(h),0,1)):f.length>2?(h=s.zscore(f[0],f[1],f[2]),f[3]===1?s.normal.cdf(-w.abs(h),0,1):2*s.normal.cdf(-w.abs(h),0,1)):(h=f[0],f[1]===1?s.normal.cdf(-w.abs(h),0,1):2*s.normal.cdf(-w.abs(h),0,1))}}),s.extend(s.fn,{zscore:function(h,f){return(h-this.mean())/this.stdev(f)},ztest:function(h,f,c){var v=w.abs(this.zscore(h,c));return f===1?s.normal.cdf(-v,0,1):2*s.normal.cdf(-v,0,1)}}),s.extend({tscore:function(){var h=S.call(arguments);return h.length===4?(h[0]-h[1])/(h[2]/w.sqrt(h[3])):(h[0]-s.mean(h[1]))/(s.stdev(h[1],!0)/w.sqrt(h[1].length))},ttest:function(){var h,f=S.call(arguments);return f.length===5?(h=w.abs(s.tscore(f[0],f[1],f[2],f[3])),f[4]===1?s.studentt.cdf(-h,f[3]-1):2*s.studentt.cdf(-h,f[3]-1)):M(f[1])?(h=w.abs(f[0]),f[2]==1?s.studentt.cdf(-h,f[1]-1):2*s.studentt.cdf(-h,f[1]-1)):(h=w.abs(s.tscore(f[0],f[1])),f[2]==1?s.studentt.cdf(-h,f[1].length-1):2*s.studentt.cdf(-h,f[1].length-1))}}),s.extend(s.fn,{tscore:function(h){return(h-this.mean())/(this.stdev(!0)/w.sqrt(this.cols()))},ttest:function(h,f){return f===1?1-s.studentt.cdf(w.abs(this.tscore(h)),this.cols()-1):2*s.studentt.cdf(-w.abs(this.tscore(h)),this.cols()-1)}}),s.extend({anovafscore:function(){var h,f,c,v,j,L,k,N,D=S.call(arguments);if(D.length===1){for(j=new Array(D[0].length),k=0;k<D[0].length;k++)j[k]=D[0][k];D=j}for(f=new Array,k=0;k<D.length;k++)f=f.concat(D[k]);for(c=s.mean(f),h=0,k=0;k<D.length;k++)h+=D[k].length*w.pow(s.mean(D[k])-c,2);for(h/=D.length-1,L=0,k=0;k<D.length;k++)for(v=s.mean(D[k]),N=0;N<D[k].length;N++)L+=w.pow(D[k][N]-v,2);return h/(L/(f.length-D.length))},anovaftest:function(){var h,f,c,v,j=S.call(arguments);if(M(j[0]))return 1-s.centralF.cdf(j[0],j[1],j[2]);var L=s.anovafscore(j);for(h=j.length-1,c=0,v=0;v<j.length;v++)c+=j[v].length;return f=c-h-1,1-s.centralF.cdf(L,h,f)},ftest:function(h,f,c){return 1-s.centralF.cdf(h,f,c)}}),s.extend(s.fn,{anovafscore:function(){return s.anovafscore(this.toArray())},anovaftes:function(){var h,f=0;for(h=0;h<this.length;h++)f+=this[h].length;return s.ftest(this.anovafscore(),this.length-1,f-this.length)}}),s.extend({qscore:function(){var h,f,c,v,j,L=S.call(arguments);return M(L[0])?(h=L[0],f=L[1],c=L[2],v=L[3],j=L[4]):(h=s.mean(L[0]),f=s.mean(L[1]),c=L[0].length,v=L[1].length,j=L[2]),w.abs(h-f)/(j*w.sqrt((1/c+1/v)/2))},qtest:function(){var h,f=S.call(arguments);f.length===3?(h=f[0],f=f.slice(1)):f.length===7?(h=s.qscore(f[0],f[1],f[2],f[3],f[4]),f=f.slice(5)):(h=s.qscore(f[0],f[1],f[2]),f=f.slice(3));var c=f[0],v=f[1];return 1-s.tukey.cdf(h,v,c-v)},tukeyhsd:function(h){for(var f=s.pooledstdev(h),c=h.map(function(D){return s.mean(D)}),v=h.reduce(function(D,O){return D+O.length},0),j=[],L=0;L<h.length;++L)for(var k=L+1;k<h.length;++k){var N=s.qtest(c[L],c[k],h[L].length,h[k].length,f,v,h.length);j.push([[L,k],N])}return j}}),s.extend({normalci:function(){var h,f=S.call(arguments),c=new Array(2);return h=f.length===4?w.abs(s.normal.inv(f[1]/2,0,1)*f[2]/w.sqrt(f[3])):w.abs(s.normal.inv(f[1]/2,0,1)*s.stdev(f[2])/w.sqrt(f[2].length)),c[0]=f[0]-h,c[1]=f[0]+h,c},tci:function(){var h,f=S.call(arguments),c=new Array(2);return h=f.length===4?w.abs(s.studentt.inv(f[1]/2,f[3]-1)*f[2]/w.sqrt(f[3])):w.abs(s.studentt.inv(f[1]/2,f[2].length-1)*s.stdev(f[2],!0)/w.sqrt(f[2].length)),c[0]=f[0]-h,c[1]=f[0]+h,c},significant:function(h,f){return h<f}}),s.extend(s.fn,{normalci:function(h,f){return s.normalci(h,f,this.toArray())},tci:function(h,f){return s.tci(h,f,this.toArray())}}),s.extend(s.fn,{oneSidedDifferenceOfProportions:function(h,f,c,v){var j=a(h,f,c,v);return s.ztest(j,1)},twoSidedDifferenceOfProportions:function(h,f,c,v){var j=a(h,f,c,v);return s.ztest(j,2)}})}(m,Math),m.models=function(){function s(S,M){var l=S.length,a=M[0].length-1,h=l-a-1,f=m.lstsq(M,S),c=m.multiply(M,f.map(function(D){return[D]})).map(function(D){return D[0]}),v=m.subtract(S,c),j=m.mean(S),L=m.sum(c.map(function(D){return Math.pow(D-j,2)})),k=m.sum(S.map(function(D,O){return Math.pow(D-c[O],2)})),N=L+k;return{exog:M,endog:S,nobs:l,df_model:a,df_resid:h,coef:f,predict:c,resid:v,ybar:j,SST:N,SSE:L,SSR:k,R2:L/N}}function w(S){var M,l,a=(M=S.exog,l=M[0].length,m.arange(l).map(function(k){var N=m.arange(l).filter(function(D){return D!==k});return s(m.col(M,k).map(function(D){return D[0]}),m.col(M,N))})),h=Math.sqrt(S.SSR/S.df_resid),f=a.map(function(k){var N=k.SST,D=k.R2;return h/Math.sqrt(N*(1-D))}),c=S.coef.map(function(k,N){return(k-0)/f[N]}),v=c.map(function(k){var N=m.studentt.cdf(k,S.df_resid);return 2*(N>.5?1-N:N)}),j=m.studentt.inv(.975,S.df_resid),L=S.coef.map(function(k,N){var D=j*f[N];return[k-D,k+D]});return{se:f,t:c,p:v,sigmaHat:h,interval95:L}}return{ols:function(S,M){var l=s(S,M),a=w(l),h=function(c){var v,j,L,k=c.R2/c.df_model/((1-c.R2)/c.df_resid);return{F_statistic:k,pvalue:1-(v=k,j=c.df_model,L=c.df_resid,m.beta.cdf(v/(L/j+v),j/2,L/2))}}(l),f=1-(1-l.R2)*((l.nobs-1)/l.df_resid);return l.t=a,l.f=h,l.adjust_R2=f,l}}}(),m.extend({buildxmatrix:function(){for(var s=new Array(arguments.length),w=0;w<arguments.length;w++)s[w]=[1].concat(arguments[w]);return m(s)},builddxmatrix:function(){for(var s=new Array(arguments[0].length),w=0;w<arguments[0].length;w++)s[w]=[1].concat(arguments[0][w]);return m(s)},buildjxmatrix:function(s){for(var w=new Array(s.length),S=0;S<s.length;S++)w[S]=s[S];return m.builddxmatrix(w)},buildymatrix:function(s){return m(s).transpose()},buildjymatrix:function(s){return s.transpose()},matrixmult:function(s,w){var S,M,l,a,h;if(s.cols()==w.rows()){if(w.rows()>1){for(a=[],S=0;S<s.rows();S++)for(a[S]=[],M=0;M<w.cols();M++){for(h=0,l=0;l<s.cols();l++)h+=s.toArray()[S][l]*w.toArray()[l][M];a[S][M]=h}return m(a)}for(a=[],S=0;S<s.rows();S++)for(a[S]=[],M=0;M<w.cols();M++){for(h=0,l=0;l<s.cols();l++)h+=s.toArray()[S][l]*w.toArray()[M];a[S][M]=h}return m(a)}},regress:function(s,w){var S=m.xtranspxinv(s),M=s.transpose(),l=m.matrixmult(m(S),M);return m.matrixmult(l,w)},regresst:function(s,w,S){var M=m.regress(s,w),l={anova:{}},a=m.jMatYBar(s,M);l.yBar=a;var h=w.mean();l.anova.residuals=m.residuals(w,a),l.anova.ssr=m.ssr(a,h),l.anova.msr=l.anova.ssr/(s[0].length-1),l.anova.sse=m.sse(w,a),l.anova.mse=l.anova.sse/(w.length-(s[0].length-1)-1),l.anova.sst=m.sst(w,h),l.anova.mst=l.anova.sst/(w.length-1),l.anova.r2=1-l.anova.sse/l.anova.sst,l.anova.r2<0&&(l.anova.r2=0),l.anova.fratio=l.anova.msr/l.anova.mse,l.anova.pvalue=m.anovaftest(l.anova.fratio,s[0].length-1,w.length-(s[0].length-1)-1),l.anova.rmse=Math.sqrt(l.anova.mse),l.anova.r2adj=1-l.anova.mse/l.anova.mst,l.anova.r2adj<0&&(l.anova.r2adj=0),l.stats=new Array(s[0].length);for(var f,c,v,j=m.xtranspxinv(s),L=0;L<M.length;L++)f=Math.sqrt(l.anova.mse*Math.abs(j[L][L])),c=Math.abs(M[L]/f),v=m.ttest(c,w.length-s[0].length-1,S),l.stats[L]=[M[L],f,c,v];return l.regress=M,l},xtranspx:function(s){return m.matrixmult(s.transpose(),s)},xtranspxinv:function(s){var w=m.matrixmult(s.transpose(),s);return m.inv(w)},jMatYBar:function(s,w){var S=m.matrixmult(s,w);return new m(S)},residuals:function(s,w){return m.matrixsubtract(s,w)},ssr:function(s,w){for(var S=0,M=0;M<s.length;M++)S+=Math.pow(s[M]-w,2);return S},sse:function(s,w){for(var S=0,M=0;M<s.length;M++)S+=Math.pow(s[M]-w[M],2);return S},sst:function(s,w){for(var S=0,M=0;M<s.length;M++)S+=Math.pow(s[M]-w,2);return S},matrixsubtract:function(s,w){for(var S=new Array(s.length),M=0;M<s.length;M++){S[M]=new Array(s[M].length);for(var l=0;l<s[M].length;l++)S[M][l]=s[M][l]-w[M][l]}return m(S)}}),m.jStat=m,m)},960:function(H,m,s){const w=s(592);H.exports=function(S){function M(L,k){const N=k.split(".");let D=L;for(const O of N){if(D==null)return;D=D[O]}return D}for(let L=0;L<Object.keys(w).length;L++){let k,N=Object.keys(w)[L],D=[];if(typeof w[N]=="object"){D=Object.keys(w[N]),k=Object.values(w[N]);for(let O=0;O<k.length;O++)if(typeof k[O]=="object"){let Y=D[O];w[N][Y]&&(D=[...D,...Object.keys(w[N][Y]).map(V=>Y+"."+V)],D.splice(D.indexOf(Y),1))}}if(D.length<1)S[N]=w[N];else for(let O=0;O<D.length;O++)typeof M(w[N],D[O])=="function"&&(S[N]=M(w[N],D[O]))}let l=function(L){return typeof L=="number"&&(L=parseInt(L)),L},a=null,h=null,f=null;S.TABLE=function(){return f},S.COLUMN=S.COL=function(){return f.tracking&&f.tracking.push(j.getColumnNameFromCoords(l(a),l(h))),l(a)+1},S.ROW=function(){return f.tracking&&f.tracking.push(j.getColumnNameFromCoords(l(a),l(h))),l(h)+1},S.CELL=function(){return j.getColumnNameFromCoords(a,h)},S.VALUE=function(L,k,N){return f.getValueFromCoords(l(L)-1,l(k)-1,N)},S.THISROWCELL=function(L){return f.getValueFromCoords(l(L)-1,l(h))};const c=function(L,k){for(let N=0;N<L.length;N++){let D=j.getTokensFromRange(L[N]);k=k.replace(L[N],"["+D.join(",")+"]")}return k},v=function(L){return typeof L=="string"&&(L=L.trim()),!isNaN(L)&&L!==null&&L!==""},j=function(L,k,N,D,O){f=O,a=N,h=D;let Y="",V={};if(k)if(k.size){let G,ae=null;k.forEach(function(he,ce){G=ce.replace(/!/g,"."),G.indexOf(".")!==-1&&(G=G.split("."),V[G[0]]=!0)}),G=Object.keys(V);for(let he=0;he<G.length;he++)Y+="var "+G[he]+" = {};";k.forEach(function(he,ce){G=ce.replace(/!/g,"."),he===null||v(he)||(ae=he.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),ae&&ae.length&&(he=updateRanges(ae,he))),G.indexOf(".")>0?Y+=G+" = "+k.get(ce)+`;
`:Y+="var "+G+" = "+he+`;
`})}else{let G=Object.keys(k);if(G.length){let ae,he={};for(let ce=0;ce<G.length;ce++)if(ae=G[ce].replace(/\!/g,"."),ae.indexOf(".")>0){let oe=oe.split(".");he[oe[0]]={}}ae=Object.keys(he);for(let ce=0;ce<ae.length;ce++)Y+="var "+ae[ce]+" = {};";for(let ce=0;ce<G.length;ce++){if(ae=G[ce].replace(/!/g,"."),k[G[ce]]!==null&&!v(k[G[ce]])){let oe=k[G[ce]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);oe&&oe.length&&(k[G[ce]]=c(oe,k[G[ce]]))}ae.indexOf(".")>0?Y+=ae+" = "+k[G[ce]]+`;
`:Y+="var "+ae+" = "+k[G[ce]]+`;
`}}}let ue=(L=function(G,ae){let he="",ce=0,oe=["=","!",">","<"];for(let ye=0;ye<G.length;ye++)G[ye]==='"'&&(ce=ce===0?1:0),ce===1?he+=G[ye]:(he+=G[ye].toUpperCase(),ye>0&&G[ye]==="="&&oe.indexOf(G[ye-1])===-1&&oe.indexOf(G[ye+1])===-1&&(he+="="));return he=he.replace(/\^/g,"**"),he=he.replace(/<>/g,"!="),he=he.replace(/&/g,"+"),he=he.replace(/\$/g,""),he}(L=(L=L.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ue&&ue.length&&(L=c(ue,L));let ge=new Function(Y+"; return "+L)();return ge===null&&(ge=0),ge};return j.getColumnNameFromCoords=function(L,k){return N=parseInt(L),D="",N>701?(D+=String.fromCharCode(64+parseInt(N/676)),D+=String.fromCharCode(64+parseInt(N%676/26))):N>25&&(D+=String.fromCharCode(64+parseInt(N/26))),D+String.fromCharCode(65+N%26)+(parseInt(k)+1);var N,D},j.getCoordsFromColumnName=function(L){var k=/^[a-zA-Z]+/.exec(L);if(k){for(var N=0,D=0;D<k[0].length;D++)N+=parseInt(k[0].charCodeAt(D)-64)*Math.pow(26,k[0].length-1-D);--N<0&&(N=0);var O=parseInt(/[0-9]+$/.exec(L))||null;return O>0&&O--,[N,O]}},j.getRangeFromTokens=function(L){L=L.filter(function(O){return O!="#REF!"});for(var k="",N="",D=0;D<L.length;D++)L[D].indexOf(".")>=0?k=".":L[D].indexOf("!")>=0&&(k="!"),k&&(N=L[D].split(k),L[D]=N[1],N=N[0]+k);return L.sort(function(O,Y){var V=Helpers.getCoordsFromColumnName(O),ue=Helpers.getCoordsFromColumnName(Y);return V[1]>ue[1]?1:V[1]<ue[1]?-1:V[0]>ue[0]?1:V[0]<ue[0]?-1:0}),L.length?N+(L[0]+":")+L[L.length-1]:"#REF!"},j.getTokensFromRange=function(L){if(L.indexOf(".")>0){var k=L.split(".");L=k[1],k=k[0]+"."}else L.indexOf("!")>0?(k=L.split("!"),L=k[1],k=k[0]+"!"):k="";L=L.split(":");var N=j.getCoordsFromColumnName(L[0]),D=j.getCoordsFromColumnName(L[1]);if(N[0]<=D[0])var O=N[0],Y=D[0];else O=D[0],Y=N[0];if(N[1]===null&&D[1]==null)for(var V=null,ue=null,ge=Object.keys(vars),G=0;G<ge.length;G++){var ae=j.getCoordsFromColumnName(ge[G]);ae[0]===N[0]&&(V===null||ae[1]<V)&&(V=ae[1]),ae[0]===D[0]&&(ue===null||ae[1]>ue)&&(ue=ae[1])}else N[1]<=D[1]?(V=N[1],ue=D[1]):(V=D[1],ue=N[1]);for(var he=[],ce=V;ce<=ue;ce++){var oe=[];for(G=O;G<=Y;G++)oe.push(k+j.getColumnNameFromCoords(G,ce));he.push(oe)}return he},j.setFormula=function(L){let k=Object.keys(L);for(let N=0;N<k.length;N++)typeof L[k[N]]=="function"&&(S[k[N]]=L[k[N]])},j.basic=!0,j}(typeof window>"u"?s.g:window)},592:function(H,m,s){var w=s(162),S=s(765);const M=new Error("#NULL!"),l=new Error("#DIV/0!"),a=new Error("#VALUE!"),h=new Error("#REF!"),f=new Error("#NAME?"),c=new Error("#NUM!"),v=new Error("#N/A"),j=new Error("#ERROR!"),L=new Error("#GETTING_DATA");var k=Object.freeze({__proto__:null,data:L,div0:l,error:j,na:v,name:f,nil:M,num:c,ref:h,value:a});function N(e){const t=[];return D(e,u=>{t.push(u)}),t}function D(e,t){let u=-1;const b=e.length;for(;++u<b&&t(e[u],u,e)!==!1;);return e}function O(e){let t,u=e.length;for(;u--;)if(t=e[u],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const b=W(t);e[u]=b instanceof Error?0:b}}else e[u]=0;else e[u]=1;return e}function Y(e,t){if(!e)return a;e.every(B=>Array.isArray(B))&&e.length!==0||(e=[[...e]]),e.map((B,P)=>{B.map((K,le)=>{K||(e[P][le]=0)})});const u=e.reduce((B,P,K)=>P.length>e[B].length?K:B,0),b=e[u].length;return e.map(B=>[...B,...Array(b-B.length).fill(0)])}function V(){let e;if(arguments.length===1){const u=arguments[0];e=(t=u)!=null&&typeof t.length=="number"&&typeof t!="string"?N.apply(null,arguments):[u]}else e=Array.from(arguments);for(var t;!ge(e);)e=ue(e);return e}function ue(e){return e&&e.reduce?e.reduce((t,u)=>{const b=Array.isArray(t),B=Array.isArray(u);return b&&B?t.concat(u):b?(t.push(u),t):B?[t].concat(u):[t,u]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function G(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function ae(e){return e?e[0].map((t,u)=>e.map(b=>b[u])):a}function he(e,t){let u=null;return D(e,(b,B)=>{if(b[0]===t)return u=B,!1}),u??a}function ce(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function oe(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function ye(e){return Math.round(e*1e14)/1e14}function ke(){return V.apply(null,arguments).filter(e=>typeof e=="number")}function Pe(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||a}function Be(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?c:function(u){u<60&&(u+=1);const b=Math.floor(u-25569),B=new Date(86400*b*1e3),P=u-Math.floor(u)+1e-7;let K=Math.floor(86400*P);const le=K%60;K-=le;const me=Math.floor(K/3600),De=Math.floor(K/60)%60;let Re=B.getUTCDate(),ze=B.getUTCMonth();return u>=60&&u<61&&(Re=29,ze=1),new Date(B.getUTCFullYear(),ze,Re,me,De,le)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?a:e}function Ze(e){let t,u=e.length;for(;u--;){if(t=Be(e[u]),t===a)return t;e[u]=t}return e}function W(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?a:parseFloat(e))}function Le(e){let t,u;if(!e||(t=e.length)===0)return a;for(;t--;){if(e[t]instanceof Error)return e[t];if(u=W(e[t]),u instanceof Error)return u;e[t]=u}return e}function Ye(e){return e instanceof Error?e:e==null?"":e.toString()}function ot(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Ne(e){return e!=null}const Ce="=",Ie=[">",">=","<","<=","=","<>"],Ve="operator",We="literal",Xe=[Ve,We],lt=Ve,st=We;function ft(e,t){if(Xe.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function vt(e){return function(t){let u="";const b=[];for(let B=0;B<t.length;B++){const P=t[B];B===0&&Ie.indexOf(P)>=0?b.push(ft(P,lt)):u+=P}return u.length>0&&b.push(ft(function(B){return typeof B!="string"||/^\d+(\.\d+)?$/.test(B)&&(B=B.indexOf(".")===-1?parseInt(B,10):parseFloat(B)),B}(u),st)),b.length>0&&b[0].type!==lt&&b.unshift(ft(Ce,lt)),b}(function(t){const u=t.length,b=[];let B=0,P="",K="";for(;B<u;){const le=t.charAt(B);switch(le){case">":case"<":case"=":K+=le,P.length>0&&(b.push(P),P="");break;default:K.length>0&&(b.push(K),K=""),P+=le}B++}return P.length>0&&b.push(P),K.length>0&&b.push(K),b}(e))}const yt=function(e){const t=[];let u;for(let b=0;b<e.length;b++){const B=e[b];switch(B.type){case lt:u=B.value;break;case st:t.push(B.value)}}return function(b,B){let P=!1;switch(B){case">":P=b[0]>b[1];break;case">=":P=b[0]>=b[1];break;case"<":P=b[0]<b[1];break;case"<=":P=b[0]<=b[1];break;case"=":P=b[0]==b[1];break;case"<>":P=b[0]!=b[1]}return P}(t,u)},Tt={};function St(e){return[a,h,l,c,f,M].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function It(e){return St(e)||e===v}function gt(e){return e===!0||e===!1}function Nt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function Ot(e){return typeof e=="string"}function A(){const e=[];for(let t=0;t<arguments.length;++t){let u=!1;const b=arguments[t];for(let B=0;B<e.length&&(u=e[B]===b,!u);++B);u||e.push(b)}return e}function I(e,t,u,b){if(!t||!u)return v;b=!(b===0||b===!1);let B=v;const P=typeof e=="number";let K=!1;for(let le=0;le<t.length;le++){const me=t[le];if(me[0]===e){B=u<me.length+1?me[u-1]:h;break}!K&&(P&&b&&me[0]<=e||b&&typeof me[0]=="string"&&me[0].localeCompare(e)<0)&&(B=u<me.length+1?me[u-1]:h),P&&me[0]>e&&(K=!0)}return B}function d(){const e=V(arguments).filter(Ne);if(e.length===0)return l;const t=ce.apply(void 0,e);if(t)return t;const u=ke(e),b=u.length;let B,P=0,K=0;for(let le=0;le<b;le++)P+=u[le],K+=1;return B=P/K,isNaN(B)&&(B=c),B}function r(){const e=V(arguments).filter(Ne);if(e.length===0)return l;const t=ce.apply(void 0,e);if(t)return t;const u=e,b=u.length;let B,P=0,K=0;for(let le=0;le<b;le++){const me=u[le];typeof me=="number"&&(P+=me),me===!0&&P++,me!==null&&K++}return B=P/K,isNaN(B)&&(B=c),B}Tt.TYPE=e=>{switch(e){case M:return 1;case l:return 2;case a:return 3;case h:return 4;case f:return 5;case c:return 6;case v:return 7;case L:return 8}return v};const U={DIST:function(e,t,u,b,B,P){return arguments.length<4?a:(B=B===void 0?0:B,P=P===void 0?1:P,oe(e=W(e),t=W(t),u=W(u),B=W(B),P=W(P))?a:(e=(e-B)/(P-B),b?w.beta.cdf(e,t,u):w.beta.pdf(e,t,u)))},INV:(e,t,u,b,B)=>(b=b===void 0?0:b,B=B===void 0?1:B,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B))?a:w.beta.inv(e,t,u)*(B-b)+b)},re={DIST:(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u),b=W(b))?a:b?w.binomial.cdf(e,t,u):w.binomial.pdf(e,t,u)};re.DIST.RANGE=(e,t,u,b)=>{if(b=b===void 0?u:b,oe(e=W(e),t=W(t),u=W(u),b=W(b)))return a;let B=0;for(let P=u;P<=b;P++)B+=dt(e,P)*Math.pow(t,P)*Math.pow(1-t,e-P);return B},re.INV=(e,t,u)=>{if(oe(e=W(e),t=W(t),u=W(u)))return a;let b=0;for(;b<=e;){if(w.binomial.cdf(b,e,t)>=u)return b;b++}};const ne={DIST:(e,t,u)=>oe(e=W(e),t=W(t))?a:u?w.chisquare.cdf(e,t):w.chisquare.pdf(e,t)};ne.DIST.RT=(e,t)=>!e|!t?v:e<1||t>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"?a:1-w.chisquare.cdf(e,t),ne.INV=(e,t)=>oe(e=W(e),t=W(t))?a:w.chisquare.inv(e,t),ne.INV.RT=(e,t)=>!e|!t?v:e<0||e>1||t<1||t>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"?a:w.chisquare.inv(1-e,t),ne.TEST=function(e,t){if(arguments.length!==2)return v;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return a;const u=e.length;let b,B,P;for(B=0;B<u;B++)e[B]instanceof Array||(b=e[B],e[B]=[],e[B].push(b)),t[B]instanceof Array||(b=t[B],t[B]=[],t[B].push(b));const K=e[0].length,le=K===1?u-1:(u-1)*(K-1);let me=0;const De=Math.PI;for(B=0;B<u;B++)for(P=0;P<K;P++)me+=Math.pow(e[B][P]-t[B][P],2)/t[B][P];return Math.round(1e6*function(Re,ze){let Ue=Math.exp(-.5*Re);ze%2==1&&(Ue*=Math.sqrt(2*Re/De));let $e=ze;for(;$e>=2;)Ue=Ue*Re/$e,$e-=2;let rt=Ue,at=ze;for(;rt>1e-10*Ue;)at+=2,rt=rt*Re/at,Ue+=rt;return 1-Ue}(me,le))/1e6};const R={};function _(){return ke(V(arguments)).length}function q(){const e=V(arguments);return e.length-Z(e)}function Z(){const e=V(arguments);let t,u=0;for(let b=0;b<e.length;b++)t=e[b],t!=null&&t!==""||u++;return u}R.NORM=(e,t,u)=>oe(e=W(e),t=W(t),u=W(u))?a:w.normalci(1,e,t,u)[1]-1,R.T=(e,t,u)=>oe(e=W(e),t=W(t),u=W(u))?a:w.tci(1,e,t,u)[1]-1;const ie={P:(e,t)=>{if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=w.mean(e),b=w.mean(t);let B=0;const P=e.length;for(let K=0;K<P;K++)B+=(e[K]-u)*(t[K]-b);return B/P},S:(e,t)=>oe(e=Le(V(e)),t=Le(V(t)))?a:w.covariance(e,t)},we={DIST:(e,t,u)=>oe(e=W(e),t=W(t))?a:u?w.exponential.cdf(e,t):w.exponential.pdf(e,t)},fe={};function ve(e,t,u){if(oe(e=W(e),t=Le(V(t)),u=Le(V(u))))return a;const b=w.mean(u),B=w.mean(t),P=u.length;let K=0,le=0;for(let De=0;De<P;De++)K+=(u[De]-b)*(t[De]-B),le+=Math.pow(u[De]-b,2);const me=K/le;return B-me*b+me*e}function Me(e){return(e=W(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?c:w.gammafn(e)}function Se(e){return(e=W(e))instanceof Error?e:w.gammaln(e)}fe.DIST=(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u))?a:b?w.centralF.cdf(e,t,u):w.centralF.pdf(e,t,u),fe.DIST.RT=function(e,t,u){return arguments.length!==3?v:e<0||t<1||u<1?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?a:1-w.centralF.cdf(e,t,u)},fe.INV=(e,t,u)=>oe(e=W(e),t=W(t),u=W(u))?a:e<=0||e>1?c:w.centralF.inv(e,t,u),fe.INV.RT=function(e,t,u){return arguments.length!==3?v:e<0||e>1||t<1||t>Math.pow(10,10)||u<1||u>Math.pow(10,10)?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?a:w.centralF.inv(1-e,t,u)},fe.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return v;if(e.length<2||t.length<2)return l;const u=(P,K)=>{let le=0;for(let me=0;me<P.length;me++)le+=Math.pow(P[me]-K,2);return le},b=jt(e)/e.length,B=jt(t)/t.length;return u(e,b)/(e.length-1)/(u(t,B)/(t.length-1))},Me.DIST=function(e,t,u,b){return arguments.length!==4?v:e<0||t<=0||u<=0||typeof e!="number"||typeof t!="number"||typeof u!="number"?a:b?w.gamma.cdf(e,t,u,!0):w.gamma.pdf(e,t,u,!1)},Me.INV=function(e,t,u){return arguments.length!==3?v:e<0||e>1||t<=0||u<=0?c:typeof e!="number"||typeof t!="number"||typeof u!="number"?a:w.gamma.inv(e,t,u)},Se.PRECISE=function(e){return arguments.length!==1?v:e<=0?c:typeof e!="number"?a:w.gammaln(e)};const Oe={};function Ge(e,t){return oe(e=Le(V(e)),t=W(t))?e:t<0||e.length<t?a:e.sort((u,b)=>b-u)[t-1]}function et(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=w.mean(e),b=w.mean(t),B=t.length;let P=0,K=0;for(let me=0;me<B;me++)P+=(t[me]-b)*(e[me]-u),K+=Math.pow(t[me]-b,2);const le=P/K;return[le,u-le*b]}Oe.DIST=(e,t,u,b,B)=>{if(oe(e=W(e),t=W(t),u=W(u),b=W(b)))return a;function P(K,le,me,De){return dt(me,K)*dt(De-me,le-K)/dt(De,le)}return B?function(K,le,me,De){let Re=0;for(let ze=0;ze<=K;ze++)Re+=P(ze,le,me,De);return Re}(e,t,u,b):P(e,t,u,b)};const te={};function be(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;const u=ke(e);return u.length===0?0:Math.max.apply(Math,u)}function Te(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;const u=O(e);let b=w.median(u);return isNaN(b)&&(b=c),b}function z(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;const u=ke(e);return u.length===0?0:Math.min.apply(Math,u)}te.DIST=(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u))?a:b?w.lognormal.cdf(e,t,u):w.lognormal.pdf(e,t,u),te.INV=(e,t,u)=>oe(e=W(e),t=W(t),u=W(u))?a:w.lognormal.inv(e,t,u);const ee={MULT:function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=e.length,u={};let b,B=[],P=0;for(let K=0;K<t;K++)b=e[K],u[b]=u[b]?u[b]+1:1,u[b]>P&&(P=u[b],B=[]),u[b]===P&&(B[B.length]=b);return B},SNGL:function(){const e=Le(V(arguments));return e instanceof Error?e:ee.MULT(e).sort((t,u)=>t-u)[0]}},C={DIST:(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u))?a:b?w.negbin.cdf(e,t,u):w.negbin.pdf(e,t,u)},F={};function J(e,t){if(oe(t=Le(V(t)),e=Le(V(e))))return a;const u=w.mean(e),b=w.mean(t),B=e.length;let P=0,K=0,le=0;for(let me=0;me<B;me++)P+=(e[me]-u)*(t[me]-b),K+=Math.pow(e[me]-u,2),le+=Math.pow(t[me]-b,2);return P/Math.sqrt(K*le)}F.DIST=(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u))?a:u<=0?c:b?w.normal.cdf(e,t,u):w.normal.pdf(e,t,u),F.INV=(e,t,u)=>oe(e=W(e),t=W(t),u=W(u))?a:w.normal.inv(e,t,u),F.S={},F.S.DIST=(e,t)=>(e=W(e))instanceof Error?a:t?w.normal.cdf(e,0,1):w.normal.pdf(e,0,1),F.S.INV=e=>(e=W(e))instanceof Error?a:w.normal.inv(e,0,1);const de={EXC:(e,t)=>{if(oe(e=Le(V(e)),t=W(t)))return a;const u=(e=e.sort((P,K)=>P-K)).length;if(t<1/(u+1)||t>1-1/(u+1))return c;const b=t*(u+1)-1,B=Math.floor(b);return ye(b===B?e[b]:e[B]+(b-B)*(e[B+1]-e[B]))},INC:(e,t)=>{if(oe(e=Le(V(e)),t=W(t)))return a;const u=t*((e=e.sort((B,P)=>B-P)).length-1),b=Math.floor(u);return ye(u===b?e[u]:e[b]+(u-b)*(e[b+1]-e[b]))}},Q={EXC:(e,t,u)=>{if(u=u===void 0?3:u,oe(e=Le(V(e)),t=W(t),u=W(u)))return a;e=e.sort((Re,ze)=>Re-ze);const b=A.apply(null,e),B=e.length,P=b.length,K=Math.pow(10,u);let le=0,me=!1,De=0;for(;!me&&De<P;)t===b[De]?(le=(e.indexOf(b[De])+1)/(B+1),me=!0):t>=b[De]&&(t<b[De+1]||De===P-1)&&(le=(e.indexOf(b[De])+1+(t-b[De])/(b[De+1]-b[De]))/(B+1),me=!0),De++;return Math.floor(le*K)/K},INC:(e,t,u)=>{if(u=u===void 0?3:u,oe(e=Le(V(e)),t=W(t),u=W(u)))return a;e=e.sort((Re,ze)=>Re-ze);const b=A.apply(null,e),B=e.length,P=b.length,K=Math.pow(10,u);let le=0,me=!1,De=0;for(;!me&&De<P;)t===b[De]?(le=e.indexOf(b[De])/(B-1),me=!0):t>=b[De]&&(t<b[De+1]||De===P-1)&&(le=(e.indexOf(b[De])+(t-b[De])/(b[De+1]-b[De]))/(B-1),me=!0),De++;return Math.floor(le*K)/K}},pe={DIST:(e,t,u)=>oe(e=W(e),t=W(t))?a:u?w.poisson.cdf(e,t):w.poisson.pdf(e,t)},xe={EXC:(e,t)=>{if(oe(e=Le(V(e)),t=W(t)))return a;switch(t){case 1:return de.EXC(e,.25);case 2:return de.EXC(e,.5);case 3:return de.EXC(e,.75);default:return c}},INC:(e,t)=>{if(oe(e=Le(V(e)),t=W(t)))return a;switch(t){case 1:return de.INC(e,.25);case 2:return de.INC(e,.5);case 3:return de.INC(e,.75);default:return c}}},_e={};function je(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=w.mean(e),u=e.length;let b=0;for(let B=0;B<u;B++)b+=Math.pow(e[B]-t,3);return u*b/((u-1)*(u-2)*Math.pow(w.stdev(e,!0),3))}function Fe(e,t){return oe(e=Le(V(e)),t=W(t))?e:e.sort((u,b)=>u-b)[t-1]}_e.AVG=(e,t,u)=>{if(oe(e=W(e),t=Le(V(t))))return a;const b=(u=u||!1)?(K,le)=>K-le:(K,le)=>le-K,B=(t=(t=V(t)).sort(b)).length;let P=0;for(let K=0;K<B;K++)t[K]===e&&P++;return P>1?(2*t.indexOf(e)+P+1)/2:t.indexOf(e)+1},_e.EQ=(e,t,u)=>{if(oe(e=W(e),t=Le(V(t))))return a;const b=(u=u||!1)?(B,P)=>B-P:(B,P)=>P-B;return(t=t.sort(b)).indexOf(e)+1},je.P=function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=w.mean(e),u=e.length;let b=0,B=0;for(let P=0;P<u;P++)B+=Math.pow(e[P]-t,3),b+=Math.pow(e[P]-t,2);return B/=u,b/=u,B/Math.pow(b,1.5)};const He={P:function(){const e=se.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=c),t},S:function(){const e=se.S.apply(this,arguments);return Math.sqrt(e)}},Je={DIST:(e,t,u)=>u!==1&&u!==2?c:u===1?Je.DIST.RT(e,t):Je.DIST["2T"](e,t)};Je.DIST["2T"]=function(e,t){return arguments.length!==2?v:e<0||t<1?c:typeof e!="number"||typeof t!="number"?a:2*(1-w.studentt.cdf(e,t))},Je.DIST.RT=function(e,t){return arguments.length!==2?v:e<0||t<1?c:typeof e!="number"||typeof t!="number"?a:1-w.studentt.cdf(e,t)},Je.INV=(e,t)=>oe(e=W(e),t=W(t))?a:w.studentt.inv(e,t),Je.INV["2T"]=(e,t)=>(e=W(e),t=W(t),e<=0||e>1||t<1?c:oe(e,t)?a:Math.abs(w.studentt.inv(e/2,t))),Je.TEST=(e,t)=>{if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=w.mean(e),b=w.mean(t);let B,P=0,K=0;for(B=0;B<e.length;B++)P+=Math.pow(e[B]-u,2);for(B=0;B<t.length;B++)K+=Math.pow(t[B]-b,2);P/=e.length-1,K/=t.length-1;const le=Math.abs(u-b)/Math.sqrt(P/e.length+K/t.length);return Je.DIST["2T"](le,e.length+t.length-2)};const se={};function Ee(){const e=V(arguments),t=e.length;let u=0,b=0;const B=r(e);for(let P=0;P<t;P++){const K=e[P];u+=Math.pow(typeof K=="number"?K-B:K===!0?1-B:0-B,2),K!==null&&b++}return u/(b-1)}function Ae(){const e=V(arguments),t=e.length;let u=0,b=0;const B=r(e);let P;for(let K=0;K<t;K++){const le=e[K];u+=Math.pow(typeof le=="number"?le-B:le===!0?1-B:0-B,2),le!==null&&b++}return P=u/b,isNaN(P)&&(P=c),P}se.P=function(){const e=ke(V(arguments)),t=e.length;let u=0;const b=d(e);let B;for(let P=0;P<t;P++)u+=Math.pow(e[P]-b,2);return B=u/t,isNaN(B)&&(B=c),B},se.S=function(){const e=ke(V(arguments)),t=e.length;let u=0;const b=d(e);for(let B=0;B<t;B++)u+=Math.pow(e[B]-b,2);return u/(t-1)};const qe={DIST:(e,t,u,b)=>oe(e=W(e),t=W(t),u=W(u))?a:b?1-Math.exp(-Math.pow(e/u,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/u,t))*t/Math.pow(u,t)},tt={};function Ke(e,t,u){const b=ce(e=W(e),t=W(t),u=W(u));if(b)return b;if(t===0)return 0;t=Math.abs(t);const B=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.ceil(e/t)*t,B):u===0?-xt(Math.floor(Math.abs(e)/t)*t,B):-xt(Math.ceil(Math.abs(e)/t)*t,B)}function dt(e,t){return ce(e=W(e),t=W(t))||(e<t?c:nt(e)/(nt(t)*nt(e-t)))}tt.TEST=(e,t,u)=>{if(oe(e=Le(V(e)),t=W(t)))return a;u=u||He.S(e);const b=e.length;return 1-F.S.DIST((d(e)-t)/(u/Math.sqrt(b)),!0)},Ke.MATH=Ke,Ke.PRECISE=Ke;const mt=[];function nt(e){if((e=W(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(mt[t]>0||(mt[t]=nt(t-1)*t),mt[t])}function it(e,t){const u=ce(e=W(e),t=W(t));if(u)return u;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return c;t=Math.abs(t);const b=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,b):-xt(Math.ceil(Math.abs(e)/t),b)}it.MATH=(e,t,u)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const b=ce(e=W(e),t=W(t),u=W(u));if(b)return b;if(t===0)return 0;t=t?Math.abs(t):1;const B=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,B):u===0||u===void 0?-xt(Math.ceil(Math.abs(e)/t)*t,B):-xt(Math.floor(Math.abs(e)/t)*t,B)},it.PRECISE=it.MATH;const Qe={CEILING:Ke};function tn(e,t){const u=ce(e=W(e),t=W(t));if(u)return u;if(e===0&&t===0)return c;const b=Math.pow(e,t);return isNaN(b)?c:b}function Ut(){const e=V(arguments).filter(b=>b!=null);if(e.length===0)return 0;const t=Le(e);if(t instanceof Error)return t;let u=1;for(let b=0;b<t.length;b++)u*=t[b];return u}function xt(e,t){return ce(e=W(e),t=W(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function jt(){let e=0;return D(N(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const u=parseFloat(t);!isNaN(u)&&(e+=u)}else if(Array.isArray(t)){const u=jt.apply(null,t);u instanceof Error?e=u:e+=u}}),e}var fn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?v:ce(e=W(e),t=W(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?v:ce(e=W(e),t=W(t))||(t===0?l:e/t)},EQ:function(e,t){return arguments.length!==2?v:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?v:e instanceof Error?e:t instanceof Error?t:(ot(e,t)?(e=Ye(e),t=Ye(t)):(e=W(e),t=W(t)),ce(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?v:(ot(e,t)?(e=Ye(e),t=Ye(t)):(e=W(e),t=W(t)),ce(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?v:(ot(e,t)?(e=Ye(e),t=Ye(t)):(e=W(e),t=W(t)),ce(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?v:(ot(e,t)?(e=Ye(e),t=Ye(t)):(e=W(e),t=W(t)),ce(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?v:ce(e=W(e),t=W(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?v:ce(e=W(e),t=W(t))||e*t},NE:function(e,t){return arguments.length!==2?v:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?v:tn(e,t)}});const pn=new Date(Date.UTC(1900,0,1)),hn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],gn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],kt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function _t(e,t,u){u=u.toUpperCase(),e=Be(e),t=Be(t);const b=e.getFullYear(),B=e.getMonth(),P=e.getDate(),K=t.getFullYear(),le=t.getMonth(),me=t.getDate();let De;switch(u){case"Y":De=Math.floor(Yt(e,t));break;case"D":De=Lt(t,e);break;case"M":De=le-B+12*(K-b),me<P&&De--;break;case"MD":P<=me?De=me-P:(le===0?(e.setFullYear(K-1),e.setMonth(12)):(e.setFullYear(K),e.setMonth(le-1)),De=Lt(t,e));break;case"YM":De=le-B+12*(K-b),me<P&&De--,De%=12;break;case"YD":le>B||le===B&&me<P?e.setFullYear(K):e.setFullYear(K-1),De=Lt(t,e)}return De}function Ft(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=Be(e),t=Be(t),e instanceof Error?e:t instanceof Error?t:rn(Ft(e))-rn(Ft(t))}function Et(e,t,u){if(u=Pe(u||"false"),e=Be(e),t=Be(t),e instanceof Error)return e;if(t instanceof Error)return t;if(u instanceof Error)return u;const b=e.getMonth();let B,P,K=t.getMonth();if(u)B=e.getDate()===31?30:e.getDate(),P=t.getDate()===31?30:t.getDate();else{const le=new Date(e.getFullYear(),b+1,0).getDate(),me=new Date(t.getFullYear(),K+1,0).getDate();B=e.getDate()===le?30:e.getDate(),t.getDate()===me?B<30?(K++,P=1):P=30:P=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(K-b)+(P-B)}function nn(e){if((e=Be(e))instanceof Error)return e;(e=Ft(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Rt(e,t,u){return Rt.INTL(e,t,1,u)}function Ht(e,t,u){return Ht.INTL(e,t,1,u)}function Wt(e){return new Date(e,1,29).getMonth()===1}function Pt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Yt(e,t,u){if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;u=u||0;let b=e.getDate();const B=e.getMonth()+1,P=e.getFullYear();let K=t.getDate();const le=t.getMonth()+1,me=t.getFullYear();switch(u){case 0:return b===31&&K===31?(b=30,K=30):b===31?b=30:b===30&&K===31&&(K=30),(K+30*le+360*me-(b+30*B+360*P))/360;case 1:{const De=($e,rt)=>{const at=$e.getFullYear(),bt=new Date(at,2,1);if(Wt(at)&&$e<bt&&rt>=bt)return!0;const pt=rt.getFullYear(),At=new Date(pt,2,1);return Wt(pt)&&rt>=At&&$e<At};let Re=365;if(P===me||P+1===me&&(B>le||B===le&&b>=K))return(P===me&&Wt(P)||De(e,t)||le===1&&K===29)&&(Re=366),Pt(e,t)/Re;const ze=me-P+1,Ue=(new Date(me+1,0,1)-new Date(P,0,1))/1e3/60/60/24/ze;return Pt(e,t)/Ue}case 2:return Pt(e,t)/360;case 3:return Pt(e,t)/365;case 4:return(K+30*le+360*me-(b+30*B+360*P))/360}}function rn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-pn)/864e5)+t}function on(e){return(e=W(e))===0?a:e instanceof Error?e:String.fromCharCode(e)}function sn(e){if(oe(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=a),t}function an(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;let u=0;for(;(u=e.indexOf(!0))>-1;)e[u]="TRUE";let b=0;for(;(b=e.indexOf(!1))>-1;)e[b]="FALSE";return e.join("")}Rt.INTL=(e,t,u,b)=>{if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;let B=!1;const P=[],K=[1,2,3,4,5,6,0],le=new RegExp("^[0|1]{7}$");if(u===void 0)u=kt[1];else if(typeof u=="string"&&le.test(u)){B=!0,u=u.split("");for(let ze=0;ze<u.length;ze++)u[ze]==="1"&&P.push(K[ze])}else u=kt[u];if(!(u instanceof Array))return a;b===void 0?b=[]:b instanceof Array||(b=[b]);for(let ze=0;ze<b.length;ze++){const Ue=Be(b[ze]);if(Ue instanceof Error)return Ue;b[ze]=Ue}const me=Math.round((t-e)/864e5)+1;let De=me;const Re=e;for(let ze=0;ze<me;ze++){const Ue=new Date().getTimezoneOffset()>0?Re.getUTCDay():Re.getDay();let $e=B?P.includes(Ue):Ue===u[0]||Ue===u[1];for(let rt=0;rt<b.length;rt++){const at=b[rt];if(at.getDate()===Re.getDate()&&at.getMonth()===Re.getMonth()&&at.getFullYear()===Re.getFullYear()){$e=!0;break}}$e&&De--,Re.setDate(Re.getDate()+1)}return De},Ht.INTL=(e,t,u,b)=>{if((e=Be(e))instanceof Error)return e;if((t=W(t))instanceof Error)return t;if(t<0)return c;if(!((u=u===void 0?kt[1]:kt[u])instanceof Array))return a;b===void 0?b=[]:b instanceof Array||(b=[b]);for(let P=0;P<b.length;P++){const K=Be(b[P]);if(K instanceof Error)return K;b[P]=K}let B=0;for(;B<t;){e.setDate(e.getDate()+1);const P=e.getDay();if(P!==u[0]&&P!==u[1]){for(let K=0;K<b.length;K++){const le=b[K];if(le.getDate()===e.getDate()&&le.getMonth()===e.getMonth()&&le.getFullYear()===e.getFullYear()){B--;break}}B++}}return e};const mn=an;function ln(e,t=2,u=!1){if(e=W(e),isNaN(e)||(t=W(t),isNaN(t)))return a;if(t<0){const b=Math.pow(10,-t);e=Math.round(e/b)*b}else e=e.toFixed(t);if(u)e=e.toString().replace(/,/g,"");else{const b=e.toString().split(".");b[0]=b[0].replace(/\B(?=(\d{3})+$)/g,","),e=b.join(".")}return e}function wt(e,t){return ce(e,t)||(e=Ye(e),(t=W(t))instanceof Error?t:new Array(t+1).join(e))}const vn=on,yn=sn;function zt(e){return/^[01]{1,10}$/.test(e)}function ht(e,t,u){if(oe(e=W(e),t=W(t)))return e;if((u=u===void 0?"i":u)!=="i"&&u!=="j")return a;if(e===0&&t===0)return 0;if(e===0)return t===1?u:t.toString()+u;if(t===0)return e.toString();{const b=t>0?"+":"";return e.toString()+b+(t===1?u:t.toString()+u)}}function Xt(e,t){return t=t===void 0?0:t,oe(e=W(e),t=W(t))?a:w.erf(e)}function Gt(e){return isNaN(e)?a:w.erfc(e)}function Kt(e){const t=ct(e),u=ut(e);return oe(t,u)?a:Math.sqrt(Math.pow(t,2)+Math.pow(u,2))}function ut(e){if(e===void 0||e===!0||e===!1)return a;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),u=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),u===0&&(u=e.indexOf("-",1));const b=e.substring(e.length-1,e.length),B=b==="i"||b==="j";return t>=0||u>=0?B?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?c:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,u))||isNaN(e.substring(u+1,e.length-1))?c:-Number(e.substring(u+1,e.length-1)):c:B?isNaN(e.substring(0,e.length-1))?c:e.substring(0,e.length-1):isNaN(e)?c:0}function $t(e){const t=ct(e),u=ut(e);return oe(t,u)?a:t===0&&u===0?l:t===0&&u>0?Math.PI/2:t===0&&u<0?-Math.PI/2:u===0&&t>0?0:u===0&&t<0?-Math.PI:t>0?Math.atan(u/t):t<0&&u>=0?Math.atan(u/t)+Math.PI:Math.atan(u/t)-Math.PI}function Vt(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.cos(t)*(Math.exp(u)+Math.exp(-u))/2,-Math.sin(t)*(Math.exp(u)-Math.exp(-u))/2,b)}function un(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.cos(u)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(u)*(Math.exp(t)-Math.exp(-t))/2,b)}function Mt(e,t){const u=ct(e),b=ut(e),B=ct(t),P=ut(t);if(oe(u,b,B,P))return a;const K=e.substring(e.length-1),le=t.substring(t.length-1);let me="i";if((K==="j"||le==="j")&&(me="j"),B===0&&P===0)return c;const De=B*B+P*P;return ht((u*B+b*P)/De,(b*B-u*P)/De,me)}function ct(e){if(e===void 0||e===!0||e===!1)return a;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),u=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),u===0&&(u=e.indexOf("-",1));const b=e.substring(e.length-1,e.length),B=b==="i"||b==="j";return t>=0||u>=0?B?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?c:Number(e.substring(0,t)):isNaN(e.substring(0,u))||isNaN(e.substring(u+1,e.length-1))?c:Number(e.substring(0,u)):c:B?isNaN(e.substring(0,e.length-1))?c:0:isNaN(e)?c:e}function qt(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.sin(t)*(Math.exp(u)+Math.exp(-u))/2,Math.cos(t)*(Math.exp(u)-Math.exp(-u))/2,b)}function cn(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.cos(u)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(u)*(Math.exp(t)+Math.exp(-t))/2,b)}Xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const bn=U.DIST,wn=U.INV,Cn=re.DIST,xn=Ke.MATH,En=Ke.PRECISE,An=ne.DIST,jn=ne.DIST.RT,Ln=ne.INV,Mn=ne.INV.RT,Dn=ne.TEST,In=ie.P,Tn=ie.P,Nn=ie.S,_n=re.INV,Bn=Gt.PRECISE,Sn=Xt.PRECISE,On=we.DIST,kn=fe.DIST,Fn=fe.DIST.RT,Rn=fe.INV,Hn=fe.INV.RT,Pn=it.MATH,Vn=it.PRECISE,qn=fe.TEST,Un=Me.DIST,Wn=Me.INV,Yn=Se.PRECISE,zn=Oe.DIST,Xn=te.INV,Gn=te.DIST,Kn=te.INV,$n=ee.MULT,Zn=ee.SNGL,Jn=C.DIST,Qn=Rt.INTL,er=F.DIST,tr=F.INV,nr=F.S.DIST,rr=F.S.INV,or=de.EXC,sr=de.INC,ir=Q.EXC,ar=Q.INC,lr=pe.DIST,ur=xe.EXC,cr=xe.INC,dr=_e.AVG,fr=_e.EQ,pr=je.P,hr=He.P,gr=He.S,mr=Je.DIST,vr=Je.DIST.RT,yr=Je.INV,br=Je.TEST,wr=se.P,Cr=se.S,xr=qe.DIST,Er=Ht.INTL,Ar=tt.TEST;function Zt(e){const t=[];return D(e,u=>{u&&t.push(u)}),t}function Ct(e,t){const u={};for(let P=1;P<e[0].length;++P)u[P]=!0;let b=t[0].length;for(let P=1;P<t.length;++P)t[P].length>b&&(b=t[P].length);for(let P=1;P<e.length;++P)for(let K=1;K<e[P].length;++K){let le=!1,me=!1;for(let De=0;De<t.length;++De){const Re=t[De];if(Re.length<b)continue;const ze=Re[0];if(e[P][0]===ze){me=!0;for(let Ue=1;Ue<Re.length;++Ue)if(!le)if(Re[Ue]===void 0||Re[Ue]==="*")le=!0;else{const $e=vt(Re[Ue]+""),rt=[ft(e[P][K],st)].concat($e);le=yt(rt)}}}me&&(u[K]=u[K]&&le)}const B=[];for(let P=0;P<e[0].length;++P)u[P]&&B.push(P-1);return B}function Jt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Qt(e){return e instanceof Date?e:new Date(e)}function Dt(e,t,u,b,B){if(b=b||0,B=B||0,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B)))return a;let P;if(e===0)P=b+u*t;else{const K=Math.pow(1+e,t);P=B===1?b*K+u*(1+e)*(K-1)/e:b*K+u*(K-1)/e}return-P}function dn(e,t,u,b,B,P){if(B=B||0,P=P||0,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B),P=W(P)))return a;const K=Bt(e,u,b,B,P);return(t===1?P===1?0:-b:P===1?Dt(e,t-2,K,b,1)-K:Dt(e,t-1,K,b,0))*e}function en(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=e[0];let u=0;for(let b=1;b<e.length;b++)u+=e[b]/Math.pow(1+t,b);return u}function Bt(e,t,u,b,B){if(b=b||0,B=B||0,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B)))return a;let P;if(e===0)P=(u+b)/t;else{const K=Math.pow(1+e,t);P=B===1?(b*e/(K-1)+u*e/(1-1/K))/(1+e):b*e/(K-1)+u*e/(1-1/K)}return-P}const jr={errors:k,symbols:fn};m.ABS=function(e){return(e=W(e))instanceof Error?e:Math.abs(e)},m.ACCRINT=function(e,t,u,b,B,P,K){return e=Qt(e),t=Qt(t),u=Qt(u),Jt(e)&&Jt(t)&&Jt(u)?b<=0||B<=0||[1,2,4].indexOf(P)===-1||[0,1,2,3,4].indexOf(K)===-1||u<=e?c:(B=B||0)*b*Yt(e,u,K=K||0):a},m.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},m.ACOS=function(e){if((e=W(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=c),t},m.ACOSH=function(e){if((e=W(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=c),t},m.ACOT=function(e){return(e=W(e))instanceof Error?e:Math.atan(1/e)},m.ACOTH=function(e){if((e=W(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=c),t},m.AGGREGATE=function(e,t,u,b){if(oe(e=W(e),W(e)))return a;switch(e){case 1:return d(u);case 2:return _(u);case 3:return q(u);case 4:return be(u);case 5:return z(u);case 6:return Ut(u);case 7:return He.S(u);case 8:return He.P(u);case 9:return jt(u);case 10:return se.S(u);case 11:return se.P(u);case 12:return Te(u);case 13:return ee.SNGL(u);case 14:return Ge(u,b);case 15:return Fe(u,b);case 16:return de.INC(u,b);case 17:return xe.INC(u,b);case 18:return de.EXC(u,b);case 19:return xe.EXC(u,b)}},m.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},m.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},m.AND=function(){const e=V(arguments);let t=a;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===a&&(t=!0),e[u]||(t=!1))}return t},m.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return a;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,u=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[u]}),t},m.ASC=function(){throw new Error("ASC is not implemented")},m.ASIN=function(e){if((e=W(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=c),t},m.ASINH=function(e){return(e=W(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},m.ATAN=function(e){return(e=W(e))instanceof Error?e:Math.atan(e)},m.ATAN2=function(e,t){return ce(e=W(e),t=W(t))||Math.atan2(e,t)},m.ATANH=function(e){if((e=W(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=c),t},m.AVEDEV=function(){const e=V(arguments).filter(Ne);if(e.length===0)return c;const t=Le(e);return t instanceof Error?t:w.sum(w(t).subtract(w.mean(t)).abs()[0])/t.length},m.AVERAGE=d,m.AVERAGEA=r,m.AVERAGEIF=function(e,t,u){if(arguments.length<=1)return v;if(u=Le(V(u=u||e).filter(Ne)),e=V(e),u instanceof Error)return u;let b=0,B=0;const P=t===void 0||t==="*",K=P?null:vt(t+"");for(let le=0;le<e.length;le++){const me=e[le];if(P)B+=u[le],b++;else{const De=[ft(me,st)].concat(K);yt(De)&&(B+=u[le],b++)}}return B/b},m.AVERAGEIFS=function(){const e=N(arguments),t=(e.length-1)/2,u=V(e[0]);let b=0,B=0;for(let K=0;K<u.length;K++){let le=!1;for(let me=0;me<t;me++){const De=e[2*me+1][K],Re=e[2*me+2];let ze=!1;if(Re===void 0||Re==="*")ze=!0;else{const Ue=vt(Re+""),$e=[ft(De,st)].concat(Ue);ze=yt($e)}if(!ze){le=!1;break}le=!0}le&&(B+=u[K],b++)}const P=B/b;return isNaN(P)?0:P},m.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},m.BASE=function(e,t,u){const b=ce(e=W(e),t=W(t),u=W(u));if(b)return b;if(t===0)return c;const B=e.toString(t);return new Array(Math.max(u+1-B.length,0)).join("0")+B},m.BESSELI=function(e,t){return oe(e=W(e),t=W(t))?a:S.besseli(e,t)},m.BESSELJ=function(e,t){return oe(e=W(e),t=W(t))?a:S.besselj(e,t)},m.BESSELK=function(e,t){return oe(e=W(e),t=W(t))?a:S.besselk(e,t)},m.BESSELY=function(e,t){return oe(e=W(e),t=W(t))?a:S.bessely(e,t)},m.BETA=U,m.BETADIST=bn,m.BETAINV=wn,m.BIN2DEC=function(e){if(!zt(e))return c;const t=parseInt(e,2),u=e.toString();return u.length===10&&u.substring(0,1)==="1"?parseInt(u.substring(1),2)-512:t},m.BIN2HEX=function(e,t){if(!zt(e))return c;const u=e.toString();if(u.length===10&&u.substring(0,1)==="1")return(0xfffffffe00+parseInt(u.substring(1),2)).toString(16);const b=parseInt(e,2).toString(16);return t===void 0?b:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=b.length?wt("0",t-b.length)+b:c},m.BIN2OCT=function(e,t){if(!zt(e))return c;const u=e.toString();if(u.length===10&&u.substring(0,1)==="1")return(1073741312+parseInt(u.substring(1),2)).toString(8);const b=parseInt(e,2).toString(8);return t===void 0?b:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=b.length?wt("0",t-b.length)+b:c},m.BINOM=re,m.BINOMDIST=Cn,m.BITAND=function(e,t){return oe(e=W(e),t=W(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e&t},m.BITLSHIFT=function(e,t){return oe(e=W(e),t=W(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?c:t>=0?e<<t:e>>-t},m.BITOR=function(e,t){return oe(e=W(e),t=W(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e|t},m.BITRSHIFT=function(e,t){return oe(e=W(e),t=W(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?c:t>=0?e>>t:e<<-t},m.BITXOR=function(e,t){return oe(e=W(e),t=W(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?c:e^t},m.CEILING=Ke,m.CEILINGMATH=xn,m.CEILINGPRECISE=En,m.CELL=function(){throw new Error("CELL is not implemented")},m.CHAR=on,m.CHIDIST=An,m.CHIDISTRT=jn,m.CHIINV=Ln,m.CHIINVRT=Mn,m.CHISQ=ne,m.CHITEST=Dn,m.CHOOSE=function(){if(arguments.length<2)return v;const e=arguments[0];return e<1||e>254||arguments.length<e+1?a:arguments[e]},m.CLEAN=function(e){return oe(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},m.CODE=sn,m.COLUMN=function(e,t){return arguments.length!==2?v:t<0?c:e instanceof Array&&typeof t=="number"?e.length!==0?w.col(e,t):void 0:a},m.COLUMNS=function(e){return arguments.length!==1?v:e instanceof Array?e.length===0?0:w.cols(e):a},m.COMBIN=dt,m.COMBINA=function(e,t){return ce(e=W(e),t=W(t))||(e<t?c:e===0&&t===0?1:dt(e+t-1,e-1))},m.COMPLEX=ht,m.CONCAT=mn,m.CONCATENATE=an,m.CONFIDENCE=R,m.CONVERT=function(e,t,u){if((e=W(e))instanceof Error)return e;const b=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],B={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},P={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let K,le=null,me=null,De=t,Re=u,ze=1,Ue=1;for(let $e=0;$e<b.length;$e++)K=b[$e][2]===null?[]:b[$e][2],(b[$e][1]===De||K.indexOf(De)>=0)&&(le=b[$e]),(b[$e][1]===Re||K.indexOf(Re)>=0)&&(me=b[$e]);if(le===null){const $e=B[t.substring(0,2)];let rt=P[t.substring(0,1)];t.substring(0,2)==="da"&&(rt=["dekao",10,"da"]),$e?(ze=$e[2],De=t.substring(2)):rt&&(ze=rt[1],De=t.substring(rt[2].length));for(let at=0;at<b.length;at++)K=b[at][2]===null?[]:b[at][2],(b[at][1]===De||K.indexOf(De)>=0)&&(le=b[at])}if(me===null){const $e=B[u.substring(0,2)];let rt=P[u.substring(0,1)];u.substring(0,2)==="da"&&(rt=["dekao",10,"da"]),$e?(Ue=$e[2],Re=u.substring(2)):rt&&(Ue=rt[1],Re=u.substring(rt[2].length));for(let at=0;at<b.length;at++)K=b[at][2]===null?[]:b[at][2],(b[at][1]===Re||K.indexOf(Re)>=0)&&(me=b[at])}return le===null||me===null||le[3]!==me[3]?v:e*le[6]*ze/(me[6]*Ue)},m.CORREL=function(e,t){return oe(e=Le(V(e)),t=Le(V(t)))?a:w.corrcoeff(e,t)},m.COS=function(e){return(e=W(e))instanceof Error?e:Math.cos(e)},m.COSH=function(e){return(e=W(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},m.COT=function(e){return(e=W(e))instanceof Error?e:e===0?l:1/Math.tan(e)},m.COTH=function(e){if((e=W(e))instanceof Error)return e;if(e===0)return l;const t=Math.exp(2*e);return(t+1)/(t-1)},m.COUNT=_,m.COUNTA=q,m.COUNTBLANK=Z,m.COUNTIF=function(e,t){if(e=V(e),t===void 0||t==="*")return e.length;let u=0;const b=vt(t+"");for(let B=0;B<e.length;B++){const P=[ft(e[B],st)].concat(b);yt(P)&&u++}return u},m.COUNTIFS=function(){const e=N(arguments),t=new Array(V(e[0]).length);for(let b=0;b<t.length;b++)t[b]=!0;for(let b=0;b<e.length;b+=2){const B=V(e[b]),P=e[b+1];if(P!==void 0&&P!=="*"){const K=vt(P+"");for(let le=0;le<B.length;le++){const me=[ft(B[le],st)].concat(K);t[le]=t[le]&&yt(me)}}}let u=0;for(let b=0;b<t.length;b++)t[b]&&u++;return u},m.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},m.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},m.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},m.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},m.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},m.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},m.COVAR=In,m.COVARIANCE=ie,m.COVARIANCEP=Tn,m.COVARIANCES=Nn,m.CRITBINOM=_n,m.CSC=function(e){return(e=W(e))instanceof Error?e:e===0?l:1/Math.sin(e)},m.CSCH=function(e){return(e=W(e))instanceof Error?e:e===0?l:2/(Math.exp(e)-Math.exp(-e))},m.CUMIPMT=function(e,t,u,b,B,P){if(oe(e=W(e),t=W(t),u=W(u)))return a;if(e<=0||t<=0||u<=0||b<1||B<1||b>B||P!==0&&P!==1)return c;const K=Bt(e,t,u,0,P);let le=0;b===1&&(P===0&&(le=-u),b++);for(let me=b;me<=B;me++)le+=P===1?Dt(e,me-2,K,u,1)-K:Dt(e,me-1,K,u,0);return le*=e,le},m.CUMPRINC=function(e,t,u,b,B,P){if(oe(e=W(e),t=W(t),u=W(u)))return a;if(e<=0||t<=0||u<=0||b<1||B<1||b>B||P!==0&&P!==1)return c;const K=Bt(e,t,u,0,P);let le=0;b===1&&(le=P===0?K+u*e:K,b++);for(let me=b;me<=B;me++)le+=P>0?K-(Dt(e,me-2,K,u,1)-K)*e:K-Dt(e,me-1,K,u,0)*e;return le},m.DATE=function(e,t,u){let b;return oe(e=W(e),t=W(t),u=W(u))?b=a:(b=new Date(e,t-1,u),b.getFullYear()<0&&(b=c)),b},m.DATEDIF=_t,m.DATEVALUE=function(e){if(typeof e!="string")return a;const t=Date.parse(e);return isNaN(t)?a:new Date(e)},m.DAVERAGE=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);let P=0;return D(b,K=>{P+=B[K]}),b.length===0?l:P/b.length},m.DAY=function(e){const t=Be(e);return t instanceof Error?t:t.getDate()},m.DAYS=Lt,m.DAYS360=Et,m.DB=function(e,t,u,b,B){if(B=B===void 0?12:B,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B)))return a;if(e<0||t<0||u<0||b<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(B)===-1||b>u)return c;if(t>=e)return 0;const P=(1-Math.pow(t/e,1/u)).toFixed(3),K=e*P*B/12;let le=K,me=0;const De=b===u?u-1:b;for(let Re=2;Re<=De;Re++)me=(e-le)*P,le+=me;return b===1?K:b===u?(e-le)*P:me},m.DBCS=function(){throw new Error("DBCS is not implemented")},m.DCOUNT=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);const P=[];return D(b,K=>{P.push(B[K])}),_(P)},m.DCOUNTA=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);const P=[];return D(b,K=>{P.push(B[K])}),q(P)},m.DDB=function(e,t,u,b,B){if(B=B===void 0?2:B,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B)))return a;if(e<0||t<0||u<0||b<0||B<=0||b>u)return c;if(t>=e)return 0;let P=0,K=0;for(let le=1;le<=b;le++)K=Math.min(B/u*(e-P),e-t-P),P+=K;return K},m.DEC2BIN=function(e,t){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return c;if(e<0)return"1"+wt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const u=parseInt(e,10).toString(2);return t===void 0?u:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=u.length?wt("0",t-u.length)+u:c},m.DEC2HEX=function(e,t){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return c;if(e<0)return(1099511627776+e).toString(16);const u=parseInt(e,10).toString(16);return t===void 0?u:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=u.length?wt("0",t-u.length)+u:c},m.DEC2OCT=function(e,t){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return c;if(e<0)return(1073741824+e).toString(8);const u=parseInt(e,10).toString(8);return t===void 0?u:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=u.length?wt("0",t-u.length)+u:c},m.DECIMAL=function(e,t){return arguments.length<1?a:ce(e=W(e),t=W(t))||(t===0?c:parseInt(e,t))},m.DEGREES=function(e){return(e=W(e))instanceof Error?e:180*e/Math.PI},m.DELTA=function(e,t){return t=t===void 0?0:t,oe(e=W(e),t=W(t))?a:e===t?1:0},m.DEVSQ=function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=w.mean(e);let u=0;for(let b=0;b<e.length;b++)u+=Math.pow(e[b]-t,2);return u},m.DGET=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];return B=G(typeof t=="string"?e[he(e,t)]:e[t]),b.length===0?a:b.length>1?c:B[b[0]]},m.DISC=function(e,t,u,b,B){if(oe(e=Be(e),t=Be(t),u=W(u),b=W(b),B=(B=W(B))||0))return a;if(u<=0||b<=0)return c;if(e>=t)return a;let P,K;switch(B){case 0:P=360,K=Et(e,t,!1);break;case 1:case 3:P=365,K=_t(e,t,"D");break;case 2:P=360,K=_t(e,t,"D");break;case 4:P=360,K=Et(e,t,!0);break;default:return c}return(b-u)/b*P/K},m.DMAX=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);let P=B[b[0]];return D(b,K=>{P<B[K]&&(P=B[K])}),P},m.DMIN=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);let P=B[b[0]];return D(b,K=>{P>B[K]&&(P=B[K])}),P},m.DOLLAR=function(e,t=2){if(e=W(e),isNaN(e))return a;const u={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},b=(e=xt(e,t)).toLocaleString("en-US",u);return e<0?"$("+b.slice(2)+")":b},m.DOLLARDE=function(e,t){if(oe(e=W(e),t=W(t)))return a;if(t<0)return c;if(t>=0&&t<1)return l;t=parseInt(t,10);let u=parseInt(e,10);u+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const b=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return u=Math.round(u*b)/b,u},m.DOLLARFR=function(e,t){if(oe(e=W(e),t=W(t)))return a;if(t<0)return c;if(t>=0&&t<1)return l;t=parseInt(t,10);let u=parseInt(e,10);return u+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,u},m.DPRODUCT=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const le=he(e,t);B=G(e[le])}else B=G(e[t]);let P=[];D(b,le=>{P.push(B[le])}),P=Zt(P);let K=1;return D(P,le=>{K*=le}),K},m.DSTDEV=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);let P=[];return D(b,K=>{P.push(B[K])}),P=Zt(P),He.S(P)},m.DSTDEVP=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);let P=[];return D(b,K=>{P.push(B[K])}),P=Zt(P),He.P(P)},m.DSUM=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);const P=[];return D(b,K=>{P.push(B[K])}),jt(P)},m.DURATION=function(){throw new Error("DURATION is not implemented")},m.DVAR=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);const P=[];return D(b,K=>{P.push(B[K])}),se.S(P)},m.DVARP=function(e,t,u){if(isNaN(t)&&typeof t!="string")return a;const b=Ct(e,u);let B=[];if(typeof t=="string"){const K=he(e,t);B=G(e[K])}else B=G(e[t]);const P=[];return D(b,K=>{P.push(B[K])}),se.P(P)},m.EDATE=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},m.EFFECT=function(e,t){return oe(e=W(e),t=W(t))?a:e<=0||t<1?c:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},m.EOMONTH=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},m.ERF=Xt,m.ERFC=Gt,m.ERFCPRECISE=Bn,m.ERFPRECISE=Sn,m.ERROR=Tt,m.EVEN=function(e){return(e=W(e))instanceof Error?e:Ke(e,-2,-1)},m.EXACT=function(e,t){return arguments.length!==2?v:ce(e,t)||(e=Ye(e))===Ye(t)},m.EXP=function(e){return arguments.length<1?v:arguments.length>1?j:(e=W(e))instanceof Error?e:e=Math.exp(e)},m.EXPON=we,m.EXPONDIST=On,m.F=fe,m.FACT=nt,m.FACTDOUBLE=function e(t){if((t=W(t))instanceof Error)return t;const u=Math.floor(t);return u<=0?1:u*e(u-2)},m.FALSE=function(){return!1},m.FDIST=kn,m.FDISTRT=Fn,m.FIND=function(e,t,u){if(arguments.length<2)return v;e=Ye(e),u=u===void 0?0:u;const b=(t=Ye(t)).indexOf(e,u-1);return b===-1?a:b+1},m.FINV=Rn,m.FINVRT=Hn,m.FISHER=function(e){return(e=W(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},m.FISHERINV=function(e){if((e=W(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.FIXED=ln,m.FLOOR=it,m.FLOORMATH=Pn,m.FLOORPRECISE=Vn,m.FORECAST=ve,m.FREQUENCY=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=e.length,b=t.length,B=[];for(let P=0;P<=b;P++){B[P]=0;for(let K=0;K<u;K++)P===0?e[K]<=t[0]&&(B[0]+=1):P<b?e[K]>t[P-1]&&e[K]<=t[P]&&(B[P]+=1):P===b&&e[K]>t[b-1]&&(B[b]+=1)}return B},m.FTEST=qn,m.FV=Dt,m.FVSCHEDULE=function(e,t){if(oe(e=W(e),t=Le(V(t))))return a;const u=t.length;let b=e;for(let B=0;B<u;B++)b*=1+t[B];return b},m.GAMMA=Me,m.GAMMADIST=Un,m.GAMMAINV=Wn,m.GAMMALN=Se,m.GAMMALNPRECISE=Yn,m.GAUSS=function(e){return(e=W(e))instanceof Error?e:w.normal.cdf(e,0,1)-.5},m.GCD=function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=e.length,u=e[0];let b=u<0?-u:u;for(let B=1;B<t;B++){const P=e[B];let K=P<0?-P:P;for(;b&&K;)b>K?b%=K:K%=b;b+=K}return b},m.GEOMEAN=function(){const e=Le(V(arguments));return e instanceof Error?e:w.geomean(e)},m.GESTEP=function(e,t){return oe(t=t||0,e=W(e))?e:e>=t?1:0},m.GROWTH=function(e,t,u,b){if((e=Le(e))instanceof Error)return e;let B;if(t===void 0)for(t=[],B=1;B<=e.length;B++)t.push(B);if(u===void 0)for(u=[],B=1;B<=e.length;B++)u.push(B);if(oe(t=Le(t),u=Le(u)))return a;b===void 0&&(b=!0);const P=e.length;let K,le,me=0,De=0,Re=0,ze=0;for(B=0;B<P;B++){const $e=t[B],rt=Math.log(e[B]);me+=$e,De+=rt,Re+=$e*rt,ze+=$e*$e}me/=P,De/=P,Re/=P,ze/=P,b?(K=(Re-me*De)/(ze-me*me),le=De-K*me):(K=Re/ze,le=0);const Ue=[];for(B=0;B<u.length;B++)Ue.push(Math.exp(le+K*u[B]));return Ue},m.HARMEAN=function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=e.length;let u=0;for(let b=0;b<t;b++)u+=1/e[b];return t/u},m.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const u=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),b=u?parseInt(e,16)-1099511627776:parseInt(e,16);if(b<-512||b>511)return c;if(u)return"1"+wt("0",9-(512+b).toString(2).length)+(512+b).toString(2);const B=b.toString(2);return t===void 0?B:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=B.length?wt("0",t-B.length)+B:c},m.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},m.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return c;const u=parseInt(e,16);if(u>536870911&&u<0xffe0000000)return c;if(u>=0xffe0000000)return(u-0xffc0000000).toString(8);const b=u.toString(8);return t===void 0?b:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=b.length?wt("0",t-b.length)+b:c},m.HLOOKUP=function(e,t,u,b){return I(e,ae(t),u,b)},m.HOUR=function(e){return(e=Be(e))instanceof Error?e:e.getHours()},m.HYPGEOM=Oe,m.HYPGEOMDIST=zn,m.IF=function(e,t,u){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(u=arguments.length===3&&u)==null&&(u=0),e?t:u)},m.IFERROR=function(e,t){return It(e)?t:e},m.IFNA=function(e,t){return e===v?t:e},m.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return v},m.IMABS=Kt,m.IMAGINARY=ut,m.IMARGUMENT=$t,m.IMCONJUGATE=function(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",u!==0?ht(t,-u,b):e},m.IMCOS=Vt,m.IMCOSH=un,m.IMCOT=function(e){return oe(ct(e),ut(e))?a:Mt(Vt(e),qt(e))},m.IMCSC=function(e){return e===!0||e===!1?a:oe(ct(e),ut(e))?c:Mt("1",qt(e))},m.IMCSCH=function(e){return e===!0||e===!1?a:oe(ct(e),ut(e))?c:Mt("1",cn(e))},m.IMDIV=Mt,m.IMEXP=function(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);b=b==="i"||b==="j"?b:"i";const B=Math.exp(t);return ht(B*Math.cos(u),B*Math.sin(u),b)},m.IMLN=function(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.log(Math.sqrt(t*t+u*u)),Math.atan(u/t),b)},m.IMLOG10=function(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.log(Math.sqrt(t*t+u*u))/Math.log(10),Math.atan(u/t)/Math.log(10),b)},m.IMLOG2=function(e){const t=ct(e),u=ut(e);if(oe(t,u))return a;let b=e.substring(e.length-1);return b=b==="i"||b==="j"?b:"i",ht(Math.log(Math.sqrt(t*t+u*u))/Math.log(2),Math.atan(u/t)/Math.log(2),b)},m.IMPOWER=function(e,t){if(oe(t=W(t),ct(e),ut(e)))return a;let u=e.substring(e.length-1);u=u==="i"||u==="j"?u:"i";const b=Math.pow(Kt(e),t),B=$t(e);return ht(b*Math.cos(t*B),b*Math.sin(t*B),u)},m.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return a;for(let t=1;t<arguments.length;t++){const u=ct(e),b=ut(e),B=ct(arguments[t]),P=ut(arguments[t]);if(oe(u,b,B,P))return a;e=ht(u*B-b*P,u*P+b*B)}return e},m.IMREAL=ct,m.IMSEC=function(e){return e===!0||e===!1||oe(ct(e),ut(e))?a:Mt("1",Vt(e))},m.IMSECH=function(e){return oe(ct(e),ut(e))?a:Mt("1",un(e))},m.IMSIN=qt,m.IMSINH=cn,m.IMSQRT=function(e){if(oe(ct(e),ut(e)))return a;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const u=Math.sqrt(Kt(e)),b=$t(e);return ht(u*Math.cos(b/2),u*Math.sin(b/2),t)},m.IMSUB=function(e,t){const u=ct(e),b=ut(e),B=ct(t),P=ut(t);if(oe(u,b,B,P))return a;const K=e.substring(e.length-1),le=t.substring(t.length-1);let me="i";return(K==="j"||le==="j")&&(me="j"),ht(u-B,b-P,me)},m.IMSUM=function(){if(!arguments.length)return a;const e=V(arguments);let t=e[0];for(let u=1;u<e.length;u++){const b=ct(t),B=ut(t),P=ct(e[u]),K=ut(e[u]);if(oe(b,B,P,K))return a;t=ht(b+P,B+K)}return t},m.IMTAN=function(e){return e===!0||e===!1||oe(ct(e),ut(e))?a:Mt(qt(e),Vt(e))},m.INDEX=function(e,t,u){const b=ce(e,t,u);if(b)return b;if(!Array.isArray(e))return a;const B=e.length>0&&!Array.isArray(e[0]);return B&&!u?(u=t,t=1):(u=u||1,t=t||1),u<0||t<0?a:B&&t===1&&u<=e.length?e[u-1]:t<=e.length&&u<=e[t-1].length?e[t-1][u-1]:h},m.INFO=function(){throw new Error("INFO is not implemented")},m.INT=function(e){return(e=W(e))instanceof Error?e:Math.floor(e)},m.INTERCEPT=function(e,t){return oe(e=Le(e),t=Le(t))?a:e.length!==t.length?v:ve(0,e,t)},m.INTRATE=function(){throw new Error("INTRATE is not implemented")},m.IPMT=dn,m.IRR=function(e,t){if(t=t||0,oe(e=Le(V(e)),t=W(t)))return a;const u=(Ue,$e,rt)=>{const at=rt+1;let bt=Ue[0];for(let pt=1;pt<Ue.length;pt++)bt+=Ue[pt]/Math.pow(at,($e[pt]-$e[0])/365);return bt},b=(Ue,$e,rt)=>{const at=rt+1;let bt=0;for(let pt=1;pt<Ue.length;pt++){const At=($e[pt]-$e[0])/365;bt-=At*Ue[pt]/Math.pow(at,At+1)}return bt},B=[];let P=!1,K=!1;for(let Ue=0;Ue<e.length;Ue++)B[Ue]=Ue===0?0:B[Ue-1]+365,e[Ue]>0&&(P=!0),e[Ue]<0&&(K=!0);if(!P||!K)return c;let le,me,De,Re=t=t===void 0?.1:t,ze=!0;do De=u(e,B,Re),le=Re-De/b(e,B,Re),me=Math.abs(le-Re),Re=le,ze=me>1e-10&&Math.abs(De)>1e-10;while(ze);return Re},m.ISBLANK=function(e){return e===null},m.ISERR=St,m.ISERROR=It,m.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},m.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},m.ISLOGICAL=gt,m.ISNA=function(e){return e===v},m.ISNONTEXT=function(e){return typeof e!="string"},m.ISNUMBER=Nt,m.ISO=Qe,m.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},m.ISOWEEKNUM=nn,m.ISPMT=function(e,t,u,b){return oe(e=W(e),t=W(t),u=W(u),b=W(b))?a:b*e*(t/u-1)},m.ISREF=function(){throw new Error("ISREF is not implemented")},m.ISTEXT=Ot,m.KURT=function(){const e=Le(V(arguments));if(e instanceof Error)return e;const t=w.mean(e),u=e.length;let b=0;for(let B=0;B<u;B++)b+=Math.pow(e[B]-t,4);return b/=Math.pow(w.stdev(e,!0),4),u*(u+1)/((u-1)*(u-2)*(u-3))*b-3*(u-1)*(u-1)/((u-2)*(u-3))},m.LARGE=Ge,m.LCM=function(){const e=Le(V(arguments));if(e instanceof Error)return e;for(var t,u,b,B,P=1;(b=e.pop())!==void 0;){if(b===0)return 0;for(;b>1;){if(b%2){for(t=3,u=Math.floor(Math.sqrt(b));t<=u&&b%t;t+=2);B=t<=u?t:b}else B=2;for(b/=B,P*=B,t=e.length;t;e[--t]%B==0&&(e[t]/=B)==1&&e.splice(t,1));}}return P},m.LEFT=function(e,t){return ce(e,t)||(e=Ye(e),(t=W(t=t===void 0?1:t))instanceof Error||typeof e!="string"?a:e.substring(0,t))},m.LEN=function(e){return arguments.length===0?j:e instanceof Error?e:Array.isArray(e)?a:Ye(e).length},m.LINEST=et,m.LN=function(e){return(e=W(e))instanceof Error?e:e===0?c:Math.log(e)},m.LOG=function(e,t){return ce(e=W(e),t=W(t))||(e===0||t===0?c:Math.log(e)/Math.log(t))},m.LOG10=function(e){return(e=W(e))instanceof Error?e:e===0?c:Math.log(e)/Math.log(10)},m.LOGEST=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t)))||e.length!==t.length)return a;for(let b=0;b<e.length;b++)e[b]=Math.log(e[b]);const u=et(e,t);return u[0]=Math.round(1e6*Math.exp(u[0]))/1e6,u[1]=Math.round(1e6*Math.exp(u[1]))/1e6,u},m.LOGINV=Xn,m.LOGNORM=te,m.LOGNORMDIST=Gn,m.LOGNORMINV=Kn,m.LOOKUP=function(e,t,u){t=V(t),u=u?V(u):t;const b=typeof e=="number";let B=v;for(let P=0;P<t.length;P++){if(t[P]===e)return u[P];if(b&&t[P]<=e||typeof t[P]=="string"&&t[P].localeCompare(e)<0)B=u[P];else if(b&&t[P]>e)return B}return B},m.LOWER=function(e){return arguments.length!==1?a:oe(e=Ye(e))?e:e.toLowerCase()},m.MATCH=function(e,t,u){if(!e||!t||(arguments.length===2&&(u=1),!((t=V(t))instanceof Array))||u!==-1&&u!==0&&u!==1)return v;let b,B;for(let P=0;P<t.length;P++)if(u===1){if(t[P]===e)return P+1;t[P]<e&&(B?t[P]>B&&(b=P+1,B=t[P]):(b=P+1,B=t[P]))}else if(u===0){if(typeof e=="string"&&typeof t[P]=="string"){const K=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+K+"$").test(t[P].toLowerCase()))return P+1}else if(t[P]===e)return P+1}else if(u===-1){if(t[P]===e)return P+1;t[P]>e&&(B?t[P]<B&&(b=P+1,B=t[P]):(b=P+1,B=t[P]))}return b||v},m.MAX=be,m.MAXA=function(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;let u=O(e);return u=u.map(b=>b??0),u.length===0?0:Math.max.apply(Math,u)},m.MDURATION=function(){throw new Error("MDURATION is not implemented")},m.MEDIAN=Te,m.MID=function(e,t,u){if(t==null)return a;if(oe(t=W(t),u=W(u))||typeof e!="string")return u;const b=t-1,B=b+u;return e.substring(b,B)},m.MIN=z,m.MINA=function(){const e=V(arguments),t=ce.apply(void 0,e);if(t)return t;let u=O(e);return u=u.map(b=>b??0),u.length===0?0:Math.min.apply(Math,u)},m.MINUTE=function(e){return(e=Be(e))instanceof Error?e:e.getMinutes()},m.MIRR=function(e,t,u){if(oe(e=Le(V(e)),t=W(t),u=W(u)))return a;const b=e.length,B=[],P=[];for(let me=0;me<b;me++)e[me]<0?B.push(e[me]):P.push(e[me]);const K=-en(u,P)*Math.pow(1+u,b-1),le=en(t,B)*(1+t);return Math.pow(K/le,1/(b-1))-1},m.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(u=>!u.length)||t.some(u=>!u.length)||ue(e).some(u=>typeof u!="number")||ue(t).some(u=>typeof u!="number")||e[0].length!==t.length?a:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((u,b)=>u.map((B,P)=>e[b].reduce((K,le,me)=>K+le*t[me][P],0)))},m.MOD=function(e,t){const u=ce(e=W(e),t=W(t));if(u)return u;if(t===0)return l;let b=Math.abs(e%t);return b=e<0?t-b:b,t>0?b:-b},m.MODE=ee,m.MODEMULT=$n,m.MODESNGL=Zn,m.MONTH=function(e){return(e=Be(e))instanceof Error?e:e.getMonth()+1},m.MROUND=function(e,t){return ce(e=W(e),t=W(t))||(e*t==0?0:e*t<0?c:Math.round(e/t)*t)},m.MULTINOMIAL=function(){const e=Le(V(arguments));if(e instanceof Error)return e;let t=0,u=1;for(let b=0;b<e.length;b++)t+=e[b],u*=nt(e[b]);return nt(t)/u},m.MUNIT=function(e){return arguments.length>1?v:!(e=parseInt(e))||e<=0?a:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,u)=>(t[u]=1,t))},m.N=function(e){return Nt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:It(e)?e:0},m.NA=function(){return v},m.NEGBINOM=C,m.NEGBINOMDIST=Jn,m.NETWORKDAYS=Rt,m.NETWORKDAYSINTL=Qn,m.NOMINAL=function(e,t){return oe(e=W(e),t=W(t))?a:e<=0||t<1?c:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},m.NORM=F,m.NORMDIST=er,m.NORMINV=tr,m.NORMSDIST=nr,m.NORMSINV=rr,m.NOT=function(e){return typeof e=="string"?a:e instanceof Error?e:!e},m.NOW=function(){return new Date},m.NPER=function(e,t,u,b,B){if(B=B===void 0?0:B,b=b===void 0?0:b,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B)))return a;if(e===0)return-(u+b)/t;{const P=t*(1+e*B)-b*e,K=u*e+t*(1+e*B);return Math.log(P/K)/Math.log(1+e)}},m.NPV=en,m.NUMBERVALUE=function(e,t,u){return typeof(e=Ne(e)?e:"")=="number"?e:typeof e!="string"?v:(t=t===void 0?".":t,u=u===void 0?",":u,Number(e.replace(t,".").replace(u,"")))},m.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return c;const u=!(e.length!==10||e.substring(0,1)!=="7"),b=u?parseInt(e,8)-1073741824:parseInt(e,8);if(b<-512||b>511)return c;if(u)return"1"+wt("0",9-(512+b).toString(2).length)+(512+b).toString(2);const B=b.toString(2);return t===void 0?B:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=B.length?wt("0",t-B.length)+B:c},m.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return c;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},m.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return c;const u=parseInt(e,8);if(u>=536870912)return"ff"+(u+3221225472).toString(16);const b=u.toString(16);return t===void 0?b:isNaN(t)?a:t<0?c:(t=Math.floor(t))>=b.length?wt("0",t-b.length)+b:c},m.ODD=function(e){if((e=W(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},m.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},m.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},m.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},m.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},m.OR=function(){const e=V(arguments);let t=a;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===a&&(t=!1),e[u]&&(t=!0))}return t},m.PDURATION=function(e,t,u){return oe(e=W(e),t=W(t),u=W(u))?a:e<=0?c:(Math.log(u)-Math.log(t))/Math.log(1+e)},m.PEARSON=J,m.PERCENTILE=de,m.PERCENTILEEXC=or,m.PERCENTILEINC=sr,m.PERCENTRANK=Q,m.PERCENTRANKEXC=ir,m.PERCENTRANKINC=ar,m.PERMUT=function(e,t){return oe(e=W(e),t=W(t))?a:nt(e)/nt(e-t)},m.PERMUTATIONA=function(e,t){return oe(e=W(e),t=W(t))?a:Math.pow(e,t)},m.PHI=function(e){return(e=W(e))instanceof Error?a:Math.exp(-.5*e*e)/2.5066282746310002},m.PI=function(){return Math.PI},m.PMT=Bt,m.POISSON=pe,m.POISSONDIST=lr,m.POWER=tn,m.PPMT=function(e,t,u,b,B,P){return B=B||0,P=P||0,oe(e=W(e),u=W(u),b=W(b),B=W(B),P=W(P))?a:Bt(e,u,b,B,P)-dn(e,t,u,b,B,P)},m.PRICE=function(){throw new Error("PRICE is not implemented")},m.PRICEDISC=function(e,t,u,b,B){if(oe(e=Be(e),t=Be(t),u=W(u),b=W(b),B=(B=W(B))||0))return a;if(u<=0||b<=0)return c;if(e>=t)return a;let P,K;switch(B){case 0:P=360,K=Et(e,t,!1);break;case 1:case 3:P=365,K=_t(e,t,"D");break;case 2:P=360,K=_t(e,t,"D");break;case 4:P=360,K=Et(e,t,!0);break;default:return c}return b-u*b*K/P},m.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},m.PROB=function(e,t,u,b){if(u===void 0)return 0;if(b=b===void 0?u:b,oe(e=Le(V(e)),t=Le(V(t)),u=W(u),b=W(b)))return a;if(u===b)return e.indexOf(u)>=0?t[e.indexOf(u)]:0;const B=e.sort((le,me)=>le-me),P=B.length;let K=0;for(let le=0;le<P;le++)B[le]>=u&&B[le]<=b&&(K+=t[e.indexOf(B[le])]);return K},m.PRODUCT=Ut,m.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},m.PROPER=function(e){return oe(e)?e:isNaN(e)&&typeof e=="number"?a:(e=Ye(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},m.PV=function(e,t,u,b,B){return b=b||0,B=B||0,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B))?a:e===0?-u*t-b:((1-Math.pow(1+e,t))/e*u*(1+e*B)-b)/Math.pow(1+e,t)},m.QUARTILE=xe,m.QUARTILEEXC=ur,m.QUARTILEINC=cr,m.QUOTIENT=function(e,t){return ce(e=W(e),t=W(t))||parseInt(e/t,10)},m.RADIANS=function(e){return(e=W(e))instanceof Error?e:e*Math.PI/180},m.RAND=function(){return Math.random()},m.RANDBETWEEN=function(e,t){return ce(e=W(e),t=W(t))||e+Math.ceil((t-e+1)*Math.random())-1},m.RANK=_e,m.RANKAVG=dr,m.RANKEQ=fr,m.RATE=function(e,t,u,b,B,P){if(P=P===void 0?.01:P,b=b===void 0?0:b,B=B===void 0?0:B,oe(e=W(e),t=W(t),u=W(u),b=W(b),B=W(B),P=W(P)))return a;const K=1e-10;let le=P;B=B?1:0;for(let me=0;me<20;me++){if(le<=-1)return c;let De,Re,ze;if(Math.abs(le)<K?De=u*(1+e*le)+t*(1+le*B)*e+b:(Re=Math.pow(1+le,e),De=u*Re+t*(1/le+B)*(Re-1)+b),Math.abs(De)<K)return le;if(Math.abs(le)<K)ze=u*e+t*B*e;else{Re=Math.pow(1+le,e);const Ue=e*Math.pow(1+le,e-1);ze=u*Ue+t*(1/le+B)*Ue+t*(-1/(le*le))*(Re-1)}le-=De/ze}return le},m.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},m.REPLACE=function(e,t,u,b){return oe(t=W(t),u=W(u))||typeof e!="string"||typeof b!="string"?a:e.substr(0,t-1)+b+e.substr(t-1+u)},m.REPT=wt,m.RIGHT=function(e,t){return ce(e,t)||(e=Ye(e),(t=W(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},m.ROMAN=function(e){if((e=W(e))instanceof Error)return e;const t=String(e).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let b="",B=3;for(;B--;)b=(u[+t.pop()+10*B]||"")+b;return new Array(+t.join("")+1).join("M")+b},m.ROUND=xt,m.ROUNDDOWN=function(e,t){return ce(e=W(e),t=W(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROUNDUP=function(e,t){return ce(e=W(e),t=W(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROW=function(e,t){return arguments.length!==2?v:t<0?c:e instanceof Array&&typeof t=="number"?e.length!==0?w.row(e,t):void 0:a},m.ROWS=function(e){return arguments.length!==1?v:e instanceof Array?e.length===0?0:w.rows(e):a},m.RRI=function(e,t,u){return oe(e=W(e),t=W(t),u=W(u))?a:e===0||t===0?c:Math.pow(u/t,1/e)-1},m.RSQ=function(e,t){return oe(e=Le(V(e)),t=Le(V(t)))?a:Math.pow(J(e,t),2)},m.SEARCH=function(e,t,u){let b;return typeof e!="string"||typeof t!="string"?a:(u=u===void 0?0:u,b=t.toLowerCase().indexOf(e.toLowerCase(),u-1)+1,b===0?a:b)},m.SEC=function(e){return(e=W(e))instanceof Error?e:1/Math.cos(e)},m.SECH=function(e){return(e=W(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},m.SECOND=function(e){return(e=Be(e))instanceof Error?e:e.getSeconds()},m.SERIESSUM=function(e,t,u,b){if(oe(e=W(e),t=W(t),u=W(u),b=Le(b)))return a;let B=b[0]*Math.pow(e,t);for(let P=1;P<b.length;P++)B+=b[P]*Math.pow(e,t+P*u);return B},m.SHEET=function(){throw new Error("SHEET is not implemented")},m.SHEETS=function(){throw new Error("SHEETS is not implemented")},m.SIGN=function(e){return(e=W(e))instanceof Error?e:e<0?-1:e===0?0:1},m.SIN=function(e){return(e=W(e))instanceof Error?e:Math.sin(e)},m.SINH=function(e){return(e=W(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},m.SKEW=je,m.SKEWP=pr,m.SLN=function(e,t,u){return oe(e=W(e),t=W(t),u=W(u))?a:u===0?c:(e-t)/u},m.SLOPE=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=w.mean(t),b=w.mean(e),B=t.length;let P=0,K=0;for(let le=0;le<B;le++)P+=(t[le]-u)*(e[le]-b),K+=Math.pow(t[le]-u,2);return P/K},m.SMALL=Fe,m.SORT=function(e,t=1,u=1,b=!1){if(!e||!Array.isArray(e))return v;if(e.length===0)return 0;if(!(t=W(t))||t<1||(u=W(u))!==1&&u!==-1)return a;if(typeof(b=Pe(b))!="boolean")return f;const B=le=>le.sort((me,De)=>(me=Ye(me[t-1]),De=Ye(De[t-1]),u===1?me<De?-1*u:u:me>De?u:-1*u)),P=Y(e),K=b?ae(P):P;return t>=1&&t<=K[0].length?b?ae(B(K)):B(K):a},m.SQRT=function(e){return(e=W(e))instanceof Error?e:e<0?c:Math.sqrt(e)},m.SQRTPI=function(e){return(e=W(e))instanceof Error?e:Math.sqrt(e*Math.PI)},m.STANDARDIZE=function(e,t,u){return oe(e=W(e),t=W(t),u=W(u))?a:(e-t)/u},m.STDEV=He,m.STDEVA=function(){const e=Ee.apply(this,arguments);return Math.sqrt(e)},m.STDEVP=hr,m.STDEVPA=function(){const e=Ae.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=c),t},m.STDEVS=gr,m.STEYX=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;const u=w.mean(t),b=w.mean(e),B=t.length;let P=0,K=0,le=0;for(let me=0;me<B;me++)P+=Math.pow(e[me]-b,2),K+=(t[me]-u)*(e[me]-b),le+=Math.pow(t[me]-u,2);return Math.sqrt((P-K*K/le)/(B-2))},m.SUBSTITUTE=function(e,t,u,b){if(arguments.length<3)return v;if(e&&t){if(b===void 0)return e.split(t).join(u);{if(b=Math.floor(Number(b)),Number.isNaN(b)||b<=0)return a;let B=0,P=0;for(;B>-1&&e.indexOf(t,B)>-1;)if(B=e.indexOf(t,B+1),P++,B>-1&&P===b)return e.substring(0,B)+u+e.substring(B+t.length);return e}}return e},m.SUBTOTAL=function(e,t){if((e=W(e))instanceof Error)return e;switch(e){case 1:case 101:return d(t);case 2:case 102:return _(t);case 3:case 103:return q(t);case 4:case 104:return be(t);case 5:case 105:return z(t);case 6:case 106:return Ut(t);case 7:case 107:return He.S(t);case 8:case 108:return He.P(t);case 9:case 109:return jt(t);case 10:case 110:return se.S(t);case 11:case 111:return se.P(t)}},m.SUM=jt,m.SUMIF=function(e,t,u){if(e=V(e),u=u?V(u):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let b=0;const B=t==="*",P=B?null:vt(t+"");for(let K=0;K<e.length;K++){const le=e[K],me=u[K];if(B)b+=le;else{const De=[ft(le,st)].concat(P);b+=yt(De)?me:0}}return b},m.SUMIFS=function(){const e=N(arguments),t=Le(V(e.shift()));if(t instanceof Error)return t;const u=e,b=u.length/2;for(let P=0;P<b;P++)u[2*P]=V(u[2*P]);let B=0;for(let P=0;P<t.length;P++){let K=!1;for(let le=0;le<b;le++){const me=u[2*le][P],De=u[2*le+1];let Re=!1;if(De===void 0||De==="*")Re=!0;else{const ze=vt(De+""),Ue=[ft(me,st)].concat(ze);Re=yt(Ue)}if(!Re){K=!1;break}K=!0}K&&(B+=t[P])}return B},m.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return a;const e=arguments.length+1;let t,u,b,B,P=0;for(let K=0;K<arguments[0].length;K++)if(arguments[0][K]instanceof Array)for(let le=0;le<arguments[0][K].length;le++){for(t=1,u=1;u<e;u++){const me=arguments[u-1][K][le];if(me instanceof Error)return me;if(B=W(me),B instanceof Error)return B;t*=B}P+=t}else{for(t=1,u=1;u<e;u++){const le=arguments[u-1][K];if(le instanceof Error)return le;if(b=W(le),b instanceof Error)return b;t*=b}P+=t}return P},m.SUMSQ=function(){const e=Le(V(arguments));if(e instanceof Error)return e;let t=0;const u=e.length;for(let b=0;b<u;b++)t+=Nt(e[b])?e[b]*e[b]:0;return t},m.SUMX2MY2=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;let u=0;for(let b=0;b<e.length;b++)u+=e[b]*e[b]-t[b]*t[b];return u},m.SUMX2PY2=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;let u=0;e=Le(V(e)),t=Le(V(t));for(let b=0;b<e.length;b++)u+=e[b]*e[b]+t[b]*t[b];return u},m.SUMXMY2=function(e,t){if(oe(e=Le(V(e)),t=Le(V(t))))return a;let u=0;e=V(e),t=V(t);for(let b=0;b<e.length;b++)u+=Math.pow(e[b]-t[b],2);return u},m.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],u=arguments.length-1,b=Math.floor(u/2);let B=!1;const P=u%2!=0,K=u%2==0?null:arguments[arguments.length-1];if(b){for(let le=0;le<b;le++)if(t===arguments[2*le+1]){e=arguments[2*le+2],B=!0;break}}B||(e=P?K:v)}else e=a;return e},m.SYD=function(e,t,u,b){return oe(e=W(e),t=W(t),u=W(u),b=W(b))?a:u===0||b<1||b>u?c:(e-t)*(u-(b=parseInt(b,10))+1)*2/(u*(u+1))},m.T=function(e){return e instanceof Error||typeof e=="string"?e:""},m.TAN=function(e){return(e=W(e))instanceof Error?e:Math.tan(e)},m.TANH=function(e){if((e=W(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.TBILLEQ=function(e,t,u){return oe(e=Be(e),t=Be(t),u=W(u))?a:u<=0||e>t||t-e>31536e6?c:365*u/(360-u*Et(e,t,!1))},m.TBILLPRICE=function(e,t,u){return oe(e=Be(e),t=Be(t),u=W(u))?a:u<=0||e>t||t-e>31536e6?c:100*(1-u*Et(e,t,!1)/360)},m.TBILLYIELD=function(e,t,u){return oe(e=Be(e),t=Be(t),u=W(u))?a:u<=0||e>t||t-e>31536e6?c:360*(100-u)/(u*Et(e,t,!1))},m.TDIST=mr,m.TDISTRT=vr,m.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return v;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return a;const u=t.startsWith("$")?"$":"",b=t.endsWith("%");return b&&(e*=100),e=(e=ln(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+u+(e=e.replace("-","")):u+e,b&&(e+="%"),e},m.TEXTJOIN=function(e,t,...u){if(typeof t!="boolean"&&(t=Pe(t)),arguments.length<3)return v;e=e??"";let b=V(u),B=t?b.filter(P=>P):b;if(Array.isArray(e)){e=V(e);let P=B.map(le=>[le]),K=0;for(let le=0;le<P.length-1;le++)P[le].push(e[K]),K++,K===e.length&&(K=0);return B=V(P),B.join("")}return B.join(e)},m.TIME=function(e,t,u){return oe(e=W(e),t=W(t),u=W(u))?a:e<0||t<0||u<0?c:(3600*e+60*t+u)/86400},m.TIMEVALUE=function(e){return(e=Be(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},m.TINV=yr,m.TODAY=function(){return Ft(new Date)},m.TRANSPOSE=function(e){return e?ae(Y(e)):v},m.TREND=function(e,t,u){if(oe(e=Le(V(e)),t=Le(V(t)),u=Le(V(u))))return a;const b=et(e,t),B=b[0],P=b[1],K=[];return u.forEach(le=>{K.push(B*le+P)}),K},m.TRIM=function(e){return(e=Ye(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},m.TRIMMEAN=function(e,t){if(oe(e=Le(V(e)),t=W(t)))return a;const u=it(e.length*t,2)/2;return w.mean((B=(B=u)||1,(b=G(e.sort((P,K)=>P-K),u))&&typeof b.slice=="function"?b.slice(0,b.length-B):b));var b,B},m.TRUE=function(){return!0},m.TRUNC=function(e,t){return ce(e=W(e),t=W(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.TTEST=br,m.TYPE=function(e){return Nt(e)?1:Ot(e)?2:gt(e)?4:It(e)?16:Array.isArray(e)?64:void 0},m.UNICHAR=vn,m.UNICODE=yn,m.UNIQUE=A,m.UPPER=function(e){return(e=Ye(e))instanceof Error?e:e.toUpperCase()},m.VALUE=function(e){const t=ce(e);if(t)return t;if(typeof e=="number")return e;if(Ne(e)||(e=""),typeof e!="string")return a;const u=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let b=Number(e);return isNaN(b)?a:(b=b||0,u&&(b*=.01),b)},m.VAR=se,m.VARA=Ee,m.VARP=wr,m.VARPA=Ae,m.VARS=Cr,m.VDB=function(){throw new Error("VDB is not implemented")},m.VLOOKUP=I,m.WEEKDAY=function(e,t){if((e=Be(e))instanceof Error)return e;t===void 0&&(t=1);const u=e.getDay();return gn[t][u]},m.WEEKNUM=function(e,t){if((e=Be(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return nn(e);const u=hn[t];let b=new Date(e.getFullYear(),0,1);const B=b.getDay()<u?1:0;return b-=24*Math.abs(b.getDay()-u)*60*60*1e3,Math.floor((e-b)/864e5/7+1)+B},m.WEIBULL=qe,m.WEIBULLDIST=xr,m.WORKDAY=Ht,m.WORKDAYINTL=Er,m.XIRR=function(e,t,u){if(oe(e=Le(V(e)),t=Ze(V(t)),u=W(u)))return a;const b=(Ue,$e,rt)=>{const at=rt+1;let bt=Ue[0];for(let pt=1;pt<Ue.length;pt++)bt+=Ue[pt]/Math.pow(at,Lt($e[pt],$e[0])/365);return bt},B=(Ue,$e,rt)=>{const at=rt+1;let bt=0;for(let pt=1;pt<Ue.length;pt++){const At=Lt($e[pt],$e[0])/365;bt-=At*Ue[pt]/Math.pow(at,At+1)}return bt};let P=!1,K=!1;for(let Ue=0;Ue<e.length;Ue++)e[Ue]>0&&(P=!0),e[Ue]<0&&(K=!0);if(!P||!K)return c;let le,me,De,Re=u=u||.1,ze=!0;do De=b(e,t,Re),le=Re-De/B(e,t,Re),me=Math.abs(le-Re),Re=le,ze=me>1e-10&&Math.abs(De)>1e-10;while(ze);return Re},m.XNPV=function(e,t,u){if(oe(e=W(e),t=Le(V(t)),u=Ze(V(u))))return a;let b=0;for(let B=0;B<t.length;B++)b+=t[B]/Math.pow(1+e,Lt(u[B],u[0])/365);return b},m.XOR=function(){const e=V(arguments);let t=a;for(let u=0;u<e.length;u++){if(e[u]instanceof Error)return e[u];e[u]!==void 0&&e[u]!==null&&typeof e[u]!="string"&&(t===a&&(t=0),e[u]&&t++)}return t===a?t:!!(1&Math.floor(Math.abs(t)))},m.YEAR=function(e){return(e=Be(e))instanceof Error?e:e.getFullYear()},m.YEARFRAC=Yt,m.YIELD=function(){throw new Error("YIELD is not implemented")},m.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},m.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},m.Z=tt,m.ZTEST=Ar,m.utils=jr}},E={};function T(H){var m=E[H];if(m!==void 0)return m.exports;var s=E[H]={exports:{}};return p[H].call(s.exports,s,s.exports,T),s.exports}T.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var X=T(960);o=X}(),o})}(dist$2)),dist$2.exports}var dist=dist$3.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire=="function")var formula=requireDist$1();(function(n,g){module.exports=g()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={805:function(n,g){const o=function(T){const X=this,H=[];for(let m=0;m<T.length;m++){const s=T[m].x,w=T[m].y,S=X.options.columns[s].name?X.options.columns[s].name:s;H[w]||(H[w]={row:w,data:{}}),H[w].data[S]=T[m].value}return H.filter(function(m){return m!=null})},p=function(T,X){const H=this,m=E.call(H.parent,"onbeforesave",H.parent,H,X);if(m)X=m;else if(m===!1)return!1;jSuites.ajax({url:T,method:"POST",dataType:"json",data:{data:JSON.stringify(X)},success:function(s){E.call(H,"onsave",H.parent,H,X)}})},E=function(T){const X=this;let H=null,m=X.parent?X.parent:X;if(!m.ignoreEvents&&(typeof m.config.onevent=="function"&&(H=m.config.onevent.apply(this,arguments)),typeof m.config[T]=="function"&&(H=m.config[T].apply(this,Array.prototype.slice.call(arguments,1))),typeof m.plugins=="object")){const s=Object.keys(m.plugins);for(let w=0;w<s.length;w++){const S=s[w],M=m.plugins[S];typeof M.onevent=="function"&&(H=M.onevent.apply(this,arguments))}}if(T=="onafterchanges"){const s=arguments;if(typeof m.plugins=="object"&&Object.entries(m.plugins).forEach(function([,w]){typeof w.persistence=="function"&&w.persistence(X,"setValue",{data:s[2]})}),X.options.persistence){const w=X.options.persistence==1?X.options.url:X.options.persistence,S=o.call(X,arguments[2]);p.call(X,w,S)}}return H};g.A=E},829:function(n,g,o){o.d(g,{F8:function(){return X},N$:function(){return T},dr:function(){return H}});var p=o(530),E=o(657);const T=function(m){const s=this;if(s.options.filters){m=parseInt(m),s.resetSelection();let w=[];if(s.options.columns[m].type=="checkbox")w.push({id:"true",name:"True"}),w.push({id:"false",name:"False"});else{const l=[];let a=!1;for(let f=0;f<s.options.data.length;f++){const c=s.options.data[f][m],v=s.records[f][m].element.innerHTML;c&&v?l[c]=v:a=!0}const h=Object.keys(l);w=[];for(let f=0;f<h.length;f++)w.push({id:h[f],name:l[h[f]]});a&&w.push({value:"",id:"",name:"(Blanks)"})}const S=document.createElement("div");s.filter.children[m+1].innerHTML="",s.filter.children[m+1].appendChild(S),s.filter.children[m+1].style.paddingLeft="0px",s.filter.children[m+1].style.paddingRight="0px",s.filter.children[m+1].style.overflow="initial";const M={data:w,multiple:!0,autocomplete:!0,opened:!0,value:s.filters[m]!==void 0?s.filters[m]:null,width:"100%",position:s.options.tableOverflow==1||s.parent.config.fullscreen==1,onclose:function(l){H.call(s),s.filters[m]=l.dropdown.getValue(!0),s.filter.children[m+1].innerHTML=l.dropdown.getText(),s.filter.children[m+1].style.paddingLeft="",s.filter.children[m+1].style.paddingRight="",s.filter.children[m+1].style.overflow="",X.call(s,m),E.G9.call(s)}};jSuites.dropdown(S,M)}else console.log("Jspreadsheet: filters not enabled.")},X=function(m){const s=this;if(!m)for(let M=0;M<s.filter.children.length;M++)s.filters[M]&&(m=M);const w=function(M,l,a){for(let h=0;h<M.length;h++){const f=""+s.options.data[a][l],c=""+s.records[a][l].element.innerHTML;if(M[h]==f||M[h]==c)return!0}return!1},S=s.filters[m];s.results=[];for(let M=0;M<s.options.data.length;M++)w(S,m,M)&&s.results.push(M);s.results.length||(s.results=null),p.hG.call(s)},H=function(){const m=this;if(m.options.filters)for(let s=0;s<m.filter.children.length;s++)m.filter.children[s].innerHTML="&nbsp;",m.filters[s]=null;m.results=null,p.hG.call(m)}},160:function(n,g,o){o.d(g,{e:function(){return E}});var p=o(530);const E=function(T){const X=this;if(T&&(X.options.footers=T),X.options.footers){X.tfoot||(X.tfoot=document.createElement("tfoot"),X.table.appendChild(X.tfoot));for(let H=0;H<X.options.footers.length;H++){let m;if(X.tfoot.children[H])m=X.tfoot.children[H];else{m=document.createElement("tr");const s=document.createElement("td");m.appendChild(s),X.tfoot.appendChild(m)}for(let s=0;s<X.headers.length;s++){let w;if(X.options.footers[H][s]||(X.options.footers[H][s]=""),X.tfoot.children[H].children[s+1])w=X.tfoot.children[H].children[s+1];else{w=document.createElement("td"),m.appendChild(w);const S=X.options.columns[s].align||X.options.defaultColAlign||"center";w.style.textAlign=S}w.textContent=p.$x.call(X,+X.records.length+s,H,X.options.footers[H][s]),w.style.display=X.cols[s].colElement.style.display}}}}},296:function(n,g,o){o.d(g,{w:function(){return p}});const p=function(){const E=this;let T=0;if(E.options.freezeColumns>0)for(let X=0;X<E.options.freezeColumns;X++){let H;H=E.options.columns&&E.options.columns[X]&&E.options.columns[X].width!==void 0?parseInt(E.options.columns[X].width):E.options.defaultColWidth!==void 0?parseInt(E.options.defaultColWidth):100,T+=H}return T}},978:function(n,g,o){o.r(g),o.d(g,{createFromTable:function(){return S},getCaretIndex:function(){return E},getCellNameFromCoords:function(){return H},getColumnName:function(){return X},getCoordsFromCellName:function(){return m},getCoordsFromRange:function(){return s},invert:function(){return T},parseCSV:function(){return w}});var p=o(689);const E=function(M){let l;l=this.config.root?this.config.root:window;let a=0;const h=l.getSelection();if(h&&h.rangeCount!==0){const f=h.getRangeAt(0),c=f.cloneRange();c.selectNodeContents(M),c.setEnd(f.endContainer,f.endOffset),a=c.toString().length}return a},T=function(M){const l=[],a=Object.keys(M);for(let h=0;h<a.length;h++)l[M[a[h]]]=a[h];return l},X=function(M){let l,a=M+1,h="";for(;a>0;)l=(a-1)%26,h=String.fromCharCode(65+l).toString()+h,a=parseInt((a-l)/26);return h},H=function(M,l){return X(parseInt(M))+(parseInt(l)+1)},m=function(M){const l=/^[a-zA-Z]+/.exec(M);if(l){let a=0;for(let f=0;f<l[0].length;f++)a+=parseInt(l[0].charCodeAt(f)-64)*Math.pow(26,l[0].length-1-f);a--,a<0&&(a=0);let h=parseInt(/[0-9]+$/.exec(M))||null;return h>0&&h--,[a,h]}},s=function(M){const[l,a]=M.split(":");return[...m(l),...m(a)]},w=function(M,l){l=l||",",M=M.replace(/\r?\n$|\r$|\n$/g,"");const a=[];let h=!1,f=0,c=0,v=0;for(let j=0;j<M.length;j++){const L=M[j],k=M[j+1];a[c]=a[c]||[],a[c][v]=a[c][v]||"",L=='"'&&h&&k=='"'?(a[c][v]+=L,++j):L!='"'?L!=l||h?L!="\r"||k!=`
`||h?L==`
`&&!h||L=="\r"&&!h?(++c,f=Math.max(f,v),v=0):a[c][v]+=L:(++c,f=Math.max(f,v),v=0,++j):++v:h=!h}return a.forEach((j,L)=>{for(let k=j.length;k<=f;k++)j.push("")}),a},S=function(M,l){if(M.tagName=="TABLE"){l||(l={}),l.columns=[],l.data=[];const a=M.querySelectorAll("colgroup > col");if(a.length)for(let O=0;O<a.length;O++){let Y=a[O].style.width;Y||(Y=a[O].getAttribute("width")),Y&&(l.columns[O]||(l.columns[O]={}),l.columns[O].width=Y)}const h=function(O,Y){let V=O.getBoundingClientRect();const ue=V.width>50?V.width:50;l.columns[Y]||(l.columns[Y]={}),O.getAttribute("data-celltype")?l.columns[Y].type=O.getAttribute("data-celltype"):l.columns[Y].type="text",l.columns[Y].width=ue+"px",l.columns[Y].title=O.innerHTML,O.style.textAlign&&(l.columns[Y].align=O.style.textAlign),(V=O.getAttribute("name"))&&(l.columns[Y].name=V),(V=O.getAttribute("id"))&&(l.columns[Y].id=V),(V=O.getAttribute("data-mask"))&&(l.columns[Y].mask=V)},f=[];let c=M.querySelectorAll(":scope > thead > tr");if(c.length){for(let O=0;O<c.length-1;O++){const Y=[];for(let V=0;V<c[O].children.length;V++){const ue={title:c[O].children[V].textContent,colspan:c[O].children[V].getAttribute("colspan")||1};Y.push(ue)}f.push(Y)}c=c[c.length-1].children;for(let O=0;O<c.length;O++)h(c[O],O)}let v=0;const j={},L={},k={},N={};let D=M.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let O=0;O<D.length;O++)if(l.data[v]=[],l.parseTableFirstRowAsHeader!=1||c.length||O!=0){for(let Y=0;Y<D[O].children.length;Y++){let V=D[O].children[Y].getAttribute("data-formula");V?V.substr(0,1)!="="&&(V="="+V):V=D[O].children[Y].innerHTML,l.data[v].push(V);const ue=(0,p.t3)([Y,O]),ge=D[O].children[Y].getAttribute("class");ge&&(N[ue]=ge);const G=parseInt(D[O].children[Y].getAttribute("colspan"))||0,ae=parseInt(D[O].children[Y].getAttribute("rowspan"))||0;(G||ae)&&(j[ue]=[G||1,ae||1]),D[O].children[Y].style&&D[O].children[Y].style.display=="none"&&(D[O].children[Y].style.display="");const he=D[O].children[Y].getAttribute("style");he&&(k[ue]=he),D[O].children[Y].classList.contains("styleBold")&&(k[ue]?k[ue]+="; font-weight:bold;":k[ue]="font-weight:bold;")}D[O].style&&D[O].style.height&&(L[O]={height:D[O].style.height}),v++}else for(let Y=0;Y<D[O].children.length;Y++)h(D[O].children[Y],Y);if(Object.keys(f).length>0&&(l.nestedHeaders=f),Object.keys(k).length>0&&(l.style=k),Object.keys(j).length>0&&(l.mergeCells=j),Object.keys(L).length>0&&(l.rows=L),Object.keys(N).length>0&&(l.classes=N),D=M.querySelectorAll("tfoot tr"),D.length){const O=[];for(let Y=0;Y<D.length;Y++){let V=[];for(let ue=0;ue<D[Y].children.length;ue++)V.push(D[Y].children[ue].textContent);O.push(V)}Object.keys(O).length>0&&(l.footers=O)}if(l.parseTableAutoCellType==1){const O=[];for(let Y=0;Y<l.columns.length;Y++){let V=!0,ue=!0;O[Y]=[];for(let G=0;G<l.data.length;G++){const ae=l.data[G][Y];O[Y][ae]||(O[Y][ae]=0),O[Y][ae]++,ae.length>25&&(V=!1),ae.length==10&&ae.substr(4,1)=="-"&&ae.substr(7,1)=="-"||(ue=!1)}const ge=Object.keys(O[Y]).length;ue?l.columns[Y].type="calendar":V==1&&ge>1&&ge<=parseInt(.1*l.data.length)&&(l.columns[Y].type="dropdown",l.columns[Y].source=Object.keys(O[Y]))}}return l}console.log("Element is not a table")}},911:function(n,g,o){o.d(g,{Dh:function(){return s},ZS:function(){return l},tN:function(){return M}});var p=o(805),E=o(689),T=o(530),X=o(910),H=o(94),m=o(657);const s=function(a){const h=this;if(h.ignoreHistory!=1){const f=++h.historyIndex;h.history=h.history=h.history.slice(0,f+1),h.history[f]=a}},w=function(a,h){const f=this,c=h.insertBefore?+h.rowNumber:h.rowNumber+1;if(f.options.search==1&&f.results&&f.results.length!=f.rows.length&&f.resetSearch(),a==1){const v=h.numOfRows;for(let j=c;j<v+c;j++)f.rows[j].element.parentNode.removeChild(f.rows[j].element);f.records.splice(c,v),f.options.data.splice(c,v),f.rows.splice(c,v),m.at.call(f,1,c,v+c-1)}else{f.records=(0,E.Hh)(f.records,c,h.rowRecords),f.options.data=(0,E.Hh)(f.options.data,c,h.rowData),f.rows=(0,E.Hh)(f.rows,c,h.rowNode);let v=0;for(let j=c;j<h.numOfRows+c;j++)f.tbody.insertBefore(h.rowNode[v].element,f.tbody.children[j]),v++}for(let v=c;v<f.rows.length;v++)f.rows[v].y=v;for(let v=c;v<f.records.length;v++)for(let j=0;j<f.records[v].length;j++)f.records[v][j].y=v;f.options.pagination>0&&f.page(f.pageNumber),T.o8.call(f)},S=function(a,h){const f=this,c=h.insertBefore?h.columnNumber:h.columnNumber+1;if(a==1){const v=h.numOfColumns;f.options.columns.splice(c,v);for(let j=c;j<v+c;j++)f.headers[j].parentNode.removeChild(f.headers[j]),f.cols[j].colElement.parentNode.removeChild(f.cols[j].colElement);f.headers.splice(c,v),f.cols.splice(c,v);for(let j=0;j<h.data.length;j++){for(let L=c;L<v+c;L++)f.records[j][L].element.parentNode.removeChild(f.records[j][L].element);f.records[j].splice(c,v),f.options.data[j].splice(c,v)}if(f.options.footers)for(let j=0;j<f.options.footers.length;j++)f.options.footers[j].splice(c,v)}else{f.options.columns=(0,E.Hh)(f.options.columns,c,h.columns),f.headers=(0,E.Hh)(f.headers,c,h.headers),f.cols=(0,E.Hh)(f.cols,c,h.cols);let v=0;for(let j=c;j<h.numOfColumns+c;j++)f.headerContainer.insertBefore(h.headers[v],f.headerContainer.children[j+1]),f.colgroupContainer.insertBefore(h.cols[v].colElement,f.colgroupContainer.children[j+1]),v++;for(let j=0;j<h.data.length;j++){f.options.data[j]=(0,E.Hh)(f.options.data[j],c,h.data[j]),f.records[j]=(0,E.Hh)(f.records[j],c,h.records[j]);let L=0;for(let k=c;k<h.numOfColumns+c;k++)f.rows[j].element.insertBefore(h.records[j][L].element,f.rows[j].element.children[k+1]),L++}if(f.options.footers)for(let j=0;j<f.options.footers.length;j++)f.options.footers[j]=(0,E.Hh)(f.options.footers[j],c,h.footers[j])}for(let v=c;v<f.cols.length;v++)f.cols[v].x=v;for(let v=0;v<f.records.length;v++)for(let j=c;j<f.records[v].length;j++)f.records[v][j].x=j;if(f.options.nestedHeaders&&f.options.nestedHeaders.length>0&&f.options.nestedHeaders[0]&&f.options.nestedHeaders[0][0])for(let v=0;v<f.options.nestedHeaders.length;v++){let j;j=a==1?parseInt(f.options.nestedHeaders[v][f.options.nestedHeaders[v].length-1].colspan)-h.numOfColumns:parseInt(f.options.nestedHeaders[v][f.options.nestedHeaders[v].length-1].colspan)+h.numOfColumns,f.options.nestedHeaders[v][f.options.nestedHeaders[v].length-1].colspan=j,f.thead.children[v].children[f.thead.children[v].children.length-1].setAttribute("colspan",j)}T.o8.call(f)},M=function(){const a=this,h=!!a.parent.ignoreEvents,f=!!a.ignoreHistory;a.parent.ignoreEvents=!0,a.ignoreHistory=!0;const c=[];let v;if(a.historyIndex>=0){if(v=a.history[a.historyIndex--],v.action=="insertRow")w.call(a,1,v);else if(v.action=="deleteRow")w.call(a,0,v);else if(v.action=="insertColumn")S.call(a,1,v);else if(v.action=="deleteColumn")S.call(a,0,v);else if(v.action=="moveRow")a.moveRow(v.newValue,v.oldValue);else if(v.action=="moveColumn")a.moveColumn(v.newValue,v.oldValue);else if(v.action=="setMerge")a.removeMerge(v.column,v.data);else if(v.action=="setStyle")a.setStyle(v.oldValue,null,null,1);else if(v.action=="setWidth")a.setWidth(v.column,v.oldValue);else if(v.action=="setHeight")a.setHeight(v.row,v.oldValue);else if(v.action=="setHeader")a.setHeader(v.column,v.oldValue);else if(v.action=="setComments")a.setComments(v.oldValue);else if(v.action=="orderBy"){let j=[];for(let L=0;L<v.rows.length;L++)j[v.rows[L]]=L;H.Th.call(a,v.column,v.order?0:1),H.iY.call(a,j)}else if(v.action=="setValue"){for(let j=0;j<v.records.length;j++)c.push({x:v.records[j].x,y:v.records[j].y,value:v.records[j].oldValue}),v.oldStyle&&a.resetStyle(v.oldStyle);a.setValue(c),v.selection&&a.updateSelectionFromCoords(v.selection[0],v.selection[1],v.selection[2],v.selection[3])}}a.parent.ignoreEvents=h,a.ignoreHistory=f,p.A.call(a,"onundo",a,v)},l=function(){const a=this,h=!!a.parent.ignoreEvents,f=!!a.ignoreHistory;let c;if(a.parent.ignoreEvents=!0,a.ignoreHistory=!0,a.historyIndex<a.history.length-1){if(c=a.history[++a.historyIndex],c.action=="insertRow")w.call(a,0,c);else if(c.action=="deleteRow")w.call(a,1,c);else if(c.action=="insertColumn")S.call(a,0,c);else if(c.action=="deleteColumn")S.call(a,1,c);else if(c.action=="moveRow")a.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")a.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")X.FU.call(a,c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")a.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")a.setWidth(c.column,c.newValue);else if(c.action=="setHeight")a.setHeight(c.row,c.newValue);else if(c.action=="setHeader")a.setHeader(c.column,c.newValue);else if(c.action=="setComments")a.setComments(c.newValue);else if(c.action=="orderBy")H.Th.call(a,c.column,c.order),H.iY.call(a,c.rows);else if(c.action=="setValue"){a.setValue(c.records);for(let v=0;v<c.records.length;v++)c.oldStyle&&a.resetStyle(c.newStyle);c.selection&&a.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}a.parent.ignoreEvents=h,a.ignoreHistory=f,p.A.call(a,"onredo",a,c)}},530:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(805),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(657),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(978),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(654),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(296),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(167),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(160),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(689);const updateTable=function(){const n=this;if(n.options.minSpareRows>0){let g=0;for(let o=n.rows.length-1;o>=0;o--){let p=!1;for(let E=0;E<n.headers.length;E++)n.options.data[o][E]&&(p=!0);if(p)break;g++}n.options.minSpareRows-g>0&&n.insertRow(n.options.minSpareRows-g)}if(n.options.minSpareCols>0){let g=0;for(let o=n.headers.length-1;o>=0;o--){let p=!1;for(let E=0;E<n.rows.length;E++)n.options.data[E][o]&&(p=!0);if(p)break;g++}n.options.minSpareCols-g>0&&n.insertColumn(n.options.minSpareCols-g)}n.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.e.call(n),setTimeout(function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(n)},0)},parseNumber=function(n,g){const o=g&&this.options.columns[g].decimal?this.options.columns[g].decimal:".";let p=""+n;return p=p.split(o),p[0]=p[0].match(/[+-]?[0-9]/g),p[0]&&(p[0]=p[0].join("")),p[1]&&(p[1]=p[1].match(/[0-9]*/g).join("")),p[0]&&Number.isInteger(Number(p[0]))?p[1]?+(p[0]+"."+p[1]):+(p[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(n){for(let g=0;g<n.length;g++){const o=[],p=n[g].split(":"),E=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(p[0],!0),T=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(p[1],!0);let X,H,m,s;E[0]<=T[0]?(X=E[0],H=T[0]):(X=T[0],H=E[0]),E[1]<=T[1]?(m=E[1],s=T[1]):(m=T[1],s=E[1]);for(let w=m;w<=s;w++)for(let S=X;S<=H;S++)o.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([S,w]));expression=expression.replace(n[g],o.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(tokens[i],1);let g;if(g=obj.options.data[n[1]]!==void 0&&obj.options.data[n[1]][n[0]]!==void 0?obj.options.data[n[1]][n[0]]:"",(""+g).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?g=formulaResults[tokens[i]]:(g=execute(g,n[0],n[1]),formulaResults[tokens[i]]=g)),(""+g).trim()=="")formulaExpressions[tokens[i]]=null;else if(g==Number(g)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(g);else{const o=parseNumber.call(obj,g,n[0]);obj.parent.config.autoCasting!=0&&o?formulaExpressions[tokens[i]]=o:formulaExpressions[tokens[i]]='"'+g+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(n){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,n)}return res}};return execute(expression,x,y)},parseValue=function(n,g,o,p){const E=this;(""+o).substr(0,1)=="="&&E.parent.config.parseFormulas!=0&&(o=executeFormula.call(E,o,n,g));const T=E.options.columns&&E.options.columns[n];if(T&&!isFormula(o)){let X=null;if(X=getMask(T)){o&&o==Number(o)&&(o=Number(o));let H=jSuites.mask.render(o,X,!0);if(p&&X.mask){const m=X.mask.split(";");m[1]&&(m[1].match(new RegExp("\\[Red\\]","gi"))&&(o<0?p.classList.add("red"):p.classList.remove("red")),m[1].match(new RegExp("\\(","gi"))&&o<0&&(H="("+H+")"))}H&&(o=H)}}return o},getDropDownValue=function(n,g){const o=this,p=[];if(o.options.columns&&o.options.columns[n]&&o.options.columns[n].source){const E=[],T=o.options.columns[n].source;for(let H=0;H<T.length;H++)typeof T[H]=="object"?E[T[H].id]=T[H].name:E[T[H]]=T[H];const X=Array.isArray(g)?g:(""+g).split(";");for(let H=0;H<X.length;H++)typeof X[H]=="object"?p.push(E[X[H].id]):E[X[H]]&&p.push(E[X[H]])}else console.error("Invalid column");return p.length>0?p.join("; "):""},validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])},stripScript=function(n){const g=new Option;g.innerHTML=n;let o=null;for(n=g.getElementsByTagName("script");o=n[0];)o.parentNode.removeChild(o);return g.innerHTML},createCell=function(n,g,o){const p=this;let E=document.createElement("td");if(E.setAttribute("data-x",n),E.setAttribute("data-y",g),p.headers[n].style.display==="none"&&(E.style.display="none"),(""+o).substr(0,1)=="="&&p.options.secureFormulas==1){const X=secureFormula(o);X!=o&&(o=X)}if(p.options.columns&&p.options.columns[n]&&typeof p.options.columns[n].type=="object")p.parent.config.parseHTML===!0?E.innerHTML=o:E.textContent=o,typeof p.options.columns[n].type.createCell=="function"&&p.options.columns[n].type.createCell(E,o,parseInt(n),parseInt(g),p,p.options.columns[n]);else if(p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="hidden")E.style.display="none",E.textContent=o;else if(p.options.columns&&p.options.columns[n]&&(p.options.columns[n].type=="checkbox"||p.options.columns[n].type=="radio")){const X=document.createElement("input");X.type=p.options.columns[n].type,X.name="c"+n,X.checked=o==1||o==1||o=="true",X.onclick=function(){p.setValue(E,this.checked)},p.options.columns[n].readOnly!=1&&p.options.editable!=0||X.setAttribute("disabled","disabled"),E.appendChild(X),p.options.data[g][n]=X.checked}else if(p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="calendar"){let X=null;if(!validDate(o)){const H=jSuites.calendar.extractDateFromString(o,p.options.columns[n].options&&p.options.columns[n].options.format||"YYYY-MM-DD");H&&(X=H)}E.textContent=jSuites.calendar.getDateString(X||o,p.options.columns[n].options&&p.options.columns[n].options.format)}else if(p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="dropdown")E.classList.add("jss_dropdown"),E.textContent=getDropDownValue.call(p,n,o);else if(p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="color")if(p.options.columns[n].render=="square"){const X=document.createElement("div");X.className="color",X.style.backgroundColor=o,E.appendChild(X)}else E.style.color=o,E.textContent=o;else if(p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="image"){if(o&&o.substr(0,10)=="data:image"){const X=document.createElement("img");X.src=o,E.appendChild(X)}}else p.options.columns&&p.options.columns[n]&&p.options.columns[n].type=="html"||p.parent.config.parseHTML===!0?E.innerHTML=stripScript(parseValue.call(this,n,g,o,E)):E.textContent=parseValue.call(this,n,g,o,E);p.options.columns&&p.options.columns[n]&&p.options.columns[n].readOnly==1&&(E.className="readonly");const T=p.options.columns&&p.options.columns[n]&&p.options.columns[n].align||p.options.defaultColAlign||"center";return E.style.textAlign=T,p.options.columns&&p.options.columns[n]&&p.options.columns[n].wordWrap==0||!(p.options.wordWrap==1||p.options.columns&&p.options.columns[n]&&p.options.columns[n].wordWrap==1||E.innerHTML.length>200)||(E.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(o||E.innerHTML?p.records[g][n-1].element.style.overflow="hidden":n==p.options.columns.length-1&&(E.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(p,"oncreatecell",p,E,n,g,o),E},updateCell=function(n,g,o,p){const E=this;let T;if(E.records[g][n].element.classList.contains("readonly")!=1||p){if((""+o).substr(0,1)=="="&&E.options.secureFormulas==1){const m=secureFormula(o);m!=o&&(o=m)}const X=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(E,"onbeforechange",E,E.records[g][n].element,n,g,o);if(X!=null&&(o=X),E.options.columns&&E.options.columns[n]&&typeof E.options.columns[n].type=="object"&&typeof E.options.columns[n].type.updateCell=="function"){const m=E.options.columns[n].type.updateCell(E.records[g][n].element,o,parseInt(n),parseInt(g),E,E.options.columns[n]);m!==void 0&&(o=m)}T={x:n,y:g,col:n,row:g,value:o,oldValue:E.options.data[g][n]};let H=E.options.columns&&E.options.columns[n]&&typeof E.options.columns[n].type=="object"?E.options.columns[n].type:null;if(H)E.options.data[g][n]=o,typeof H.setValue=="function"&&H.setValue(E.records[g][n].element,o);else if(E.options.columns&&E.options.columns[n]&&(E.options.columns[n].type=="checkbox"||E.options.columns[n].type=="radio")){if(E.options.columns[n].type=="radio")for(let m=0;m<E.options.data.length;m++)E.options.data[m][n]=!1;E.records[g][n].element.children[0].checked=o==1||o==1||o=="true"||o=="TRUE",E.options.data[g][n]=E.records[g][n].element.children[0].checked}else if(E.options.columns&&E.options.columns[n]&&E.options.columns[n].type=="dropdown")E.options.data[g][n]=o,E.records[g][n].element.textContent=getDropDownValue.call(E,n,o);else if(E.options.columns&&E.options.columns[n]&&E.options.columns[n].type=="calendar"){let m=null;if(!validDate(o)){const s=jSuites.calendar.extractDateFromString(o,E.options.columns[n].options&&E.options.columns[n].options.format||"YYYY-MM-DD");s&&(m=s)}E.options.data[g][n]=o,E.records[g][n].element.textContent=jSuites.calendar.getDateString(m||o,E.options.columns[n].options&&E.options.columns[n].options.format)}else if(E.options.columns&&E.options.columns[n]&&E.options.columns[n].type=="color")if(E.options.data[g][n]=o,E.options.columns[n].render=="square"){const m=document.createElement("div");m.className="color",m.style.backgroundColor=o,E.records[g][n].element.textContent="",E.records[g][n].element.appendChild(m)}else E.records[g][n].element.style.color=o,E.records[g][n].element.textContent=o;else if(E.options.columns&&E.options.columns[n]&&E.options.columns[n].type=="image"){if(o=""+o,E.options.data[g][n]=o,E.records[g][n].element.innerHTML="",o&&o.substr(0,10)=="data:image"){const m=document.createElement("img");m.src=o,E.records[g][n].element.appendChild(m)}}else E.options.data[g][n]=o,E.options.columns&&E.options.columns[n]&&E.options.columns[n].type=="html"?E.records[g][n].element.innerHTML=stripScript(parseValue.call(E,n,g,o)):E.parent.config.parseHTML===!0?E.records[g][n].element.innerHTML=stripScript(parseValue.call(E,n,g,o,E.records[g][n].element)):E.records[g][n].element.textContent=parseValue.call(E,n,g,o,E.records[g][n].element),E.options.columns&&E.options.columns[n]&&E.options.columns[n].wordWrap==0||!(E.options.wordWrap==1||E.options.columns&&E.options.columns[n]&&E.options.columns[n].wordWrap==1||E.records[g][n].element.innerHTML.length>200)?E.records[g][n].element.style.whiteSpace="":E.records[g][n].element.style.whiteSpace="pre-wrap";n>0&&(E.records[g][n-1].element.style.overflow=o?"hidden":""),E.options.columns&&E.options.columns[n]&&typeof E.options.columns[n].render=="function"&&E.options.columns[n].render(E.records[g]&&E.records[g][n]?E.records[g][n].element:null,o,parseInt(n),parseInt(g),E,E.options.columns[n]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(E,"onchange",E,E.records[g]&&E.records[g][n]?E.records[g][n].element:null,n,g,o,T.oldValue)}else T={x:n,y:g,col:n,row:g};return T},isFormula=function(n){const g=(""+n)[0];return g=="="||g=="#"},getMask=function(n){if(n.format||n.mask||n.locale){const g={};return n.mask?g.mask=n.mask:n.format?g.mask=n.format:(g.locale=n.locale,g.options=n.options),n.decimal&&(g.options||(g.options={}),g.options={decimal:n.decimal}),g}return null},secureFormula=function(n){let g="",o=0;for(let p=0;p<n.length;p++)n[p]=='"'&&(o=o==0?1:0),g+=o==1?n[p]:n[p].toUpperCase();return g};let chainLoopProtection=[];const updateFormulaChain=function(n,g,o){const p=this,E=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([n,g]);if(p.formula[E]&&p.formula[E].length>0)if(chainLoopProtection[E])p.records[g][n].element.innerHTML="#ERROR",p.formula[E]="";else{chainLoopProtection[E]=!0;for(let T=0;T<p.formula[E].length;T++){const X=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(p.formula[E][T],!0),H=""+p.options.data[X[1]][X[0]];H.substr(0,1)=="="?o.push(updateCell.call(p,X[0],X[1],H,!0)):Object.keys(p.formula)[T]=null,updateFormulaChain.call(p,X[0],X[1],o)}}chainLoopProtection=[]},updateFormula=function(n,g){const o=/[A-Z]/,p=/[0-9]/;let E="",T=null,X=null,H="";for(let m=0;m<n.length;m++)o.exec(n[m])?(T=1,X=0,H+=n[m]):p.exec(n[m])?(X=T?1:0,H+=n[m]):(T&&X&&(H=g[H]?g[H]:H),E+=H,E+=n[m],T=0,X=0,H="");return H&&(T&&X&&(H=g[H]?g[H]:H),E+=H),E},updateFormulas=function(n){const g=this;for(let E=0;E<g.options.data.length;E++)for(let T=0;T<g.options.data[0].length;T++){const X=""+g.options.data[E][T];if(X.substr(0,1)=="="){const H=updateFormula(X,n);H!=X&&(g.options.data[E][T]=H)}}const o=[],p=Object.keys(g.formula);for(let E=0;E<p.length;E++){let T=p[E];const X=g.formula[T];n[T]&&(T=n[T]),o[T]=[];for(let H=0;H<X.length;H++){let m=X[H];n[m]&&(m=n[m]),o[T].push(m)}}g.formula=o},updateTableReferences=function(){const n=this;if(n.skipUpdateTableReferences)return;for(let T=0;T<n.headers.length;T++)n.headers[T].getAttribute("data-x")!=T&&(n.headers[T].setAttribute("data-x",T),n.headers[T].getAttribute("title")||(n.headers[T].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(T)));for(let T=0;T<n.rows.length;T++)n.rows[T]&&n.rows[T].element.getAttribute("data-y")!=T&&(n.rows[T].element.setAttribute("data-y",T),n.rows[T].element.children[0].setAttribute("data-y",T),n.rows[T].element.children[0].innerHTML=T+1);const g=[],o=[],p=function(T,X,H,m){if(T!=H&&n.records[m][H].element.setAttribute("data-x",H),X!=m&&n.records[m][H].element.setAttribute("data-y",m),T!=H||X!=m){const s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([T,X]),w=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([H,m]);g[s]=w}};for(let T=0;T<n.records.length;T++)for(let X=0;X<n.records[0].length;X++)if(n.records[T][X]){const H=n.records[T][X].element.getAttribute("data-x"),m=n.records[T][X].element.getAttribute("data-y");if(n.records[T][X].element.getAttribute("data-merged")){const s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([H,m]),w=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([X,T]);if(o[s]==null)if(s==w)o[s]=!1;else{const S=parseInt(X-H),M=parseInt(T-m);o[s]=[w,S,M]}}else p(H,m,X,T)}const E=Object.keys(o);if(E.length){for(let T=0;T<E.length;T++)if(o[E[T]]){const X=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(E[T],!0);let H=X[0],m=X[1];p(H,m,H+o[E[T]][1],m+o[E[T]][2]);const s=E[T],w=o[E[T]][0];for(let S=0;S<n.options.mergeCells[s][2].length;S++)H=parseInt(n.options.mergeCells[s][2][S].getAttribute("data-x")),m=parseInt(n.options.mergeCells[s][2][S].getAttribute("data-y")),n.options.mergeCells[s][2][S].setAttribute("data-x",H+o[E[T]][1]),n.options.mergeCells[s][2][S].setAttribute("data-y",m+o[E[T]][2]);n.options.mergeCells[w]=n.options.mergeCells[s],delete n.options.mergeCells[s]}}updateFormulas.call(n,g),_meta_js__WEBPACK_IMPORTED_MODULE_5__.hs.call(n,g),_selection_js__WEBPACK_IMPORTED_MODULE_1__.G9.call(n),updateTable.call(n)},updateScroll=function(n){const g=this,o=g.content.getBoundingClientRect(),p=o.left,E=o.top,T=o.width,X=o.height,H=g.records[g.selectedCell[3]][g.selectedCell[2]].element.getBoundingClientRect(),m=H.left,s=H.top,w=H.width,S=H.height;let M,l;n==0||n==1?(M=m-p+g.content.scrollLeft,l=s-E+g.content.scrollTop-2):(M=m-p+g.content.scrollLeft+w,l=s-E+g.content.scrollTop+S),l>g.content.scrollTop+30&&l<g.content.scrollTop+X||(l<g.content.scrollTop+30?g.content.scrollTop=l-S:g.content.scrollTop=l-(X-2));const a=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.w.call(g);M>g.content.scrollLeft+a&&M<g.content.scrollLeft+T||(M<g.content.scrollLeft+30?(g.content.scrollLeft=M,g.content.scrollLeft<50&&(g.content.scrollLeft=0)):M<g.content.scrollLeft+a?g.content.scrollLeft=M-a-1:g.content.scrollLeft=M-(T-20))},updateResult=function(){const n=this;let g=0,o=0;for(g=n.options.lazyLoading==1?100:n.options.pagination>0?n.options.pagination:n.results?n.results.length:n.rows.length;n.tbody.firstChild;)n.tbody.removeChild(n.tbody.firstChild);for(let p=0;p<n.rows.length;p++)!n.results||n.results.indexOf(p)>-1?(o<g&&(n.tbody.appendChild(n.rows[p].element),o++),n.rows[p].element.style.display=""):n.rows[p].element.style.display="none";return n.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.IV.call(n),_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(n),g},getCell=function(n,g){if(typeof n=="string"){const o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(n,!0);n=o[0],g=o[1]}return this.records[g][n].element},getCellFromCoords=function(n,g){return this.records[g][n].element},getLabel=function(n,g){if(typeof n=="string"){const o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(n,!0);n=o[0],g=o[1]}return this.records[g][n].element.innerHTML},fullscreen=function(n){const g=this;n==null&&(n=!g.config.fullscreen),g.config.fullscreen!=n&&(g.config.fullscreen=n,n==1?g.element.classList.add("fullscreen"):g.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(n){const g=this,o=document.createElement("tr");o.classList.add("jss_nested");const p=document.createElement("td");p.classList.add("jss_selectall"),o.appendChild(p),n.element=o;let E=0;for(let T=0;T<n.length;T++){n[T].colspan||(n[T].colspan=1),n[T].title||(n[T].title=""),n[T].id||(n[T].id="");let X=n[T].colspan;const H=[];for(let s=0;s<X;s++)g.options.columns[E]&&g.options.columns[E].type=="hidden"&&X++,H.push(E),E++;const m=document.createElement("td");m.setAttribute("data-column",H.join(",")),m.setAttribute("colspan",n[T].colspan),m.setAttribute("align",n[T].align||"center"),m.setAttribute("id",n[T].id),m.textContent=n[T].title,o.appendChild(m)}return o},getWorksheetActive=function(){const n=this.parent?this.parent:this;return n.element.tabs?n.element.tabs.getActive():0},getWorksheetInstance=function(n){const g=n!==void 0?n:getWorksheetActive.call(this);return this.worksheets[g]}},689:function(n,g,o){o.d(g,{Hh:function(){return E},t3:function(){return X},vu:function(){return T}});var p=o(978);const E=function(H,m,s){if(m<=H.length)return H.slice(0,m).concat(s).concat(H.slice(m));const w=H.slice(0,H.length);for(;m>w.length;)w.push(void 0);return w.concat(s)},T=function(H,m){const s=/^[a-zA-Z]+/.exec(H);if(s){let w=0;for(let M=0;M<s[0].length;M++)w+=parseInt(s[0].charCodeAt(M)-64)*Math.pow(26,s[0].length-1-M);w--,w<0&&(w=0);let S=parseInt(/[0-9]+$/.exec(H));S>0&&S--,H=m==1?[w,S]:w+"-"+S}return H},X=function(H){return Array.isArray(H)||(H=H.split("-")),(0,p.getColumnName)(parseInt(H[0]))+(parseInt(H[1])+1)}},497:function(n,g,o){o.d(g,{AG:function(){return E},G_:function(){return T},p6:function(){return X},wu:function(){return p}});const p=function(H){const m=this;let s;s=m.options.search!=1&&m.options.filters!=1||!m.results?m.rows:m.results;const w=100;H!=null&&H!=-1||(H=Math.ceil(s.length/w)-1);let S=H*w,M=H*w+w;M>s.length&&(M=s.length),S=M-100,S<0&&(S=0);for(let l=S;l<M;l++)m.options.search!=1&&m.options.filters!=1||!m.results?m.tbody.appendChild(m.rows[l].element):m.tbody.appendChild(m.rows[s[l]].element),m.tbody.children.length>w&&m.tbody.removeChild(m.tbody.firstChild)},E=function(){const H=this;if(H.selectedCell){const m=parseInt(H.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(H.selectedCell[3]/100),w=parseInt(H.rows.length/100);if(m!=s&&s<=w&&!Array.prototype.indexOf.call(H.tbody.children,H.rows[H.selectedCell[3]].element))return H.loadPage(s),!0}return!1},T=function(){const H=this;let m;m=H.options.search!=1&&H.options.filters!=1||!H.results?H.rows:H.results;let s=0;if(m.length>100){let w=parseInt(H.tbody.firstChild.getAttribute("data-y"));if(H.options.search!=1&&H.options.filters!=1||!H.results||(w=m.indexOf(w)),w>0)for(let S=0;S<30;S++)w-=1,w>-1&&(H.options.search!=1&&H.options.filters!=1||!H.results?H.tbody.insertBefore(H.rows[w].element,H.tbody.firstChild):H.tbody.insertBefore(H.rows[m[w]].element,H.tbody.firstChild),H.tbody.children.length>100&&(H.tbody.removeChild(H.tbody.lastChild),s=1))}return s},X=function(){const H=this;let m;m=H.options.search!=1&&H.options.filters!=1||!H.results?H.rows:H.results;let s=0;if(m.length>100){let w=parseInt(H.tbody.lastChild.getAttribute("data-y"));if(H.options.search!=1&&H.options.filters!=1||!H.results||(w=m.indexOf(w)),w<H.rows.length-1)for(let S=0;S<=30;S++)w<m.length&&(H.options.search!=1&&H.options.filters!=1||!H.results?H.tbody.appendChild(H.rows[w].element):H.tbody.appendChild(H.rows[m[w]].element),H.tbody.children.length>100&&(H.tbody.removeChild(H.tbody.firstChild),s=1)),w+=1}return s}},910:function(n,g,o){o.d(g,{D0:function(){return s},FU:function(){return S},Lt:function(){return m},VP:function(){return l},Zp:function(){return M},fd:function(){return w}});var p=o(689),E=o(530),T=o(911),X=o(805),H=o(657);const m=function(a,h){const f=this,c=[];if(f.options.mergeCells){const v=Object.keys(f.options.mergeCells);for(let j=0;j<v.length;j++){const L=(0,p.vu)(v[j],!0),k=f.options.mergeCells[v[j]][0],N=L[0],D=L[0]+(k>1?k-1:0);h==null?N<=a&&D>=a&&c.push(v[j]):h?N<a&&D>=a&&c.push(v[j]):N<=a&&D>a&&c.push(v[j])}}return c},s=function(a,h){const f=this,c=[];if(f.options.mergeCells){const v=Object.keys(f.options.mergeCells);for(let j=0;j<v.length;j++){const L=(0,p.vu)(v[j],!0),k=f.options.mergeCells[v[j]][1],N=L[1],D=L[1]+(k>1?k-1:0);h==null?N<=a&&D>=a&&c.push(v[j]):h?N<a&&D>=a&&c.push(v[j]):N<=a&&D>a&&c.push(v[j])}}return c},w=function(a){const h=this;let f={};if(a)f=h.options.mergeCells&&h.options.mergeCells[a]?[h.options.mergeCells[a][0],h.options.mergeCells[a][1]]:null;else if(h.options.mergeCells){h.options.mergeCells;const c=Object.keys(h.options.mergeCells);for(let v=0;v<c.length;v++)f[c[v]]=[h.options.mergeCells[c[v]][0],h.options.mergeCells[c[v]][1]]}return f},S=function(a,h,f,c){const v=this;let j=!1;if(a){if(typeof a!="string")return null}else{if(!v.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const k=parseInt(v.highlighted[0].getAttribute("data-x")),N=parseInt(v.highlighted[0].getAttribute("data-y")),D=parseInt(v.highlighted[v.highlighted.length-1].getAttribute("data-x")),O=parseInt(v.highlighted[v.highlighted.length-1].getAttribute("data-y"));a=(0,p.t3)([k,N]),h=D-k+1,f=O-N+1}}const L=(0,p.vu)(a,!0);if(v.options.mergeCells&&v.options.mergeCells[a])v.records[L[1]][L[0]].element.getAttribute("data-merged")&&(j="Cell already merged");else if((!h||h<2)&&(!f||f<2))j="Invalid merged properties";else for(let k=L[1];k<L[1]+f;k++)for(let N=L[0];N<L[0]+h;N++)(0,p.t3)([N,k]),v.records[k][N].element.getAttribute("data-merged")&&(j="There is a conflict with another merged cell");if(j)alert(jSuites.translate(j));else{h>1?v.records[L[1]][L[0]].element.setAttribute("colspan",h):h=1,f>1?v.records[L[1]][L[0]].element.setAttribute("rowspan",f):f=1,v.options.mergeCells||(v.options.mergeCells={}),v.options.mergeCells[a]=[h,f,[]],v.records[L[1]][L[0]].element.setAttribute("data-merged","true"),v.records[L[1]][L[0]].element.style.overflow="hidden";const k=[];for(let N=L[1];N<L[1]+f;N++)for(let D=L[0];D<L[0]+h;D++)L[0]==D&&L[1]==N||(k.push(v.options.data[N][D]),E.k9.call(v,D,N,"",!0),v.options.mergeCells[a][2].push(v.records[N][D].element),v.records[N][D].element.style.display="none",v.records[N][D].element=v.records[L[1]][L[0]].element);H.c6.call(v,v.records[L[1]][L[0]].element),c||(T.Dh.call(v,{action:"setMerge",column:a,colspan:h,rowspan:f,data:k}),X.A.call(v,"onmerge",v,{[a]:[h,f]}))}},M=function(a,h,f){const c=this;if(c.options.mergeCells&&c.options.mergeCells[a]){const v=(0,p.vu)(a,!0);c.records[v[1]][v[0]].element.removeAttribute("colspan"),c.records[v[1]][v[0]].element.removeAttribute("rowspan"),c.records[v[1]][v[0]].element.removeAttribute("data-merged");const j=c.options.mergeCells[a];let L,k,N=0;for(L=0;L<j[1];L++)for(k=0;k<j[0];k++)(L>0||k>0)&&(c.records[v[1]+L][v[0]+k].element=j[2][N],c.records[v[1]+L][v[0]+k].element.style.display="",h&&h[N]&&E.k9.call(c,v[0]+k,v[1]+L,h[N]),N++);H.c6.call(c,c.records[v[1]][v[0]].element,c.records[v[1]+L-1][v[0]+k-1].element),f||delete c.options.mergeCells[a]}},l=function(a){const h=this;if(h.options.mergeCells){h.options.mergeCells;const f=Object.keys(h.options.mergeCells);for(let c=0;c<f.length;c++)M.call(h,f[c],null,a)}}},654:function(n,g,o){o.d(g,{IQ:function(){return E},hs:function(){return T},iZ:function(){return X}});var p=o(805);const E=function(H,m){const s=this;return H?m?s.options.meta&&s.options.meta[H]&&s.options.meta[H][m]?s.options.meta[H][m]:null:s.options.meta&&s.options.meta[H]?s.options.meta[H]:null:s.options.meta},T=function(H){const m=this;if(m.options.meta){const s={},w=Object.keys(m.options.meta);for(let S=0;S<w.length;S++)H[w[S]]?s[H[w[S]]]=m.options.meta[w[S]]:s[w[S]]=m.options.meta[w[S]];m.options.meta=s}},X=function(H,m,s){const w=this;if(w.options.meta||(w.options.meta={}),m&&s)w.options.meta[H]||(w.options.meta[H]={}),w.options.meta[H][m]=s,p.A.call(w,"onchangemeta",w,{[H]:{[m]:s}});else{const S=Object.keys(H);for(let M=0;M<S.length;M++){w.options.meta[S[M]]||(w.options.meta[S[M]]={});const l=Object.keys(H[S[M]]);for(let a=0;a<l.length;a++)w.options.meta[S[M]][l[a]]=H[S[M]][l[a]]}p.A.call(w,"onchangemeta",w,H)}}},94:function(n,g,o){o.d(g,{My:function(){return w},Th:function(){return m},iY:function(){return s}});var p=o(911),E=o(805),T=o(530),X=o(497),H=o(829);const m=function(S,M){const l=this;for(let a=0;a<l.headers.length;a++)l.headers[a].classList.remove("arrow-up"),l.headers[a].classList.remove("arrow-down");M?l.headers[S].classList.add("arrow-up"):l.headers[S].classList.add("arrow-down")},s=function(S){const M=this;let l=[];for(let a=0;a<S.length;a++)l[a]=M.options.data[S[a]];M.options.data=l,l=[];for(let a=0;a<S.length;a++){l[a]=M.records[S[a]];for(let h=0;h<l[a].length;h++)l[a][h].y=a}M.records=l,l=[];for(let a=0;a<S.length;a++)l[a]=M.rows[S[a]],l[a].y=a;if(M.rows=l,T.o8.call(M),M.results&&M.results.length)M.searchInput.value?M.search(M.searchInput.value):H.F8.call(M);else if(M.results=null,M.pageNumber=0,M.options.pagination>0)M.page(0);else if(M.options.lazyLoading==1)X.wu.call(M,0);else for(let a=0;a<M.rows.length;a++)M.tbody.appendChild(M.rows[a].element)},w=function(S,M){const l=this;if(S>=0){if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}M=M==null?l.headers[S].classList.contains("arrow-down")?1:0:M?1:0;let a=[];if(l.options.columns&&l.options.columns[S]&&(l.options.columns[S].type=="number"||l.options.columns[S].type=="numeric"||l.options.columns[S].type=="percentage"||l.options.columns[S].type=="autonumber"||l.options.columns[S].type=="color"))for(let f=0;f<l.options.data.length;f++)a[f]=[f,Number(l.options.data[f][S])];else if(l.options.columns&&l.options.columns[S]&&(l.options.columns[S].type=="calendar"||l.options.columns[S].type=="checkbox"||l.options.columns[S].type=="radio"))for(let f=0;f<l.options.data.length;f++)a[f]=[f,l.options.data[f][S]];else for(let f=0;f<l.options.data.length;f++)a[f]=[f,l.records[f][S].element.textContent.toLowerCase()];typeof l.parent.config.sorting!="function"&&(l.parent.config.sorting=function(f){return function(c,v){const j=c[1],L=v[1];return f?j===""&&L!==""?1:j!==""&&L===""||j>L?-1:j<L?1:0:j===""&&L!==""?1:j!==""&&L===""?-1:j>L?1:j<L?-1:0}}),a=a.sort(l.parent.config.sorting(M));const h=[];for(let f=0;f<a.length;f++)h[f]=a[f][0];return p.Dh.call(l,{action:"orderBy",rows:h,column:S,order:M}),m.call(l,S,M),s.call(l,h),E.A.call(l,"onsort",l,S,M,h.map(f=>f)),!0}}},167:function(n,g,o){o.d(g,{$f:function(){return m},IV:function(){return X},MY:function(){return H},ho:function(){return T}});var p=o(805),E=o(657);const T=function(s){const w=this;return w.options.search!=1&&w.options.filters!=1||!w.results||(s=w.results.indexOf(s)),Math.ceil((parseInt(s)+1)/parseInt(w.options.pagination))-1},X=function(){const s=this;if(s.pagination.children[0].innerHTML="",s.pagination.children[1].innerHTML="",s.options.pagination){let w;if(w=s.options.search!=1&&s.options.filters!=1||!s.results?s.rows.length:s.results.length,w){const S=Math.ceil(w/s.options.pagination);let M,l;if(s.pageNumber<6?(M=1,l=S<10?S:10):S-s.pageNumber<5?(M=S-9,l=S,M<1&&(M=1)):(M=s.pageNumber-4,l=s.pageNumber+5),M>1){const h=document.createElement("div");h.className="jss_page",h.innerHTML="<",h.title=1,s.pagination.children[1].appendChild(h)}for(let h=M;h<=l;h++){const f=document.createElement("div");f.className="jss_page",f.innerHTML=h,s.pagination.children[1].appendChild(f),s.pageNumber==h-1&&f.classList.add("jss_page_selected")}if(l<S){const h=document.createElement("div");h.className="jss_page",h.innerHTML=">",h.title=S,s.pagination.children[1].appendChild(h)}const a=function(h){const f=Array.prototype.slice.call(arguments,1);return h.replace(/{(\d+)}/g,function(c,v){return f[v]!==void 0?f[v]:c})};s.pagination.children[0].innerHTML=a(jSuites.translate("Showing page {0} of {1} entries"),s.pageNumber+1,S)}else s.pagination.children[0].innerHTML=jSuites.translate("No records found")}},H=function(s){const w=this,S=w.pageNumber;let M;M=w.options.search!=1&&w.options.filters!=1||!w.results?w.rows:w.results;const l=parseInt(w.options.pagination);s!=null&&s!=-1||(s=Math.ceil(M.length/l)-1),w.pageNumber=s;let a=s*l,h=s*l+l;for(h>M.length&&(h=M.length),a<0&&(a=0);w.tbody.firstChild;)w.tbody.removeChild(w.tbody.firstChild);for(let f=a;f<h;f++)w.options.search!=1&&w.options.filters!=1||!w.results?w.tbody.appendChild(w.rows[f].element):w.tbody.appendChild(w.rows[M[f]].element);w.options.pagination>0&&X.call(w),E.Aq.call(w),p.A.call(w,"onchangepage",w,s,S,w.options.pagination)},m=function(){const s=this;let w;return w=s.options.search!=1&&s.options.filters!=1||!s.results?s.rows.length:s.results.length,Math.ceil(w/s.options.pagination)}},657:function(n,g,o){o.d(g,{AH:function(){return a},Aq:function(){return w},G9:function(){return f},Jg:function(){return h},Lo:function(){return O},R5:function(){return N},Ub:function(){return D},at:function(){return k},c6:function(){return M},eO:function(){return V},ef:function(){return Y},gE:function(){return S},gG:function(){return c},kA:function(){return l},kF:function(){return j},kV:function(){return ge},sp:function(){return ue},tW:function(){return L}});var p=o(805),E=o(296),T=o(978),X=o(911),H=o(530),m=o(689),s=o(392);const w=function(){const G=this;if(G.highlighted&&G.highlighted.length){const ae=G.highlighted[G.highlighted.length-1].element,he=ae.getAttribute("data-x"),ce=G.content.getBoundingClientRect(),oe=ce.left,ye=ce.top,ke=ae.getBoundingClientRect(),Pe=ke.left,Be=ke.top,Ze=ke.width,W=ke.height,Le=Pe-oe+G.content.scrollLeft+Ze-4,Ye=Be-ye+G.content.scrollTop+W-4;if(G.corner.style.top=Ye+"px",G.corner.style.left=Le+"px",G.options.freezeColumns){const ot=E.w.call(G);he>G.options.freezeColumns-1&&Pe-oe+Ze<ot?G.corner.style.display="none":G.options.selectionCopy!=0&&(G.corner.style.display="")}else G.options.selectionCopy!=0&&(G.corner.style.display="")}else G.corner.style.top="-2000px",G.corner.style.left="-2000px";(0,s.nK)(G)},S=function(G){const ae=this;let he;if(ae.highlighted&&ae.highlighted.length){he=1;for(let ce=0;ce<ae.highlighted.length;ce++){ae.highlighted[ce].element.classList.remove("highlight"),ae.highlighted[ce].element.classList.remove("highlight-left"),ae.highlighted[ce].element.classList.remove("highlight-right"),ae.highlighted[ce].element.classList.remove("highlight-top"),ae.highlighted[ce].element.classList.remove("highlight-bottom"),ae.highlighted[ce].element.classList.remove("highlight-selected");const oe=parseInt(ae.highlighted[ce].element.getAttribute("data-x")),ye=parseInt(ae.highlighted[ce].element.getAttribute("data-y"));let ke,Pe;if(ae.highlighted[ce].element.getAttribute("data-merged")){const Be=parseInt(ae.highlighted[ce].element.getAttribute("colspan")),Ze=parseInt(ae.highlighted[ce].element.getAttribute("rowspan"));ke=Be>0?oe+(Be-1):oe,Pe=Ze>0?ye+(Ze-1):ye}else ke=oe,Pe=ye;for(let Be=oe;Be<=ke;Be++)ae.headers[Be]&&ae.headers[Be].classList.remove("selected");for(let Be=ye;Be<=Pe;Be++)ae.rows[Be]&&ae.rows[Be].element.classList.remove("selected")}}else he=0;return ae.highlighted=[],ae.selectedCell=null,ae.corner.style.top="-2000px",ae.corner.style.left="-2000px",G==1&&he==1&&p.A.call(ae,"onblur",ae),he},M=function(G,ae,he){const ce=G.getAttribute("data-x"),oe=G.getAttribute("data-y");let ye,ke;ae?(ye=ae.getAttribute("data-x"),ke=ae.getAttribute("data-y")):(ye=ce,ke=oe),a.call(this,ce,oe,ye,ke,he)},l=function(){const G=document.querySelectorAll(".jss_worksheet .copying");for(let ae=0;ae<G.length;ae++)G[ae].classList.remove("copying"),G[ae].classList.remove("copying-left"),G[ae].classList.remove("copying-right"),G[ae].classList.remove("copying-top"),G[ae].classList.remove("copying-bottom")},a=function(G,ae,he,ce,oe){const ye=this;if(ae==null){if(ae=0,ce=ye.rows.length-1,G==null)return}else G==null&&(G=0,he=ye.options.data[0].length-1);he==null&&(he=G),ce==null&&(ce=ae),G>=ye.headers.length&&(G=ye.headers.length-1),ae>=ye.rows.length&&(ae=ye.rows.length-1),he>=ye.headers.length&&(he=ye.headers.length-1),ce>=ye.rows.length&&(ce=ye.rows.length-1);let ke,Pe,Be,Ze,W=null,Le=null,Ye=null,ot=null;parseInt(G)<parseInt(he)?(ke=parseInt(G),Pe=parseInt(he)):(ke=parseInt(he),Pe=parseInt(G)),parseInt(ae)<parseInt(ce)?(Be=parseInt(ae),Ze=parseInt(ce)):(Be=parseInt(ce),Ze=parseInt(ae));for(let Ce=ke;Ce<=Pe;Ce++)for(let Ie=Be;Ie<=Ze;Ie++)if(ye.records[Ie][Ce]&&ye.records[Ie][Ce].element.getAttribute("data-merged")){const Ve=parseInt(ye.records[Ie][Ce].element.getAttribute("data-x")),We=parseInt(ye.records[Ie][Ce].element.getAttribute("data-y")),Xe=parseInt(ye.records[Ie][Ce].element.getAttribute("colspan")),lt=parseInt(ye.records[Ie][Ce].element.getAttribute("rowspan"));Xe>1&&(Ve<ke&&(ke=Ve),Ve+Xe>Pe&&(Pe=Ve+Xe-1)),lt&&(We<Be&&(Be=We),We+lt>Ze&&(Ze=We+lt-1))}for(let Ce=Be;Ce<=Ze;Ce++)ye.rows[Ce].element.style.display!="none"&&(Ye==null&&(Ye=Ce),ot=Ce);for(let Ce=ke;Ce<=Pe;Ce++)for(let Ie=Be;Ie<=Ze;Ie++)ye.options.columns&&ye.options.columns[Ce]&&ye.options.columns[Ce].type=="hidden"||(W==null&&(W=Ce),Le=Ce);if(W||(W=0),Le||(Le=0),p.A.call(ye,"onbeforeselection",ye,W,Ye,Le,ot,oe)===!1)return!1;const Ne=ye.resetSelection();ye.selectedCell=[G,ae,he,ce],ye.records[ae][G]&&ye.records[ae][G].element.classList.add("highlight-selected");for(let Ce=ke;Ce<=Pe;Ce++)for(let Ie=Be;Ie<=Ze;Ie++)ye.rows[Ie].element.style.display!="none"&&ye.records[Ie][Ce].element.style.display!="none"&&(ye.records[Ie][Ce].element.classList.add("highlight"),ye.highlighted.push(ye.records[Ie][Ce]));for(let Ce=W;Ce<=Le;Ce++)ye.options.columns&&ye.options.columns[Ce]&&ye.options.columns[Ce].type=="hidden"||!ye.cols[Ce].colElement.style||ye.cols[Ce].colElement.style.display=="none"||(ye.records[Ye]&&ye.records[Ye][Ce]&&ye.records[Ye][Ce].element.classList.add("highlight-top"),ye.records[ot]&&ye.records[ot][Ce]&&ye.records[ot][Ce].element.classList.add("highlight-bottom"),ye.headers[Ce].classList.add("selected"));for(let Ce=Ye;Ce<=ot;Ce++)ye.rows[Ce]&&ye.rows[Ce].element.style.display!="none"&&(ye.records[Ce][W].element.classList.add("highlight-left"),ye.records[Ce][Le].element.classList.add("highlight-right"),ye.rows[Ce].element.classList.add("selected"));ye.selectedContainer=[W,Ye,Le,ot],Ne==0&&(p.A.call(ye,"onfocus",ye),l()),p.A.call(ye,"onselection",ye,W,Ye,Le,ot,oe),w.call(ye)},h=function(G){const ae=this;if(!ae.selectedCell)return[];const he=[];for(let ce=Math.min(ae.selectedCell[0],ae.selectedCell[2]);ce<=Math.max(ae.selectedCell[0],ae.selectedCell[2]);ce++)G&&ae.headers[ce].style.display=="none"||he.push(ce);return he},f=function(){const G=this;G.selectedCell&&G.updateSelectionFromCoords(G.selectedCell[0],G.selectedCell[1],G.selectedCell[2],G.selectedCell[3])},c=function(){const G=this;for(let ae=0;ae<G.selection.length;ae++)G.selection[ae].classList.remove("selection"),G.selection[ae].classList.remove("selection-left"),G.selection[ae].classList.remove("selection-right"),G.selection[ae].classList.remove("selection-top"),G.selection[ae].classList.remove("selection-bottom");G.selection=[]},v=function(G){return(G=""+G).length==1&&(G="0"+G),G},j=function(G,ae){const he=this,ce=he.getData(!0,!1),oe=he.selectedContainer,ye=parseInt(G.getAttribute("data-x")),ke=parseInt(G.getAttribute("data-y")),Pe=parseInt(ae.getAttribute("data-x")),Be=parseInt(ae.getAttribute("data-y")),Ze=[];let W,Le,Ye=!1;oe[0]==ye?(W=ke<oe[1]?ke-oe[1]:1,Le=0):(Le=ye<oe[0]?ye-oe[0]:1,W=0);let ot=0,Ne=0;for(let Ie=ke;Ie<=Be;Ie++)if(!he.rows[Ie]||he.rows[Ie].element.style.display!="none"){ce[Ne]==null&&(Ne=0),ot=0,oe[0]!=ye&&(Le=ye<oe[0]?ye-oe[0]:1);for(let Ve=ye;Ve<=Pe;Ve++){if(he.records[Ie][Ve]&&!he.records[Ie][Ve].element.classList.contains("readonly")&&he.records[Ie][Ve].element.style.display!="none"&&Ye==0){if(!he.selection.length&&he.options.data[Ie][Ve]!=""){Ye=!0;continue}(ce[Ne]==null||ce[Ne][ot]==null)&&(ot=0);let We=ce[Ne][ot];if(We&&!ce[1]&&he.parent.config.autoIncrement!=0)if(!he.options.columns||!he.options.columns[Ve]||he.options.columns[Ve].type&&he.options.columns[Ve].type!="text"&&he.options.columns[Ve].type!="number"){if(he.options.columns&&he.options.columns[Ve]&&he.options.columns[Ve].type=="calendar"){const Xe=new Date(We);Xe.setDate(Xe.getDate()+W),We=Xe.getFullYear()+"-"+v(parseInt(Xe.getMonth()+1))+"-"+v(Xe.getDate())+" 00:00:00"}}else if((""+We).substr(0,1)=="="){const Xe=We.match(/([A-Z]+[0-9]+)/g);if(Xe){const lt=[];for(let st=0;st<Xe.length;st++){const ft=(0,m.vu)(Xe[st],1);ft[0]+=Le,ft[1]+=W,ft[1]<0&&(ft[1]=0);const vt=(0,m.t3)([ft[0],ft[1]]);vt!=Xe[st]&&(lt[Xe[st]]=vt)}lt&&(We=(0,H.yB)(We,lt))}}else We==Number(We)&&(We=Number(We)+W);Ze.push(H.k9.call(he,Ve,Ie,We)),H.xF.call(he,Ve,Ie,Ze)}ot++,oe[0]!=ye&&Le++}Ne++,W++}X.Dh.call(he,{action:"setValue",records:Ze,selection:he.selectedCell}),H.am.call(he);const Ce=Ze.map(function(Ie){return{x:Ie.x,y:Ie.y,value:Ie.newValue,oldValue:Ie.oldValue}});p.A.call(he,"onafterchanges",he,Ce)},L=function(G){let ae,he,ce=0;if(!G||G.length===0)return ce;for(ae=0;ae<G.length;ae++)he=G.charCodeAt(ae),ce=(ce<<5)-ce+he,ce|=0;return ce},k=function(G,ae,he){const ce=this;if(G==1){if(ce.selectedCell&&(ae>=ce.selectedCell[1]&&ae<=ce.selectedCell[3]||he>=ce.selectedCell[1]&&he<=ce.selectedCell[3]))return void ce.resetSelection()}else if(ce.selectedCell&&(ae>=ce.selectedCell[0]&&ae<=ce.selectedCell[2]||he>=ce.selectedCell[0]&&he<=ce.selectedCell[2]))return void ce.resetSelection()},N=function(G){const ae=this;if(!ae.selectedCell)return[];const he=[];for(let ce=Math.min(ae.selectedCell[1],ae.selectedCell[3]);ce<=Math.max(ae.selectedCell[1],ae.selectedCell[3]);ce++)G&&ae.rows[ce].element.style.display=="none"||he.push(ce);return he},D=function(){const G=this;G.selectedCell||(G.selectedCell=[]),G.selectedCell[0]=0,G.selectedCell[1]=0,G.selectedCell[2]=G.headers.length-1,G.selectedCell[3]=G.records.length-1,G.updateSelectionFromCoords(G.selectedCell[0],G.selectedCell[1],G.selectedCell[2],G.selectedCell[3])},O=function(){const G=this;return G.selectedCell?[Math.min(G.selectedCell[0],G.selectedCell[2]),Math.min(G.selectedCell[1],G.selectedCell[3]),Math.max(G.selectedCell[0],G.selectedCell[2]),Math.max(G.selectedCell[1],G.selectedCell[3])]:null},Y=function(G){const ae=this,he=O.call(ae);if(!he)return[];const ce=[];for(let oe=he[1];oe<=he[3];oe++)for(let ye=he[0];ye<=he[2];ye++)G?ce.push((0,T.getCellNameFromCoords)(ye,oe)):ce.push(ae.records[oe][ye]);return ce},V=function(){const G=this,ae=O.call(G);if(!ae)return"";const he=(0,T.getCellNameFromCoords)(ae[0],ae[1]),ce=(0,T.getCellNameFromCoords)(ae[2],ae[3]);return he===ce?G.options.worksheetName+"!"+he:G.options.worksheetName+"!"+he+":"+ce},ue=function(G,ae){const he=O.call(this);return G>=he[0]&&G<=he[2]&&ae>=he[1]&&ae<=he[3]},ge=function(){const G=O.call(this);return G?[G]:[]}},392:function(n,g,o){o.d(g,{Ar:function(){return S},ll:function(){return w},nK:function(){return s}});var p=o(978),E=o(530);const T=function(M,l){l.options.editable!=0?M.classList.remove("jtoolbar-disabled"):M.classList.add("jtoolbar-disabled")},X=function(){const M=[],l=this,a=function(){return E.eN.call(l)};M.push({content:"undo",onclick:function(){a().undo()}}),M.push({content:"redo",onclick:function(){a().redo()}}),M.push({content:"save",onclick:function(){const f=a();f&&f.download()}}),M.push({type:"divisor"}),M.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(f){return'<span style="font-family:'+f+'">'+f+"</span>"},onchange:function(f,c,v,j,L){const k=a();let N=k.getSelected(!0);if(N){let D=L?j:"";k.setStyle(Object.fromEntries(N.map(function(O){return[O,"font-family: "+D]})))}},updateState:function(f,c,v){T(v,a())}}),M.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(f){return'<span style="font-size:'+f+'">'+f+"</span>"},onchange:function(f,c,v,j){const L=a();let k=L.getSelected(!0);k&&L.setStyle(Object.fromEntries(k.map(function(N){return[N,"font-size: "+j]})))},updateState:function(f,c,v){T(v,a())}}),M.push({type:"select",options:["left","center","right","justify"],render:function(f){return'<i class="material-icons">format_align_'+f+"</i>"},onchange:function(f,c,v,j){const L=a();let k=L.getSelected(!0);k&&L.setStyle(Object.fromEntries(k.map(function(N){return[N,"text-align: "+j]})))},updateState:function(f,c,v){T(v,a())}}),M.push({content:"format_bold",onclick:function(f,c,v){const j=a();let L=j.getSelected(!0);L&&j.setStyle(Object.fromEntries(L.map(function(k){return[k,"font-weight:bold"]})))},updateState:function(f,c,v){T(v,a())}}),M.push({type:"color",content:"format_color_text",k:"color",updateState:function(f,c,v){T(v,a())}}),M.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(f,c,v,j){T(v,a())}});let h=["top","middle","bottom"];return M.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(f){return'<i class="material-icons">'+f+"</i>"},value:1,onchange:function(f,c,v,j,L){const k=a();let N=k.getSelected(!0);N&&k.setStyle(Object.fromEntries(N.map(function(D){return[D,"vertical-align: "+h[L]]})))},updateState:function(f,c,v){T(v,a())}}),M.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const f=a();if(f.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const c=[Math.min(f.selectedCell[0],f.selectedCell[2]),Math.min(f.selectedCell[1],f.selectedCell[3]),Math.max(f.selectedCell[0],f.selectedCell[2]),Math.max(f.selectedCell[1],f.selectedCell[3])];let v=(0,p.getCellNameFromCoords)(c[0],c[1]);if(f.records[c[1]][c[0]].element.getAttribute("data-merged"))f.removeMerge(v);else{let j=c[2]-c[0]+1,L=c[3]-c[1]+1;j===1&&L===1||f.setMerge(v,j,L)}}},updateState:function(f,c,v){T(v,a())}}),M.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(f){return'<i class="material-icons">'+f+"</i>"},right:!0,onchange:function(f,c,v,j){const L=a();if(L.selectedCell){const k=[Math.min(L.selectedCell[0],L.selectedCell[2]),Math.min(L.selectedCell[1],L.selectedCell[3]),Math.max(L.selectedCell[0],L.selectedCell[2]),Math.max(L.selectedCell[1],L.selectedCell[3])];let N=j;if(k){let D=c.thickness||1,O=c.color||"black";const Y=c.style||"solid";Y==="double"&&(D+=2);let V={},ue=k[0],ge=k[1],G=k[2],ae=k[3];const he=function(ce,oe,ye){let ke=["","","",""];ke[0]=(N==="border_top"||N==="border_outer")&&ye===ge||(N==="border_inner"||N==="border_horizontal")&&ye>ge||N==="border_all"?"border-top: "+D+"px "+Y+" "+O:"border-top: ",ke[1]=N!=="border_all"&&N!=="border_right"&&N!=="border_outer"||oe!==G?"border-right: ":"border-right: "+D+"px "+Y+" "+O,ke[2]=N!=="border_all"&&N!=="border_bottom"&&N!=="border_outer"||ye!==ae?"border-bottom: ":"border-bottom: "+D+"px "+Y+" "+O,ke[3]=(N==="border_left"||N==="border_outer")&&oe===ue||(N==="border_inner"||N==="border_vertical")&&oe>ue||N==="border_all"?"border-left: "+D+"px "+Y+" "+O:"border-left: ",V[ce]=ke.join(";")};for(let ce=k[1];ce<=k[3];ce++)for(let oe=k[0];oe<=k[2];oe++)he((0,p.getCellNameFromCoords)(oe,ce),oe,ce),L.records[ce][oe].element.getAttribute("data-merged")&&he((0,p.getCellNameFromCoords)(k[0],k[1]),oe,ce);Object.keys(V)&&L.setStyle(V)}}},onload:function(f,c){let v=document.createElement("div"),j=document.createElement("div");v.appendChild(j);let L=jSuites.color(j,{closeOnChange:!1,onchange:function(D,O){D.parentNode.children[1].style.color=O,c.color=O}}),k=document.createElement("i");k.classList.add("material-icons"),k.innerHTML="color_lens",k.onclick=function(){L.open()},v.appendChild(k),f.children[1].appendChild(v),j=document.createElement("div"),jSuites.picker(j,{type:"select",data:[1,2,3,4,5],render:function(D){return'<div style="height: '+D+'px; width: 30px; background-color: black;"></div>'},onchange:function(D,O,Y,V){c.thickness=V},width:"50px"}),f.children[1].appendChild(j);const N=document.createElement("div");jSuites.picker(N,{type:"select",data:["solid","dotted","dashed","double"],render:function(D){return D==="double"?'<div style="width: 30px; border-top: 3px '+D+' black;"></div>':'<div style="width: 30px; border-top: 2px '+D+' black;"></div>'},onchange:function(D,O,Y,V){c.style=V},width:"50px"}),f.children[1].appendChild(N),j=document.createElement("div"),j.style.flex="1",f.children[1].appendChild(j)},updateState:function(f,c,v){T(v,a())}}),M.push({type:"divisor"}),M.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(f,c,v){v.children[0].textContent==="fullscreen"?(l.fullscreen(!0),v.children[0].textContent="fullscreen_exit"):(l.fullscreen(!1),v.children[0].textContent="fullscreen")},updateState:function(f,c,v,j){j.parent.config.fullscreen===!0?v.children[0].textContent="fullscreen_exit":v.children[0].textContent="fullscreen"}}),M},H=function(M){const l=this,a=M.items;for(let h=0;h<a.length;h++)a[h].tooltip&&(a[h].title=a[h].tooltip,delete a[h].tooltip),a[h].type=="select"?a[h].options?(a[h].data=a[h].options,delete a[h].options):(a[h].data=a[h].v,delete a[h].v,a[h].k&&!a[h].onchange&&(a[h].onchange=function(f,c,v){const j=E.eN.call(l),L=j.getSelected(!0);j.setStyle(Object.fromEntries(L.map(function(k){return[k,a[h].k+": "+v]})))})):a[h].type=="color"&&(a[h].type="i",a[h].onclick=function(f,c,v){v.color||(jSuites.color(v,{onchange:function(j,L){const k=E.eN.call(l),N=k.getSelected(!0);k.setStyle(Object.fromEntries(N.map(function(D){return[D,a[h].k+": "+L]})))},onopen:function(j){j.color.select("")}}),v.color.open())})},m=function(M){const l=this,a=document.createElement("div");return a.classList.add("jss_toolbar"),H.call(l,M),typeof l.plugins=="object"&&Object.entries(l.plugins).forEach(function([,h]){if(typeof h.toolbar=="function"){const f=h.toolbar(M);f&&(M=f)}}),jSuites.toolbar(a,M),a},s=function(M){M.parent.toolbar&&M.parent.toolbar.toolbar.update(M)},w=function(){const M=this;if(M.config.toolbar&&!M.toolbar){let l;Array.isArray(M.config.toolbar)?l={items:M.config.toolbar}:typeof M.config.toolbar=="object"?l=M.config.toolbar:(l={items:X.call(M)},typeof M.config.toolbar=="function"&&(l=M.config.toolbar(l))),M.toolbar=M.element.insertBefore(m.call(M,l),M.element.children[1])}},S=function(){const M=this;M.toolbar&&(M.toolbar.parentNode.removeChild(M.toolbar),delete M.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(n){var g=__webpack_module_cache__[n];if(g!==void 0)return g.exports;var o=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](o,o.exports,__webpack_require__),o.exports}__webpack_require__.d=function(n,g){for(var o in g)__webpack_require__.o(g,o)&&!__webpack_require__.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:g[o]})},__webpack_require__.o=function(n,g){return Object.prototype.hasOwnProperty.call(n,g)},__webpack_require__.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return src}});const lib={jspreadsheet:{}};var libraryBase=lib,dispatch=__webpack_require__(805),internal=__webpack_require__(530),utils_history=__webpack_require__(911);const openEditor=function(n,g,o){const p=this,E=n.getAttribute("data-y"),T=n.getAttribute("data-x");dispatch.A.call(p,"oneditionstart",p,n,parseInt(T),parseInt(E)),T>0&&(p.records[E][T-1].element.style.overflow="hidden");const X=function(H){const m=n.getBoundingClientRect(),s=document.createElement(H);return s.style.width=m.width+"px",s.style.height=m.height-2+"px",s.style.minHeight=m.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(s),s};if(n.classList.contains("readonly")!=1){if(p.edition=[p.records[E][T].element,p.records[E][T].element.innerHTML,T,E],p.options.columns&&p.options.columns[T]&&typeof p.options.columns[T].type=="object")p.options.columns[T].type.openEditor(n,p.options.data[E][T],parseInt(T),parseInt(E),p,p.options.columns[T],o),dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]);else if(!(p.options.columns&&p.options.columns[T]&&p.options.columns[T].type=="hidden"))if(p.options.columns&&p.options.columns[T]&&(p.options.columns[T].type=="checkbox"||p.options.columns[T].type=="radio")){const H=!n.children[0].checked;p.setValue(n,H),p.edition=null}else if(p.options.columns&&p.options.columns[T]&&p.options.columns[T].type=="dropdown"){let H,m=p.options.data[E][T];p.options.columns[T].multiple&&!Array.isArray(m)&&(m=m.split(";")),H=typeof p.options.columns[T].filter=="function"?p.options.columns[T].filter(p.element,n,T,E,p.options.columns[T].source):p.options.columns[T].source;const s=[];if(H)for(let M=0;M<H.length;M++)s.push(H[M]);const w=X("div");dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]);const S={data:s,multiple:!!p.options.columns[T].multiple,autocomplete:!!p.options.columns[T].autocomplete,opened:!0,value:m,width:"100%",height:w.style.minHeight,position:p.options.tableOverflow==1||p.parent.config.fullscreen==1,onclose:function(){closeEditor.call(p,n,!0)}};p.options.columns[T].options&&p.options.columns[T].options.type&&(S.type=p.options.columns[T].options.type),jSuites.dropdown(w,S)}else if(p.options.columns&&p.options.columns[T]&&(p.options.columns[T].type=="calendar"||p.options.columns[T].type=="color")){const H=p.options.data[E][T],m=X("input");dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]),m.value=H;const s=p.options.columns[T].options?{...p.options.columns[T].options}:{};if(p.options.tableOverflow!=1&&p.parent.config.fullscreen!=1||(s.position=!0),s.value=p.options.data[E][T],s.opened=!0,s.onclose=function(w,S){closeEditor.call(p,n,!0)},p.options.columns[T].type=="color"){jSuites.color(m,s);const w=n.getBoundingClientRect();s.position&&(m.nextSibling.children[1].style.top=w.top+w.height+"px",m.nextSibling.children[1].style.left=w.left+"px")}else s.format||(s.format="YYYY-MM-DD"),jSuites.calendar(m,s);m.focus()}else if(p.options.columns&&p.options.columns[T]&&p.options.columns[T].type=="html"){const H=p.options.data[E][T],m=X("div");dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]),m.style.position="relative";const s=document.createElement("div");s.classList.add("jss_richtext"),m.appendChild(s),jSuites.editor(s,{focus:!0,value:H});const w=n.getBoundingClientRect(),S=s.getBoundingClientRect();window.innerHeight<w.bottom+S.height?s.style.top=w.bottom-(S.height+2)+"px":s.style.top=w.top+"px",window.innerWidth<w.left+S.width?s.style.left=w.right-(S.width+2)+"px":s.style.left=w.left+"px"}else if(p.options.columns&&p.options.columns[T]&&p.options.columns[T].type=="image"){const H=n.children[0],m=X("div");dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]),m.style.position="relative";const s=document.createElement("div");s.classList.add("jclose"),H&&H.src&&s.appendChild(H),m.appendChild(s),jSuites.image(s,p.options.columns[T]);const w=n.getBoundingClientRect(),S=s.getBoundingClientRect();window.innerHeight<w.bottom+S.height?s.style.top=w.top-(S.height+2)+"px":s.style.top=w.top+"px",s.style.left=w.left+"px"}else{const H=g==1?"":p.options.data[E][T];let m;m=p.options.columns&&p.options.columns[T]&&p.options.columns[T].wordWrap==0||!(p.options.wordWrap==1||p.options.columns&&p.options.columns[T]&&p.options.columns[T].wordWrap==1)?X("input"):X("textarea"),dispatch.A.call(p,"oncreateeditor",p,n,parseInt(T),parseInt(E),null,p.options.columns[T]),m.focus(),m.value=H;const s=p.options.columns&&p.options.columns[T];if(!(0,internal.dw)(H)&&s){const w=(0,internal.rS)(s);if(w){if(!s.disabledMaskOnEdition)if(s.mask){const S=s.mask.split(";");m.setAttribute("data-mask",S[0])}else s.locale&&m.setAttribute("data-locale",s.locale);w.input=m,m.mask=w,jSuites.mask.render(H,w,!1)}}m.onblur=function(){closeEditor.call(p,n,!0)},m.scrollLeft=m.scrollWidth}}},closeEditor=function(n,g){const o=this,p=parseInt(n.getAttribute("data-x")),E=parseInt(n.getAttribute("data-y"));let T;if(g==1){if(o.options.columns&&o.options.columns[p]&&typeof o.options.columns[p].type=="object")T=o.options.columns[p].type.closeEditor(n,g,parseInt(p),parseInt(E),o,o.options.columns[p]);else if(!(o.options.columns&&o.options.columns[p]&&(o.options.columns[p].type=="checkbox"||o.options.columns[p].type=="radio"||o.options.columns[p].type=="hidden")))if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="dropdown")T=n.children[0].dropdown.close(!0);else if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="calendar")T=n.children[0].calendar.close(!0);else if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="color")T=n.children[0].color.close(!0);else if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="html")T=n.children[0].children[0].editor.getData();else if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="image"){const X=n.children[0].children[0].children[0];T=X&&X.tagName=="IMG"?X.src:""}else if(o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="numeric")T=n.children[0].value,(""+T).substr(0,1)!="="&&T==""&&(T=o.options.columns[p].allowEmpty?"":0),n.children[0].onblur=null;else{T=n.children[0].value,n.children[0].onblur=null;const X=o.options.columns&&o.options.columns[p];if(X){const H=(0,internal.rS)(X);if(H&&T!==""&&!(0,internal.dw)(T)&&typeof T!="number"){const m=jSuites.mask.extract(T,H,!0);m&&m.value!==""&&(T=m.value)}}}o.options.data[E][p]==T?n.innerHTML=o.edition[1]:o.setValue(n,T)}else o.options.columns&&o.options.columns[p]&&typeof o.options.columns[p].type=="object"?o.options.columns[p].type.closeEditor(n,g,parseInt(p),parseInt(E),o,o.options.columns[p]):o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="dropdown"?n.children[0].dropdown.close(!0):o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="calendar"?n.children[0].calendar.close(!0):o.options.columns&&o.options.columns[p]&&o.options.columns[p].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=o.edition&&o.edition[1]?o.edition[1]:"";dispatch.A.call(o,"oneditionend",o,n,p,E,T,g),n.classList.remove("editor"),o.edition=null},setCheckRadioValue=function(){const n=this,g=[],o=Object.keys(n.highlighted);for(let p=0;p<o.length;p++){const E=n.highlighted[p].element.getAttribute("data-x"),T=n.highlighted[p].element.getAttribute("data-y");n.options.columns[E].type!="checkbox"&&n.options.columns[E].type!="radio"||g.push(internal.k9.call(n,E,T,!n.options.data[T][E]))}if(g.length){utils_history.Dh.call(n,{action:"setValue",records:g,selection:n.selectedCell});const p=g.map(function(E){return{x:E.x,y:E.y,value:E.newValue,oldValue:E.oldValue}});dispatch.A.call(n,"onafterchanges",n,p)}};var lazyLoading=__webpack_require__(497);const upGet=function(n,g){const o=this;n=parseInt(n);for(let p=(g=parseInt(g))-1;p>=0;p--)if(o.records[p][n].element.style.display!="none"&&o.rows[p].element.style.display!="none"){if(o.records[p][n].element.getAttribute("data-merged")&&o.records[p][n].element==o.records[g][n].element)continue;g=p;break}return g},upVisible=function(n,g){const o=this;let p,E;if(n==0?(p=parseInt(o.selectedCell[0]),E=parseInt(o.selectedCell[1])):(p=parseInt(o.selectedCell[2]),E=parseInt(o.selectedCell[3])),g==0){for(let T=0;T<E;T++)if(o.records[T][p].element.style.display!="none"&&o.rows[T].element.style.display!="none"){E=T;break}}else E=upGet.call(o,p,E);n==0?(o.selectedCell[0]=p,o.selectedCell[1]=E):(o.selectedCell[2]=p,o.selectedCell[3]=E)},up=function(n,g){const o=this;if(n?o.selectedCell[3]>0&&upVisible.call(o,1,g?0:1):(o.selectedCell[1]>0&&upVisible.call(o,0,g?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),o.options.lazyLoading==1)if(o.selectedCell[1]==0||o.selectedCell[3]==0)lazyLoading.wu.call(o,0),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]);else if(lazyLoading.AG.call(o))o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]);else{const p=parseInt(o.tbody.firstChild.getAttribute("data-y"));o.selectedCell[1]-p<30&&(lazyLoading.G_.call(o),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]))}else if(o.options.pagination>0){const p=o.whichPage(o.selectedCell[3]);p!=o.pageNumber&&o.page(p)}internal.Rs.call(o,1)},rightGet=function(n,g){const o=this;n=parseInt(n),g=parseInt(g);for(let p=n+1;p<o.headers.length;p++)if(o.records[g][p].element.style.display!="none"){if(o.records[g][p].element.getAttribute("data-merged")&&o.records[g][p].element==o.records[g][n].element)continue;n=p;break}return n},rightVisible=function(n,g){const o=this;let p,E;if(n==0?(p=parseInt(o.selectedCell[0]),E=parseInt(o.selectedCell[1])):(p=parseInt(o.selectedCell[2]),E=parseInt(o.selectedCell[3])),g==0){for(let T=o.headers.length-1;T>p;T--)if(o.records[E][T].element.style.display!="none"){p=T;break}}else p=rightGet.call(o,p,E);n==0?(o.selectedCell[0]=p,o.selectedCell[1]=E):(o.selectedCell[2]=p,o.selectedCell[3]=E)},right=function(n,g){const o=this;n?o.selectedCell[2]<o.headers.length-1&&rightVisible.call(o,1,g?0:1):(o.selectedCell[0]<o.headers.length-1&&rightVisible.call(o,0,g?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,2)},downGet=function(n,g){const o=this;n=parseInt(n);for(let p=(g=parseInt(g))+1;p<o.rows.length;p++)if(o.records[p][n].element.style.display!="none"&&o.rows[p].element.style.display!="none"){if(o.records[p][n].element.getAttribute("data-merged")&&o.records[p][n].element==o.records[g][n].element)continue;g=p;break}return g},downVisible=function(n,g){const o=this;let p,E;if(n==0?(p=parseInt(o.selectedCell[0]),E=parseInt(o.selectedCell[1])):(p=parseInt(o.selectedCell[2]),E=parseInt(o.selectedCell[3])),g==0){for(let T=o.rows.length-1;T>E;T--)if(o.records[T][p].element.style.display!="none"&&o.rows[T].element.style.display!="none"){E=T;break}}else E=downGet.call(o,p,E);n==0?(o.selectedCell[0]=p,o.selectedCell[1]=E):(o.selectedCell[2]=p,o.selectedCell[3]=E)},down=function(n,g){const o=this;if(n?o.selectedCell[3]<o.records.length-1&&downVisible.call(o,1,g?0:1):(o.selectedCell[1]<o.records.length-1&&downVisible.call(o,0,g?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),o.options.lazyLoading==1)o.selectedCell[1]==o.records.length-1||o.selectedCell[3]==o.records.length-1?(lazyLoading.wu.call(o,-1),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3])):lazyLoading.AG.call(o)?o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]):parseInt(o.tbody.lastChild.getAttribute("data-y"))-o.selectedCell[3]<30&&(lazyLoading.p6.call(o),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]));else if(o.options.pagination>0){const p=o.whichPage(o.selectedCell[3]);p!=o.pageNumber&&o.page(p)}internal.Rs.call(o,3)},leftGet=function(n,g){const o=this;n=parseInt(n),g=parseInt(g);for(let p=n-1;p>=0;p--)if(o.records[g][p].element.style.display!="none"){if(o.records[g][p].element.getAttribute("data-merged")&&o.records[g][p].element==o.records[g][n].element)continue;n=p;break}return n},leftVisible=function(n,g){const o=this;let p,E;if(n==0?(p=parseInt(o.selectedCell[0]),E=parseInt(o.selectedCell[1])):(p=parseInt(o.selectedCell[2]),E=parseInt(o.selectedCell[3])),g==0){for(let T=0;T<p;T++)if(o.records[E][T].element.style.display!="none"){p=T;break}}else p=leftGet.call(o,p,E);n==0?(o.selectedCell[0]=p,o.selectedCell[1]=E):(o.selectedCell[2]=p,o.selectedCell[3]=E)},left=function(n,g){const o=this;n?o.selectedCell[2]>0&&leftVisible.call(o,1,g?0:1):(o.selectedCell[0]>0&&leftVisible.call(o,0,g?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,0)},first=function(n,g){const o=this;if(n?g?o.selectedCell[3]=0:leftVisible.call(o,1,0):(g?o.selectedCell[1]=0:leftVisible.call(o,0,0),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.options.lazyLoading!=1||o.selectedCell[1]!=0&&o.selectedCell[3]!=0){if(o.options.pagination>0){const p=o.whichPage(o.selectedCell[3]);p!=o.pageNumber&&o.page(p)}}else lazyLoading.wu.call(o,0);o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,1)},last=function(n,g){const o=this;if(n?g?o.selectedCell[3]=o.records.length-1:rightVisible.call(o,1,0):(g?o.selectedCell[1]=o.records.length-1:rightVisible.call(o,0,0),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),o.options.lazyLoading!=1||o.selectedCell[1]!=o.records.length-1&&o.selectedCell[3]!=o.records.length-1){if(o.options.pagination>0){const p=o.whichPage(o.selectedCell[3]);p!=o.pageNumber&&o.page(p)}}else lazyLoading.wu.call(o,-1);o.updateSelectionFromCoords(o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),internal.Rs.call(o,3)};var merges=__webpack_require__(910),selection=__webpack_require__(657),helpers=__webpack_require__(978),internalHelpers=__webpack_require__(689);const copy=function(n,g,o,p,E,T,X){const H=this;g||(g="	");const m=new RegExp(g,"ig"),s=[];let w=[],S=[];const M=[],l=[],a=H.options.data[0].length,h=H.options.data.length;let f="",c=!1,v="",j="",L=0,k=0,N=0;for(let Y=0;Y<h;Y++)for(let V=0;V<a;V++)n&&!H.records[Y][V].element.classList.contains("highlight")||N<=Y&&(N=Y);if(E&&(H.parent.config.includeHeadersOnDownload==1||p)){if(H.options.nestedHeaders&&H.options.nestedHeaders.length>0){f=H.options.nestedHeaders;for(let Y=0;Y<f.length;Y++){const V=[];for(let ue=0;ue<f[Y].length;ue++){const ge=parseInt(f[Y][ue].colspan);V.push(f[Y][ue].title);for(let G=0;G<ge-1;G++)V.push("")}j+=V.join(g)+`\r
`}}c=!0}H.style=[];for(let Y=0;Y<h;Y++){w=[],S=[];for(let V=0;V<a;V++)if(!n||H.records[Y][V].element.classList.contains("highlight")){c==1&&s.push(H.headers[V].textContent);let ue,ge=H.options.data[Y][V];ge.match&&(ge.match(m)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge=ge.replace(new RegExp('"',"g"),'""'),ge='"'+ge+'"'),w.push(ge),H.options.columns&&H.options.columns[V]&&(H.options.columns[V].type=="checkbox"||H.options.columns[V].type=="radio")?ue=ge:(ue=H.records[Y][V].element.innerHTML,ue.match&&(ue.match(m)||ue.match(/,/g)||ue.match(/\n/)||ue.match(/\"/))&&(ue=ue.replace(new RegExp('"',"g"),'""'),ue='"'+ue+'"')),S.push(ue),f=H.records[Y][V].element.getAttribute("style"),f=f.replace("display: none;",""),H.style.push(f||"")}w.length&&(c&&(L=w.length,M.push(s.join(g))),M.push(w.join(g))),S.length&&(k++,c&&(l.push(s.join(g)),c=!1),l.push(S.join(g)))}a==L&&h==k&&(v=j);const D=v+M.join(`\r
`);let O=v+l.join(`\r
`);if(!o){const Y=[Math.min(H.selectedCell[0],H.selectedCell[2]),Math.min(H.selectedCell[1],H.selectedCell[3]),Math.max(H.selectedCell[0],H.selectedCell[2]),Math.max(H.selectedCell[1],H.selectedCell[3])],V=dispatch.A.call(H,"oncopy",H,Y,O,T);if(V)O=V;else if(V===!1)return!1;H.textarea.value=O,H.textarea.select(),document.execCommand("copy")}if(H.data=X==1?O:D,H.hashString=selection.tW.call(H,H.data),!o&&(selection.kA.call(H),H.highlighted))for(let Y=0;Y<H.highlighted.length;Y++)H.highlighted[Y].element.classList.add("copying"),H.highlighted[Y].element.classList.contains("highlight-left")&&H.highlighted[Y].element.classList.add("copying-left"),H.highlighted[Y].element.classList.contains("highlight-right")&&H.highlighted[Y].element.classList.add("copying-right"),H.highlighted[Y].element.classList.contains("highlight-top")&&H.highlighted[Y].element.classList.add("copying-top"),H.highlighted[Y].element.classList.contains("highlight-bottom")&&H.highlighted[Y].element.classList.add("copying-bottom");return H.data},paste=function(n,g,o){const p=this,E=(0,selection.tW)(o);let T=E==p.hashString?p.style:null;E==p.hashString&&(o=p.data),o=(0,helpers.parseCSV)(o,"	");const X=p.selectedCell[2]-n+1,H=p.selectedCell[3]-g+1,m=o[0].length;if(X>1&Number.isInteger(X/m)){const S=X/m;if(T){const l=[];for(let a=0;a<T.length;a+=m){const h=T.slice(a,a+m);for(let f=0;f<S;f++)l.push(...h)}T=l}o=o.map(function(l,a){return Array.apply(null,{length:S*l.length}).map(function(f,c){return l[c%l.length]})})}const s=o.length;if(H>1&Number.isInteger(H/s)){const S=H/s;if(T){const l=[];for(let a=0;a<S;a++)l.push(...T);T=l}o=Array.apply(null,{length:S*s}).map(function(l,a){return o[a%s]})}const w=dispatch.A.call(p,"onbeforepaste",p,o.map(function(S){return S.map(function(M){return{value:M}})}),n,g);if(w===!1)return!1;if(w&&(o=w),n!=null&&g!=null&&o){let S=0,M=0;const l=[],a={},h={};let f=0,c=parseInt(n),v=parseInt(g),j=null;const L=p.headers.slice(c).filter(ge=>ge.style.display==="none").length,k=c+L+o[0].length,N=p.headers.length;k>N&&(p.skipUpdateTableReferences=!0,p.insertColumn(k-N));const D=p.rows.slice(v).filter(ge=>ge.element.style.display==="none").length,O=v+D+o.length,Y=p.rows.length;for(O>Y&&(p.skipUpdateTableReferences=!0,p.insertRow(O-Y)),p.skipUpdateTableReferences&&(p.skipUpdateTableReferences=!1,internal.o8.call(p));j=o[M];){for(S=0,c=parseInt(n);j[S]!=null;){const ge=internal.k9.call(p,c,v,j[S]);if(l.push(ge),internal.xF.call(p,c,v,l),T&&T[f]){const G=(0,internalHelpers.t3)([c,v]);a[G]=T[f],h[G]=p.getStyle(G),p.records[v][c].element.setAttribute("style",T[f]),f++}if(S++,j[S]!=null){if(c>=p.headers.length-1){if(p.options.allowInsertColumn==0)break;p.insertColumn()}c=rightGet.call(p,c,v)}}if(M++,o[M]){if(v>=p.rows.length-1){if(p.options.allowInsertRow==0)break;p.insertRow()}v=downGet.call(p,n,v)}}selection.AH.call(p,n,g,c,v),utils_history.Dh.call(p,{action:"setValue",records:l,selection:p.selectedCell,newStyle:a,oldStyle:h}),internal.am.call(p);const V=[];for(let ge=0;ge<o.length;ge++)for(let G=0;G<o[ge].length;G++)V.push({x:G+n,y:ge+g,value:o[ge][G]});dispatch.A.call(p,"onpaste",p,V);const ue=l.map(function(ge){return{x:ge.x,y:ge.y,value:ge.newValue,oldValue:ge.oldValue}});dispatch.A.call(p,"onafterchanges",p,ue)}(0,selection.kA)()};var filter=__webpack_require__(829),footer=__webpack_require__(160);const getNumberOfColumns=function(){const n=this;let g=n.options.columns&&n.options.columns.length||0;if(n.options.data&&n.options.data[0]!==void 0){const o=Object.keys(n.options.data[0]);o.length>g&&(g=o.length)}return n.options.minDimensions&&n.options.minDimensions[0]>g&&(g=n.options.minDimensions[0]),g},createCellHeader=function(n){const g=this,o=g.options.columns&&g.options.columns[n]&&g.options.columns[n].width||g.options.defaultColWidth||100,p=g.options.columns&&g.options.columns[n]&&g.options.columns[n].align||g.options.defaultColAlign||"center";g.headers[n]=document.createElement("td"),g.headers[n].textContent=g.options.columns&&g.options.columns[n]&&g.options.columns[n].title||(0,helpers.getColumnName)(n),g.headers[n].setAttribute("data-x",n),g.headers[n].style.textAlign=p,g.options.columns&&g.options.columns[n]&&g.options.columns[n].title&&g.headers[n].setAttribute("title",g.headers[n].innerText),g.options.columns&&g.options.columns[n]&&g.options.columns[n].id&&g.headers[n].setAttribute("id",g.options.columns[n].id);const E=document.createElement("col");E.setAttribute("width",o),g.cols[n]={colElement:E,x:n},g.options.columns&&g.options.columns[n]&&g.options.columns[n].type=="hidden"&&(g.headers[n].style.display="none",E.style.display="none")},insertColumn=function(n,g,o,p){const E=this;if(E.options.allowInsertColumn!=0){let T,X=[];Array.isArray(n)?(T=1,n&&(X=n)):T=typeof n=="number"?n:1,o=!!o;const H=Math.max(E.options.columns.length,...E.options.data.map(function(c){return c.length}))-1;(g==null||g>=parseInt(H)||g<0)&&(g=H),p||(p=[]);for(let c=0;c<T;c++)p[c]||(p[c]={});const m=[];if(Array.isArray(n)){const c=[];for(let j=0;j<E.options.data.length;j++)c.push(j<n.length?n[j]:"");const v={column:g+(o?0:1),options:Object.assign({},p[0]),data:c};m.push(v)}else for(let c=0;c<n;c++){const v={column:g+c+(o?0:1),options:Object.assign({},p[c])};m.push(v)}if(dispatch.A.call(E,"onbeforeinsertcolumn",E,m)===!1)return!1;if(E.options.mergeCells&&Object.keys(E.options.mergeCells).length>0&&merges.Lt.call(E,g,o).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;E.destroyMerge()}const s=o?g:g+1;E.options.columns=(0,internalHelpers.Hh)(E.options.columns,s,p);const w=E.headers.splice(s),S=E.cols.splice(s),M=[],l=[],a=[],h=[],f=[];for(let c=s;c<T+s;c++)createCellHeader.call(E,c),E.headerContainer.insertBefore(E.headers[c],E.headerContainer.children[c+1]),E.colgroupContainer.insertBefore(E.cols[c].colElement,E.colgroupContainer.children[c+1]),M.push(E.headers[c]),l.push(E.cols[c]);if(E.options.footers)for(let c=0;c<E.options.footers.length;c++){f[c]=[];for(let v=0;v<T;v++)f[c].push("");E.options.footers[c].splice(s,0,f[c])}for(let c=0;c<E.options.data.length;c++){const v=E.options.data[c].splice(s),j=E.records[c].splice(s);h[c]=[],a[c]=[];for(let L=s;L<T+s;L++){const k=X[c]?X[c]:"";E.options.data[c][L]=k;const N=internal.P9.call(E,L,c,E.options.data[c][L]);E.records[c][L]={element:N,y:c},E.rows[c]&&E.rows[c].element.insertBefore(N,E.rows[c].element.children[L+1]),E.options.columns&&E.options.columns[L]&&typeof E.options.columns[L].render=="function"&&E.options.columns[L].render(N,k,parseInt(L),parseInt(c),E,E.options.columns[L]),h[c].push(k),a[c].push({element:N,x:L,y:c})}Array.prototype.push.apply(E.options.data[c],v),Array.prototype.push.apply(E.records[c],j)}Array.prototype.push.apply(E.headers,w),Array.prototype.push.apply(E.cols,S);for(let c=s;c<E.cols.length;c++)E.cols[c].x=c;for(let c=0;c<E.records.length;c++)for(let v=0;v<E.records[c].length;v++)E.records[c][v].x=v;if(E.options.nestedHeaders&&E.options.nestedHeaders.length>0&&E.options.nestedHeaders[0]&&E.options.nestedHeaders[0][0])for(let c=0;c<E.options.nestedHeaders.length;c++){const v=parseInt(E.options.nestedHeaders[c][E.options.nestedHeaders[c].length-1].colspan)+T;E.options.nestedHeaders[c][E.options.nestedHeaders[c].length-1].colspan=v,E.thead.children[c].children[E.thead.children[c].children.length-1].setAttribute("colspan",v);let j=E.thead.children[c].children[E.thead.children[c].children.length-1].getAttribute("data-column");j=j.split(",");for(let L=s;L<T+s;L++)j.push(L);E.thead.children[c].children[E.thead.children[c].children.length-1].setAttribute("data-column",j)}utils_history.Dh.call(E,{action:"insertColumn",columnNumber:g,numOfColumns:T,insertBefore:o,columns:p,headers:M,cols:l,records:a,footers:f,data:h}),internal.o8.call(E),dispatch.A.call(E,"oninsertcolumn",E,m)}},moveColumn=function(n,g){const o=this;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0){let T;if(T=n>g?1:0,merges.Lt.call(o,n).length||merges.Lt.call(o,g,T).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}}if((n=parseInt(n))>(g=parseInt(g))){o.headerContainer.insertBefore(o.headers[n],o.headers[g]),o.colgroupContainer.insertBefore(o.cols[n].colElement,o.cols[g].colElement);for(let T=0;T<o.rows.length;T++)o.rows[T].element.insertBefore(o.records[T][n].element,o.records[T][g].element)}else{o.headerContainer.insertBefore(o.headers[n],o.headers[g].nextSibling),o.colgroupContainer.insertBefore(o.cols[n].colElement,o.cols[g].colElement.nextSibling);for(let T=0;T<o.rows.length;T++)o.rows[T].element.insertBefore(o.records[T][n].element,o.records[T][g].element.nextSibling)}o.options.columns.splice(g,0,o.options.columns.splice(n,1)[0]),o.headers.splice(g,0,o.headers.splice(n,1)[0]),o.cols.splice(g,0,o.cols.splice(n,1)[0]);const p=Math.min(n,g),E=Math.max(n,g);for(let T=0;T<o.rows.length;T++)o.options.data[T].splice(g,0,o.options.data[T].splice(n,1)[0]),o.records[T].splice(g,0,o.records[T].splice(n,1)[0]);for(let T=p;T<=E;T++)o.cols[T].x=T;for(let T=0;T<o.records.length;T++)for(let X=p;X<=E;X++)o.records[T][X].x=X;if(o.options.footers)for(let T=0;T<o.options.footers.length;T++)o.options.footers[T].splice(g,0,o.options.footers[T].splice(n,1)[0]);utils_history.Dh.call(o,{action:"moveColumn",oldValue:n,newValue:g}),internal.o8.call(o),dispatch.A.call(o,"onmovecolumn",o,n,g,1)},deleteColumn=function(n,g){const o=this;if(o.options.allowDeleteColumn!=0)if(o.headers.length>1){if(n==null){const T=o.getSelectedColumns(!0);T.length?(n=parseInt(T[0]),g=parseInt(T.length)):(n=o.headers.length-1,g=1)}const p=o.options.data[0].length-1;(n==null||n>p||n<0)&&(n=p),g||(g=1),g>o.options.data[0].length-n&&(g=o.options.data[0].length-n);const E=[];for(let T=0;T<g;T++)E.push(T+n);if(dispatch.A.call(o,"onbeforedeletecolumn",o,E)===!1)return!1;if(parseInt(n)>-1){let T=!1;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0)for(let M=n;M<n+g;M++)merges.Lt.call(o,M,null).length&&(T=!0);if(T){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}const X=o.options.columns?o.options.columns.splice(n,g):void 0;for(let M=n;M<n+g;M++)o.cols[M].colElement.className="",o.headers[M].className="",o.cols[M].colElement.parentNode.removeChild(o.cols[M].colElement),o.headers[M].parentNode.removeChild(o.headers[M]);const H=o.headers.splice(n,g),m=o.cols.splice(n,g),s=[],w=[],S=[];for(let M=0;M<o.options.data.length;M++)for(let l=n;l<n+g;l++)o.records[M][l].element.className="",o.records[M][l].element.parentNode.removeChild(o.records[M][l].element);for(let M=0;M<o.options.data.length;M++)w[M]=o.options.data[M].splice(n,g),s[M]=o.records[M].splice(n,g);for(let M=n;M<o.cols.length;M++)o.cols[M].x=M;for(let M=0;M<o.records.length;M++)for(let l=n;l<o.records[M].length;l++)o.records[M][l].x=l;if(o.options.footers)for(let M=0;M<o.options.footers.length;M++)S[M]=o.options.footers[M].splice(n,g);if(selection.at.call(o,0,n,n+g-1),o.options.nestedHeaders&&o.options.nestedHeaders.length>0&&o.options.nestedHeaders[0]&&o.options.nestedHeaders[0][0])for(let M=0;M<o.options.nestedHeaders.length;M++){const l=parseInt(o.options.nestedHeaders[M][o.options.nestedHeaders[M].length-1].colspan)-g;o.options.nestedHeaders[M][o.options.nestedHeaders[M].length-1].colspan=l,o.thead.children[M].children[o.thead.children[M].children.length-1].setAttribute("colspan",l)}utils_history.Dh.call(o,{action:"deleteColumn",columnNumber:n,numOfColumns:g,insertBefore:1,columns:X,headers:H,cols:m,records:s,footers:S,data:w}),internal.o8.call(o),dispatch.A.call(o,"ondeletecolumn",o,E)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},getWidth=function(n){const g=this;let o;if(n===void 0){o=[];for(let p=0;p<g.headers.length;p++)o.push(g.options.columns&&g.options.columns[p]&&g.options.columns[p].width||g.options.defaultColWidth||100)}else o=parseInt(g.cols[n].colElement.getAttribute("width"));return o},setWidth=function(n,g,o){const p=this;if(g){if(Array.isArray(n)){o||(o=[]);for(let E=0;E<n.length;E++){o[E]||(o[E]=parseInt(p.cols[n[E]].colElement.getAttribute("width")));const T=Array.isArray(g)&&g[E]?g[E]:g;p.cols[n[E]].colElement.setAttribute("width",T),p.options.columns||(p.options.columns=[]),p.options.columns[n[E]]||(p.options.columns[n[E]]={}),p.options.columns[n[E]].width=T}}else o||(o=parseInt(p.cols[n].colElement.getAttribute("width"))),p.cols[n].colElement.setAttribute("width",g),p.options.columns||(p.options.columns=[]),p.options.columns[n]||(p.options.columns[n]={}),p.options.columns[n].width=g;utils_history.Dh.call(p,{action:"setWidth",column:n,oldValue:o,newValue:g}),dispatch.A.call(p,"onresizecolumn",p,n,g,o),selection.Aq.call(p)}},showColumn=function(n){const g=this;Array.isArray(n)||(n=[n]);for(let o=0;o<n.length;o++){const p=n[o];g.headers[p].style.display="",g.cols[p].colElement.style.display="",g.filter&&g.filter.children.length>p+1&&(g.filter.children[p+1].style.display="");for(let E=0;E<g.options.data.length;E++)g.records[E][p].element.style.display=""}g.options.footers&&footer.e.call(g),g.resetSelection()},hideColumn=function(n){const g=this;Array.isArray(n)||(n=[n]);for(let o=0;o<n.length;o++){const p=n[o];g.headers[p].style.display="none",g.cols[p].colElement.style.display="none",g.filter&&g.filter.children.length>p+1&&(g.filter.children[p+1].style.display="none");for(let E=0;E<g.options.data.length;E++)g.records[E][p].element.style.display="none"}g.options.footers&&footer.e.call(g),g.resetSelection()},getColumnData=function(n,g){const o=this,p=[];for(let E=0;E<o.options.data.length;E++)g?p.push(o.records[E][n].element.innerHTML):p.push(o.options.data[E][n]);return p},setColumnData=function(n,g,o){const p=this;for(let E=0;E<p.rows.length;E++){const T=(0,internalHelpers.t3)([n,E]);g[E]!=null&&p.setValue(T,g[E],o)}},createRow=function(n,g){const o=this;o.records[n]||(o.records[n]=[]),g||(g=o.options.data[n]);const p={element:document.createElement("tr"),y:n};o.rows[n]=p,p.element.setAttribute("data-y",n);let E=null;o.options.defaultRowHeight&&(p.element.style.height=o.options.defaultRowHeight+"px"),o.options.rows&&o.options.rows[n]&&(o.options.rows[n].height&&(p.element.style.height=o.options.rows[n].height),o.options.rows[n].title&&(E=o.options.rows[n].title)),E||(E=parseInt(n+1));const T=document.createElement("td");T.innerHTML=E,T.setAttribute("data-y",n),T.className="jss_row",p.element.appendChild(T);const X=getNumberOfColumns.call(o);for(let H=0;H<X;H++)o.records[n][H]={element:internal.P9.call(this,H,n,g[H]),x:H,y:n},p.element.appendChild(o.records[n][H].element),o.options.columns&&o.options.columns[H]&&typeof o.options.columns[H].render=="function"&&o.options.columns[H].render(o.records[n][H].element,g[H],parseInt(H),parseInt(n),o,o.options.columns[H]);return p},insertRow=function(n,g,o){const p=this;if(p.options.allowInsertRow!=0){let E,T=[];Array.isArray(n)?(E=1,n&&(T=n)):E=n!==void 0?n:1,o=!!o;const X=p.options.data.length-1;(g==null||g>=parseInt(X)||g<0)&&(g=X);const H=[];for(let h=0;h<E;h++){const f=[];for(let c=0;c<p.options.columns.length;c++)f[c]=T[c]?T[c]:"";H.push({row:h+g+(o?0:1),data:f})}if(dispatch.A.call(p,"onbeforeinsertrow",p,H)===!1)return!1;if(p.options.mergeCells&&Object.keys(p.options.mergeCells).length>0&&merges.D0.call(p,g,o).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;p.destroyMerge()}if(p.options.search==1){if(p.results&&p.results.length!=p.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;p.resetSearch()}p.results=null}const m=o?g:g+1,s=p.records.splice(m),w=p.options.data.splice(m),S=p.rows.splice(m),M=[],l=[],a=[];for(let h=m;h<E+m;h++){p.options.data[h]=[];for(let c=0;c<p.options.columns.length;c++)p.options.data[h][c]=T[c]?T[c]:"";const f=createRow.call(p,h,p.options.data[h]);S[0]?Array.prototype.indexOf.call(p.tbody.children,S[0].element)>=0&&p.tbody.insertBefore(f.element,S[0].element):Array.prototype.indexOf.call(p.tbody.children,p.rows[g].element)>=0&&p.tbody.appendChild(f.element),M.push(p.records[h]),l.push(p.options.data[h]),a.push(f)}Array.prototype.push.apply(p.records,s),Array.prototype.push.apply(p.options.data,w),Array.prototype.push.apply(p.rows,S);for(let h=m;h<p.rows.length;h++)p.rows[h].y=h;for(let h=m;h<p.records.length;h++)for(let f=0;f<p.records[h].length;f++)p.records[h][f].y=h;p.options.pagination>0&&p.page(p.pageNumber),utils_history.Dh.call(p,{action:"insertRow",rowNumber:g,numOfRows:E,insertBefore:o,rowRecords:M,rowData:l,rowNode:a}),internal.o8.call(p),dispatch.A.call(p,"oninsertrow",p,H)}},moveRow=function(n,g,o){const p=this;if(p.options.mergeCells&&Object.keys(p.options.mergeCells).length>0){let X;if(X=n>g?1:0,merges.D0.call(p,n).length||merges.D0.call(p,g,X).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;p.destroyMerge()}}if(p.options.search==1){if(p.results&&p.results.length!=p.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;p.resetSearch()}p.results=null}o||(Array.prototype.indexOf.call(p.tbody.children,p.rows[g].element)>=0?n>g?p.tbody.insertBefore(p.rows[n].element,p.rows[g].element):p.tbody.insertBefore(p.rows[n].element,p.rows[g].element.nextSibling):p.tbody.removeChild(p.rows[n].element)),p.rows.splice(g,0,p.rows.splice(n,1)[0]),p.records.splice(g,0,p.records.splice(n,1)[0]),p.options.data.splice(g,0,p.options.data.splice(n,1)[0]);const E=Math.min(n,g),T=Math.max(n,g);for(let X=E;X<=T;X++)p.rows[X].y=X;for(let X=E;X<=T;X++)for(let H=0;H<p.records[X].length;H++)p.records[X][H].y=X;p.options.pagination>0&&p.tbody.children.length!=p.options.pagination&&p.page(p.pageNumber),utils_history.Dh.call(p,{action:"moveRow",oldValue:n,newValue:g}),internal.o8.call(p),dispatch.A.call(p,"onmoverow",p,parseInt(n),parseInt(g),1)},deleteRow=function(n,g){const o=this;if(o.options.allowDeleteRow!=0)if(o.options.allowDeletingAllRows==1||o.options.data.length>1){if(n==null){const T=selection.R5.call(o);T.length===0?(n=o.options.data.length-1,g=1):(n=T[0],g=T.length)}let p=o.options.data.length-1;(n==null||n>p||n<0)&&(n=p),g||(g=1),n+g>=o.options.data.length&&(g=o.options.data.length-n);const E=[];for(let T=0;T<g;T++)E.push(T+n);if(dispatch.A.call(o,"onbeforedeleterow",o,E)===!1)return!1;if(parseInt(n)>-1){let T=!1;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0)for(let s=n;s<n+g;s++)merges.D0.call(o,s,!1).length&&(T=!0);if(T){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}if(o.options.search==1){if(o.results&&o.results.length!=o.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;o.resetSearch()}o.results=null}o.options.allowDeletingAllRows!=1&&p+1===g&&(g--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let s=n;s<n+g;s++)Array.prototype.indexOf.call(o.tbody.children,o.rows[s].element)>=0&&(o.rows[s].element.className="",o.rows[s].element.parentNode.removeChild(o.rows[s].element));const X=o.records.splice(n,g),H=o.options.data.splice(n,g),m=o.rows.splice(n,g);for(let s=n;s<o.rows.length;s++)o.rows[s].y=s;for(let s=n;s<o.records.length;s++)for(let w=0;w<o.records[s].length;w++)o.records[s][w].y=s;o.options.pagination>0&&o.tbody.children.length!=o.options.pagination&&o.page(o.pageNumber),selection.at.call(o,1,n,n+g-1),utils_history.Dh.call(o,{action:"deleteRow",rowNumber:n,numOfRows:g,insertBefore:1,rowRecords:X,rowData:H,rowNode:m}),internal.o8.call(o),dispatch.A.call(o,"ondeleterow",o,E)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},getHeight=function(n){const g=this;let o;if(n===void 0){o=[];for(let p=0;p<g.rows.length;p++){const E=g.rows[p].element.style.height;E&&(o[p]=E)}}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),o=g.rows[n].element.style.height;return o},setHeight=function(n,g,o){const p=this;g>0&&(o||(o=p.rows[n].element.getAttribute("height"))||(o=p.rows[n].element.getBoundingClientRect().height),g=parseInt(g),p.rows[n].element.style.height=g+"px",p.options.rows||(p.options.rows=[]),p.options.rows[n]||(p.options.rows[n]={}),p.options.rows[n].height=g,utils_history.Dh.call(p,{action:"setHeight",row:n,oldValue:o,newValue:g}),dispatch.A.call(p,"onresizerow",p,n,g,o),selection.Aq.call(p))},showRow=function(n){const g=this;Array.isArray(n)||(n=[n]),n.forEach(function(o){g.rows[o].element.style.display=""})},hideRow=function(n){const g=this;Array.isArray(n)||(n=[n]),n.forEach(function(o){g.rows[o].element.style.display="none"})},getRowData=function(n,g){return g?this.records[n].map(function(o){return o.element.innerHTML}):this.options.data[n]},setRowData=function(n,g,o){const p=this;for(let E=0;E<p.headers.length;E++){const T=(0,internalHelpers.t3)([E,n]);g[E]!=null&&p.setValue(T,g[E],o)}};var version={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const getElement=function(n){let g=0,o=0;return function p(E){E.className&&(E.classList.contains("jss_container")&&(o=E),E.classList.contains("jss_spreadsheet")&&(o=E.querySelector(":scope > .jtabs-content > .jtabs-selected"))),E.tagName=="THEAD"?g=1:E.tagName=="TBODY"&&(g=2),E.parentNode&&(o||p(E.parentNode))}(n),[o,g]},mouseUpControls=function(n){if(libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.current.resizing){if(libraryBase.jspreadsheet.current.resizing.column){const g=parseInt(libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),o=libraryBase.jspreadsheet.current.getSelectedColumns();if(o.length>1){const p=[];for(let E=0;E<o.length;E++)p.push(parseInt(libraryBase.jspreadsheet.current.cols[o[E]].colElement.getAttribute("width")));p[o.indexOf(parseInt(libraryBase.jspreadsheet.current.resizing.column))]=libraryBase.jspreadsheet.current.resizing.width,setWidth.call(libraryBase.jspreadsheet.current,o,g,p)}else setWidth.call(libraryBase.jspreadsheet.current,parseInt(libraryBase.jspreadsheet.current.resizing.column),g,libraryBase.jspreadsheet.current.resizing.width);libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let p=0;p<libraryBase.jspreadsheet.current.records.length;p++)libraryBase.jspreadsheet.current.records[p][libraryBase.jspreadsheet.current.resizing.column]&&libraryBase.jspreadsheet.current.records[p][libraryBase.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let g=libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.getAttribute("height");setHeight.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.resizing.row,g,libraryBase.jspreadsheet.current.resizing.height),libraryBase.jspreadsheet.current.resizing.element.classList.remove("resizing")}libraryBase.jspreadsheet.current.resizing=null}else if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging.column){const g=n.target.getAttribute("data-x");libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let o=0;o<libraryBase.jspreadsheet.current.rows.length;o++)libraryBase.jspreadsheet.current.records[o][libraryBase.jspreadsheet.current.dragging.column]&&libraryBase.jspreadsheet.current.records[o][libraryBase.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let o=0;o<libraryBase.jspreadsheet.current.headers.length;o++)libraryBase.jspreadsheet.current.headers[o].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[o].classList.remove("dragging-right");g&&libraryBase.jspreadsheet.current.dragging.column!=libraryBase.jspreadsheet.current.dragging.destination&&libraryBase.jspreadsheet.current.moveColumn(libraryBase.jspreadsheet.current.dragging.column,libraryBase.jspreadsheet.current.dragging.destination)}else{let g;libraryBase.jspreadsheet.current.dragging.element.nextSibling?(g=parseInt(libraryBase.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row<g&&(g-=1)):g=parseInt(libraryBase.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row!=libraryBase.jspreadsheet.current.dragging.destination&&moveRow.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.dragging.row,g,!0),libraryBase.jspreadsheet.current.dragging.element.classList.remove("dragging")}libraryBase.jspreadsheet.current.dragging=null}}else libraryBase.jspreadsheet.current.selectedCorner&&(libraryBase.jspreadsheet.current.selectedCorner=!1,libraryBase.jspreadsheet.current.selection.length>0&&(selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selection[0],libraryBase.jspreadsheet.current.selection[libraryBase.jspreadsheet.current.selection.length-1]),selection.gG.call(libraryBase.jspreadsheet.current)));libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null),libraryBase.jspreadsheet.isMouseAction=!1},mouseDownControls=function(n){let g;g=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which;const o=getElement(n.target);if(o[0]?libraryBase.jspreadsheet.current!=o[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),libraryBase.jspreadsheet.current.resetSelection()),libraryBase.jspreadsheet.current=o[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),n.target.classList.contains("jss_object")||(selection.gE.call(libraryBase.jspreadsheet.current,!0),libraryBase.jspreadsheet.current=null)),libraryBase.jspreadsheet.current&&g==1){if(n.target.classList.contains("jss_selectall"))libraryBase.jspreadsheet.current&&selection.Ub.call(libraryBase.jspreadsheet.current);else if(n.target.classList.contains("jss_corner"))libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedCorner=!0);else{if(o[1]==1){const p=n.target.getAttribute("data-x");if(p){const E=n.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.columnResize!=0&&E.width-n.offsetX<6){libraryBase.jspreadsheet.current.resizing={mousePosition:n.pageX,column:p,width:E.width},libraryBase.jspreadsheet.current.headers[p].classList.add("resizing");for(let T=0;T<libraryBase.jspreadsheet.current.records.length;T++)libraryBase.jspreadsheet.current.records[T][p]&&libraryBase.jspreadsheet.current.records[T][p].element.classList.add("resizing")}else if(libraryBase.jspreadsheet.current.options.columnDrag!=0&&E.height-n.offsetY<6)if(merges.Lt.call(libraryBase.jspreadsheet.current,p).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:n.target,column:p,destination:p},libraryBase.jspreadsheet.current.headers[p].classList.add("dragging");for(let T=0;T<libraryBase.jspreadsheet.current.records.length;T++)libraryBase.jspreadsheet.current.records[T][p]&&libraryBase.jspreadsheet.current.records[T][p].element.classList.add("dragging")}else{let T,X;libraryBase.jspreadsheet.current.selectedHeader&&(n.shiftKey||n.ctrlKey)?(T=libraryBase.jspreadsheet.current.selectedHeader,X=p):(libraryBase.jspreadsheet.current.selectedHeader==p&&libraryBase.jspreadsheet.current.options.allowRenameColumn!=0&&(libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.setHeader(p)},800)),libraryBase.jspreadsheet.current.selectedHeader=p,T=p,X=p),selection.AH.call(libraryBase.jspreadsheet.current,T,0,X,libraryBase.jspreadsheet.current.options.data.length-1,n)}}else if(n.target.parentNode.classList.contains("jss_nested")){let E,T;if(n.target.getAttribute("data-column")){const X=n.target.getAttribute("data-column").split(",");E=parseInt(X[0]),T=parseInt(X[X.length-1])}else E=0,T=libraryBase.jspreadsheet.current.options.columns.length-1;selection.AH.call(libraryBase.jspreadsheet.current,E,0,T,libraryBase.jspreadsheet.current.options.data.length-1,n)}}else libraryBase.jspreadsheet.current.selectedHeader=!1;if(o[1]==2){const p=parseInt(n.target.getAttribute("data-y"));if(n.target.classList.contains("jss_row")){const E=n.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.rowResize!=0&&E.height-n.offsetY<6)libraryBase.jspreadsheet.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:p,height:E.height},n.target.parentNode.classList.add("resizing");else if(libraryBase.jspreadsheet.current.options.rowDrag!=0&&E.width-n.offsetX<6)merges.D0.call(libraryBase.jspreadsheet.current,p).length?console.error("Jspreadsheet: This row is part of a merged cell"):libraryBase.jspreadsheet.current.options.search==1&&libraryBase.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:n.target.parentNode,row:p,destination:p},n.target.parentNode.classList.add("dragging"));else{let T,X;libraryBase.jspreadsheet.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(T=libraryBase.jspreadsheet.current.selectedRow,X=p):(libraryBase.jspreadsheet.current.selectedRow=p,T=p,X=p),selection.AH.call(libraryBase.jspreadsheet.current,null,T,null,X,n)}}else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else{const E=function(X){const H=X.getAttribute("data-x"),m=X.getAttribute("data-y");return H&&m?[H,m]:X.parentNode?E(X.parentNode):void 0},T=E(n.target);if(T){const X=T[0],H=T[1];libraryBase.jspreadsheet.current.edition&&(libraryBase.jspreadsheet.current.edition[2]==X&&libraryBase.jspreadsheet.current.edition[3]==H||closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0)),libraryBase.jspreadsheet.current.edition||(n.shiftKey?selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],X,H,n):selection.AH.call(libraryBase.jspreadsheet.current,X,H,void 0,void 0,n)),libraryBase.jspreadsheet.current.selectedHeader=null,libraryBase.jspreadsheet.current.selectedRow=null}}}else libraryBase.jspreadsheet.current.selectedRow=!1;n.target.classList.contains("jss_page")&&(n.target.textContent=="<"?libraryBase.jspreadsheet.current.page(0):n.target.textContent==">"?libraryBase.jspreadsheet.current.page(n.target.getAttribute("title")-1):libraryBase.jspreadsheet.current.page(n.target.textContent-1))}libraryBase.jspreadsheet.current.edition?libraryBase.jspreadsheet.isMouseAction=!1:libraryBase.jspreadsheet.isMouseAction=!0}else libraryBase.jspreadsheet.isMouseAction=!1},mouseMoveControls=function(n){let g;if(g=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which,g||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.isMouseAction==1){if(libraryBase.jspreadsheet.current.resizing)if(libraryBase.jspreadsheet.current.resizing.column){const o=n.pageX-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.width+o>0){const p=libraryBase.jspreadsheet.current.resizing.width+o;libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.setAttribute("width",p),selection.Aq.call(libraryBase.jspreadsheet.current)}}else{const o=n.pageY-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.height+o>0){const p=libraryBase.jspreadsheet.current.resizing.height+o;libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.setAttribute("height",p),selection.Aq.call(libraryBase.jspreadsheet.current)}}else if(libraryBase.jspreadsheet.current.dragging)if(libraryBase.jspreadsheet.current.dragging.column){const o=n.target.getAttribute("data-x");if(o)if(merges.Lt.call(libraryBase.jspreadsheet.current,o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let p=0;p<libraryBase.jspreadsheet.current.headers.length;p++)libraryBase.jspreadsheet.current.headers[p].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[p].classList.remove("dragging-right");libraryBase.jspreadsheet.current.dragging.column==o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o):n.target.clientWidth/2>n.offsetX?(libraryBase.jspreadsheet.current.dragging.column<o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o)-1:libraryBase.jspreadsheet.current.dragging.destination=parseInt(o),libraryBase.jspreadsheet.current.headers[o].classList.add("dragging-left")):(libraryBase.jspreadsheet.current.dragging.column<o?libraryBase.jspreadsheet.current.dragging.destination=parseInt(o):libraryBase.jspreadsheet.current.dragging.destination=parseInt(o)+1,libraryBase.jspreadsheet.current.headers[o].classList.add("dragging-right"))}}else{const o=n.target.getAttribute("data-y");if(o)if(merges.D0.call(libraryBase.jspreadsheet.current,o).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const p=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;libraryBase.jspreadsheet.current.dragging.element!=p&&(n.target.parentNode.parentNode.insertBefore(libraryBase.jspreadsheet.current.dragging.element,p),libraryBase.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(libraryBase.jspreadsheet.current.dragging.element.parentNode.children,libraryBase.jspreadsheet.current.dragging.element))}}}else{const o=n.target.getAttribute("data-x"),p=n.target.getAttribute("data-y"),E=n.target.getBoundingClientRect();libraryBase.jspreadsheet.current.cursor&&(libraryBase.jspreadsheet.current.cursor.style.cursor="",libraryBase.jspreadsheet.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&o&&!p&&E.width-(n.clientX-E.left)<6?(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="col-resize"):n.target&&!o&&p&&E.height-(n.clientY-E.top)<6&&(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!o&&p&&E.width-(n.clientX-E.left)<6||n.target&&o&&!p&&E.height-(n.clientY-E.top)<6)&&(libraryBase.jspreadsheet.current.cursor=n.target,libraryBase.jspreadsheet.current.cursor.style.cursor="move"))}},updateCopySelection=function(n,g){const o=this;selection.gG.call(o);const p=o.selectedContainer[0],E=o.selectedContainer[1],T=o.selectedContainer[2],X=o.selectedContainer[3];if(n!=null&&g!=null){let H,m,s,w;n-T>0?(H=parseInt(T)+1,m=parseInt(n)):(H=parseInt(n),m=parseInt(p)-1),g-X>0?(s=parseInt(X)+1,w=parseInt(g)):(s=parseInt(g),w=parseInt(E)-1),m-H<=w-s?(H=parseInt(p),m=parseInt(T)):(s=parseInt(E),w=parseInt(X));for(let S=s;S<=w;S++)for(let M=H;M<=m;M++)o.records[S][M]&&o.rows[S].element.style.display!="none"&&o.records[S][M].element.style.display!="none"&&(o.records[S][M].element.classList.add("selection"),o.records[s][M].element.classList.add("selection-top"),o.records[w][M].element.classList.add("selection-bottom"),o.records[S][H].element.classList.add("selection-left"),o.records[S][m].element.classList.add("selection-right"),o.selection.push(o.records[S][M].element))}},mouseOverControls=function(n){let g;if(g=(n=n||window.event).buttons?n.buttons:n.button?n.button:n.which,g||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.isMouseAction==1){const o=getElement(n.target);if(o[0]){if(libraryBase.jspreadsheet.current!=o[0].jssWorksheet&&libraryBase.jspreadsheet.current)return!1;let p=n.target.getAttribute("data-x");const E=n.target.getAttribute("data-y");if(!(libraryBase.jspreadsheet.current.resizing||libraryBase.jspreadsheet.current.dragging)){if(o[1]==1&&libraryBase.jspreadsheet.current.selectedHeader){p=n.target.getAttribute("data-x");const T=libraryBase.jspreadsheet.current.selectedHeader,X=p;selection.AH.call(libraryBase.jspreadsheet.current,T,0,X,libraryBase.jspreadsheet.current.options.data.length-1,n)}if(o[1]==2)if(n.target.classList.contains("jss_row")){if(libraryBase.jspreadsheet.current.selectedRow){const T=libraryBase.jspreadsheet.current.selectedRow,X=E;selection.AH.call(libraryBase.jspreadsheet.current,0,T,libraryBase.jspreadsheet.current.options.data[0].length-1,X,n)}}else libraryBase.jspreadsheet.current.edition||p&&E&&(libraryBase.jspreadsheet.current.selectedCorner?updateCopySelection.call(libraryBase.jspreadsheet.current,p,E):libraryBase.jspreadsheet.current.selectedCell&&selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],p,E,n))}}}libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null)},doubleClickControls=function(n){if(libraryBase.jspreadsheet.current)if(n.target.classList.contains("jss_corner")){if(libraryBase.jspreadsheet.current.highlighted.length>0){const g=libraryBase.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),o=parseInt(libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,p=libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),E=libraryBase.jspreadsheet.current.records.length-1;selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[o][g].element,libraryBase.jspreadsheet.current.records[E][p].element)}}else if(n.target.classList.contains("jss_column_filter")){const g=n.target.getAttribute("data-x");filter.N$.call(libraryBase.jspreadsheet.current,g)}else{const g=getElement(n.target);if(g[1]==1&&libraryBase.jspreadsheet.current.options.columnSorting!=0){const o=n.target.getAttribute("data-x");o&&libraryBase.jspreadsheet.current.orderBy(parseInt(o))}if(g[1]==2&&libraryBase.jspreadsheet.current.options.editable!=0&&!libraryBase.jspreadsheet.current.edition){const o=function(E){if(E.parentNode){const T=E.getAttribute("data-x"),X=E.getAttribute("data-y");return T&&X?E:o(E.parentNode)}},p=o(n.target);p&&p.classList.contains("highlight")&&openEditor.call(libraryBase.jspreadsheet.current,p,void 0,n)}}},pasteControls=function(n){libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.selectedCell&&(libraryBase.jspreadsheet.current.edition||libraryBase.jspreadsheet.current.options.editable!=0&&(n&&n.clipboardData?(paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},getRole=function(n){if(n.classList.contains("jss_selectall"))return"select-all";if(n.classList.contains("jss_corner"))return"fill-handle";let g=n;for(;!g.classList.contains("jss_spreadsheet");){if(g.classList.contains("jss_row"))return"row";if(g.classList.contains("jss_nested"))return"nested";if(g.classList.contains("jtabs-headers"))return"tabs";if(g.classList.contains("jtoolbar"))return"toolbar";if(g.classList.contains("jss_pagination"))return"pagination";if(g.tagName==="TBODY")return"cell";if(g.tagName==="TFOOT")return getElementIndex(n)===0?"grid":"footer";if(g.tagName==="THEAD")return"header";g=g.parentElement}return"applications"},defaultContextMenu=function(n,g,o,p){const E=[];if(p==="header"&&(n.options.allowInsertColumn!=0&&E.push({title:jSuites.translate("Insert a new column before"),onclick:function(){n.insertColumn(1,parseInt(g),1)}}),n.options.allowInsertColumn!=0&&E.push({title:jSuites.translate("Insert a new column after"),onclick:function(){n.insertColumn(1,parseInt(g),0)}}),n.options.allowDeleteColumn!=0&&E.push({title:jSuites.translate("Delete selected columns"),onclick:function(){n.deleteColumn(n.getSelectedColumns().length?void 0:parseInt(g))}}),n.options.allowRenameColumn!=0&&E.push({title:jSuites.translate("Rename this column"),onclick:function(){const T=n.getHeader(g),X=prompt(jSuites.translate("Column name"),T);n.setHeader(g,X)}}),n.options.columnSorting!=0&&(E.push({type:"line"}),E.push({title:jSuites.translate("Order ascending"),onclick:function(){n.orderBy(g,0)}}),E.push({title:jSuites.translate("Order descending"),onclick:function(){n.orderBy(g,1)}}))),p!=="row"&&p!=="cell"||(n.options.allowInsertRow!=0&&(E.push({title:jSuites.translate("Insert a new row before"),onclick:function(){n.insertRow(1,parseInt(o),1)}}),E.push({title:jSuites.translate("Insert a new row after"),onclick:function(){n.insertRow(1,parseInt(o))}})),n.options.allowDeleteRow!=0&&E.push({title:jSuites.translate("Delete selected rows"),onclick:function(){n.deleteRow(n.getSelectedRows().length?void 0:parseInt(o))}})),p==="cell"&&n.options.allowComments!=0){E.push({type:"line"});const T=n.records[o][g].element.getAttribute("title")||"";E.push({title:jSuites.translate(T?"Edit comments":"Add comments"),onclick:function(){const X=prompt(jSuites.translate("Comments"),T);X&&n.setComments((0,helpers.getCellNameFromCoords)(g,o),X)}}),T&&E.push({title:jSuites.translate("Clear comments"),onclick:function(){n.setComments((0,helpers.getCellNameFromCoords)(g,o),"")}})}return E.length!==0&&E.push({type:"line"}),p!=="header"&&p!=="row"&&p!=="cell"||(E.push({title:jSuites.translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){copy.call(n,!0)}}),navigator&&navigator.clipboard&&E.push({title:jSuites.translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){n.selectedCell&&navigator.clipboard.readText().then(function(T){T&&paste.call(n,n.selectedCell[0],n.selectedCell[1],T)})}})),n.parent.config.allowExport!=0&&E.push({title:jSuites.translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){n.download()}}),n.parent.config.about!=0&&E.push({title:jSuites.translate("About"),onclick:function(){n.parent.config.about===void 0||n.parent.config.about===!0?alert(version.print()):alert(n.parent.config.about)}}),E},getElementIndex=function(n){const g=n.parentElement.children;for(let o=0;o<g.length;o++)if(n===g[o])return o;return-1},contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,libraryBase.jspreadsheet.current){const g=libraryBase.jspreadsheet.current.parent;if(libraryBase.jspreadsheet.current.edition)n.preventDefault();else if(g.contextMenu.contextmenu.close(),libraryBase.jspreadsheet.current){const o=getRole(n.target);let p=null,E=null;if(o==="cell"){let X=n.target;for(;X.tagName!=="TD";)X=X.parentNode;E=X.getAttribute("data-y"),p=X.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||p<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||p>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||E<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||E>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,p,E,p,E,n)}else if(o==="row"||o==="header")o==="row"?E=n.target.getAttribute("data-y"):p=n.target.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||p<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||p>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||E<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||E>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,p,E,p,E,n);else if(o==="nested"){const X=n.target.getAttribute("data-column").split(",");p=getElementIndex(n.target)-1,E=getElementIndex(n.target.parentElement),libraryBase.jspreadsheet.current.selectedCell&&X[0]==parseInt(libraryBase.jspreadsheet.current.selectedCell[0])&&X[X.length-1]==parseInt(libraryBase.jspreadsheet.current.selectedCell[2])&&libraryBase.jspreadsheet.current.selectedCell[1]==null&&libraryBase.jspreadsheet.current.selectedCell[3]==null||selection.AH.call(libraryBase.jspreadsheet.current,X[0],null,X[X.length-1],null,n)}else o==="select-all"?selection.Ub.call(libraryBase.jspreadsheet.current):o==="tabs"?p=getElementIndex(n.target):o==="footer"&&(p=getElementIndex(n.target)-1,E=getElementIndex(n.target.parentElement));let T=defaultContextMenu(libraryBase.jspreadsheet.current,parseInt(p),parseInt(E),o);if(typeof g.config.contextMenu=="function"){const X=g.config.contextMenu(libraryBase.jspreadsheet.current,p,E,n,T,o,p,E);if(X)T=X;else if(X===!1)return}typeof g.plugins=="object"&&Object.entries(g.plugins).forEach(function([,X]){if(typeof X.contextMenu=="function"){const H=X.contextMenu(libraryBase.jspreadsheet.current,p!==null?parseInt(p):null,E!==null?parseInt(E):null,n,T,o,p!==null?parseInt(p):null,E!==null?parseInt(E):null);H&&(T=H)}}),g.contextMenu.contextmenu.open(n,T),n.preventDefault()}}},touchStartControls=function(n){const g=getElement(n.target);if(g[0]?libraryBase.jspreadsheet.current!=g[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=g[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=null),libraryBase.jspreadsheet.current&&!libraryBase.jspreadsheet.current.edition){const o=n.target.getAttribute("data-x"),p=n.target.getAttribute("data-y");o&&p&&(selection.AH.call(libraryBase.jspreadsheet.current,o,p,void 0,void 0,n),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.options.columns[o].type=="color"?libraryBase.jspreadsheet.tmpElement=null:libraryBase.jspreadsheet.tmpElement=n.target,openEditor.call(libraryBase.jspreadsheet.current,n.target,!1,n)},500))}},touchEndControls=function(n){libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null,libraryBase.jspreadsheet.tmpElement&&libraryBase.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&libraryBase.jspreadsheet.tmpElement.children[0].focus(),libraryBase.jspreadsheet.tmpElement=null)},cutControls=function(n){libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition||(copy.call(libraryBase.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),libraryBase.jspreadsheet.current.options.editable!=0&&libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(g){return g.element}),"")))},copyControls=function(n){libraryBase.jspreadsheet.current&&copyControls.enabled&&(libraryBase.jspreadsheet.current.edition||copy.call(libraryBase.jspreadsheet.current,!0))},validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},keyDownControls=function(n){if(libraryBase.jspreadsheet.current){if(libraryBase.jspreadsheet.current.edition)if(n.which==27)libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="calendar")closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else if(!(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="dropdown"))if((libraryBase.jspreadsheet.current.options.wordWrap==1||libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].wordWrap==1||libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]].length>200)&&n.altKey){const g=libraryBase.jspreadsheet.current.edition[0].children[0];let o=libraryBase.jspreadsheet.current.edition[0].children[0].value;const p=g.selectionStart;o=o.slice(0,p)+`
`+o.slice(p),g.value=o,g.focus(),g.selectionStart=p+1,g.selectionEnd=p+1}else libraryBase.jspreadsheet.current.edition[0].children[0].blur()}else n.which==9&&(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type)?closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0):libraryBase.jspreadsheet.current.edition[0].children[0].blur());if(!libraryBase.jspreadsheet.current.edition&&libraryBase.jspreadsheet.current.selectedCell)if(n.which==37)left.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)right.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)up.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)down.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)first.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)last.call(libraryBase.jspreadsheet.current,n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedRow?libraryBase.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&libraryBase.jspreadsheet.current.deleteRow():libraryBase.jspreadsheet.current.selectedHeader?libraryBase.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&libraryBase.jspreadsheet.current.deleteColumn():libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(g){return g.element}),""));else if(n.which==13)n.shiftKey?up.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertRow!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertRow!=0&&libraryBase.jspreadsheet.current.selectedCell[1]==libraryBase.jspreadsheet.current.options.data.length-1&&libraryBase.jspreadsheet.current.insertRow(),down.call(libraryBase.jspreadsheet.current)),n.preventDefault();else if(n.which==9)n.shiftKey?left.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertColumn!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertColumn!=0&&libraryBase.jspreadsheet.current.selectedCell[0]==libraryBase.jspreadsheet.current.options.data[0].length-1&&libraryBase.jspreadsheet.current.insertColumn(),right.call(libraryBase.jspreadsheet.current)),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(libraryBase.jspreadsheet.current.selectedCell&&libraryBase.jspreadsheet.current.options.editable!=0){const g=libraryBase.jspreadsheet.current.selectedCell[1],o=libraryBase.jspreadsheet.current.selectedCell[0];n.keyCode==32?(n.preventDefault(),libraryBase.jspreadsheet.current.options.columns[o].type=="checkbox"||libraryBase.jspreadsheet.current.options.columns[o].type=="radio"?setCheckRadioValue.call(libraryBase.jspreadsheet.current):openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[g][o].element,!0,n)):n.keyCode==113?openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[g][o].element,!1,n):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&validLetter(String.fromCharCode(n.keyCode)))&&(openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[g][o].element,!0,n),libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[o]&&libraryBase.jspreadsheet.current.options.columns[o].type=="calendar"&&n.preventDefault())}}else n.which==65?(selection.Ub.call(libraryBase.jspreadsheet.current),n.preventDefault()):n.which==83?(libraryBase.jspreadsheet.current.download(),n.preventDefault()):n.which==89?(libraryBase.jspreadsheet.current.redo(),n.preventDefault()):n.which==90?(libraryBase.jspreadsheet.current.undo(),n.preventDefault()):n.which==67?(copy.call(libraryBase.jspreadsheet.current,!0),n.preventDefault()):n.which==88?(libraryBase.jspreadsheet.current.options.editable!=0?cutControls():copyControls(),n.preventDefault()):n.which==86&&pasteControls();else n.target.classList.contains("jss_search")&&(libraryBase.jspreadsheet.timeControl&&clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.search(n.target.value)},200))}},wheelControls=function(n){const g=this;g.options.lazyLoading==1&&libraryBase.jspreadsheet.timeControlLoading==null&&(libraryBase.jspreadsheet.timeControlLoading=setTimeout(function(){g.content.scrollTop+g.content.clientHeight>=g.content.scrollHeight-10?lazyLoading.p6.call(g)&&(g.content.scrollTop+g.content.clientHeight>g.content.scrollHeight-10&&(g.content.scrollTop=g.content.scrollTop-g.content.clientHeight),selection.Aq.call(g)):g.content.scrollTop<=g.content.clientHeight&&lazyLoading.G_.call(g)&&(g.content.scrollTop<10&&(g.content.scrollTop=g.content.scrollTop+g.content.clientHeight),selection.Aq.call(g)),libraryBase.jspreadsheet.timeControlLoading=null},100))};let scrollLeft=0;const updateFreezePosition=function(){const n=this;scrollLeft=n.content.scrollLeft;let g=0;if(scrollLeft>50)for(let o=0;o<n.options.freezeColumns;o++){if(o>0&&(!n.options.columns||!n.options.columns[o-1]||n.options.columns[o-1].type!=="hidden")){let p;p=n.options.columns&&n.options.columns[o-1]&&n.options.columns[o-1].width!==void 0?parseInt(n.options.columns[o-1].width):n.options.defaultColWidth!==void 0?parseInt(n.options.defaultColWidth):100,g+=parseInt(p)}n.headers[o].classList.add("jss_freezed"),n.headers[o].style.left=g+"px";for(let p=0;p<n.rows.length;p++)if(n.rows[p]&&n.records[p][o]){const E=scrollLeft+(o>0?n.records[p][o-1].element.style.width:0)-51+"px";n.records[p][o].element.classList.add("jss_freezed"),n.records[p][o].element.style.left=E}}else for(let o=0;o<n.options.freezeColumns;o++){n.headers[o].classList.remove("jss_freezed"),n.headers[o].style.left="";for(let p=0;p<n.rows.length;p++)n.records[p][o]&&(n.records[p][o].element.classList.remove("jss_freezed"),n.records[p][o].element.style.left="")}selection.Aq.call(n)},scrollControls=function(n){const g=this;wheelControls.call(g),g.options.freezeColumns>0&&g.content.scrollLeft!=scrollLeft&&updateFreezePosition.call(g),g.options.lazyLoading!=1&&g.options.tableOverflow!=1||g.edition&&n.target.className.substr(0,9)!="jdropdown"&&closeEditor.call(g,g.edition[0],!0)},setEvents=function(n){destroyEvents(n),n.addEventListener("mouseup",mouseUpControls),n.addEventListener("mousedown",mouseDownControls),n.addEventListener("mousemove",mouseMoveControls),n.addEventListener("mouseover",mouseOverControls),n.addEventListener("dblclick",doubleClickControls),n.addEventListener("paste",pasteControls),n.addEventListener("contextmenu",contextMenuControls),n.addEventListener("touchstart",touchStartControls),n.addEventListener("touchend",touchEndControls),n.addEventListener("touchcancel",touchEndControls),n.addEventListener("touchmove",touchEndControls),document.addEventListener("keydown",keyDownControls)},destroyEvents=function(n){n.removeEventListener("mouseup",mouseUpControls),n.removeEventListener("mousedown",mouseDownControls),n.removeEventListener("mousemove",mouseMoveControls),n.removeEventListener("mouseover",mouseOverControls),n.removeEventListener("dblclick",doubleClickControls),n.removeEventListener("paste",pasteControls),n.removeEventListener("contextmenu",contextMenuControls),n.removeEventListener("touchstart",touchStartControls),n.removeEventListener("touchend",touchEndControls),n.removeEventListener("touchcancel",touchEndControls),document.removeEventListener("keydown",keyDownControls)};var toolbar=__webpack_require__(392),pagination=__webpack_require__(167);const setData=function(n){const g=this;if(n&&(g.options.data=n),g.options.data||(g.options.data=[]),g.options.data&&g.options.data[0]&&!Array.isArray(g.options.data[0])){n=[];for(let M=0;M<g.options.data.length;M++){const l=[];for(let a=0;a<g.options.columns.length;a++)l[a]=g.options.data[M][g.options.columns[a].name];n.push(l)}g.options.data=n}let o=0,p=0;const E=g.options.columns&&g.options.columns.length||0,T=g.options.data.length,X=g.options.minDimensions[0],H=g.options.minDimensions[1],m=X>E?X:E,s=H>T?H:T;for(o=0;o<s;o++)for(p=0;p<m;p++)g.options.data[o]==null&&(g.options.data[o]=[]),g.options.data[o][p]==null&&(g.options.data[o][p]="");let w,S;for(g.rows=[],g.results=null,g.records=[],g.history=[],g.historyIndex=-1,g.tbody.innerHTML="",g.options.lazyLoading==1?(w=0,S=g.options.data.length<100?g.options.data.length:100,g.options.pagination&&(g.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):g.options.pagination?(g.pageNumber||(g.pageNumber=0),g.options.pagination,w=g.options.pagination*g.pageNumber,S=g.options.pagination*g.pageNumber+g.options.pagination,g.options.data.length<S&&(S=g.options.data.length)):(w=0,S=g.options.data.length),o=0;o<g.options.data.length;o++){const M=createRow.call(g,o,g.options.data[o]);o>=w&&o<S&&g.tbody.appendChild(M.element)}if(g.options.lazyLoading==1||g.options.pagination&&pagination.IV.call(g),g.options.mergeCells){const M=Object.keys(g.options.mergeCells);for(let l=0;l<M.length;l++){const a=g.options.mergeCells[M[l]];merges.FU.call(g,M[l],a[0],a[1],1)}}internal.am.call(g)},getValue=function(n,g){const o=this;let p,E;if(typeof n!="string")return null;p=(n=(0,internalHelpers.vu)(n,!0))[0],E=n[1];let T=null;return p!=null&&E!=null&&(o.records[E]&&o.records[E][p]&&g?T=o.records[E][p].element.innerHTML:o.options.data[E]&&o.options.data[E][p]!="undefined"&&(T=o.options.data[E][p])),T},getValueFromCoords=function(n,g,o){const p=this;let E=null;return n!=null&&g!=null&&(p.records[g]&&p.records[g][n]&&o?E=p.records[g][n].element.innerHTML:p.options.data[g]&&p.options.data[g][n]!="undefined"&&(E=p.options.data[g][n])),E},setValue=function(n,g,o){const p=this,E=[];if(typeof n=="string"){const X=(0,internalHelpers.vu)(n,!0),H=X[0],m=X[1];E.push(internal.k9.call(p,H,m,g,o)),internal.xF.call(p,H,m,E)}else{let X=null,H=null;if(n&&n.getAttribute&&(X=n.getAttribute("data-x"),H=n.getAttribute("data-y")),X!=null&&H!=null)E.push(internal.k9.call(p,X,H,g,o)),internal.xF.call(p,X,H,E);else{const m=Object.keys(n);if(m.length>0)for(let s=0;s<m.length;s++){let w,S;if(typeof n[s]=="string"){const M=(0,internalHelpers.vu)(n[s],!0);w=M[0],S=M[1]}else n[s].x!=null&&n[s].y!=null?(w=n[s].x,S=n[s].y,n[s].value!=null&&(g=n[s].value)):(w=n[s].getAttribute("data-x"),S=n[s].getAttribute("data-y"));w!=null&&S!=null&&(E.push(internal.k9.call(p,w,S,g,o)),internal.xF.call(p,w,S,E))}}}utils_history.Dh.call(p,{action:"setValue",records:E,selection:p.selectedCell}),internal.am.call(p);const T=E.map(function(X){return{x:X.x,y:X.y,value:X.newValue,oldValue:X.oldValue}});dispatch.A.call(p,"onafterchanges",p,T)},setValueFromCoords=function(n,g,o,p){const E=this,T=[];T.push(internal.k9.call(E,n,g,o,p)),internal.xF.call(E,n,g,T),utils_history.Dh.call(E,{action:"setValue",records:T,selection:E.selectedCell}),internal.am.call(E);const X=T.map(function(H){return{x:H.x,y:H.y,value:H.newValue,oldValue:H.oldValue}});dispatch.A.call(E,"onafterchanges",E,X)},getData=function(n,g,o,p){const E=this,T=[];let X=0,H=0;const m=Math.max(...E.options.data.map(function(w){return w.length})),s=E.options.data.length;for(let w=0;w<s;w++){X=0;for(let S=0;S<m;S++)n&&!E.records[w][S].element.classList.contains("highlight")||(T[H]||(T[H]=[]),T[H][X]=g?E.records[w][S].element.innerHTML:E.options.data[w][S],X++);X>0&&H++}return o?T.map(function(w){return w.join(o)}).join(`\r
`)+`\r
`:p?T.map(function(w){const S={};return w.forEach(function(M,l){S[l]=M}),S}):T},getDataFromRange=function(n,g){const o=this,p=(0,helpers.getCoordsFromRange)(n),E=[];for(let T=p[1];T<=p[3];T++){E.push([]);for(let X=p[0];X<=p[2];X++)g?E[E.length-1].push(o.records[T][X].element.innerHTML):E[E.length-1].push(o.options.data[T][X])}return E},search=function(n){const g=this;if(g.options.filters&&filter.dr.call(g),g.resetSelection(),g.pageNumber=0,g.results=[],n){g.searchInput.value!==n&&(g.searchInput.value=n);const o=function(T,X,H){for(let m=0;m<T.length;m++)if((""+T[m]).toLowerCase().search(X)>=0||(""+g.records[H][m].element.innerHTML).toLowerCase().search(X)>=0)return!0;return!1},p=function(T){g.results.indexOf(T)==-1&&g.results.push(T)};let E=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");E=new RegExp(E,"i"),g.options.data.forEach(function(T,X){if(o(T,E,X)){const H=merges.D0.call(g,X);if(H.length)for(let m=0;m<H.length;m++){const s=(0,internalHelpers.vu)(H[m],!0);for(let w=0;w<g.options.mergeCells[H[m]][1];w++)p(s[1]+w)}else p(X)}})}else g.results=null;internal.hG.call(g)},resetSearch=function(){const n=this;n.searchInput.value="",n.search(""),n.results=null},getHeader=function(n){return this.headers[n].textContent},getHeaders=function(n){const g=this,o=[];for(let p=0;p<g.headers.length;p++)o.push(g.getHeader(p));return n?o:o.join(g.options.csvDelimiter)},setHeader=function(n,g){const o=this;if(o.headers[n]){const p=o.headers[n].textContent,E=o.options.columns&&o.options.columns[n]&&o.options.columns[n].title||"";g||(g=(0,helpers.getColumnName)(n)),o.headers[n].textContent=g,o.headers[n].setAttribute("title",g),o.options.columns||(o.options.columns=[]),o.options.columns[n]||(o.options.columns[n]={}),o.options.columns[n].title=g,utils_history.Dh.call(o,{action:"setHeader",column:n,oldValue:p,newValue:g}),dispatch.A.call(o,"onchangeheader",o,parseInt(n),g,E)}},getStyle=function(n,g){const o=this;if(n)return n=(0,internalHelpers.vu)(n,!0),g?o.records[n[1]][n[0]].element.style[g]:o.records[n[1]][n[0]].element.getAttribute("style");{const p={},E=o.options.data[0].length,T=o.options.data.length;for(let X=0;X<T;X++)for(let H=0;H<E;H++){const m=g?o.records[X][H].element.style[g]:o.records[X][H].element.getAttribute("style");m&&(p[(0,internalHelpers.t3)([H,X])]=m)}return p}},setStyle=function(n,g,o,p,E){const T=this,X={},H={},m=function(w,S,M){const l=(0,internalHelpers.vu)(w,!0);if(T.records[l[1]]&&T.records[l[1]][l[0]]&&(T.records[l[1]][l[0]].element.classList.contains("readonly")==0||p)){const a=T.records[l[1]][l[0]].element.style[S];a!=M||p?T.records[l[1]][l[0]].element.style[S]=M:(M="",T.records[l[1]][l[0]].element.style[S]=""),H[w]||(H[w]=[]),X[w]||(X[w]=[]),H[w].push([S+":"+a]),X[w].push([S+":"+M])}};if(g&&o)typeof n=="string"&&m(n,g,o);else{const w=Object.keys(n);for(let S=0;S<w.length;S++){let M=n[w[S]];typeof M=="string"&&(M=M.split(";"));for(let l=0;l<M.length;l++)typeof M[l]=="string"&&(M[l]=M[l].split(":")),M[l][0].trim()&&m(w[S],M[l][0].trim(),M[l][1])}}let s=Object.keys(H);for(let w=0;w<s.length;w++)H[s[w]]=H[s[w]].join(";");s=Object.keys(X);for(let w=0;w<s.length;w++)X[s[w]]=X[s[w]].join(";");E||utils_history.Dh.call(T,{action:"setStyle",oldValue:H,newValue:X}),dispatch.A.call(T,"onchangestyle",T,X)},resetStyle=function(n,g){const o=this,p=Object.keys(n);for(let E=0;E<p.length;E++){const T=(0,internalHelpers.vu)(p[E],!0);o.records[T[1]]&&o.records[T[1]][T[0]]&&o.records[T[1]][T[0]].element.setAttribute("style","")}o.setStyle(n,null,null,null,g)},download=function(n,g){const o=this;if(o.parent.config.allowExport==0)console.error("Export not allowed");else{let p="";p+=copy.call(o,!1,o.options.csvDelimiter,!0,n,!0,void 0,g);const E=new Blob(["\uFEFF"+p],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(E,(o.options.csvFileName||o.options.worksheetName)+".csv");else{const T=document.createElement("a"),X=URL.createObjectURL(E);T.href=X,T.setAttribute("download",(o.options.csvFileName||o.options.worksheetName)+".csv"),document.body.appendChild(T),T.click(),T.parentNode.removeChild(T)}}},getComments=function(n){const g=this;if(n)return typeof n!="string"?getComments.call(g):(n=(0,internalHelpers.vu)(n,!0),g.records[n[1]][n[0]].element.getAttribute("title")||"");{const o={};for(let p=0;p<g.options.data.length;p++)for(let E=0;E<g.options.columns.length;E++){const T=g.records[p][E].element.getAttribute("title");T&&(o[(0,internalHelpers.t3)([E,p])]=T)}return o}},setComments=function(n,g){const o=this;let p;p=typeof n=="string"?{[n]:g}:n;const E={};Object.entries(p).forEach(function([T,X]){const H=(0,helpers.getCoordsFromCellName)(T);E[T]=o.records[H[1]][H[0]].element.getAttribute("title"),o.records[H[1]][H[0]].element.setAttribute("title",X||""),X?(o.records[H[1]][H[0]].element.classList.add("jss_comments"),o.options.comments||(o.options.comments={}),o.options.comments[T]=X):(o.records[H[1]][H[0]].element.classList.remove("jss_comments"),o.options.comments&&o.options.comments[T]&&delete o.options.comments[T])}),utils_history.Dh.call(o,{action:"setComments",newValue:p,oldValue:E}),dispatch.A.call(o,"oncomments",o,p,E)};var orderBy=__webpack_require__(94);const getWorksheetConfig=function(){return this.options},getSpreadsheetConfig=function(){return this.config},setConfig=function(n,g){const o=this,p=Object.keys(n);let E;o.parent?E=o.parent:(g=!0,E=o),p.forEach(function(T){g?(E.config[T]=n[T],T==="toolbar"&&(n[T]===!0?E.showToolbar():n[T]===!1&&E.hideToolbar())):o.options[T]=n[T]})};var meta=__webpack_require__(654);const setReadOnly=function(n,g){const o=this;let p;if(typeof n=="string"){const E=(0,helpers.getCoordsFromCellName)(n);p=o.records[E[1]][E[0]]}else{const E=parseInt(n.getAttribute("data-x")),T=parseInt(n.getAttribute("data-y"));p=o.records[T][E]}g?p.element.classList.add("readonly"):p.element.classList.remove("readonly")},isReadOnly=function(n,g){return typeof n=="string"&&g===void 0&&([n,g]=(0,helpers.getCoordsFromCellName)(n)),this.records[g][n].element.classList.contains("readonly")},setWorksheetFunctions=function(n){for(let g=0;g<worksheetPublicMethodsLength;g++){const[o,p]=worksheetPublicMethods[g];n[o]=p.bind(n)}},createTable=function(){let n=this;setWorksheetFunctions(n),n.table=document.createElement("table"),n.thead=document.createElement("thead"),n.tbody=document.createElement("tbody"),n.headers=[],n.cols=[],n.content=document.createElement("div"),n.content.classList.add("jss_content"),n.content.onscroll=function(S){scrollControls.call(n,S)},n.content.onwheel=function(S){wheelControls.call(n,S)};const g=document.createElement("div"),o=document.createElement("label");o.innerHTML=jSuites.translate("Search")+": ",g.appendChild(o),n.searchInput=document.createElement("input"),n.searchInput.classList.add("jss_search"),o.appendChild(n.searchInput),n.searchInput.onfocus=function(){n.resetSelection()};const p=document.createElement("div");if(n.options.pagination>0&&n.options.paginationOptions&&n.options.paginationOptions.length>0){n.paginationDropdown=document.createElement("select"),n.paginationDropdown.classList.add("jss_pagination_dropdown"),n.paginationDropdown.onchange=function(){n.options.pagination=parseInt(this.value),n.page(0)};for(let S=0;S<n.options.paginationOptions.length;S++){const M=document.createElement("option");M.value=n.options.paginationOptions[S],M.innerHTML=n.options.paginationOptions[S],n.paginationDropdown.appendChild(M)}n.paginationDropdown.value=n.options.pagination,p.appendChild(document.createTextNode(jSuites.translate("Show "))),p.appendChild(n.paginationDropdown),p.appendChild(document.createTextNode(jSuites.translate("entries")))}const E=document.createElement("div");E.classList.add("jss_filter"),E.appendChild(p),E.appendChild(g),n.colgroupContainer=document.createElement("colgroup");let T=document.createElement("col");if(T.setAttribute("width","50"),n.colgroupContainer.appendChild(T),n.options.nestedHeaders&&n.options.nestedHeaders.length>0&&n.options.nestedHeaders[0]&&n.options.nestedHeaders[0][0])for(let S=0;S<n.options.nestedHeaders.length;S++)n.thead.appendChild(internal.ju.call(n,n.options.nestedHeaders[S]));n.headerContainer=document.createElement("tr"),T=document.createElement("td"),T.classList.add("jss_selectall"),n.headerContainer.appendChild(T);const X=getNumberOfColumns.call(n);for(let S=0;S<X;S++)createCellHeader.call(n,S),n.headerContainer.appendChild(n.headers[S]),n.colgroupContainer.appendChild(n.cols[S].colElement);if(n.thead.appendChild(n.headerContainer),n.options.filters==1){n.filter=document.createElement("tr");const S=document.createElement("td");n.filter.appendChild(S);for(let M=0;M<n.options.columns.length;M++){const l=document.createElement("td");l.innerHTML="&nbsp;",l.setAttribute("data-x",M),l.className="jss_column_filter",n.options.columns[M].type=="hidden"&&(l.style.display="none"),n.filter.appendChild(l)}n.thead.appendChild(n.filter)}n.table=document.createElement("table"),n.table.classList.add("jss_worksheet"),n.table.setAttribute("cellpadding","0"),n.table.setAttribute("cellspacing","0"),n.table.setAttribute("unselectable","yes"),n.table.appendChild(n.colgroupContainer),n.table.appendChild(n.thead),n.table.appendChild(n.tbody),n.options.textOverflow||n.table.classList.add("jss_overflow"),n.corner=document.createElement("div"),n.corner.className="jss_corner",n.corner.setAttribute("unselectable","on"),n.corner.setAttribute("onselectstart","return false"),n.options.selectionCopy==0&&(n.corner.style.display="none"),n.textarea=document.createElement("textarea"),n.textarea.className="jss_textarea",n.textarea.id="jss_textarea",n.textarea.tabIndex="-1",n.textarea.ariaHidden="true";const H=document.createElement("a");H.setAttribute("href","https://bossanova.uk/jspreadsheet/"),n.ads=document.createElement("div"),n.ads.className="jss_about";const m=document.createElement("span");m.innerHTML="Jspreadsheet CE",H.appendChild(m),n.ads.appendChild(H),document.createElement("div").classList.add("jss_table"),n.pagination=document.createElement("div"),n.pagination.classList.add("jss_pagination");const s=document.createElement("div"),w=document.createElement("div");if(n.pagination.appendChild(s),n.pagination.appendChild(w),n.options.pagination||(n.pagination.style.display="none"),n.options.search==1&&n.element.appendChild(E),n.content.appendChild(n.table),n.content.appendChild(n.corner),n.content.appendChild(n.textarea),n.element.appendChild(n.content),n.element.appendChild(n.pagination),n.element.appendChild(n.ads),n.element.classList.add("jss_container"),n.element.jssWorksheet=n,n.element.jspreadsheet=n,n.options.tableOverflow==1&&(n.options.tableHeight&&(n.content.style["overflow-y"]="auto",n.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",n.content.style.maxHeight=typeof n.options.tableHeight=="string"?n.options.tableHeight:n.options.tableHeight+"px"),n.options.tableWidth&&(n.content.style["overflow-x"]="auto",n.content.style.width=typeof n.options.tableWidth=="string"?n.options.tableWidth:n.options.tableWidth+"px")),n.options.tableOverflow!=1&&n.parent.config.toolbar&&n.element.classList.add("with-toolbar"),n.options.columnDrag!=0&&n.thead.classList.add("draggable"),n.options.columnResize!=0&&n.thead.classList.add("resizable"),n.options.rowDrag!=0&&n.tbody.classList.add("draggable"),n.options.rowResize!=0&&n.tbody.classList.add("resizable"),n.setData.call(n),n.options.style&&(n.setStyle(n.options.style,null,null,1,1),delete n.options.style),Object.defineProperty(n.options,"style",{enumerable:!0,configurable:!0,get(){return n.getStyle()}}),n.options.comments&&n.setComments(n.options.comments),n.options.classes){const S=Object.keys(n.options.classes);for(let M=0;M<S.length;M++){const l=(0,internalHelpers.vu)(S[M],!0);n.records[l[1]][l[0]].element.classList.add(n.options.classes[S[M]])}}},prepareTable=function(){const n=this;n.options.lazyLoading==1&&n.options.tableOverflow!=1&&n.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),n.options.lazyLoading=!1),n.options.columns||(n.options.columns=[]);let g,o=n.options.columns.length;if(n.options.data&&n.options.data[0]!==void 0)if(Array.isArray(n.options.data[0])){const E=n.options.data[0].length;E>o&&(o=E)}else g=Object.keys(n.options.data[0]),g.length>o&&(o=g.length);n.options.minDimensions||(n.options.minDimensions=[0,0]),n.options.minDimensions[0]>o&&(o=n.options.minDimensions[0]);const p=[];for(let E=0;E<o;E++)n.options.columns[E]||(n.options.columns[E]={}),!n.options.columns[E].name&&g&&g[E]&&(n.options.columns[E].name=g[E]),n.options.columns[E].type=="dropdown"&&n.options.columns[E].url&&p.push({url:n.options.columns[E].url,index:E,method:"GET",dataType:"json",success:function(T){n.options.columns[this.index].source||(n.options.columns[this.index].source=[]);for(let X=0;X<T.length;X++)n.options.columns[this.index].source.push(T[X])}});p.length?jSuites.ajax(p,function(){createTable.call(n)}):createTable.call(n)},getNextDefaultWorksheetName=function(n){const g=/^Sheet(\d+)$/;let o=0;return n.worksheets.forEach(function(p){const E=g.exec(p.options.worksheetName);E&&(o=Math.max(o,parseInt(E[1])))}),"Sheet"+(o+1)},buildWorksheet=async function(){const n=this,g=(n.element,n.parent);typeof g.plugins=="object"&&Object.entries(g.plugins).forEach(function([,p]){typeof p.beforeinit=="function"&&p.beforeinit(n)}),libraryBase.jspreadsheet.current=n;const o=[];if(n.options.csv){const p=new Promise(E=>{jSuites.ajax({url:n.options.csv,method:"GET",dataType:"text",success:function(T){const X=(0,helpers.parseCSV)(T,n.options.csvDelimiter);if(n.options.csvHeaders==1&&X.length>0){const H=X.shift();if(H.length>0){n.options.columns||(n.options.columns=[]);for(let m=0;m<H.length;m++)n.options.columns[m]||(n.options.columns[m]={}),n.options.columns[m].title===void 0&&(n.options.columns[m].title=H[m])}}n.options.data=X,prepareTable.call(n),E()}})});o.push(p)}else if(n.options.url){const p=new Promise(E=>{jSuites.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(T){n.options.data=T.data?T.data:T,prepareTable.call(n),E()}})});o.push(p)}else prepareTable.call(n);await Promise.all(o),typeof g.plugins=="object"&&Object.entries(g.plugins).forEach(function([,p]){typeof p.init=="function"&&p.init(n)})},createWorksheetObj=function(n){const g=this.parent;n.worksheetName||(n.worksheetName=getNextDefaultWorksheetName(this.parent));const o={parent:g,options:n,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return g.config.worksheets.push(o.options),g.worksheets.push(o),o},createWorksheet=function(n){const g=this.parent;g.creationThroughJss=!0,createWorksheetObj.call(this,n),g.element.tabs.create(n.worksheetName)},openWorksheet=function(n){this.parent.element.tabs.open(n)},deleteWorksheet=function(n){const g=this;g.parent.element.tabs.remove(n);const o=g.parent.worksheets.splice(n,1)[0];dispatch.A.call(g.parent,"ondeleteworksheet",o,n)},worksheetPublicMethods=[["selectAll",selection.Ub],["updateSelectionFromCoords",function(n,g,o,p){return selection.AH.call(this,n,g,o,p)}],["resetSelection",function(){return selection.gE.call(this)}],["getSelection",selection.Lo],["getSelected",selection.ef],["getSelectedColumns",selection.Jg],["getSelectedRows",selection.R5],["getData",getData],["setData",setData],["getValue",getValue],["getValueFromCoords",getValueFromCoords],["setValue",setValue],["setValueFromCoords",setValueFromCoords],["getWidth",getWidth],["setWidth",function(n,g){return setWidth.call(this,n,g)}],["insertRow",insertRow],["moveRow",function(n,g){return moveRow.call(this,n,g)}],["deleteRow",deleteRow],["hideRow",hideRow],["showRow",showRow],["getRowData",getRowData],["setRowData",setRowData],["getHeight",getHeight],["setHeight",function(n,g){return setHeight.call(this,n,g)}],["getMerge",merges.fd],["setMerge",function(n,g,o){return merges.FU.call(this,n,g,o)}],["destroyMerge",function(){return merges.VP.call(this)}],["removeMerge",function(n,g){return merges.Zp.call(this,n,g)}],["search",search],["resetSearch",resetSearch],["getHeader",getHeader],["getHeaders",getHeaders],["setHeader",setHeader],["getStyle",getStyle],["setStyle",function(n,g,o,p){return setStyle.call(this,n,g,o,p)}],["resetStyle",resetStyle],["insertColumn",insertColumn],["moveColumn",moveColumn],["deleteColumn",deleteColumn],["getColumnData",getColumnData],["setColumnData",setColumnData],["whichPage",pagination.ho],["page",pagination.MY],["download",download],["getComments",getComments],["setComments",setComments],["orderBy",orderBy.My],["undo",utils_history.tN],["redo",utils_history.ZS],["getCell",internal.tT],["getCellFromCoords",internal.Xr],["getLabel",internal.p9],["getConfig",getWorksheetConfig],["setConfig",setConfig],["getMeta",function(n){return meta.IQ.call(this,n)}],["setMeta",meta.iZ],["showColumn",showColumn],["hideColumn",hideColumn],["showIndex",internal.C6],["hideIndex",internal.TI],["getWorksheetActive",internal.$O],["openEditor",openEditor],["closeEditor",closeEditor],["createWorksheet",createWorksheet],["openWorksheet",openWorksheet],["deleteWorksheet",deleteWorksheet],["copy",function(n){n?cutControls():copy.call(this,!0)}],["paste",paste],["executeFormula",internal.Em],["getDataFromRange",getDataFromRange],["quantiyOfPages",pagination.$f],["getRange",selection.eO],["isSelected",selection.sp],["setReadOnly",setReadOnly],["isReadOnly",isReadOnly],["getHighlighted",selection.kV],["dispatch",dispatch.A],["down",down],["first",first],["last",last],["left",left],["right",right],["up",up],["openFilter",filter.N$],["resetFilters",filter.dr]],worksheetPublicMethodsLength=worksheetPublicMethods.length,factory=function(){},createWorksheets=async function(n,g,o){let p=g.worksheets;if(!p)throw new Error("JSS: worksheets are not defined");{let E={animation:!0,onbeforecreate:function(m,s){return s||getNextDefaultWorksheetName(n)},oncreate:function(m,s){if(n.creationThroughJss)n.creationThroughJss=!1;else{const S=m.tabs.headers.children[m.tabs.headers.children.length-2].innerHTML;createWorksheetObj.call(n.worksheets[0],{minDimensions:[10,15],worksheetName:S})}const w=n.worksheets[n.worksheets.length-1];w.element=s,buildWorksheet.call(w).then(function(){(0,toolbar.nK)(w),dispatch.A.call(w,"oncreateworksheet",w,g,n.worksheets.length-1)})},onchange:function(m,s,w){n.worksheets.length!=0&&n.worksheets[w]&&(0,toolbar.nK)(n.worksheets[w])}};g.tabs==1?E.allowCreate=!0:E.hideHeaders=!0,E.data=[];let T=1;for(let m=0;m<p.length;m++)p[m].worksheetName||(p[m].worksheetName="Sheet"+T++),E.data.push({title:p[m].worksheetName,content:""});o.classList.add("jss_spreadsheet");const X=jSuites.tabs(o,E),H=g.style;delete g.style;for(let m=0;m<p.length;m++)p[m].style&&Object.entries(p[m].style).forEach(function([s,w]){typeof w=="number"&&(p[m].style[s]=H[w])}),n.worksheets.push({parent:n,element:X.content.children[m],options:p[m],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await buildWorksheet.call(n.worksheets[m])}};factory.spreadsheet=async function(n,g,o){if(n.tagName=="TABLE"){g||(g={}),g.worksheets||(g.worksheets=[]);const E=(0,helpers.createFromTable)(n,g.worksheets[0]);g.worksheets[0]=E;const T=document.createElement("div");n.parentNode.insertBefore(T,n),n.remove(),n=T}let p={worksheets:o,config:g,element:n,el:n};return p.contextMenu=document.createElement("div"),p.contextMenu.className="jss_contextmenu",p.getWorksheetActive=internal.$O.bind(p),p.fullscreen=internal.Y5.bind(p),p.showToolbar=toolbar.ll.bind(p),p.hideToolbar=toolbar.Ar.bind(p),p.getConfig=getSpreadsheetConfig.bind(p),p.setConfig=setConfig.bind(p),p.setPlugins=function(E){p.plugins||(p.plugins={}),typeof E=="object"&&Object.entries(E).forEach(function([T,X]){p.plugins[T]=X.call(libraryBase.jspreadsheet,p,{},p.config)})},p.setPlugins(g.plugins),await createWorksheets(p,g,n),p.element.appendChild(p.contextMenu),jSuites.contextmenu(p.contextMenu,{onclick:function(){p.contextMenu.contextmenu.close(!1)}}),p.config.fullscreen==1&&p.element.classList.add("fullscreen"),toolbar.ll.call(p),g.root?setEvents(g.root):setEvents(document),n.spreadsheet=p,p},factory.worksheet=function(n,g,o){let p={parent:n,options:{}};return o===void 0?n.worksheets.push(p):n.worksheets.splice(o,0,p),Object.assign(p.options,g),p};var utils_factory=factory;libraryBase.jspreadsheet=function(n,g){try{let o=[];return utils_factory.spreadsheet(n,g,o).then(p=>{libraryBase.jspreadsheet.spreadsheet.push(p),dispatch.A.call(p,"onload",p)}),o}catch(o){console.error(o)}},libraryBase.jspreadsheet.getWorksheetInstanceByName=function(n,g){const o=libraryBase.jspreadsheet.spreadsheet.find(p=>p.config.namespace===g);if(o)return{};if(n==null){const p=o.worksheets.map(E=>[E.options.worksheetName,E]);return Object.fromEntries(p)}return o.worksheets.find(p=>p.options.worksheetName===n)},libraryBase.jspreadsheet.setDictionary=function(n){jSuites.setDictionary(n)},libraryBase.jspreadsheet.destroy=function(n,g){if(n.spreadsheet){const o=libraryBase.jspreadsheet.spreadsheet.indexOf(n.spreadsheet);libraryBase.jspreadsheet.spreadsheet.splice(o,1);const p=n.spreadsheet.config.root||document;n.spreadsheet=null,n.innerHTML="",g&&destroyEvents(p)}},libraryBase.jspreadsheet.destroyAll=function(){for(let n=0;n<libraryBase.jspreadsheet.spreadsheet.length;n++){const g=libraryBase.jspreadsheet.spreadsheet[n];libraryBase.jspreadsheet.destroy(g.element)}},libraryBase.jspreadsheet.current=null,libraryBase.jspreadsheet.spreadsheet=[],libraryBase.jspreadsheet.helpers={},libraryBase.jspreadsheet.version=function(){return version},Object.entries(helpers).forEach(([n,g])=>{libraryBase.jspreadsheet.helpers[n]=g});var src=libraryBase.jspreadsheet;jspreadsheet=__webpack_exports__.default}(),jspreadsheet})}(dist$3)),dist$3.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports);export{jspreadsheet as j};
