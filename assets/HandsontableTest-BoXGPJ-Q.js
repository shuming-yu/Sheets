import{g as wC,a as CC,b as vC,c as SC,T as To,s as Rm,e as Nt,E as xo,d as Os,i as pe,f as U,h as Oe,A as bC,j as yC,k as Em,l as RC,m as sn,n as EC,o as MC,p as PC,t as Hs,q as tt,r as _C,u as IC,v as TC,w as Is,x as xC,y as Mm,z as AC,B as NC,C as OC,D as HC,F as DC,G as Te,H as Yd,K as Ds,I as $C,J as sh,L as Wc,M as Ne,N as ve,O as Ee,P as LC,Q as Pm,R as Bc,S as _m,U as Ts,V as kC,W as oh,X as Ao,Y as yt,Z as Yr,_ as Kt,$ as Vc,a0 as No,a1 as Rt,a2 as yl,a3 as Im,a4 as FC,a5 as WC,a6 as BC,a7 as al,a8 as X,a9 as Ut,aa as ne,ab as qt,ac as VC,ad as ho,ae as un,af as UC,ag as jC,ah as Tm,ai as Me,aj as S,ak as YC,al as GC,am as zC,an as KC,ao as qC,ap as Gr,aq as xm,ar as Am,as as Rl,at as El,au as Nm,av as Ml,aw as Om,ax as XC,ay as ZC,az as $e,aA as Or,aB as JC,aC as QC,aD as Gd,aE as Uc,aF as zr,aG as ot,aH as rh,aI as ev,aJ as Vn,aK as Hm,aL as tv,aM as Vi,aN as Ui,aO as Dm,aP as nv,aQ as iv,aR as sv,aS as ov,aT as rv,aU as av,aV as lv,aW as hv,aX as uv,aY as cv,aZ as dv,a_ as zd,a$ as fv,b0 as gv,b1 as mv,b2 as pv,b3 as wv,b4 as Cv,b5 as vv,b6 as Sv,b7 as bv,b8 as yv,b9 as Rv,ba as Ev,bb as Mv,bc as Hr,bd as Pv,be as _v,bf as xs,bg as ll,bh as jt,bi as Yt,bj as Iv,bk as Tv,bl as $m,bm as xv,bn as Lm,bo as ji,bp as Av,bq as Kd,br as Nv,bs as Ov,bt as Hv,bu as Dv,bv as $v,bw as Lv,bx as km,by as Ih,bz as Th,bA as qd,bB as kv,bC as Fv,bD as Wv,bE as Bv,bF as Vv,bG as Uv,bH as jv,bI as Yv,bJ as Gv,bK as zv,bL as Kv,bM as Xd,bN as Zd,bO as qv,bP as Un,bQ as Xv,bR as Fm,bS as Zv,bT as Jv,bU as Qv,bV as eS,bW as tS,bX as nS,bY as iS,bZ as sS,b_ as oS,b$ as rS,c0 as aS,c1 as lS,c2 as hS,c3 as uS,c4 as cS,c5 as dS,c6 as fS,c7 as gS,c8 as mS,c9 as pS,ca as wS,cb as Wm,cc as CS,cd as vS,ce as SS,cf as bS,cg as ah,ch as yS,ci as RS,cj as ES,ck as MS,cl as Bm,cm as Jd,cn as PS,co as _S,cp as IS,cq as TS,cr as jc,cs as xS,ct as AS,cu as NS,cv as Cn,cw as OS,cx as Vm,cy as HS,cz as DS,cA as Um,cB as $S,cC as LS,cD as kS,cE as FS,cF as WS,cG as jm,cH as BS,cI as VS,cJ as Ym,cK as Gm,cL as zm,cM as US,cN as Km,cO as jS,cP as YS,cQ as GS,cR as zS,cS as KS,cT as qS,cU as XS,cV as Qd,cW as ZS,cX as JS,cY as QS,cZ as eb,c_ as tb,c$ as nb,d0 as ib,d1 as sb,d2 as ob,d3 as rb,d4 as ce,d5 as he,d6 as ab,d7 as lb,d8 as hb,d9 as ub,da as cb,db,dc as fb,dd as gb,de as mb,df as pb,dg as wb,dh as Cb,di as vb,dj as Sb,dk as bb,dl as qm,dm as yb,dn as Xm,dp as Rb,dq as Zm,dr as Eb,ds as Jm,dt as Mb,du as Qm,dv as Pb}from"./vue-handsontable-BE29mp4r.js";import{r as ef,n as _b,v as Ib,x as tf,y as Tb,q as xb}from"./index-CH4OG0QN.js";import"./_commonjsHelpers-Cpj98o6Y.js";const nf=new Map([["indexesSequence",{getListWithInsertedItems:CC,getListWithRemovedItems:wC}],["physicallyIndexed",{getListWithInsertedItems:SC,getListWithRemovedItems:vC}]]),ep=n=>{if(nf.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return nf.get(n)},sf="handsontableEditor",Ab="handsontable";class Yc extends To{static get EDITOR_TYPE(){return Ab}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Rm(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,s,o,r){super.prepare(e,t,i,s,o,r);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(h,u){const c=this.getSourceData(u.row,u.col);c!==void 0&&a.setValue(c),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Nt(l,r.handsontable),this.htOptions=l}beginEditing(e,t){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{if(!t){var i;(i=this.htEditor)===null||i===void 0||i.useTheme(e)}})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:sf,relativeToGroup:xo,position:"before"},s=(o,r)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return r.preventDefault(),Os(r),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const r=this.htEditor;let a,l;return!r.getSelectedLast()&&r.flipped?a=r.countRows()-1:r.getSelectedLast()&&(r.flipped?(l=r.getSelectedLast()[0],a=Math.max(0,l-1)):(l=r.getSelectedLast()[0],a=l-1)),s(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const r=this.htEditor;let a,l;if(!r.getSelectedLast()&&!r.flipped)a=0;else if(r.getSelectedLast()){if(r.flipped)a=r.getSelectedLast()[0]+1;else if(!r.flipped){const h=r.countRows()-1;l=r.getSelectedLast()[0],a=Math.min(h,l+1)}}return s(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(sf)}}function Nb(n,e){tp(n,e),e.add(n)}function Ob(n,e,t){tp(n,e),e.set(n,t)}function tp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(n,e,t){return(e=Hb(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hb(n){var e=Db(n,"string");return typeof e=="symbol"?e:e+""}function Db(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function of(n,e){return n.get(cc(n,e))}function cc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const $b="autocomplete";var xh=new WeakMap,Ah=new WeakSet;class Gc extends Yc{constructor(){super(...arguments),Nb(this,Ah),sa(this,"query",null),sa(this,"strippedChoices",[]),sa(this,"rawChoices",[]),Ob(this,xh,this.hot.guid.slice(0,9)),sa(this,"sortByRelevance",function(e,t,i){const s=[],o=[],r=e.length;let a=t.length,l,h,u,c;if(r===0){for(u=0;u<a;u++)o.push(u);return o}for(u=0;u<a;u++){if(h=Yd(tt(t[u])),i)c=h.indexOf(e);else{const d=this.cellProperties.locale;c=h.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}c!==-1&&(l=h.length-c-r,s.push({baseIndex:u,index:c,charsLeft:l,value:h}))}for(s.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),u=0,a=s.length;u<a;u++)o.push(s[u].baseIndex);return o})}static get EDITOR_TYPE(){return $b}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return pe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),U(this.htContainer,"autocompleteEditor"),U(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Oe(this.TEXTAREA,[bC(),yC(),Em("listbox"),RC()])}prepare(e,t,i,s,o,r){super.prepare(e,t,i,s,o,r),this.hot.getSettings().ariaTags&&Oe(this.TEXTAREA,[sn("false"),EC(`${of(xh,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=i==null?void 0:i.length,{row:o,col:r}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.updateSettings({colWidths:e?[Is(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(a,l,h,u,c,d,g)=>{Hs(a,l,h,u,c,d,g);const{filteringCaseSensitive:w,allowHtml:E,locale:C}=this.cellProperties,A=this.query;let T=tt(d),k,K;T&&!E&&(k=w===!0?T.indexOf(A):T.toLocaleLowerCase(C).indexOf(A.toLocaleLowerCase(C)),k!==-1&&(K=T.substr(k,A.length),T=T.replace(K,`<strong>${K}</strong>`))),t&&Oe(l,[_C(),...i?[IC(s)]:[],...i?[TC(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${h}-${u}`]]),l.innerHTML=T},afterSelectionEnd:(a,l)=>{if(t){const h=this.htEditor.getCell(a,l,!0);Oe(h,[MC()]),Oe(this.TEXTAREA,...PC(h.id))}}}),t&&(Oe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...xC()),Oe(this.htEditor.rootElement,[Mm(),AC("polite"),NC("text"),["id",`${of(xh,this)}-listbox-${o}-${r}`]]),Oe(this.TEXTAREA,...sn("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Oe(this.TEXTAREA,[sn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=OC(this.TEXTAREA),i=HC(this.TEXTAREA),s=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let r=null,a=null,l=e;s&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(r)?r.length:0;if(o===!1)a=h>0?r[0]:0;else{const u=[];for(let c=0,d=l.length;c<d&&!(s&&h<=c);c++)h?u.push(l[r[c]]):u.push(l[c]);a=0,l=u}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(DC([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Rm(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),t=e.height;let i=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const s=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-i-t,r=s>o&&i>o+t;return r?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(r?i:o,s),r}limitDropdownIfNeeded(e,t){if(t>e){let i=0,s=0,o=0,r=null;do o=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),i+=o,s+=1;while(i<e);r=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-r}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),cc(Ah,this,rf).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),cc(Ah,this,rf).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(o,r)=>r).reduce((o,r)=>o+this.htEditor.getRowHeight(r),0)+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,i=Te(e,o=>tt(o));return Te(i,o=>t?o:Yd(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1};let s=!1;return e===Ds.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(s=!0),e===Ds.ARROW_UP&&i.row>-1&&(s=!0),s}onBeforeKeyDown(e){if($C(e.keyCode)||e.keyCode===Ds.BACKSPACE||e.keyCode===Ds.DELETE||e.keyCode===Ds.INSERT){let t=10;if(e.keyCode===Ds.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}function rf(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+sh(this.hot.rootDocument)})}const Lb="checkbox";class np extends Wc{static get EDITOR_TYPE(){return Lb}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Ne(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Hi=()=>window,en=()=>window.document,dc=(n,e)=>window.setTimeout(n,e),An=function(n,e,t,i){n.addEventListener(e,t,!!i)},Gn=function(n,e,t,i){n.removeEventListener(e,t,!!i)},kb=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},$t=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Nh=function(n,e){$t(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Oh=function(n,e){n.className=kb((" "+n.className+" ").replace(" "+e+" "," "))},zc=function(n){return/Array/.test(Object.prototype.toString.call(n))},Ft=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},Fb=function(n){let e=n.getDay();return e===0||e===6},Wb=function(n){return n%4===0&&n%100!==0||n%400===0},af=function(n,e){return[31,Wb(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},oa=function(n){Ft(n)&&n.setHours(0,0,0,0)},ra=function(n,e){return n.getTime()===e.getTime()},Pl=function(n,e,t){let i,s;for(i in e)s=n[i]!==void 0,s&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Ft(e[i])?t&&(n[i]=new Date(e[i].getTime())):zc(e[i])?t&&(n[i]=e[i].slice(0)):n[i]=Pl({},e[i],t):(t||!s)&&(n[i]=e[i]);return n},lf=function(n,e,t){let i=en().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Pl(i,t),n.dispatchEvent(i)},hf=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},Sn={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},uf=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},Bb=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},Vb=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),i=n.getDay(),s=e,o=s-1,r=7,a=function(d){return(d+r-1)%r};n.setDate(t+o-a(i));let l=new Date(n.getFullYear(),0,s),h=24*60*60*1e3,u=(n.getTime()-l.getTime())/h;return 1+Math.round((u-o+a(l.getDay()))/r)},Ub=function(n,e,t,i,s){let o=new Date(i,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(o).isoWeek():Vb(o,s))+"</td>"},jb=function(n,e,t,i){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},Yb=function(n){return"<tbody>"+n.join("")+"</tbody>"},Gb=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+uf(n,e)+'">'+uf(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},zb=function(n,e,t,i,s,o){let r,a,l,h=n._o,u=t===h.minYear,c=t===h.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,w,E=!0,C=!0;for(l=[],r=0;r<12;r++)l.push('<option value="'+(t===s?r-e:12+r-e)+'"'+(r===i?' selected="selected"':"")+(u&&r<h.minMonth||c&&r>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[r]+"</option>");for(g='<div class="pika-label">'+h.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",zc(h.yearRange)?(r=h.yearRange[0],a=h.yearRange[1]+1):(r=t-h.yearRange,a=1+t+h.yearRange),l=[];r<a&&r<=h.maxYear;r++)r>=h.minYear&&l.push('<option value="'+r+'"'+(r===t?' selected="selected"':"")+">"+r+"</option>");return w='<div class="pika-label">'+t+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?d+=w+g:d+=g+w,u&&(i===0||h.minMonth>=i)&&(E=!1),c&&(i===11||h.maxMonth<=i)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(E?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),d+="</div>"},Kb=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+Gb(n)+Yb(e)+"</table>"};function fc(n){let e=this,t=e.config(n);e._onMouseDown=function(s){if(!e._v)return;s=s||Hi().event;let o=s.target||s.srcElement;if(o)if($t(o,"is-disabled")||($t(o,"pika-button")&&!$t(o,"is-empty")&&!$t(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),t.bound&&dc(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):$t(o,"pika-prev")?e.prevMonth():$t(o,"pika-next")&&e.nextMonth()),$t(o,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||Hi().event;let o=s.target||s.srcElement;o&&($t(o,"pika-select-month")?e.gotoMonth(o.value):$t(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(s){if(s=s||Hi().event,e.isVisible())switch(s.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let s=this.moment(t.field.value,t.format,t.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(s){let o;s.firedBy!==e&&(o=e._parseFieldValue(),Ft(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=en().activeElement;do if($t(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=dc(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||Hi().event;let o=s.target||s.srcElement,r=o;if(o){!hasEventListeners&&$t(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),An(o,"change",e._onChange)));do if($t(r,"pika-single")||r===t.trigger)return;while(r=r.parentNode);e._v&&o!==t.trigger&&r!==t.trigger&&e.hide()}},e.el=en().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),An(e.el,"mousedown",e._onMouseDown,!0),An(e.el,"touchend",e._onMouseDown,!0),An(e.el,"change",e._onChange),t.keyboardInput&&An(en(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?en().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),An(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let i=t.defaultDate;Ft(i)?t.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",An(t.trigger,"click",e._onInputClick),An(t.trigger,"focus",e._onInputFocus),An(t.trigger,"blur",e._onInputBlur)):this.show()}fc.prototype={config:function(n){this._o||(this._o=Pl({},Sn,!0));let e=Pl(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,Ft(e.minDate)||(e.minDate=!1),Ft(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),zc(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Sn.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,Ft(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return Ft(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",lf(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!Ft(n))return;let t=this._o.minDate,i=this._o.maxDate;Ft(t)&&n<t?n=t:Ft(i)&&n>i&&(n=i),this._d=new Date(n.getTime()),oa(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),lf(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(Ft(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=n.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=s<t.getTime()||i.getTime()<s}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,s;n==="add"?s=new Date(t.valueOf()+i):n==="subtract"&&(s=new Date(t.valueOf()-i)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=hf(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=hf({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(oa(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=Sn.minDate,this._o.minYear=Sn.minYear,this._o.minMonth=Sn.minMonth,this._o.startRange=Sn.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(oa(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=Sn.maxDate,this._o.maxYear=Sn.maxYear,this._o.maxMonth=Sn.maxMonth,this._o.endRange=Sn.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,i=e.maxYear,s=e.minMonth,o=e.maxMonth,r="",a;this._y<=t&&(this._y=t,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),r+='<div class="pika-lendar">'+zb(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=r,e.bound&&e.field.type!=="hidden"&&dc(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,i,s,o,r,a,l,h,u;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,i=Hi().innerWidth||en().documentElement.clientWidth,s=Hi().innerHeight||en().documentElement.clientHeight,o=en().body.scrollTop||en().documentElement.scrollTop,h=!0,u=!0,l=n.getBoundingClientRect(),r=l.left+Hi().pageXOffset,a=l.bottom+Hi().pageYOffset,(this._o.reposition&&r+e>i||this._o.position.indexOf("right")>-1&&r-e+n.offsetWidth>0)&&(r=r-e+n.offsetWidth,h=!1),(this._o.reposition&&a+t>s+o||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,u=!1),r<0&&(r=0),a<0&&(a=0),this.el.style.left=r+"px",this.el.style.top=a+"px",Nh(this.el,h?"left-aligned":"right-aligned"),Nh(this.el,u?"bottom-aligned":"top-aligned"),Oh(this.el,h?"right-aligned":"left-aligned"),Oh(this.el,u?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let i=this._o,s=new Date,o=af(n,e),r=new Date(n,e,1).getDay(),a=[],l=[];oa(s),i.firstDay>0&&(r-=i.firstDay,r<0&&(r+=7));let h=e===0?11:e-1,u=e===11?0:e+1,c=e===0?n-1:n,d=e===11?n+1:n,g=af(c,h),w=o+r,E=w;for(;E>7;)E-=7;w+=7-E;let C=!1;for(let A=0,T=0;A<w;A++){let k=new Date(n,e,1+(A-r)),K=Ft(this._d)?ra(k,this._d):!1,$=ra(k,s),x=i.events.indexOf(k.toDateString())!==-1,N=A<r||A>=o+r,q=1+(A-r),ee=e,O=n,Y=i.startRange&&ra(i.startRange,k),Q=i.endRange&&ra(i.endRange,k),fe=i.startRange&&i.endRange&&i.startRange<k&&k<i.endRange,j=i.minDate&&k<i.minDate||i.maxDate&&k>i.maxDate||i.disableWeekends&&Fb(k)||i.disableDayFn&&i.disableDayFn(k);N&&(A<r?(q=g+q,ee=h,O=c):(q=q-o,ee=u,O=d));let L={day:q,month:ee,year:O,hasEvent:x,isSelected:K,isToday:$,isDisabled:j,isEmpty:N,isStartRange:Y,isEndRange:Q,isInRange:fe,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&K&&(C=!0),l.push(Bb(L)),++T===7&&(i.showWeekNumber&&l.unshift(Ub(this,A-r,e,n,i.firstWeekOfYearMinDays)),a.push(jb(l,i.isRTL,i.pickWholeWeek,C)),l=[],T=0,C=!1)}return Kb(i,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Oh(this.el,"is-hidden"),this._o.bound&&(An(en(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Gn(en(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Nh(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Gn(this.el,"mousedown",this._onMouseDown,!0),Gn(this.el,"touchend",this._onMouseDown,!0),Gn(this.el,"change",this._onChange),n.keyboardInput&&Gn(en(),"keydown",this._onKeyChange),n.field&&(Gn(n.field,"change",this._onInputChange),n.bound&&(Gn(n.trigger,"click",this._onInputClick),Gn(n.trigger,"focus",this._onInputFocus),Gn(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function qb(n,e){Xb(n,e),e.add(n)}function Xb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cf(n,e,t){return(e=Zb(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Zb(n){var e=Jb(n,"string");return typeof e=="symbol"?e:e+""}function Jb(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Hh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ip="date",df="dateEditor",Qb="DD/MM/YYYY";var aa=new WeakSet;class sp extends To{constructor(){super(...arguments),qb(this,aa),cf(this,"parentDestroyed",!1),cf(this,"$datePicker",null)}static get EDITOR_TYPE(){return ip}init(){if(typeof ve!="function")throw new Error("You need to include moment.js to your project.");if(typeof fc!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||(Ee(this.datePicker,/ht-theme-.*/g),U(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),U(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Ee(this.datePicker,/ht-theme-.*/g),U(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{Ne(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,s,o,r){super.prepare(e,t,i,s,o,r)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:df})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(df),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=Hh(aa,this,Dh).call(this),i=this.hot.view.isMouseDown(),s=e?LC(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new fc(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ve),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,ve(o,t,!0).isValid()&&this.$datePicker.setMoment(ve(o,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,ve(o,t,!0).isValid()&&this.$datePicker.setMoment(ve(o,t),!0),!s&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Pm(i,this.cellProperties.datePickerConfig);const s=i.onSelect,o=i.onClose;return i.field=t,i.trigger=t,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:Hh(aa,this,Dh).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=r=>{let a=r;isNaN(a.getTime())||(a=ve(a).format(Hh(aa,this,Dh).call(this))),this.setValue(a),s&&s(),Bc()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==_m.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:r}=(t=o.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=i.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),h=s.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),u=s.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=h&&this.col<=u){const c=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+c.top+Ts(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=c.right-Is(this.datePicker):d+=c.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Dh(){var n;return(n=this.cellProperties.dateFormat)!==null&&n!==void 0?n:Qb}const ey="dropdown";class op extends Gc{static get EDITOR_TYPE(){return ey}prepare(e,t,i,s,o,r){r.filter=!1,r.strict=!0,super.prepare(e,t,i,s,o,r)}}const ty="numeric";class rp extends To{static get EDITOR_TYPE(){return ty}}function ny(n,e,t){return(e=iy(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iy(n){var e=sy(n,"string");return typeof e=="symbol"?e:e+""}function sy(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const oy="password";class ap extends To{constructor(){super(...arguments),ny(this,"autoResize",kC(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return oy}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,oh(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const $h="ht_editor_visible",ff="selectEditor",ry="select";class lp extends Wc{static get EDITOR_TYPE(){return ry}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...Ao()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),U(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ne(this.selectWrapper,$h)&&Ee(this.selectWrapper,$h),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,s,o,r){super.prepare(e,t,i,s,o,r);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),oh(this.select),yt(l,(h,u)=>{const c=this.hot.rootDocument.createElement("OPTION");c.value=u,Yr(c,h),this.select.appendChild(c)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,s=e.length;i<s;i++)t[e[i]]=e[i];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==_m.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:i,height:s}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${s}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",U(this.selectWrapper,$h)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={group:ff};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ff)}}const ay="time";class hp extends To{static get EDITOR_TYPE(){return ay}prepare(e,t,i,s,o,r){super.prepare(e,t,i,s,o,r),this.TEXTAREA.dir="ltr"}}function ly(){Kt(Wc),Kt(Gc),Kt(np),Kt(sp),Kt(op),Kt(Yc),Kt(rp),Kt(ap),Kt(lp),Kt(To),Kt(hp)}const hy="html";function Kc(n,e,t,i,s,o,r){Vc.apply(this,[n,e,t,i,s,o,r]),Yr(e,o??"",!1)}Kc.RENDERER_TYPE=hy;const uy="autocomplete";function Oo(n,e,t,i,s,o,r){const{rootDocument:a}=n,l=r.allowHtml?Kc:Hs,h=a.createElement("DIV"),u=n.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...Ao()),h.appendChild(a.createTextNode("▼")),l.apply(this,[n,e,t,i,s,o,r]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(h,e.firstChild),U(e,"htAutocomplete"),!n.acArrowListener){const c=new No(n);n.acArrowListener=function(d){Ne(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,i),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}Oo.RENDERER_TYPE=uy;const cy="dropdown";function qc(n,e,t,i,s,o,r){Oo.apply(this,[n,e,t,i,s,o,r])}qc.RENDERER_TYPE=cy;const gf=new WeakMap,mf=new WeakMap,dy="htBadValue",Po="data-row",_o="data-col",fy="checkboxRenderer",up="checkbox";X.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:i,type:s,row:o,column:r,prop:a}=e;if(s===up){if(i){const{value:l,property:h}=i;let u=t;if(l)u=typeof l=="function"?l(o,r,a,t):l;else if(h){const c=this.getDataAtRowProp(o,h);u=c!==null?c:t}n=u}return n}});function Xc(n,e,t,i,s,o,r){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Vc.apply(this,[n,e,t,i,s,o,r]),gy(n);let h=my(a);const u=r.label;let c=!1;if(typeof r.checkedTemplate>"u"&&(r.checkedTemplate=!0),typeof r.uncheckedTemplate>"u"&&(r.uncheckedTemplate=!1),oh(e),o===r.checkedTemplate||tt(o).toLocaleLowerCase(r.locale)===tt(r.checkedTemplate).toLocaleLowerCase(r.locale)?h.checked=!0:o===r.uncheckedTemplate||tt(o).toLocaleLowerCase(r.locale)===tt(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?h.checked=!1:Rt(o)?U(h,"noValue"):(h.style.display="none",U(h,dy),c=!0),Oe(h,[[Po,t],[_o,i]]),l&&Oe(h,[yl(h.checked?n.getTranslatedPhrase(WC):n.getTranslatedPhrase(BC)),Im(h.checked),FC()]),!c&&u){let E="";if(u.value)E=typeof u.value=="function"?u.value.call(this,t,i,s,o):u.value;else if(u.property){const A=n.getDataAtRowProp(t,u.property);E=A!==null?A:""}const C=py(a,E,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(C),e.appendChild(h)):(C.appendChild(h),h=C):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(h),e.appendChild(C)):(C.insertBefore(h,C.firstChild),h=C))}(!u||u&&!u.separated)&&e.appendChild(h),c&&e.appendChild(a.createTextNode("#bad-value#")),gf.has(n)||(gf.set(n,!0),d());function d(){const C=n.getShortcutManager().getContext("grid"),A={group:fy,relativeToGroup:xo,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(g(),!w()),runOnlyIf:()=>{var T;return(T=n.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}},{keys:[["enter"]],callback:()=>(g(),!w()),runOnlyIf:()=>{const T=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&(T==null?void 0:T.highlight.isCell())&&!n.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!w()),runOnlyIf:()=>{var T;return(T=n.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}}],A)}function g(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=n.getSelectedRange(),A=[],T=new Map;let k=[],K=0;if(C){for(let $=0;$<C.length;$++){const{row:x,col:N}=C[$].getTopStartCorner(),{row:q,col:ee}=C[$].getBottomEndCorner();for(let O=x;O<=q;O+=1)for(let Y=N;Y<=ee;Y+=1){const Q=n.getCellMeta(O,Y);if(Q.hidden)continue;const fe={checkedTemplate:Q.checkedTemplate,uncheckedTemplate:Q.uncheckedTemplate};if(Q.type!=="checkbox"){E===!0&&!Q.readOnly&&(T.has(A.length)?T.set(A.length,[...T.get(A.length),[O,Y,null]]):T.set(A.length,[[O,Y,null]]));continue}if(Q.readOnly===!0)continue;typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);const j=n.getDataAtCell(O,Y);E===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(j)?k.push([O,Y,Q.uncheckedTemplate,fe]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(j)&&k.push([O,Y,Q.checkedTemplate,fe]):k.push([O,Y,Q.uncheckedTemplate,fe]),K+=1}A.push(K),K=0}k.every($=>{let[,,x]=$;return x===k[0][2]})?k=k.map($=>{let[x,N,q]=$;return[x,N,q]}):k=k.map($=>{let[x,N,,q]=$;return[x,N,q.checkedTemplate]}),k.length>0&&A.forEach(($,x)=>{let N=k.splice(0,$);T.size&&T.has(x)&&(N=[...N,...T.get(x)]),n.setDataAtCell(N)})}}function w(){const E=n.getSelectedRange();if(E){for(let C=0;C<E.length;C++){const A=E[C].getTopStartCorner(),T=E[C].getBottomEndCorner();for(let k=A.row;k<=T.row;k++)for(let K=A.col;K<=T.col;K++){if(n.getCellMeta(k,K).readOnly)continue;const x=n.getCell(k,K);if(al(x)&&x.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}Xc.RENDERER_TYPE=up;function gy(n){let e=mf.get(n);if(!e){const{rootElement:t}=n;e=new No(n),e.addEventListener(t,"click",i=>Cy(i,n)),e.addEventListener(t,"mouseup",i=>wy(i,n)),e.addEventListener(t,"change",i=>vy(i,n)),mf.set(n,e)}return e}function my(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function py(n,e,t){const i=n.createElement("label");i.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`;const s=n.createTextNode(e);if(t){const o=n.createElement("span");o.appendChild(s),i.appendChild(o)}else i.appendChild(s);return i.cloneNode(!0)}function wy(n,e){const{target:t}=n;Zc(t)&&(!t.hasAttribute(Po)||!t.hasAttribute(_o)||setTimeout(e.listen,10))}function Cy(n,e){const{target:t}=n;if(!Zc(t)||!t.hasAttribute(Po)||!t.hasAttribute(_o))return;const i=parseInt(t.getAttribute(Po),10),s=parseInt(t.getAttribute(_o),10);e.getCellMeta(i,s).readOnly&&n.preventDefault()}function vy(n,e){const{target:t}=n;if(!Zc(t)||!t.hasAttribute(Po)||!t.hasAttribute(_o))return;const i=parseInt(t.getAttribute(Po),10),s=parseInt(t.getAttribute(_o),10),o=e.getCellMeta(i,s);if(!o.readOnly){let r=null;n.target.checked?r=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:r=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,s,r)}}function Zc(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const Sy="handsontable";function Jc(n,e,t,i,s,o,r){Oo.apply(this,[n,e,t,i,s,o,r])}Jc.RENDERER_TYPE=Sy;var by=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Lh,pf;function Ry(){return pf||(pf=1,Lh={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(n){let e=n%10;return~~(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Lh}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var kh,wf;function cp(){if(wf)return kh;wf=1;const n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function t(l,h,u,c,d,g,w){if(!isNaN(+l))return+l;let E="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*t(C,h,u,c,d,g);for(let x=0;x<n.length;x++){let N=n[x];if(E=l.replace(RegExp(`([0-9 ])(${N.key})$`),"$1"),E!==l)return t(E,h,u,c,d,g)*N.factor}if(E=l.replace("%",""),E!==l)return t(E,h,u,c,d,g)/100;let A=parseFloat(l);if(isNaN(A))return;let T=c(A);if(T&&T!=="."&&(E=l.replace(new RegExp(`${e(T)}$`),""),E!==l))return t(E,h,u,c,d,g);let k={};Object.keys(g).forEach(x=>{k[g[x]]=x});let K=Object.keys(k).sort().reverse(),$=K.length;for(let x=0;x<$;x++){let N=K[x],q=k[N];if(E=l.replace(N,""),E!==l){let ee;switch(q){case"thousand":ee=Math.pow(10,3);break;case"million":ee=Math.pow(10,6);break;case"billion":ee=Math.pow(10,9);break;case"trillion":ee=Math.pow(10,12);break}return t(E,h,u,c,d,g)*ee}}}function i(l,h,u){let c=l.replace(u,"");return c=c.replace(new RegExp(`([0-9])${e(h.thousands)}([0-9])`,"g"),"$1$2"),c=c.replace(h.decimal,"."),c}function s(l,h,u="",c,d,g,w){if(l==="")return;if(l===d)return 0;let E=i(l,h,u);return t(E,h,u,c,d,g)}function o(l,h){if(!(l.indexOf(":")&&h.thousands!==":"))return!1;let c=l.split(":");if(c.length!==3)return!1;let d=+c[0],g=+c[1],w=+c[2];return!isNaN(d)&&!isNaN(g)&&!isNaN(w)}function r(l){let h=l.split(":"),u=+h[0],c=+h[1];return+h[2]+60*c+3600*u}function a(l,h){const u=td();let c=u.currentDelimiters(),d=u.currentCurrency().symbol,g=u.currentOrdinal(),w=u.getZeroFormat(),E=u.currentAbbreviations(),C;if(typeof l=="string")o(l,c)?C=r(l):C=s(l,c,d,g,w,E);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return kh={unformat:a},kh}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Fh,Cf;function Qc(){if(Cf)return Fh;Cf=1;let n=cp();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,t=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],o=["sign","parenthesis"],r={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},h={output:{type:"string",validValues:t},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,A)=>A.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,A)=>A.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,A)=>!A.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,A)=>A.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:r,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(C,A){let T=d(C),k=w(A);return T&&k}function d(C){return n.unformat(C)!==void 0}function g(C,A,T,k=!1){let K=Object.keys(C).map($=>{if(!A[$])return console.error(`${T} Invalid key: ${$}`),!1;let x=C[$],N=A[$];if(typeof N=="string"&&(N={type:N}),N.type==="format"){if(!g(x,h,`[Validate ${$}]`,!0))return!1}else if(typeof x!==N.type)return console.error(`${T} ${$} type mismatched: "${N.type}" expected, "${typeof x}" provided`),!1;if(N.restrictions&&N.restrictions.length){let q=N.restrictions.length;for(let ee=0;ee<q;ee++){let{restriction:O,message:Y}=N.restrictions[ee];if(!O(x,C))return console.error(`${T} ${$} invalid value: ${Y}`),!1}}return N.restriction&&!N.restriction(x,C)?(console.error(`${T} ${$} invalid value: ${N.message}`),!1):N.validValues&&N.validValues.indexOf(x)===-1?(console.error(`${T} ${$} invalid value: must be among ${JSON.stringify(N.validValues)}, "${x}" provided`),!1):!(N.children&&!g(x,N.children,`[Validate ${$}]`))});return k||K.push(...Object.keys(A).map($=>{let x=A[$];if(typeof x=="string"&&(x={type:x}),x.mandatory){let N=x.mandatory;if(typeof N=="function"&&(N=N(C)),N&&C[$]===void 0)return console.error(`${T} Missing mandatory key "${$}"`),!1}return!0})),K.reduce(($,x)=>$&&x,!0)}function w(C){return g(C,h,"[Validate format]")}function E(C){return g(C,u,"[Validate language]")}return Fh={validate:c,validateFormat:w,validateInput:d,validateLanguage:E},Fh}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Ey(n,e){let t=n.match(/^{([^}]*)}/);return t?(e.prefix=t[1],n.slice(t[0].length)):n}function My(n,e){let t=n.match(/{([^}]*)}$/);return t?(e.postfix=t[1],n.slice(0,-t[0].length)):n}function Py(n,e){if(n.indexOf("$")!==-1){e.output="currency";return}if(n.indexOf("%")!==-1){e.output="percent";return}if(n.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(n.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(n.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(n.indexOf(":")!==-1){e.output="time";return}n.indexOf("o")!==-1&&(e.output="ordinal")}function _y(n,e){n.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Iy(n,e){n.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Ty(n,e){let t=n.match(/[1-9]+[0-9]*/);t&&(e.totalLength=+t[0])}function xy(n,e){let i=n.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function Ay(n,e){let t=n.split(".")[1];if(t){let i=t.match(/0+/);i&&(e.mantissa=i[0].length)}}function Ny(n,e){const t=n.split(".")[1];t&&(e.trimMantissa=t.indexOf("[")!==-1)}function Oy(n,e){n.indexOf("a")!==-1&&(e.average=!0)}function Hy(n,e){n.indexOf("K")!==-1?e.forceAverage="thousand":n.indexOf("M")!==-1?e.forceAverage="million":n.indexOf("B")!==-1?e.forceAverage="billion":n.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Dy(n,e){n.match(/\[\.]/)?e.optionalMantissa=!0:n.match(/\./)&&(e.optionalMantissa=!1)}function $y(n,e){if(n.indexOf(".")!==-1){let t=n.split(".")[0];e.optionalCharacteristic=t.indexOf("0")===-1}}function Ly(n,e){n.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),n.match(/^\+?-/)&&(e.negative="sign")}function ky(n,e){n.match(/^\+/)&&(e.forceSign=!0)}function Fy(n,e={}){return typeof n!="string"?n:(n=Ey(n,e),n=My(n,e),Py(n,e),Ty(n,e),xy(n,e),$y(n,e),Oy(n,e),Hy(n,e),Ay(n,e),Dy(n,e),Ny(n,e),_y(n,e),Iy(n,e),Ly(n,e),ky(n,e),e)}var ed={parseFormat:Fy};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Wh,vf;function td(){if(vf)return Wh;vf=1;const n=Ry(),e=Qc(),t=ed;let i={},s,o={},r=null,a={};function l(u){s=u}function h(){return o[s]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>s,i.currentBytes=()=>h().bytes||{},i.currentCurrency=()=>h().currency,i.currentAbbreviations=()=>h().abbreviations,i.currentDelimiters=()=>h().delimiters,i.currentOrdinal=()=>h().ordinal,i.currentDefaults=()=>Object.assign({},h().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().timeFormat),i.setDefaults=u=>{u=t.parseFormat(u),e.validateFormat(u)&&(a=u)},i.getZeroFormat=()=>r,i.setZeroFormat=u=>r=typeof u=="string"?u:null,i.hasZeroFormat=()=>r!==null,i.languageData=u=>{if(u){if(o[u])return o[u];throw new Error(`Unknown tag "${u}"`)}return h()},i.registerLanguage=(u,c=!1)=>{if(!e.validateLanguage(u))throw new Error("Invalid language data");o[u.languageTag]=u,c&&l(u.languageTag)},i.setLanguage=(u,c=n.languageTag)=>{if(!o[u]){let d=u.split("-")[0],g=Object.keys(o).find(w=>w.split("-")[0]===d);if(!o[g]){l(c);return}l(g);return}l(u)},i.registerLanguage(n),s=n.languageTag,Wh=i,Wh}function Wy(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function By(n,e){n.forEach(t=>{let i;try{i=Wy(`../languages/${t}`)}catch{console.error(`Unable to load "${t}". No matching language file found.`)}i&&e.registerLanguage(i)})}var Vy=n=>({loadLanguagesInNode:e=>By(e,n)}),dp={exports:{}};(function(n){(function(e){var t,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,o=Math.floor,r="[BigNumber Error] ",a=r+"Number primitive has more than 15 significant digits: ",l=1e14,h=14,u=9007199254740991,c=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,g=1e9;function w(x){var N,q,ee,O=D.prototype={constructor:D,toString:null,valueOf:null},Y=new D(1),Q=20,fe=4,j=-7,L=21,F=-1e7,G=1e7,V=!1,ie=1,te=0,Se={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Pe="0123456789abcdefghijklmnopqrstuvwxyz",Ue=!0;function D(f,m){var p,M,b,R,I,v,y,_,P=this;if(!(P instanceof D))return new D(f,m);if(m==null){if(f&&f._isBigNumber===!0){P.s=f.s,!f.c||f.e>G?P.c=P.e=null:f.e<F?P.c=[P.e=0]:(P.e=f.e,P.c=f.c.slice());return}if((v=typeof f=="number")&&f*0==0){if(P.s=1/f<0?(f=-f,-1):1,f===~~f){for(R=0,I=f;I>=10;I/=10,R++);R>G?P.c=P.e=null:(P.e=R,P.c=[f]);return}_=String(f)}else{if(!i.test(_=String(f)))return ee(P,_,v);P.s=_.charCodeAt(0)==45?(_=_.slice(1),-1):1}(R=_.indexOf("."))>-1&&(_=_.replace(".","")),(I=_.search(/e/i))>0?(R<0&&(R=I),R+=+_.slice(I+1),_=_.substring(0,I)):R<0&&(R=_.length)}else{if(T(m,2,Pe.length,"Base"),m==10&&Ue)return P=new D(f),nt(P,Q+P.e+1,fe);if(_=String(f),v=typeof f=="number"){if(f*0!=0)return ee(P,_,v,m);if(P.s=1/f<0?(_=_.slice(1),-1):1,D.DEBUG&&_.replace(/^0\.0*|\./,"").length>15)throw Error(a+f)}else P.s=_.charCodeAt(0)===45?(_=_.slice(1),-1):1;for(p=Pe.slice(0,m),R=I=0,y=_.length;I<y;I++)if(p.indexOf(M=_.charAt(I))<0){if(M=="."){if(I>R){R=y;continue}}else if(!b&&(_==_.toUpperCase()&&(_=_.toLowerCase())||_==_.toLowerCase()&&(_=_.toUpperCase()))){b=!0,I=-1,R=0;continue}return ee(P,String(f),v,m)}v=!1,_=q(_,m,10,P.s),(R=_.indexOf("."))>-1?_=_.replace(".",""):R=_.length}for(I=0;_.charCodeAt(I)===48;I++);for(y=_.length;_.charCodeAt(--y)===48;);if(_=_.slice(I,++y)){if(y-=I,v&&D.DEBUG&&y>15&&(f>u||f!==o(f)))throw Error(a+P.s*f);if((R=R-I-1)>G)P.c=P.e=null;else if(R<F)P.c=[P.e=0];else{if(P.e=R,P.c=[],I=(R+1)%h,R<0&&(I+=h),I<y){for(I&&P.c.push(+_.slice(0,I)),y-=h;I<y;)P.c.push(+_.slice(I,I+=h));I=h-(_=_.slice(I)).length}else I-=y;for(;I--;_+="0");P.c.push(+_)}}else P.c=[P.e=0]}D.clone=w,D.ROUND_UP=0,D.ROUND_DOWN=1,D.ROUND_CEIL=2,D.ROUND_FLOOR=3,D.ROUND_HALF_UP=4,D.ROUND_HALF_DOWN=5,D.ROUND_HALF_EVEN=6,D.ROUND_HALF_CEIL=7,D.ROUND_HALF_FLOOR=8,D.EUCLID=9,D.config=D.set=function(f){var m,p;if(f!=null)if(typeof f=="object"){if(f.hasOwnProperty(m="DECIMAL_PLACES")&&(p=f[m],T(p,0,g,m),Q=p),f.hasOwnProperty(m="ROUNDING_MODE")&&(p=f[m],T(p,0,8,m),fe=p),f.hasOwnProperty(m="EXPONENTIAL_AT")&&(p=f[m],p&&p.pop?(T(p[0],-1e9,0,m),T(p[1],0,g,m),j=p[0],L=p[1]):(T(p,-1e9,g,m),j=-(L=p<0?-p:p))),f.hasOwnProperty(m="RANGE"))if(p=f[m],p&&p.pop)T(p[0],-1e9,-1,m),T(p[1],1,g,m),F=p[0],G=p[1];else if(T(p,-1e9,g,m),p)F=-(G=p<0?-p:p);else throw Error(r+m+" cannot be zero: "+p);if(f.hasOwnProperty(m="CRYPTO"))if(p=f[m],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))V=p;else throw V=!p,Error(r+"crypto unavailable");else V=p;else throw Error(r+m+" not true or false: "+p);if(f.hasOwnProperty(m="MODULO_MODE")&&(p=f[m],T(p,0,9,m),ie=p),f.hasOwnProperty(m="POW_PRECISION")&&(p=f[m],T(p,0,g,m),te=p),f.hasOwnProperty(m="FORMAT"))if(p=f[m],typeof p=="object")Se=p;else throw Error(r+m+" not an object: "+p);if(f.hasOwnProperty(m="ALPHABET"))if(p=f[m],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))Ue=p.slice(0,10)=="0123456789",Pe=p;else throw Error(r+m+" invalid: "+p)}else throw Error(r+"Object expected: "+f);return{DECIMAL_PLACES:Q,ROUNDING_MODE:fe,EXPONENTIAL_AT:[j,L],RANGE:[F,G],CRYPTO:V,MODULO_MODE:ie,POW_PRECISION:te,FORMAT:Se,ALPHABET:Pe}},D.isBigNumber=function(f){if(!f||f._isBigNumber!==!0)return!1;if(!D.DEBUG)return!0;var m,p,M=f.c,b=f.e,R=f.s;e:if({}.toString.call(M)=="[object Array]"){if((R===1||R===-1)&&b>=-1e9&&b<=g&&b===o(b)){if(M[0]===0){if(b===0&&M.length===1)return!0;break e}if(m=(b+1)%h,m<1&&(m+=h),String(M[0]).length==m){for(m=0;m<M.length;m++)if(p=M[m],p<0||p>=l||p!==o(p))break e;if(p!==0)return!0}}}else if(M===null&&b===null&&(R===null||R===1||R===-1))return!0;throw Error(r+"Invalid BigNumber: "+f)},D.maximum=D.max=function(){return Yn(arguments,-1)},D.minimum=D.min=function(){return Yn(arguments,1)},D.random=function(){var f=9007199254740992,m=Math.random()*f&2097151?function(){return o(Math.random()*f)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var M,b,R,I,v,y=0,_=[],P=new D(Y);if(p==null?p=Q:T(p,0,g),I=s(p/h),V)if(crypto.getRandomValues){for(M=crypto.getRandomValues(new Uint32Array(I*=2));y<I;)v=M[y]*131072+(M[y+1]>>>11),v>=9e15?(b=crypto.getRandomValues(new Uint32Array(2)),M[y]=b[0],M[y+1]=b[1]):(_.push(v%1e14),y+=2);y=I/2}else if(crypto.randomBytes){for(M=crypto.randomBytes(I*=7);y<I;)v=(M[y]&31)*281474976710656+M[y+1]*1099511627776+M[y+2]*4294967296+M[y+3]*16777216+(M[y+4]<<16)+(M[y+5]<<8)+M[y+6],v>=9e15?crypto.randomBytes(7).copy(M,y):(_.push(v%1e14),y+=7);y=I/7}else throw V=!1,Error(r+"crypto unavailable");if(!V)for(;y<I;)v=m(),v<9e15&&(_[y++]=v%1e14);for(I=_[--y],p%=h,I&&p&&(v=c[h-p],_[y]=o(I/v)*v);_[y]===0;_.pop(),y--);if(y<0)_=[R=0];else{for(R=-1;_[0]===0;_.splice(0,1),R-=h);for(y=1,v=_[0];v>=10;v/=10,y++);y<h&&(R-=h-y)}return P.e=R,P.c=_,P}}(),D.sum=function(){for(var f=1,m=arguments,p=new D(m[0]);f<m.length;)p=p.plus(m[f++]);return p},q=function(){var f="0123456789";function m(p,M,b,R){for(var I,v=[0],y,_=0,P=p.length;_<P;){for(y=v.length;y--;v[y]*=M);for(v[0]+=R.indexOf(p.charAt(_++)),I=0;I<v.length;I++)v[I]>b-1&&(v[I+1]==null&&(v[I+1]=0),v[I+1]+=v[I]/b|0,v[I]%=b)}return v.reverse()}return function(p,M,b,R,I){var v,y,_,P,H,Z,J,me,je=p.indexOf("."),Je=Q,ge=fe;for(je>=0&&(P=te,te=0,p=p.replace(".",""),me=new D(M),Z=me.pow(p.length-je),te=P,me.c=m($(C(Z.c),Z.e,"0"),10,b,f),me.e=me.c.length),J=m(p,M,b,I?(v=Pe,f):(v=f,Pe)),_=P=J.length;J[--P]==0;J.pop());if(!J[0])return v.charAt(0);if(je<0?--_:(Z.c=J,Z.e=_,Z.s=R,Z=N(Z,me,Je,ge,b),J=Z.c,H=Z.r,_=Z.e),y=_+Je+1,je=J[y],P=b/2,H=H||y<0||J[y+1]!=null,H=ge<4?(je!=null||H)&&(ge==0||ge==(Z.s<0?3:2)):je>P||je==P&&(ge==4||H||ge==6&&J[y-1]&1||ge==(Z.s<0?8:7)),y<1||!J[0])p=H?$(v.charAt(1),-Je,v.charAt(0)):v.charAt(0);else{if(J.length=y,H)for(--b;++J[--y]>b;)J[y]=0,y||(++_,J=[1].concat(J));for(P=J.length;!J[--P];);for(je=0,p="";je<=P;p+=v.charAt(J[je++]));p=$(p,_,v.charAt(0))}return p}}(),N=function(){function f(M,b,R){var I,v,y,_,P=0,H=M.length,Z=b%d,J=b/d|0;for(M=M.slice();H--;)y=M[H]%d,_=M[H]/d|0,I=J*y+_*Z,v=Z*y+I%d*d+P,P=(v/R|0)+(I/d|0)+J*_,M[H]=v%R;return P&&(M=[P].concat(M)),M}function m(M,b,R,I){var v,y;if(R!=I)y=R>I?1:-1;else for(v=y=0;v<R;v++)if(M[v]!=b[v]){y=M[v]>b[v]?1:-1;break}return y}function p(M,b,R,I){for(var v=0;R--;)M[R]-=v,v=M[R]<b[R]?1:0,M[R]=v*I+M[R]-b[R];for(;!M[0]&&M.length>1;M.splice(0,1));}return function(M,b,R,I,v){var y,_,P,H,Z,J,me,je,Je,ge,xe,ht,ia,Ph,_h,vn,$o,Gt=M.s==b.s?1:-1,gt=M.c,Ye=b.c;if(!gt||!gt[0]||!Ye||!Ye[0])return new D(!M.s||!b.s||(gt?Ye&&gt[0]==Ye[0]:!Ye)?NaN:gt&&gt[0]==0||!Ye?Gt*0:Gt/0);for(je=new D(Gt),Je=je.c=[],_=M.e-b.e,Gt=R+_+1,v||(v=l,_=E(M.e/h)-E(b.e/h),Gt=Gt/h|0),P=0;Ye[P]==(gt[P]||0);P++);if(Ye[P]>(gt[P]||0)&&_--,Gt<0)Je.push(1),H=!0;else{for(Ph=gt.length,vn=Ye.length,P=0,Gt+=2,Z=o(v/(Ye[0]+1)),Z>1&&(Ye=f(Ye,Z,v),gt=f(gt,Z,v),vn=Ye.length,Ph=gt.length),ia=vn,ge=gt.slice(0,vn),xe=ge.length;xe<vn;ge[xe++]=0);$o=Ye.slice(),$o=[0].concat($o),_h=Ye[0],Ye[1]>=v/2&&_h++;do{if(Z=0,y=m(Ye,ge,vn,xe),y<0){if(ht=ge[0],vn!=xe&&(ht=ht*v+(ge[1]||0)),Z=o(ht/_h),Z>1)for(Z>=v&&(Z=v-1),J=f(Ye,Z,v),me=J.length,xe=ge.length;m(J,ge,me,xe)==1;)Z--,p(J,vn<me?$o:Ye,me,v),me=J.length,y=1;else Z==0&&(y=Z=1),J=Ye.slice(),me=J.length;if(me<xe&&(J=[0].concat(J)),p(ge,J,xe,v),xe=ge.length,y==-1)for(;m(Ye,ge,vn,xe)<1;)Z++,p(ge,vn<xe?$o:Ye,xe,v),xe=ge.length}else y===0&&(Z++,ge=[0]);Je[P++]=Z,ge[0]?ge[xe++]=gt[ia]||0:(ge=[gt[ia]],xe=1)}while((ia++<Ph||ge[0]!=null)&&Gt--);H=ge[0]!=null,Je[0]||Je.splice(0,1)}if(v==l){for(P=1,Gt=Je[0];Gt>=10;Gt/=10,P++);nt(je,R+(je.e=P+_*h-1)+1,I,H)}else je.e=_,je.r=+H;return je}}();function lt(f,m,p,M){var b,R,I,v,y;if(p==null?p=fe:T(p,0,8),!f.c)return f.toString();if(b=f.c[0],I=f.e,m==null)y=C(f.c),y=M==1||M==2&&(I<=j||I>=L)?K(y,I):$(y,I,"0");else if(f=nt(new D(f),m,p),R=f.e,y=C(f.c),v=y.length,M==1||M==2&&(m<=R||R<=j)){for(;v<m;y+="0",v++);y=K(y,R)}else if(m-=I,y=$(y,R,"0"),R+1>v){if(--m>0)for(y+=".";m--;y+="0");}else if(m+=R-v,m>0)for(R+1==v&&(y+=".");m--;y+="0");return f.s<0&&b?"-"+y:y}function Yn(f,m){for(var p,M,b=1,R=new D(f[0]);b<f.length;b++)M=new D(f[b]),(!M.s||(p=A(R,M))===m||p===0&&R.s===m)&&(R=M);return R}function rn(f,m,p){for(var M=1,b=m.length;!m[--b];m.pop());for(b=m[0];b>=10;b/=10,M++);return(p=M+p*h-1)>G?f.c=f.e=null:p<F?f.c=[f.e=0]:(f.e=p,f.c=m),f}ee=function(){var f=/^(-?)0([xbo])(?=\w[\w.]*$)/i,m=/^([^.]+)\.$/,p=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,I,v,y){var _,P=v?I:I.replace(b,"");if(M.test(P))R.s=isNaN(P)?null:P<0?-1:1;else{if(!v&&(P=P.replace(f,function(H,Z,J){return _=(J=J.toLowerCase())=="x"?16:J=="b"?2:8,!y||y==_?Z:H}),y&&(_=y,P=P.replace(m,"$1").replace(p,"0.$1")),I!=P))return new D(P,_);if(D.DEBUG)throw Error(r+"Not a"+(y?" base "+y:"")+" number: "+I);R.s=null}R.c=R.e=null}}();function nt(f,m,p,M){var b,R,I,v,y,_,P,H=f.c,Z=c;if(H){e:{for(b=1,v=H[0];v>=10;v/=10,b++);if(R=m-b,R<0)R+=h,I=m,y=H[_=0],P=o(y/Z[b-I-1]%10);else if(_=s((R+1)/h),_>=H.length)if(M){for(;H.length<=_;H.push(0));y=P=0,b=1,R%=h,I=R-h+1}else break e;else{for(y=v=H[_],b=1;v>=10;v/=10,b++);R%=h,I=R-h+b,P=I<0?0:o(y/Z[b-I-1]%10)}if(M=M||m<0||H[_+1]!=null||(I<0?y:y%Z[b-I-1]),M=p<4?(P||M)&&(p==0||p==(f.s<0?3:2)):P>5||P==5&&(p==4||M||p==6&&(R>0?I>0?y/Z[b-I]:0:H[_-1])%10&1||p==(f.s<0?8:7)),m<1||!H[0])return H.length=0,M?(m-=f.e+1,H[0]=Z[(h-m%h)%h],f.e=-m||0):H[0]=f.e=0,f;if(R==0?(H.length=_,v=1,_--):(H.length=_+1,v=Z[h-R],H[_]=I>0?o(y/Z[b-I]%Z[I])*v:0),M)for(;;)if(_==0){for(R=1,I=H[0];I>=10;I/=10,R++);for(I=H[0]+=v,v=1;I>=10;I/=10,v++);R!=v&&(f.e++,H[0]==l&&(H[0]=1));break}else{if(H[_]+=v,H[_]!=l)break;H[_--]=0,v=1}for(R=H.length;H[--R]===0;H.pop());}f.e>G?f.c=f.e=null:f.e<F&&(f.c=[f.e=0])}return f}function rt(f){var m,p=f.e;return p===null?f.toString():(m=C(f.c),m=p<=j||p>=L?K(m,p):$(m,p,"0"),f.s<0?"-"+m:m)}return O.absoluteValue=O.abs=function(){var f=new D(this);return f.s<0&&(f.s=1),f},O.comparedTo=function(f,m){return A(this,new D(f,m))},O.decimalPlaces=O.dp=function(f,m){var p,M,b,R=this;if(f!=null)return T(f,0,g),m==null?m=fe:T(m,0,8),nt(new D(R),f+R.e+1,m);if(!(p=R.c))return null;if(M=((b=p.length-1)-E(this.e/h))*h,b=p[b])for(;b%10==0;b/=10,M--);return M<0&&(M=0),M},O.dividedBy=O.div=function(f,m){return N(this,new D(f,m),Q,fe)},O.dividedToIntegerBy=O.idiv=function(f,m){return N(this,new D(f,m),0,1)},O.exponentiatedBy=O.pow=function(f,m){var p,M,b,R,I,v,y,_,P,H=this;if(f=new D(f),f.c&&!f.isInteger())throw Error(r+"Exponent not an integer: "+rt(f));if(m!=null&&(m=new D(m)),v=f.e>14,!H.c||!H.c[0]||H.c[0]==1&&!H.e&&H.c.length==1||!f.c||!f.c[0])return P=new D(Math.pow(+rt(H),v?f.s*(2-k(f)):+rt(f))),m?P.mod(m):P;if(y=f.s<0,m){if(m.c?!m.c[0]:!m.s)return new D(NaN);M=!y&&H.isInteger()&&m.isInteger(),M&&(H=H.mod(m))}else{if(f.e>9&&(H.e>0||H.e<-1||(H.e==0?H.c[0]>1||v&&H.c[1]>=24e7:H.c[0]<8e13||v&&H.c[0]<=9999975e7)))return R=H.s<0&&k(f)?-0:0,H.e>-1&&(R=1/R),new D(y?1/R:R);te&&(R=s(te/h+2))}for(v?(p=new D(.5),y&&(f.s=1),_=k(f)):(b=Math.abs(+rt(f)),_=b%2),P=new D(Y);;){if(_){if(P=P.times(H),!P.c)break;R?P.c.length>R&&(P.c.length=R):M&&(P=P.mod(m))}if(b){if(b=o(b/2),b===0)break;_=b%2}else if(f=f.times(p),nt(f,f.e+1,1),f.e>14)_=k(f);else{if(b=+rt(f),b===0)break;_=b%2}H=H.times(H),R?H.c&&H.c.length>R&&(H.c.length=R):M&&(H=H.mod(m))}return M?P:(y&&(P=Y.div(P)),m?P.mod(m):R?nt(P,te,fe,I):P)},O.integerValue=function(f){var m=new D(this);return f==null?f=fe:T(f,0,8),nt(m,m.e+1,f)},O.isEqualTo=O.eq=function(f,m){return A(this,new D(f,m))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(f,m){return A(this,new D(f,m))>0},O.isGreaterThanOrEqualTo=O.gte=function(f,m){return(m=A(this,new D(f,m)))===1||m===0},O.isInteger=function(){return!!this.c&&E(this.e/h)>this.c.length-2},O.isLessThan=O.lt=function(f,m){return A(this,new D(f,m))<0},O.isLessThanOrEqualTo=O.lte=function(f,m){return(m=A(this,new D(f,m)))===-1||m===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(f,m){var p,M,b,R,I=this,v=I.s;if(f=new D(f,m),m=f.s,!v||!m)return new D(NaN);if(v!=m)return f.s=-m,I.plus(f);var y=I.e/h,_=f.e/h,P=I.c,H=f.c;if(!y||!_){if(!P||!H)return P?(f.s=-m,f):new D(H?I:NaN);if(!P[0]||!H[0])return H[0]?(f.s=-m,f):new D(P[0]?I:fe==3?-0:0)}if(y=E(y),_=E(_),P=P.slice(),v=y-_){for((R=v<0)?(v=-v,b=P):(_=y,b=H),b.reverse(),m=v;m--;b.push(0));b.reverse()}else for(M=(R=(v=P.length)<(m=H.length))?v:m,v=m=0;m<M;m++)if(P[m]!=H[m]){R=P[m]<H[m];break}if(R&&(b=P,P=H,H=b,f.s=-f.s),m=(M=H.length)-(p=P.length),m>0)for(;m--;P[p++]=0);for(m=l-1;M>v;){if(P[--M]<H[M]){for(p=M;p&&!P[--p];P[p]=m);--P[p],P[M]+=l}P[M]-=H[M]}for(;P[0]==0;P.splice(0,1),--_);return P[0]?rn(f,P,_):(f.s=fe==3?-1:1,f.c=[f.e=0],f)},O.modulo=O.mod=function(f,m){var p,M,b=this;return f=new D(f,m),!b.c||!f.s||f.c&&!f.c[0]?new D(NaN):!f.c||b.c&&!b.c[0]?new D(b):(ie==9?(M=f.s,f.s=1,p=N(b,f,0,3),f.s=M,p.s*=M):p=N(b,f,0,ie),f=b.minus(p.times(f)),!f.c[0]&&ie==1&&(f.s=b.s),f)},O.multipliedBy=O.times=function(f,m){var p,M,b,R,I,v,y,_,P,H,Z,J,me,je,Je,ge=this,xe=ge.c,ht=(f=new D(f,m)).c;if(!xe||!ht||!xe[0]||!ht[0])return!ge.s||!f.s||xe&&!xe[0]&&!ht||ht&&!ht[0]&&!xe?f.c=f.e=f.s=null:(f.s*=ge.s,!xe||!ht?f.c=f.e=null:(f.c=[0],f.e=0)),f;for(M=E(ge.e/h)+E(f.e/h),f.s*=ge.s,y=xe.length,H=ht.length,y<H&&(me=xe,xe=ht,ht=me,b=y,y=H,H=b),b=y+H,me=[];b--;me.push(0));for(je=l,Je=d,b=H;--b>=0;){for(p=0,Z=ht[b]%Je,J=ht[b]/Je|0,I=y,R=b+I;R>b;)_=xe[--I]%Je,P=xe[I]/Je|0,v=J*_+P*Z,_=Z*_+v%Je*Je+me[R]+p,p=(_/je|0)+(v/Je|0)+J*P,me[R--]=_%je;me[R]=p}return p?++M:me.splice(0,1),rn(f,me,M)},O.negated=function(){var f=new D(this);return f.s=-f.s||null,f},O.plus=function(f,m){var p,M=this,b=M.s;if(f=new D(f,m),m=f.s,!b||!m)return new D(NaN);if(b!=m)return f.s=-m,M.minus(f);var R=M.e/h,I=f.e/h,v=M.c,y=f.c;if(!R||!I){if(!v||!y)return new D(b/0);if(!v[0]||!y[0])return y[0]?f:new D(v[0]?M:b*0)}if(R=E(R),I=E(I),v=v.slice(),b=R-I){for(b>0?(I=R,p=y):(b=-b,p=v),p.reverse();b--;p.push(0));p.reverse()}for(b=v.length,m=y.length,b-m<0&&(p=y,y=v,v=p,m=b),b=0;m;)b=(v[--m]=v[m]+y[m]+b)/l|0,v[m]=l===v[m]?0:v[m]%l;return b&&(v=[b].concat(v),++I),rn(f,v,I)},O.precision=O.sd=function(f,m){var p,M,b,R=this;if(f!=null&&f!==!!f)return T(f,1,g),m==null?m=fe:T(m,0,8),nt(new D(R),f,m);if(!(p=R.c))return null;if(b=p.length-1,M=b*h+1,b=p[b]){for(;b%10==0;b/=10,M--);for(b=p[0];b>=10;b/=10,M++);}return f&&R.e+1>M&&(M=R.e+1),M},O.shiftedBy=function(f){return T(f,-9007199254740991,u),this.times("1e"+f)},O.squareRoot=O.sqrt=function(){var f,m,p,M,b,R=this,I=R.c,v=R.s,y=R.e,_=Q+4,P=new D("0.5");if(v!==1||!I||!I[0])return new D(!v||v<0&&(!I||I[0])?NaN:I?R:1/0);if(v=Math.sqrt(+rt(R)),v==0||v==1/0?(m=C(I),(m.length+y)%2==0&&(m+="0"),v=Math.sqrt(+m),y=E((y+1)/2)-(y<0||y%2),v==1/0?m="5e"+y:(m=v.toExponential(),m=m.slice(0,m.indexOf("e")+1)+y),p=new D(m)):p=new D(v+""),p.c[0]){for(y=p.e,v=y+_,v<3&&(v=0);;)if(b=p,p=P.times(b.plus(N(R,b,_,1))),C(b.c).slice(0,v)===(m=C(p.c)).slice(0,v))if(p.e<y&&--v,m=m.slice(v-3,v+1),m=="9999"||!M&&m=="4999"){if(!M&&(nt(b,b.e+Q+2,0),b.times(b).eq(R))){p=b;break}_+=4,v+=4,M=1}else{(!+m||!+m.slice(1)&&m.charAt(0)=="5")&&(nt(p,p.e+Q+2,1),f=!p.times(p).eq(R));break}}return nt(p,p.e+Q+1,fe,f)},O.toExponential=function(f,m){return f!=null&&(T(f,0,g),f++),lt(this,f,m,1)},O.toFixed=function(f,m){return f!=null&&(T(f,0,g),f=f+this.e+1),lt(this,f,m)},O.toFormat=function(f,m,p){var M,b=this;if(p==null)f!=null&&m&&typeof m=="object"?(p=m,m=null):f&&typeof f=="object"?(p=f,f=m=null):p=Se;else if(typeof p!="object")throw Error(r+"Argument not an object: "+p);if(M=b.toFixed(f,m),b.c){var R,I=M.split("."),v=+p.groupSize,y=+p.secondaryGroupSize,_=p.groupSeparator||"",P=I[0],H=I[1],Z=b.s<0,J=Z?P.slice(1):P,me=J.length;if(y&&(R=v,v=y,y=R,me-=R),v>0&&me>0){for(R=me%v||v,P=J.substr(0,R);R<me;R+=v)P+=_+J.substr(R,v);y>0&&(P+=_+J.slice(R)),Z&&(P="-"+P)}M=H?P+(p.decimalSeparator||"")+((y=+p.fractionGroupSize)?H.replace(new RegExp("\\d{"+y+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):H):P}return(p.prefix||"")+M+(p.suffix||"")},O.toFraction=function(f){var m,p,M,b,R,I,v,y,_,P,H,Z,J=this,me=J.c;if(f!=null&&(v=new D(f),!v.isInteger()&&(v.c||v.s!==1)||v.lt(Y)))throw Error(r+"Argument "+(v.isInteger()?"out of range: ":"not an integer: ")+rt(v));if(!me)return new D(J);for(m=new D(Y),_=p=new D(Y),M=y=new D(Y),Z=C(me),R=m.e=Z.length-J.e-1,m.c[0]=c[(I=R%h)<0?h+I:I],f=!f||v.comparedTo(m)>0?R>0?m:_:v,I=G,G=1/0,v=new D(Z),y.c[0]=0;P=N(v,m,0,1),b=p.plus(P.times(M)),b.comparedTo(f)!=1;)p=M,M=b,_=y.plus(P.times(b=_)),y=b,m=v.minus(P.times(b=m)),v=b;return b=N(f.minus(p),M,0,1),y=y.plus(b.times(_)),p=p.plus(b.times(M)),y.s=_.s=J.s,R=R*2,H=N(_,M,R,fe).minus(J).abs().comparedTo(N(y,p,R,fe).minus(J).abs())<1?[_,M]:[y,p],G=I,H},O.toNumber=function(){return+rt(this)},O.toPrecision=function(f,m){return f!=null&&T(f,1,g),lt(this,f,m,2)},O.toString=function(f){var m,p=this,M=p.s,b=p.e;return b===null?M?(m="Infinity",M<0&&(m="-"+m)):m="NaN":(f==null?m=b<=j||b>=L?K(C(p.c),b):$(C(p.c),b,"0"):f===10&&Ue?(p=nt(new D(p),Q+b+1,fe),m=$(C(p.c),p.e,"0")):(T(f,2,Pe.length,"Base"),m=q($(C(p.c),b,"0"),10,f,M,!0)),M<0&&p.c[0]&&(m="-"+m)),m},O.valueOf=O.toJSON=function(){return rt(this)},O._isBigNumber=!0,x!=null&&D.set(x),D}function E(x){var N=x|0;return x>0||x===N?N:N-1}function C(x){for(var N,q,ee=1,O=x.length,Y=x[0]+"";ee<O;){for(N=x[ee++]+"",q=h-N.length;q--;N="0"+N);Y+=N}for(O=Y.length;Y.charCodeAt(--O)===48;);return Y.slice(0,O+1||1)}function A(x,N){var q,ee,O=x.c,Y=N.c,Q=x.s,fe=N.s,j=x.e,L=N.e;if(!Q||!fe)return null;if(q=O&&!O[0],ee=Y&&!Y[0],q||ee)return q?ee?0:-fe:Q;if(Q!=fe)return Q;if(q=Q<0,ee=j==L,!O||!Y)return ee?0:!O^q?1:-1;if(!ee)return j>L^q?1:-1;for(fe=(j=O.length)<(L=Y.length)?j:L,Q=0;Q<fe;Q++)if(O[Q]!=Y[Q])return O[Q]>Y[Q]^q?1:-1;return j==L?0:j>L^q?1:-1}function T(x,N,q,ee){if(x<N||x>q||x!==o(x))throw Error(r+(ee||"Argument")+(typeof x=="number"?x<N||x>q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(x))}function k(x){var N=x.c.length-1;return E(x.e/h)==N&&x.c[N]%2!=0}function K(x,N){return(x.length>1?x.charAt(0)+"."+x.slice(1):x)+(N<0?"e":"e+")+N}function $(x,N,q){var ee,O;if(N<0){for(O=q+".";++N;O+=q);x=O+x}else if(ee=x.length,++N>ee){for(O=q,N-=ee;--N;O+=q);x+=O}else N<ee&&(x=x.slice(0,N)+"."+x.slice(N));return x}t=w(),t.default=t.BigNumber=t,n.exports?n.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(by)})(dp);var fp=dp.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const dn=td(),Uy=Qc(),jy=ed,Yy=fp,at={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Kr={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:gp,decimalSuffixes:_l}=dn.currentBytes(),nd={general:{scale:1024,suffixes:_l},binary:{scale:1024,suffixes:gp},decimal:{scale:1e3,suffixes:_l}};function Gy(n,e={},t){if(typeof e=="string"&&(e=jy.parseFormat(e)),!Uy.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",o=e.postfix||"",r=zy(n,e,t);return r=dR(r,s),r=fR(r,o),r}function zy(n,e,t){switch(e.output){case"currency":return e=uo(e,dn.currentCurrencyDefaultFormat()),tR(n,e,dn);case"percent":return e=uo(e,dn.currentPercentageDefaultFormat()),eR(n,e,dn,t);case"byte":return e=uo(e,dn.currentByteDefaultFormat()),Zy(n,e,dn,t);case"time":return e=uo(e,dn.currentTimeDefaultFormat()),Qy(n);case"ordinal":return e=uo(e,dn.currentOrdinalDefaultFormat()),Jy(n,e,dn);case"number":default:return qr({instance:n,providedFormat:e})}}function Ky(n){let e=nd.decimal;return lh(n._value,e.suffixes,e.scale).suffix}function qy(n){let e=nd.binary;return lh(n._value,e.suffixes,e.scale).suffix}function Xy(n){let e=nd.general;return lh(n._value,e.suffixes,e.scale).suffix}function lh(n,e,t){let i=e[0],s=Math.abs(n);if(s>=t){for(let o=1;o<e.length;++o){let r=Math.pow(t,o),a=Math.pow(t,o+1);if(s>=r&&s<a){i=e[o],n=n/r;break}}i===e[0]&&(n=n/Math.pow(t,e.length-1),i=e[e.length-1])}return{value:n,suffix:i}}function Zy(n,e,t,i){let s=e.base||"binary",o=Object.assign({},Kr,e);const{binarySuffixes:r,decimalSuffixes:a}=t.currentBytes();let h={general:{scale:1024,suffixes:a||_l,marker:"bd"},binary:{scale:1024,suffixes:r||gp,marker:"b"},decimal:{scale:1e3,suffixes:a||_l,marker:"d"}}[s],{value:u,suffix:c}=lh(n._value,h.suffixes,h.scale);return`${qr({instance:i(u),providedFormat:e,state:t,defaults:t.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${c}`}function Jy(n,e,t){let i=t.currentOrdinal(),s=Object.assign({},Kr,e),o=qr({instance:n,providedFormat:e,state:t}),r=i(n._value);return`${o}${s.spaceSeparated?" ":""}${r}`}function Qy(n){let e=Math.floor(n._value/60/60),t=Math.floor((n._value-e*60*60)/60),i=Math.round(n._value-e*60*60-t*60);return`${e}:${t<10?"0":""}${t}:${i<10?"0":""}${i}`}function eR(n,e,t,i){let s=e.prefixSymbol,o=qr({instance:i(n._value*100),providedFormat:e,state:t}),r=Object.assign({},Kr,e);return s?`%${r.spaceSeparated?" ":""}${o}`:`${o}${r.spaceSeparated?" ":""}%`}function tR(n,e,t){const i=t.currentCurrency();let s=Object.assign({},e),o=Object.assign({},Kr,s),r,a="",l=!!o.totalLength||!!o.forceAverage||o.average,h=s.currencyPosition||i.position,u=s.currencySymbol||i.symbol;const c=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),c&&(a=" "),h==="infix"&&(r=a+u+a);let d=qr({instance:n,providedFormat:s,state:t,decimalSeparator:r});return h==="prefix"&&(n._value<0&&o.negative==="sign"?d=`-${a}${u}${d.slice(1)}`:n._value>0&&o.forceSign?d=`+${a}${u}${d.slice(1)}`:d=u+a+d),(!h||h==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+u),d}function nR({value:n,forceAverage:e,lowPrecision:t=!0,abbreviations:i,spaceSeparated:s=!1,totalLength:o=0,roundingFunction:r=Math.round}){let a="",l=Math.abs(n),h=-1;if(e&&i[e]&&at[e]?(a=i[e],n=n/at[e]):l>=at.trillion||t&&r(l/at.trillion)===1?(a=i.trillion,n=n/at.trillion):l<at.trillion&&l>=at.billion||t&&r(l/at.billion)===1?(a=i.billion,n=n/at.billion):l<at.billion&&l>=at.million||t&&r(l/at.million)===1?(a=i.million,n=n/at.million):(l<at.million&&l>=at.thousand||t&&r(l/at.thousand)===1)&&(a=i.thousand,n=n/at.thousand),a&&(a=(s?" ":"")+a),o){let c=n<0,d=n.toString().split(".")[0],g=c?d.length-1:d.length;h=Math.max(o-g,0)}return{value:n,abbreviation:a,mantissaPrecision:h}}function iR({value:n,characteristicPrecision:e}){let[t,i]=n.toExponential().split("e"),s=+t;if(!e)return{value:s,abbreviation:`e${i}`};let o=1;return o<e&&(s=s*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:s,abbreviation:`e${i}`}}function la(n){let e="";for(let t=0;t<n;t++)e+="0";return e}function sR(n,e){let t=n.toString(),[i,s]=t.split("e"),[o,r=""]=i.split(".");if(+s>0)t=o+r+la(s-r.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(la(-s-1)+Math.abs(o)+r).substr(0,e);l.length<e&&(l+=la(e-l.length)),t=a+l}return+s>0&&e>0&&(t+=`.${la(e)}`),t}function oR(n,e,t=Math.round){return n.toString().indexOf("e")!==-1?sR(n,e):new Yy(t(+`${n}e+${e}`)/Math.pow(10,e)).toFixed(e)}function rR(n,e,t,i,s,o){if(i===-1)return n;let r=oR(e,i,o),[a,l=""]=r.toString().split(".");if(l.match(/^0+$/)&&(t||s))return a;let h=l.match(/0+$/);return s&&h?`${a}.${l.toString().slice(0,h.index)}`:r.toString()}function aR(n,e,t,i){let s=n,[o,r]=s.toString().split(".");if(o.match(/^-?0$/)&&t)return r?`${o.replace("0","")}.${r}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),s=s.slice(1)),o.length<i){let l=i-o.length;for(let h=0;h<l;h++)s=`0${s}`}return a&&(s=`-${s}`),s.toString()}function lR(n,e){let t=[],i=0;for(let s=n;s>0;s--)i===e&&(t.unshift(s),i=0),i++;return t}function hR(n,e,t,i,s){let o=i.currentDelimiters(),r=o.thousands;s=s||o.decimal;let a=o.thousandsSize||3,l=n.toString(),h=l.split(".")[0],u=l.split(".")[1];const c=e<0&&h.indexOf("-")===0;return t&&(c&&(h=h.slice(1)),lR(h.length,a).forEach((g,w)=>{h=h.slice(0,g+w)+r+h.slice(g+w)}),c&&(h=`-${h}`)),u?l=h+s+u:l=h,l}function uR(n,e){return n+e}function cR(n,e,t){return e===0?n:+n==0?n.replace("-",""):e>0?`+${n}`:t==="sign"?n:`(${n.replace("-","")})`}function dR(n,e){return e+n}function fR(n,e){return n+e}function qr({instance:n,providedFormat:e,state:t=dn,decimalSeparator:i,defaults:s=t.currentDefaults()}){let o=n._value;if(o===0&&t.hasZeroFormat())return t.getZeroFormat();if(!isFinite(o))return o.toString();let r=Object.assign({},Kr,s,e),a=r.totalLength,l=a?0:r.characteristic,h=r.optionalCharacteristic,u=r.forceAverage,c=r.lowPrecision,d=!!a||!!u||r.average,g=a?-1:d&&e.mantissa===void 0?0:r.mantissa,w=a?!1:e.optionalMantissa===void 0?g===-1:r.optionalMantissa,E=r.trimMantissa,C=r.thousandSeparated,A=r.spaceSeparated,T=r.negative,k=r.forceSign,K=r.exponential,$=r.roundingFunction,x="";if(d){let q=nR({value:o,forceAverage:u,lowPrecision:c,abbreviations:t.currentAbbreviations(),spaceSeparated:A,roundingFunction:$,totalLength:a});o=q.value,x+=q.abbreviation,a&&(g=q.mantissaPrecision)}if(K){let q=iR({value:o,characteristicPrecision:l});o=q.value,x=q.abbreviation+x}let N=rR(o.toString(),o,w,g,E,$);return N=aR(N,o,h,l),N=hR(N,o,C,t,i),(d||K)&&(N=uR(N,x)),(k||o<0)&&(N=cR(N,o,T)),N}function uo(n,e){if(!n)return e;let t=Object.keys(n);return t.length===1&&t[0]==="output"?e:n}var gR=n=>({format:(...e)=>Gy(...e,n),getByteUnit:(...e)=>Xy(...e,n),getBinaryByteUnit:(...e)=>qy(...e,n),getDecimalByteUnit:(...e)=>Ky(...e,n),formatOrDefault:uo});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ci=fp;function mR(n,e,t){let i=new ci(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new ci(s),n._value=i.plus(s).toNumber(),n}function mp(n,e,t){let i=new ci(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new ci(s),n._value=i.minus(s).toNumber(),n}function pR(n,e,t){let i=new ci(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new ci(s),n._value=i.times(s).toNumber(),n}function wR(n,e,t){let i=new ci(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new ci(s),n._value=i.dividedBy(s).toNumber(),n}function CR(n,e,t){let i=e;return t.isNumbro(e)&&(i=e._value),n._value=i,n}function vR(n,e,t){let i=t(n._value);return mp(i,e,t),Math.abs(i._value)}var SR=n=>({add:(e,t)=>mR(e,t,n),subtract:(e,t)=>mp(e,t,n),multiply:(e,t)=>pR(e,t,n),divide:(e,t)=>wR(e,t,n),set:(e,t)=>CR(e,t,n),difference:(e,t)=>vR(e,t,n),BigNumber:ci});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const bR="2.5.0",jn=td(),yR=Qc(),RR=Vy(Xe),ER=cp();let Yi=gR(Xe),vs=SR(Xe);const MR=ed;class pp{constructor(e){this._value=e}clone(){return Xe(this._value)}format(e={}){return Yi.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=MR.parseFormat(e)),e=Yi.formatOrDefault(e,jn.currentCurrencyDefaultFormat()),e.output="currency",Yi.format(this,e)}formatTime(e={}){return e.output="time",Yi.format(this,e)}binaryByteUnits(){return Yi.getBinaryByteUnit(this)}decimalByteUnits(){return Yi.getDecimalByteUnit(this)}byteUnits(){return Yi.getByteUnit(this)}difference(e){return vs.difference(this,e)}add(e){return vs.add(this,e)}subtract(e){return vs.subtract(this,e)}multiply(e){return vs.multiply(this,e)}divide(e){return vs.divide(this,e)}set(e){return vs.set(this,wp(e))}value(){return this._value}valueOf(){return this._value}}function wp(n){let e=n;return Xe.isNumbro(n)?e=n._value:typeof n=="string"?e=Xe.unformat(n):isNaN(n)&&(e=NaN),e}function Xe(n){return new pp(wp(n))}Xe.version=bR;Xe.isNumbro=function(n){return n instanceof pp};Xe.language=jn.currentLanguage;Xe.registerLanguage=jn.registerLanguage;Xe.setLanguage=jn.setLanguage;Xe.languages=jn.languages;Xe.languageData=jn.languageData;Xe.zeroFormat=jn.setZeroFormat;Xe.defaultFormat=jn.currentDefaults;Xe.setDefaults=jn.setDefaults;Xe.defaultCurrencyFormat=jn.currentCurrencyDefaultFormat;Xe.validate=yR.validate;Xe.loadLanguagesInNode=RR.loadLanguagesInNode;Xe.unformat=ER.unformat;Xe.BigNumber=vs.BigNumber;var PR=Xe,Gi=yy(PR);const _R="numeric";function Cp(n,e){if(Ut(n)){const t=e.numericFormat,i=t&&t.culture||"-",s=t&&t.pattern;if(typeof i<"u"&&!Gi.languages()[i]){const o=i.replace("-",""),r=Gi.allLanguages?Gi.allLanguages[i]:Gi[o];r&&Gi.registerLanguage(r)}Gi.setLanguage(i),n=Gi(n).format(s||"0")}return n}function id(n,e,t,i,s,o,r){let a=o;if(Ut(a)){let h=[];if(Array.isArray(r.className))h=r.className;else{var l;const u=(l=r.className)!==null&&l!==void 0?l:"";u.length&&(h=u.split(" "))}a=Cp(a,r),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),r.className=h.join(" "),e.dir="ltr"}Hs(n,e,t,i,s,a,r)}id.RENDERER_TYPE=_R;const IR="password";function sd(n,e,t,i,s,o,r){Hs.apply(this,[n,e,t,i,s,o,r]);const a=r.hashLength||e.innerHTML.length,l=r.hashSymbol||"*";let h="";ne(a-1,()=>{h+=l}),Yr(e,h)}sd.RENDERER_TYPE=IR;const TR="select";function od(n,e,t,i,s,o,r){Hs.apply(this,[n,e,t,i,s,o,r])}od.RENDERER_TYPE=TR;const xR="time";function rd(n,e,t,i,s,o,r){Hs.apply(this,[n,e,t,i,s,o,r]),e.dir="ltr"}rd.RENDERER_TYPE=xR;function AR(){qt(Oo),qt(Vc),qt(Xc),qt(qc),qt(Jc),qt(Kc),qt(id),qt(sd),qt(od),qt(Hs),qt(rd)}const NR="autocomplete";function hh(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,Sf(t,e)):Sf(t,e)(this.source):e(!0)}hh.VALIDATOR_TYPE=NR;function Sf(n,e){const t=n;return function(i){let s=!1;for(let o=0,r=i.length;o<r;o++)if(t===i[o]){s=!0;break}e(s)}}function vp(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const OR=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:vp},Symbol.toStringTag,{value:"Module"})),HR="date";function ad(n,e){const t=VC(ip,this.instance);let i=n,s=!0;i==null&&(i="");let o=ve(i,this.dateFormat||t.defaultDateFormat,!0).isValid(),r=ve(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(r=!0,o=!0),r||(s=!1),!r&&o&&(s=!0),r&&!o)if(this.correctFormat===!0){const a=DR(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),s=!0}else s=!1;e(s)}ad.VALIDATOR_TYPE=HR;function DR(n,e){const t=ve(vp(n)),i=ve(n,e),s=n.search(/[A-Za-z]/g)>-1;let o;return t.isValid()&&t.format("x")===i.format("x")||!i.isValid()||s?o=t:o=i,o.format(e)}const $R="dropdown";function ld(n,e){hh.apply(this,[n,e])}ld.VALIDATOR_TYPE=$R;const LR="numeric";function hd(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:Ut(n))}hd.VALIDATOR_TYPE=LR;const kR=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],FR="time";function ud(n,e){const t=this.timeFormat||"h:mm:ss a";let i=!0,s=n;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const o=/^\d{1,2}$/.test(s);o&&(s+=":00");const r=ve(s,kR,!0).isValid()?ve(s):ve(s,t);let a=r.isValid(),l=ve(s,t,!0).isValid()&&!o;if(this.allowEmpty&&s===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const h=r.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,h,"timeValidator"),i=!0}else i=!1;e(i)}ud.VALIDATOR_TYPE=FR;function WR(){ho(hh),ho(ld),ho(ad),ho(hd),ho(ud)}const BR="autocomplete",VR={CELL_TYPE:BR,editor:Gc,renderer:Oo,validator:hh},UR="checkbox",jR={CELL_TYPE:UR,editor:np,renderer:Xc},YR="date";function Sp(n,e,t,i,s,o,r){Oo.apply(this,[n,e,t,i,s,o,r])}Sp.RENDERER_TYPE=YR;const GR="date",zR={CELL_TYPE:GR,editor:sp,renderer:Sp,validator:ad},KR="dropdown",qR={CELL_TYPE:KR,editor:op,renderer:qc,validator:ld,filter:!1,strict:!0},XR="handsontable",ZR={CELL_TYPE:XR,editor:Yc,renderer:Jc},JR="numeric",QR={CELL_TYPE:JR,editor:rp,renderer:id,validator:hd,dataType:"number"},e0="password",t0={CELL_TYPE:e0,editor:ap,renderer:sd,copyable:!1},n0="select",i0={CELL_TYPE:n0,editor:lp,renderer:od},s0="time",o0={CELL_TYPE:s0,editor:hp,renderer:rd,validator:ud};function r0(){un(VR),un(jR),un(zR),un(qR),un(ZR),un(QR),un(t0),un(i0),un(UC),un(o0)}function a0(n,e){bp(n,e),e.add(n)}function l0(n,e,t){bp(n,e),e.set(n,t)}function bp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(n,e,t){return(e=h0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function h0(n){var e=u0(n,"string");return typeof e=="symbol"?e:e+""}function u0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ls(n,e){return n.get(yp(n,e))}function yp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const bf=new Map([["plugin",YC],["cell-type",GC],["editor",zC],["renderer",KC],["validator",qC]]),Rp=Symbol("mainSetting"),c0="base",ha=[];let zi=null;var Ki=new WeakMap,yf=new WeakSet;class de{static get PLUGIN_KEY(){return c0}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){a0(this,yf),$s(this,"eventManager",new No(this)),$s(this,"pluginName",null),$s(this,"pluginsInitializedCallbacks",[]),$s(this,"isPluginsReady",!1),$s(this,"enabled",!1),$s(this,"initialized",!1),l0(this,Ki,{}),jC(this,"hot",e,{writable:!1}),zi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const s=[];if(t.forEach(o=>{const[r,a]=o.split(":");if(!bf.has(r))throw new Error(`Unknown plugin dependency type "${r}" was found.`);bf.get(r)(a)||s.push(` - ${a} (${r})`)}),s.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");ha.push(o)}}if(zi||(zi=Tm()),zi.indexOf(this.pluginName)>=0&&zi.splice(zi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),zi.length===0){if(ha.length>0){const s=[`${ha.join(`
`)}
`,"You have to import and register them manually."].join("");throw ha.length=0,new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return t;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(t)||Me(t))&&i[Rp]===e){var s;return Array.isArray(t)?t:(s=t[e])!==null&&s!==void 0?s:i[e]}if(Me(t)){var o;return(o=t[e])!==null&&o!==void 0?o:i[e]}return i[e]}addHook(e,t,i){Ls(Ki,this)[e]=Ls(Ki,this)[e]||[];const s=Ls(Ki,this)[e];this.hot.addHook(e,t,i),s.push(t),Ls(Ki,this)[e]=s}removeHooks(e){S(Ls(Ki,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Ls(Ki,this);yt(e,(t,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){S(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=yp(yf,this,d0).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),yt(this,(t,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function d0(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function qi(n,e,t){return(e=f0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f0(n){var e=g0(n,"string");return typeof e=="symbol"?e:e+""}function g0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let cd=class{constructor(e){qi(this,"hot",null),qi(this,"container",null),qi(this,"injected",!1),qi(this,"rows",[]),qi(this,"columns",[]),qi(this,"samples",null),qi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),S(this.rows,t=>{const{height:i}=t.table.getBoundingClientRect();e(t.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),S(this.columns,t=>{const{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{S(i.strings,s=>{t.appendChild(this.createColElement(s.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),i.appendChild(s)),this.samples.forEach(o=>{S(o.strings,r=>{const a=r.col,l=this.hot.getCellMeta(e,a),h=this.hot.getCellRenderer(l),u=t.createElement("td");u.setAttribute("ghost-table",1),h(this.hot,u,e,a,this.hot.colToProp(a),r.value,l),i.appendChild(u)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");i.push([-1,s]),t.appendChild(s)}this.samples.forEach(s=>{S(s.strings,o=>{const r=o.col,a=e.createElement("th");i.push([r,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),S(i,s=>{const[o,r]=s;this.hot.view.appendColHeader(o,r)})}createCol(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(s=>{S(s.strings,o=>{const r=o.row,a=this.hot.getCellMeta(r,e),l=this.hot.getCellRenderer(a),h=t.createElement("td"),u=t.createElement("tr");h.setAttribute("ghost-table",1),l(this.hot,h,r,e,this.hot.colToProp(e),o.value,a),u.appendChild(h),i.appendChild(u)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const i=this.hot.rootDocument.createElement("col");let s=0;t>=0&&e>=0&&(s=this.hot.getCellMeta(t,e).colspan);let o=this.hot.getColWidth(e);if(s>1)for(let r=e+1;r<e+s;r++)o+=this.hot.getColWidth(r);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=t.createElement("thead"),r=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&s.appendChild(a),this.isHorizontal()&&(l.appendChild(h),o.appendChild(l),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(o),this.isVertical()&&r.appendChild(l),s.appendChild(r),U(s,e),i.appendChild(s),{fragment:i,table:s,tHead:o,tBody:r,colGroup:a,tr:l,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),s=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return U(s,o),i.appendChild(s),{fragment:i,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function ua(n,e,t){return(e=m0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m0(n){var e=p0(n,"string");return typeof e=="symbol"?e:e+""}function p0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uh{static get SAMPLE_COUNT(){return 3}constructor(e){ua(this,"samples",null),ua(this,"dataFactory",null),ua(this,"customSampleCount",null),ua(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:uh.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,i){const s=new Map,{from:o,to:r}=typeof i=="number"?{from:i,to:i}:i;return ne(o,r,a=>{const l=this.generateSample(e,t,a);s.set(a,l)}),s}generateSample(e,t,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,o=e==="row"?"col":"row",r=[];return ne(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:h,bundleSeed:u}=l,c=typeof u=="string"&&u.length>0;let d;c?d=u:Me(h)?d=`${Object.keys(h).length}`:Array.isArray(h)?d=`${h.length}`:d=`${tt(h).length}`,s.has(d)||s.set(d,{needed:this.getSampleCount(),strings:[]});const g=s.get(d);g.needed&&(!(r.indexOf(h)>-1)||this.allowDuplicates||c)&&(g.strings.push({value:h,[o]:a}),r.push(h),g.needed-=1)}),s}}function w0(n,e){Ep(n,e),e.add(n)}function Rf(n,e,t){Ep(n,e),e.set(n,t)}function Ep(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(n,e,t){return(e=C0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C0(n){var e=v0(n,"string");return typeof e=="symbol"?e:e+""}function v0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ys(n,e){return n.get($n(n,e))}function dd(n,e,t){return n.set($n(n,e),t),t}function $n(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("modifyAutoColumnSizeSeed");const Bh="autoColumnSize",S0=10,b0="autoColumnSize";var co=new WeakMap,Io=new WeakMap,Qn=new WeakSet;class Cr extends de{static get PLUGIN_KEY(){return Bh}static get PLUGIN_PRIORITY(){return S0}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),w0(this,Qn),Lo(this,"ghostTable",new cd(this.hot)),Lo(this,"samplesGenerator",new uh((t,i)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o))return!1;const r=this.hot.getCellMeta(t,i);let a="";r.spanned||(a=this.hot.getDataAtCell(t,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,r,a)),{value:a,bundleSeed:l}})),Lo(this,"inProgress",!1),Lo(this,"measuredColumns",0),Lo(this,"columnWidthsMap",new Gr),Rf(this,co,[]),Rf(this,Io,[]),this.hot.columnIndexMapper.registerMap(b0,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,i,s)=>$n(Qn,this,Ef).call(this,t,i,s))}isEnabled(){return this.hot.getSettings()[Bh]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return $n(Qn,e,E0).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return $n(Qn,e,M0).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return $n(Qn,e,_0).call(e,...s)}),this.addHook("beforeRender",()=>$n(Qn,this,R0).call(this)),this.addHook("modifyColWidth",(i,s)=>this.getColumnWidth(s,i)),this.addHook("init",()=>$n(Qn,this,P0).call(this)),super.enablePlugin()}updatePlugin(){dd(Io,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,i)=>$n(Qn,this,Ef).call(this,e,t,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;ne(s.from,s.to,r=>{let a=this.hot.toPhysicalColumn(r);a===null&&(a=r),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(r,o).forEach((h,u)=>this.ghostTable.addColumn(u,h))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,a)=>{const l=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countCols()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot){El(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Cr.CALCULATION_STEP,s)},e,t),i=i+Cr.CALCULATION_STEP+1,i<s?o=Nm(r):(El(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),i=a+1),i<s?r():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Bh];let t=Cr.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Me(e)&&(t=e.syncLimit,xm(t)?t=Am(i,t):t>>=0),Math.min(t,i)}getColumnWidth(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof s=="number"&&(s=Math.max(s,Rl))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,s,o)=>{const r=ys(co,this).length;return(r-1<o||ys(co,this)[o]!==s)&&i.push(this.hot.toVisualColumn(o)),r-1<o?ys(co,this).push(s):ys(co,this)[o]=s,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function y0(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const i=this.hot.toPhysicalColumn(t);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(t,e).forEach((o,r)=>this.ghostTable.addColumn(r,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,i)=>{const s=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function R0(){this.calculateVisibleColumnsWidth(),this.inProgress||($n(Qn,this,y0).call(this,ys(Io,this)),dd(Io,this,[]))}function E0(n,e){e||this.recalculateAllColumnsWidth()}function M0(n){const e=n.reduce((t,i)=>{let[,s]=i;const o=this.hot.propToCol(s);return Number.isInteger(o)&&t.indexOf(o)===-1&&t.push(o),t},[]);ys(Io,this).push(...e)}function Ef(n,e,t){let i=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function P0(){dd(co,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _0(n){const e=n.reduce((t,i)=>{var s;const o=(s=i.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(o)){const r=this.hot.toVisualColumn(o);t.indexOf(r)===-1&&t.push(r)}return t},[]);ys(Io,this).push(...e)}const Rs={horizontal:"horizontal",vertical:"vertical"};function I0(n,e,t){let i,s,o;return e[0]===n[0]&&e[1]<n[1]?(o="left",i=t(e[0],e[1]),s=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(o="right",i=t(e[0],n[3]+1),s=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(o="up",i=t(e[0],e[1]),s=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(o="down",i=t(n[2]+1,e[1]),s=t(e[2],e[3])),i&&i.normalize(),s&&s.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:s}}function T0(n){const e={};return n===!0?(e.directions=Object.keys(Rs),e.autoInsertRow=!0):Me(n)?(pe(n.autoInsertRow)?n.direction===Rs.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,pe(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Rs)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function x0(n,e){A0(n,e),e.add(n)}function A0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(n,e,t){return(e=N0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N0(n){var e=O0(n,"string");return typeof e=="symbol"?e:e+""}function O0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ko(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("modifyAutofillRange");X.getSingleton().register("beforeAutofill");X.getSingleton().register("afterAutofill");const Mf="autofill",H0=20,D0=["fillHandle"],$0="insert_row_below",L0=200;var Fs=new WeakSet;class k0 extends de{constructor(){super(...arguments),x0(this,Fs),ks(this,"addingStarted",!1),ks(this,"mouseDownOnCellCorner",!1),ks(this,"mouseDragOutside",!1),ks(this,"handleDraggedCells",0),ks(this,"directions",[]),ks(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return Mf}static get PLUGIN_PRIORITY(){return H0}static get SETTING_KEYS(){return[Mf,...D0]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ko(Fs,this,W0).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ko(Fs,this,F0).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>ko(Fs,this,B0).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:s,endCol:o}]),a=[],l=[],h=[];return S(r,u=>{for(let c=u.startRow;c<=u.endRow;c+=1)a.indexOf(c)===-1&&a.push(c);for(let c=u.startCol;c<=u.endCol;c+=1)l.indexOf(c)===-1&&l.push(c)}),S(a,u=>{const c=[];S(l,d=>{c.push(this.hot.getCopyableData(u,d))}),h.push(c)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,i,s]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),r=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,a.row,a.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,e),Math.min(r.col,t),Math.max(a.row,i),Math.max(a.col,s)],l),{directionOfDrag:u,startOfDragCoords:c,endOfDragCoords:d}=I0(l,h,(g,w)=>this.hot._createCellCoords(g,w));if(c&&c.row>-1&&c.col>-1){const g=this.getSelectionData(),w=o.clone(),E=this.hot._createCellRange(c,c,d),C=this.hot.runHooks("beforeAutofill",g,w,E,u);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let A=C;const T=C;if(["up","left"].indexOf(u)>-1&&!(T.length===1&&T[0].length===0))if(A=[],u==="up"){const k=d.row-c.row+1,K=k%T.length;for(let $=0;$<k;$++)A.push(T[($+(T.length-K))%T.length])}else{const k=d.col-c.col+1,K=k%T[0].length;for(let $=0;$<T.length;$++){A.push([]);for(let x=0;x<k;x++)A[$].push(T[$][(x+(T[$].length-K))%T[$].length])}}this.hot.populateFromArray(c.row,c.col,A,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",A,w,E,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner();let s=e;if(this.directions.includes(Rs.vertical)&&this.directions.includes(Rs.horizontal)){const o=t.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(s=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(s=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Rs.vertical))s=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Rs.horizontal))s=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter($0,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},L0)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),i=this.hot.countRows();let s;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const h=t[o][l];if(!Rt(h))return-1}const r=t[o][e[1]-1],a=t[o][e[3]+1];(!Rt(r)||!Rt(a))&&(s=o)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Te(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,i=Ml(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Ts(this.hot.table),s=Ml(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Is(this.hot.table);return e.clientY>i&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ko(Fs,this,V0).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>ko(Fs,this,U0).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=T0(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function F0(){this.selectAdjacent()&&this.fillIn()}function W0(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function B0(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function V0(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function U0(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function j0(n,e){Mp(n,e),e.add(n)}function Y0(n,e,t){Mp(n,e),e.set(n,t)}function Mp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(n,e,t){return(e=G0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G0(n){var e=z0(n,"string");return typeof e=="symbol"?e:e+""}function z0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function K0(n,e,t){return n.set(Ln(n,e),t),t}function fd(n,e){return n.get(Ln(n,e))}function Ln(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Vh="autoRowSize",q0=40,X0="autoRowSize";var Dr=new WeakMap,ei=new WeakSet;class vr extends de{static get PLUGIN_KEY(){return Vh}static get PLUGIN_PRIORITY(){return q0}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),j0(this,ei),Ws(this,"headerHeight",null),Ws(this,"ghostTable",new cd(this.hot)),Ws(this,"samplesGenerator",new uh((t,i)=>{const s=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(o)||t>=0&&i>=0&&this.hot.getCellMeta(t,i).hidden)return!1;let r;return t>=0?r=this.hot.getDataAtCell(t,i):t===-1&&(r=this.hot.getColHeader(i)),{value:r}})),Ws(this,"inProgress",!1),Ws(this,"measuredRows",0),Ws(this,"rowHeightsMap",new Gr),Y0(this,Dr,[]),this.hot.rowIndexMapper.registerMap(X0,this.rowHeightsMap),this.addHook("beforeRowResize",(t,i,s)=>Ln(ei,this,Pf).call(this,t,i,s))}isEnabled(){const e=this.hot.getSettings()[Vh];return e===!0||Me(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ln(ei,e,Q0).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ln(ei,e,eE).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ln(ei,e,nE).call(e,...s)}),this.addHook("beforeRender",()=>Ln(ei,this,J0).call(this)),this.addHook("modifyRowHeight",(i,s)=>this.getRowHeight(s,i)),this.addHook("init",()=>Ln(ei,this,tE).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,i)=>Ln(ei,this,Pf).call(this,e,t,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const r=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(r.get(-1))}ne(s.from,s.to,r=>{let a=this.hot.toPhysicalRow(r);a===null&&(a=r),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(r,o).forEach((h,u)=>this.ghostTable.addRow(u,h))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,a)=>{r<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(r),a)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countRows()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot){El(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+vr.CALCULATION_STEP,s)},e,t),i=i+vr.CALCULATION_STEP+1,i<s?o=Nm(r):(El(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),i=a+1),i<s?r():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Vh];let t=vr.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Me(e)&&(t=e.syncLimit,xm(t)?t=Am(i,t):t>>=0),Math.min(t,i)}getRowHeight(e,t){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=t;return i!==null&&i>(t||0)&&(s=i),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ne(Math.min(t,i),Math.max(t,i),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Z0(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((s,o)=>this.ghostTable.addRow(o,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,i)=>{const s=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function J0(){this.calculateVisibleRowsHeight(),this.inProgress||(Ln(ei,this,Z0).call(this,fd(Dr,this)),K0(Dr,this,[]))}function Pf(n,e,t){let i=n;return t&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Q0(n,e){e||this.recalculateAllRowsHeight()}function eE(n){const e=n.reduce((t,i)=>{let[s]=i;return t.indexOf(s)===-1&&t.push(s),t},[]);fd(Dr,this).push(...e)}function tE(){this.recalculateAllRowsHeight()}function nE(n){const e=n.reduce((t,i)=>{var s;const o=(s=i.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(o)){const r=this.hot.toVisualRow(o);t.indexOf(r)===-1&&t.push(r)}return t},[]);fd(Dr,this).push(...e)}const{getListWithInsertedItems:iE,getListWithRemovedItems:sE}=ep("physicallyIndexed");class oE extends Om{constructor(){super(e=>e)}insert(e,t){const i=XC(this.indexedValues,t);this.indexedValues=iE(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=sE(this.indexedValues,e);this.indexedValues=ZC(t,e),super.remove(e)}}const{getListWithInsertedItems:rE,getListWithRemovedItems:aE}=ep("physicallyIndexed");class lE extends Om{constructor(){super(e=>e)}insert(e,t){this.indexedValues=rE(this.indexedValues,e,t,(i,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=aE(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function hE(n,e){uE(n,e),e.add(n)}function uE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cE(n,e,t){return(e=dE(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dE(n){var e=fE(n,"string");return typeof e=="symbol"?e:e+""}function fE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _f="bindRowsWithHeaders",mE=210,pE="loose",If=new Map([["loose",oE],["strict",lE]]);var Tf=new WeakSet;class wE extends de{constructor(){super(...arguments),hE(this,Tf),cE(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _f}static get PLUGIN_PRIORITY(){return mE}isEnabled(){return!!this.hot.getSettings()[_f]}enablePlugin(){var e;if(this.enabled)return;const t=(e=If.get(this.getSetting()))!==null&&e!==void 0?e:If.get(pE);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",i=>gE(Tf,this,CE).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function CE(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function vE(n,e){Pp(n,e),e.add(n)}function SE(n,e,t){Pp(n,e),e.set(n,t)}function Pp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(n,e,t){return(e=bE(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bE(n){var e=yE(n,"string");return typeof e=="symbol"?e:e+""}function yE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Af(n,e){return n.get(wo(n,e))}function Uh(n,e,t){return n.set(wo(n,e),t),t}function wo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hl="collapsibleColumns",RE=290,EE=["nestedHeaders"],yo="collapsibleIndicator",Nf=hl,Of=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Bs=new WeakMap,Fo=new WeakSet;class ME extends de{constructor(){super(...arguments),vE(this,Fo),xf(this,"nestedHeadersPlugin",null),xf(this,"headerStateManager",null),SE(this,Bs,null)}static get PLUGIN_KEY(){return hl}static get PLUGIN_PRIORITY(){return RE}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[hl,...EE]}isEnabled(){return!!this.hot.getSettings()[hl]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||$e("You need to configure the Nested Headers plugin in order to use collapsible headers."),Uh(Bs,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>wo(Fo,this,IE).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return wo(Fo,e,TE).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return wo(Fo,e,PE).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(i,s,o)=>wo(Fo,this,_E).call(this,i,s,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Uh(Bs,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:o,columnIndex:r}=(e=this.headerStateManager.getHeaderTreeNodeData(t,i))!==null&&e!==void 0?e:{};if(s)return o?this.expandSection({row:t,col:r}):this.collapseSection({row:t,col:r}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:Nf,relativeToGroup:xo,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Nf)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(r){r&&r.parentNode.removeChild(r)};ne(0,e-1,r=>{const a=t.childNodes[r],l=i.childNodes[r],h=s?s.childNodes[r]:null;ne(0,a.childNodes.length-1,u=>{let c=a.childNodes[u].querySelector(`.${yo}`);o(c),l&&l.childNodes[u]&&(c=l.childNodes[u].querySelector(`.${yo}`),o(c)),s&&h&&h.childNodes[u]&&(c=h.childNodes[u].querySelector(`.${yo}`),o(c))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(i=>{const{collapsible:s,origColspan:o,headerLevel:r,columnIndex:a,isCollapsed:l}=i;if(s===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(r),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Of.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const i=Or(e,g=>{let{row:w}=g;return w<0});let s=i.length>0;S(i,g=>{var w;let{row:E,col:C}=g;const{collapsible:A,isCollapsed:T}=(w=this.headerStateManager.getHeaderSettings(E,C))!==null&&w!==void 0?w:{};if(!A||T&&t==="collapse"||!T&&t==="expand")return s=!1,!1});const o=[],r=[];s&&S(i,g=>{let{row:w,col:E}=g;const{colspanCompensation:C,affectedColumns:A,rollbackModification:T}=this.headerStateManager.triggerNodeModification(t,w,E);C>0&&(r.push(...A),o.push(T))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=JC([...a,...r]):t==="expand"&&(l=Or(a,g=>!r.includes(g)));const h=Of.get(t);if(this.hot.runHooks(h.beforeHook,a,l,s)===!1){S(o,g=>{g()});return}this.hot.batchExecution(()=>{S(r,g=>{Af(Bs,this).setValueAtIndex(this.hot.toPhysicalColumn(g),h.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&c&&d){const{row:g,col:w}=d.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(w))&&r.includes(w)){const C=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,A=w>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(w,1,!0):w;C!==null&&A!==null&&this.hot.selectCell(C,A)}}this.hot.runHooks(h.afterHook,a,l,s,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Af(Bs,this).getHiddenIndexes()}destroy(){Uh(Bs,this,null),super.destroy()}}function PE(n,e,t){var i;const{collapsible:s,origColspan:o,isCollapsed:r}=(i=this.headerStateManager.getHeaderSettings(t,n))!==null&&i!==void 0?i:{},a=s&&o>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${yo}`);if(QC(e,[sn("")[0]]),a)h||(h=this.hot.rootDocument.createElement("div"),U(h,yo),e.querySelector("div:first-child").appendChild(h)),Ee(h,["collapsed","expanded"]),r?(U(h,"collapsed"),Gd(h,"+"),l&&Oe(e,...sn(!1))):(U(h,"expanded"),Gd(h,"-"),l&&Oe(e,...sn(!0))),l&&Oe(h,...Ao());else{var u;(u=h)===null||u===void 0||u.remove()}}function _E(n,e){Ne(n.target,yo)&&(Ne(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ne(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Os(n))}function IE(){this.updatePlugin()}function TE(n,e){e||this.updatePlugin()}function Xi(n,e,t){return(e=xE(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xE(n){var e=AE(n,"string");return typeof e=="symbol"?e:e+""}function AE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const NE=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],OE=!1,HE=!0,DE=!0;class $E{constructor(e,t){Xi(this,"hot",void 0),Xi(this,"sortingStates",new Uc),Xi(this,"sortEmptyCells",OE),Xi(this,"indicator",HE),Xi(this,"headerAction",DE),Xi(this,"compareFunctionFactory",void 0),Xi(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){Me(e)&&yt(e,(t,i)=>{NE.includes(i)&&(this[i]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Me(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[i,s]=t;return{column:this.hot.toVisualColumn(i),...s}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(pe(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function _p(n,e,t){const i=e.locale;return function(s,o){const{sortEmptyCells:r}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),s===o?Bn:Rt(s)?Rt(o)?Bn:r&&n==="asc"?Be:Ve:Rt(o)?r&&n==="asc"?Ve:Be:isNaN(s)&&!isNaN(o)?n==="asc"?Ve:Be:!isNaN(s)&&isNaN(o)||(isNaN(s)||isNaN(o)||(s=parseFloat(s),o=parseFloat(o)),s<o)?n==="asc"?Be:Ve:s>o?n==="asc"?Ve:Be:Bn}}const Ip="default";function LE(n,e,t){return function(i,s){const o=parseFloat(i),r=parseFloat(s),{sortEmptyCells:a}=t;if(o===r||isNaN(o)&&isNaN(r))return Bn;if(a){if(Rt(i))return n==="asc"?Be:Ve;if(Rt(s))return n==="asc"?Ve:Be}return isNaN(o)?Ve:isNaN(r)?Be:o<r?n==="asc"?Be:Ve:o>r?n==="asc"?Ve:Be:Bn}}const kE="numeric";function FE(n,e,t){const i=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:o}=t;return function(r,a){const l=Rt(r),h=Rt(a),u=l?s:r,c=h?s:a,d=u===s||u===i,g=c===s||c===i;if(o===!1){if(l&&h===!1)return Ve;if(l===!1&&h)return Be}return d===!1&&g?n==="asc"?Be:Ve:d&&g===!1?n==="asc"?Ve:Be:d===!1&&g===!1?_p(n,e,t)(r,a):u===s&&c===i?n==="asc"?Be:Ve:u===i&&c===s?n==="asc"?Ve:Be:Bn}}const WE="checkbox";function BE(n,e,t){return Hp(n,e.dateFormat,t)}const VE="date";function UE(n,e,t){return Hp(n,e.timeFormat,t)}const jE="time",{register:Xr,getItem:Hf,hasItem:YE}=zr("sorting.compareFunctionFactory"),{register:Tp,getItem:GE}=zr("sorting.mainSortComparator");function xp(n){return YE(n)?Hf(n):Hf(Ip)}Xr(WE,FE);Xr(VE,BE);Xr(Ip,_p);Xr(kE,LE);Xr(jE,UE);const Bn=0,Be=-1,Ve=1;function zE(n,e){const t=GE(e);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];n.sort(t(...s))}const Il="asc",Tl="desc",Ap="colHeader";function KE(n){if(Me(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[Il,Tl].includes(t)}function qE(n){if(n.some(t=>KE(t)===!1))return!1;const e=n.map(t=>{let{column:i}=t;return i});return new Set(e).size===e.length}function Df(n){if(n!==Tl)return n===Il?Tl:Il}function Np(n){return n.querySelector(`.${Ap}`)}function Op(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function gd(n,e,t){return n===-1&&e>=0&&rh(t)===!1}function Hp(n,e,t){return function(i,s){const{sortEmptyCells:o}=t;if(i===s)return Bn;if(Rt(i))return Rt(s)?Bn:o&&n==="asc"?Be:Ve;if(Rt(s))return o&&n==="asc"?Ve:Be;const r=ve(i,e),a=ve(s,e);return r.isValid()?a.isValid()?a.isAfter(r)?n==="asc"?Be:Ve:a.isBefore(r)?n==="asc"?Ve:Be:Bn:Be:Ve}}function XE(n,e){$e(ot`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${n}\` will work. The \`${e}\` plugin will remain disabled.`)}const ZE="ascending",JE="descending",Dp="indicatorDisabled",$p="columnSorting",Lp="sortAction",kp=new Map([[Il,ZE],[Tl,JE]]);function QE(n,e,t,i){const s=[$p];if(i&&s.push(Lp),t===!1)return s.push(Dp),s;const o=n.getSortOrderOfColumn(e);return pe(o)&&s.push(kp.get(o)),s}function eM(){return Array.from(kp.values()).concat(Lp,Dp,$p)}function tM(n,e){return function(t,i){const[,...s]=t,[,...o]=i;return function(a){const l=n[a],h=e[a],u=s[a],c=o[a],d=h.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:xp(h.type))(l,h,d)(u,c)}(0)}}function nM(n,e){iM(n,e),e.add(n)}function iM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(n,e,t){return(e=sM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sM(n){var e=oM(n,"string");return typeof e=="symbol"?e:e+""}function oM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function fo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const xl="columnSorting",rM=50,Al="append",aM="replace",$f=xl;Tp(xl,tM);X.getSingleton().register("beforeColumnSort");X.getSingleton().register("afterColumnSort");const Wo=new WeakMap;var Ss=new WeakSet;class Fp extends de{constructor(){super(...arguments),nM(this,Ss),ca(this,"columnStatesManager",null),ca(this,"columnMetaCache",null),ca(this,"pluginKey",xl),ca(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return xl}static get PLUGIN_PRIORITY(){return rM}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Wo.has(this.hot)&&Wo.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),XE(Wo.get(this.hot),this.pluginKey);return}this.enabled||(Wo.set(this.hot,this.pluginKey),this.columnStatesManager=new $E(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Gr(t=>{let i=this.hot.toVisualColumn(t);return i===null&&(i=t),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,i)=>fo(Ss,this,lM).call(this,t,i)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return fo(Ss,e,uM).call(e,...i)}),this.addHook("afterOnCellMouseDown",(t,i)=>this.onAfterOnCellMouseDown(t,i)),this.addHook("afterInit",()=>fo(Ss,this,gc).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return fo(Ss,e,hM).call(e,...i)}),this.hot.view&&fo(Ss,this,gc).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,i)=>{const s=Np(i);Op(t,i)===!1||s===null||this.updateHeaderClasses(s)};Wo.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:xo,position:"before",group:$f})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($f)}sort(e){const t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",t,i,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new ev),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,s?i:t,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return pe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return qE(e)&&e.every(i=>{let{column:s}=i;return s<=t&&s>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),i=s=>{let{column:o,...r}=s;return{column:this.hot.toPhysicalColumn(o),...r}};t.initialConfig=Te(e,i),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,i=s=>{let{column:o,...r}=s;return{column:this.hot.toVisualColumn(o),...r}};return pe(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Te(t.initialConfig,i)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(pe(t)){const s=Df(t);return pe(s)?{column:e,sortOrder:s}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:Df()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Al;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=i!==-1,o=this.getSortConfig(),r=this.getColumnNextConfig(e);if(s){if(Vn(r))return[...o.slice(0,i),...o.slice(i+1)];if(t===Al)return[...o.slice(0,i),...o.slice(i+1),r];if(t===aM)return[...o.slice(0,i),r,...o.slice(i+1)]}return pe(r)?o.concat(r):o}getPluginColumnConfig(e){if(Me(e)){const t=e[this.pluginKey];if(Me(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(s);return Array.isArray(o.columns)?Object.assign(i,t,this.getPluginColumnConfig(o.columns[e])):Hm(o.columns)?Object.assign(i,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),i=Object.create(t);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],i=this.hot.countRows(),s=h=>Te(e,u=>this.hot.getDataAtCell(h,u.column));for(let h=0;h<this.getNumberOfRowsToSort(i);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(s(h)));const o=Te(t,h=>h[0]);zE(t,this.pluginKey,Te(e,h=>h.sortOrder),Te(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<i;h+=1)t.push([h].concat(s(h)));const r=Te(t,h=>h[0]),a=new Map(Te(o,(h,u)=>[h,r[u]])),l=Te(this.hot.rowIndexMapper.getIndexesSequence(),h=>a.has(h)?a.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Me(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||Me(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Ee(e,eM()),this.enabled!==!1){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];U(e,QE(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),pe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Ne(e.target,Ap)}onAfterOnCellMouseDown(e,t){if(gd(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const i=this.hot.getActiveEditor(),s=this.getColumnNextConfig(t.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function gc(){const n=this.getAllSavedSortSettings();if(Me(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function lM(n,e){const t=Np(e);if(Op(n,e)===!1||t===null)return;const i=this.getFirstCellSettings(n)[this.pluginKey],s=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,s,o),this.hot.getSettings().ariaTags){const r=this.columnStatesManager.getSortOrderOfColumn(n);Oe(e,...tv(r?`${r}ending`:"none"))}}function hM(n){n===!0&&this.hot.view&&fo(Ss,this,gc).call(this)}function uM(n,e,t,i){gd(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Zi(n,e,t){return(e=cM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cM(n){var e=dM(n,"string");return typeof e=="symbol"?e:e+""}function dM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fM{constructor(e,t){Zi(this,"plugin",void 0),Zi(this,"hot",void 0),Zi(this,"endpoints",[]),Zi(this,"settings",void 0),Zi(this,"settingsType","array"),Zi(this,"currentEndpoint",null),Zi(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),S(i,s=>{const o={};this.assignSetting(s,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,o,"reversedRowCoords",!1),this.assignSetting(s,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"sourceColumn",s.destinationColumn),this.assignSetting(s,o,"type","sum"),this.assignSetting(s,o,"forceNumeric",!1),this.assignSetting(s,o,"suppressDataTypeErrors",!0),this.assignSetting(s,o,"customFunction",null),this.assignSetting(s,o,"readOnly",!0),this.assignSetting(s,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,i,s){if(i==="ranges"&&e[i]===void 0){t[i]=s;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(s instanceof Error)throw s;t[i]=s}else i==="destinationRow"&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();S(o,r=>{s==="row"&&r.destinationRow>=t&&(e==="insert_row"?r.alterRowOffset=i:e==="remove_row"&&(r.alterRowOffset=-1*i)),s==="col"&&r.destinationColumn>=t&&(e==="insert_col"?r.alterColumnOffset=i:e==="remove_col"&&(r.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,i,s,o){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),u=e.indexOf("move_row")===0,c=t;S(h,d=>{a==="row"&&d.destinationRow>=c&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=c&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(h,!u),u?S(h,d=>{this.extendEndpointRanges(d,c,s[0],s.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):S(h,d=>{this.shiftEndpointCoordinates(d,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,s){S(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?i>o[1]?o[1]+=s:i<o[0]&&(o[0]-=s):i>=o[0]&&i<=o[1]&&(o[1]-=s,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,i=[],s=[];S(t,o=>{const r=[];if(o[1])for(let a=o[0];a<=o[1];a++)r.push(this.hot.toPhysicalRow(a));else r.push(this.hot.toPhysicalRow(o[0]));s.push(r)}),S(s,o=>{let r=[];S(o,(a,l)=>{l===0?r.push(a):o[l]!==o[l-1]+1&&(r.push(o[l-1]),i.push(r),r=[],r.push(a)),l===o.length-1&&(r.push(a),i.push(r))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,S(e.ranges,i=>{S(i,(s,o)=>{s>=t&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const o=s.alterRowOffset||0,r=s.alterColumnOffset||0;return s.destinationRow+o>=this.hot.countRows()||s.destinationColumn+r>=this.hot.countCols()})||(this.cellsToSetCache=[],S(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],S(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],S(e,(i,s,o)=>{`${i[2]||""}`!=`${i[3]}`&&S(this.getAllEndpoints(),(r,a)=>{this.hot.propToCol(o[s][1])===r.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),S(t,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const i=this.hot.getCellMeta(t,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const r=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||r.readOnly!==e.readOnly)&&(r.readOnly=e.readOnly,r.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const r=e.roundFloat;let a=0;Number.isInteger(r)&&(a=Math.min(Math.max(0,r),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){$e("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function jh(n){return n==null||isNaN(n)}function gM(n,e){mM(n,e),e.add(n)}function mM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pM(n,e,t){return(e=wM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wM(n){var e=CM(n,"string");return typeof e=="symbol"?e:e+""}function CM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function da(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Yh="columnSummary",vM=220;var Bo=new WeakSet;class SM extends de{constructor(){super(...arguments),gM(this,Bo),pM(this,"endpoints",null)}static get PLUGIN_KEY(){return Yh}static get PLUGIN_PRIORITY(){return vM}isEnabled(){return!!this.hot.getSettings()[Yh]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Yh],this.endpoints=new fM(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return da(Bo,e,bM).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return da(Bo,e,RM).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return da(Bo,e,yM).call(e,...i)}),this.addHook("beforeCreateRow",(t,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,s)),this.addHook("beforeCreateCol",(t,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,s)),this.addHook("afterCreateCol",(t,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return da(Bo,e,EM).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return yt(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,s=e[1]||e[0],o=null,r=0;do{if(o=this.getCellValue(s,t),o=jh(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>r&&(r=a)}i+=o||0,s-=1}while(s>=e[0]);return Math.round(i*10**r)/10**r}calculateMinMax(e,t){let i=null;return yt(e.ranges,s=>{const o=this.getPartialMinMax(s,e.sourceColumn,t);if(i===null&&o!==null&&(i=o),o!==null)switch(t){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,t,i){let s=null,o=e[1]||e[0],r;do{if(r=this.getCellValue(o,t),r=jh(r)?null:r,s===null)s=r;else if(r!==null)switch(i){case"min":s=Math.min(s,r);break;case"max":s=Math.max(s,r);break}o-=1}while(o>=e[0]);return s}countEmpty(e,t){let i,s=0,o=e[1]||e[0];do i=this.getCellValue(o,t),i=jh(i)?null:i,i===null&&(s+=1),o-=1;while(o>=e[0]);return s}countEntries(e){let t=0;const i=e.ranges;return yt(i,s=>{const o=s[1]===void 0?1:s[1]-s[0]+1,r=this.countEmpty(s,e.sourceColumn);t+=o,t-=r}),t}calculateAverage(e){const t=this.calculateSum(e),i=this.countEntries(e);return t/i}getCellValue(e,t){const i=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),r="";if(i!==null&&s!==null&&(r=this.hot.getCellMeta(i,s).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ot`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function bM(){this.endpoints.initEndpoints()}function yM(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function RM(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function EM(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function MM(n,e){Wp(n,e),e.add(n)}function Gh(n,e,t){Wp(n,e),e.set(n,t)}function Wp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(n,e){return n.get(md(n,e))}function mc(n,e,t){return n.set(md(n,e),t),t}function md(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap,fa=new WeakMap,ga=new WeakMap,Lf=new WeakSet;class Bp{constructor(){MM(this,Lf),Gh(this,Nl,!0),Gh(this,fa,null),Gh(this,ga,new ResizeObserver(e=>md(Lf,this,PM).call(this,e)))}setObservedElement(e){mc(fa,this,e)}unobserve(){go(ga,this).unobserve(go(fa,this))}observe(){mc(Nl,this,!0),go(ga,this).observe(go(fa,this))}destroy(){go(ga,this).disconnect()}}function PM(n){if(go(Nl,this)||!Array.isArray(n)||!n.length){mc(Nl,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:i,blockSize:s}=t[0];this.runLocalHooks("resize",i,s)})}Vi(Bp,Ui);function Ji(n,e,t){_M(n,e),e.set(n,t)}function _M(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(n,e){return n.get(Vp(n,e))}function zn(n,e,t){return n.set(Vp(n,e),t),t}function Vp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Qi=new WeakMap,zh=new WeakMap,Kn=new WeakMap,gi=new WeakMap,mi=new WeakMap,ma=new WeakMap,Vs=new WeakMap;class Es{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var i=this;Ji(this,Qi,void 0),Ji(this,zh,!1),Ji(this,Kn,null),Ji(this,gi,void 0),Ji(this,mi,void 0),Ji(this,ma,!0),Ji(this,Vs,new Bp),zn(Qi,this,e),zn(zh,this,t),zn(gi,this,this.createEditor()),zn(mi,this,_e(gi,this).style),_e(Vs,this).setObservedElement(this.getInputElement()),_e(Vs,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,t){_e(mi,this).left=`${e}px`,_e(mi,this).top=`${t}px`}setSize(e,t){if(e&&t){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${t}px`}}getSize(){return{width:Is(this.getInputElement()),height:Ts(this.getInputElement())}}observeSize(){_e(Vs,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){_e(mi,this).display="block",zn(ma,this,!1)}hide(){_e(Vs,this).unobserve(),_e(ma,this)||(_e(mi,this).display="none"),zn(ma,this,!0)}isVisible(){return _e(mi,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return _e(Qi,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=_e(Qi,this).createElement("div"),t=_e(Qi,this).createElement("textarea");return e.style.display="none",zn(Kn,this,_e(Qi,this).createElement("div")),_e(Kn,this).setAttribute("dir",_e(zh,this)?"rtl":"ltr"),U(_e(Kn,this),Es.CLASS_EDITOR_CONTAINER),_e(Qi,this).body.appendChild(_e(Kn,this)),U(e,Es.CLASS_EDITOR),U(t,Es.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),_e(Kn,this).appendChild(e),e}getInputElement(){return _e(gi,this).querySelector(`.${Es.CLASS_INPUT}`)}getEditorElement(){return _e(gi,this)}destroy(){const e=_e(Kn,this)?_e(Kn,this).parentNode:null;_e(gi,this).parentNode.removeChild(_e(gi,this)),zn(gi,this,null),zn(mi,this,null),_e(Vs,this).destroy(),e&&e.removeChild(_e(Kn,this))}}Vi(Es,Ui);function Kh(n,e,t){return(e=IM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function IM(n){var e=TM(n,"string");return typeof e=="symbol"?e:e+""}function TM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const xM=250,AM=250;class Up{constructor(e){Kh(this,"wasLastActionShow",!0),Kh(this,"showDebounced",null),Kh(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},AM)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xM;this.showDebounced=Dm(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Vi(Up,Ui);function NM(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function OM(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function es(n,e){const t={};return S(n,i=>{i.forAll((s,o)=>{s>=0&&o>=0&&(t[s]||(t[s]=[]),t[s][o]=e(s,o))})}),t}function Pi(n,e,t,i,s){S(n,o=>{o.forAll((r,a)=>{r>=0&&a>=0&&HM(r,a,e,t,i,s)})})}function HM(n,e,t,i,s,o){const r=s(n,e);let a=i;r.className&&(t==="vertical"?a=NM(r.className,i):a=OM(r.className,i)),o(n,e,"className",a)}function jp(n){return`<span class="selected">✓</span>${n}`}function ul(n,e){let t=!1;return Array.isArray(n)&&S(n,i=>(i.forAll((s,o)=>{if(s>=0&&o>=0&&e(s,o))return t=!0,!1}),t)),t}function ch(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:i}=e.defaultView,{top:s,left:o}=i.getBoundingClientRect();t.top=s,t.left=o}return t}const ae="---------";function DM(){return{name:ae}}const Zt="alignment";function $M(){return{key:Zt,name(){return this.getTranslatedPhrase(hv)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Zt}:left`,name(){return this.getTranslatedPhrase(nv)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{key:`${Zt}:center`,name(){return this.getTranslatedPhrase(iv)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{key:`${Zt}:right`,name(){return this.getTranslatedPhrase(sv)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{key:`${Zt}:justify`,name(){return this.getTranslatedPhrase(ov)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{name:ae},{key:`${Zt}:top`,name(){return this.getTranslatedPhrase(rv)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{key:`${Zt}:middle`,name(){return this.getTranslatedPhrase(av)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1},{key:`${Zt}:bottom`,name(){return this.getTranslatedPhrase(lv)},callback(){const n=this.getSelectedRange(),e=es(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,n,t,i),Pi(n,t,i,(s,o)=>this.getCellMeta(s,o),(s,o,r,a)=>this.setCellMeta(s,o,r,a)),this.render()},disabled:!1}]}}}const dh="clear_column";function LM(){return{key:dh,name(){return this.getTranslatedPhrase(uv)},callback(n,e){const t=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return n.forAll((t,i)=>{if(t<0||i<0)return!0;const{readOnly:s}=this.getCellMeta(t,i);return s?!0:(e=!0,!1)}),!e}}}const Zr="col_left";function kM(){return{key:Zr,name(){return this.getTranslatedPhrase(cv)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Jr="col_right";function FM(){return{key:Jr,name(){return this.getTranslatedPhrase(dv)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!!(!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Qr="make_read_only";function WM(){return{key:Qr,checkable:!0,ariaChecked(){return ul(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(zd)},name(){let n=this.getTranslatedPhrase(zd);return ul(this.getSelectedRange(),(t,i)=>this.getCellMeta(t,i).readOnly)&&(n=jp(n)),n},callback(){const n=this.getSelectedRange(),e=ul(n,(t,i)=>this.getCellMeta(t,i).readOnly);S(n,t=>{t.forAll((i,s)=>{i>=0&&s>=0&&this.setCellMeta(i,s,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const fh="redo";function BM(){return{key:fh,name(){return this.getTranslatedPhrase(fv)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ea="remove_col";function VM(){return{key:ea,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(mv,e)},callback(){this.alter("remove_col",gv(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const gh="remove_row";function UM(){return{key:gh,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(wv,e)},callback(){this.alter("remove_row",pv(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const mh="row_above";function jM(){return{key:mh,name(){return this.getTranslatedPhrase(Cv)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ph="row_below";function YM(){return{key:ph,name(){return this.getTranslatedPhrase(vv)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!!(!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const $r="no_items";function GM(){return{key:$r,name(){return this.getTranslatedPhrase(Sv)},disabled:!0,isCommand:!1}}const wh="undo";function zM(){return{key:wh,name(){return this.getTranslatedPhrase(bv)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const KM=[mh,ph,Zr,Jr,dh,gh,ea,wh,fh,Qr,Zt,ae,$r],qM={[ae]:DM,[$r]:GM,[mh]:jM,[ph]:YM,[Zr]:kM,[Jr]:FM,[dh]:LM,[gh]:UM,[ea]:VM,[wh]:zM,[fh]:BM,[Qr]:WM,[Zt]:$M};function Yp(){const n={};return yt(qM,(e,t)=>{n[t]=e()}),n}function XM(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(yv):this.getTranslatedPhrase(Rv)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ZM(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Ev)},callback(){this.getSelectedRangeLast().forAll((t,i)=>{t>=0&&i>=0&&n.removeCommentAtCell(t,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function JM(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Mv);return ul(this.getSelectedRange(),(i,s)=>n.getCommentMeta(i,s,cl))?jp(e):e},callback(){this.getSelectedRangeLast().forAll((t,i)=>{if(t>=0&&i>=0){const s=!!n.getCommentMeta(t,i,cl);n.updateCommentMeta(t,i,{[cl]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function QM(n,e){Gp(n,e),e.add(n)}function Us(n,e,t){Gp(n,e),e.set(n,t)}function Gp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eP(n,e,t){return(e=tP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tP(n){var e=nP(n,"string");return typeof e=="symbol"?e:e+""}function nP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Di(n,e,t){return n.set(Lt(n,e),t),t}function re(n,e){return n.get(Lt(n,e))}function Lt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ol="comments",iP=60,si="comment",mr="value",zp="style",cl="readOnly",Vo=Ol,pc=`plugin:${Ol}`;var ye=new WeakMap,On=new WeakMap,Ch=new WeakMap,dl=new WeakMap,wc=new WeakMap,Hl=new WeakMap,zt=new WeakSet;class sP extends de{constructor(){super(...arguments),QM(this,zt),eP(this,"range",{}),Us(this,ye,null),Us(this,On,null),Us(this,Ch,!1),Us(this,dl,!1),Us(this,wc,null),Us(this,Hl,"")}static get PLUGIN_KEY(){return Ol}static get PLUGIN_PRIORITY(){return iP}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Ol]}enablePlugin(){var e=this;this.enabled||(re(ye,this)||(Di(ye,this,new Es(this.hot.rootDocument,this.hot.isRtl())),re(ye,this).addLocalHook("resize",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Lt(zt,e,dP).call(e,...i)})),re(On,this)||Di(On,this,new Up(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,i,s,o,r,a)=>Lt(zt,this,hP).call(this,t,a)),this.addHook("afterScroll",()=>Lt(zt,this,gP).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Lt(zt,this,fP).call(this,t)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Lt(zt,e,mP).call(e,...i)}),re(On,this).addLocalHook("hide",()=>this.hide()),re(On,this).addLocalHook("show",(t,i)=>this.showAtCell(t,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){re(On,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),i=e.addContext(pc);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();Di(dl,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(pc),this.hot._registerTimeout(()=>{Di(dl,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:Vo}),i.addShortcut({keys:[["Escape"]],callback:()=>{re(ye,this).setValue(re(Hl,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>re(ye,this).isVisible()&&re(ye,this).isFocused(),group:Vo}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>re(ye,this).isVisible()&&re(ye,this).isFocused(),group:Vo}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{re(ye,this).setValue(re(ye,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Vo})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Vo)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Lt(zt,this,aP).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Lt(zt,this,oP).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Lt(zt,this,lP).call(this)),this.eventManager.addEventListener(t,"focus",()=>Lt(zt,this,cP).call(this)),this.eventManager.addEventListener(t,"blur",()=>Lt(zt,this,uP).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Lt(zt,this,rP).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Hr(e.target,"TD","TBODY");return!!(t&&Ne(t,"htCommentCell")&&Hr(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=re(ye,this).getValue();let i="";e!=null?i=e:t!=null&&(i=t);const s=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(s,o,{[mr]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,si),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,mr)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,mr)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:i}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return re(On,this).cancelHiding(),re(ye,this).setValue((e=s[si]?s[si][mr]:null)!==null&&e!==void 0?e:""),re(ye,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){re(ye,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!re(ye,this).isVisible()))return;const{rowIndexMapper:t,columnIndexMapper:i}=this.hot,{row:s,col:o}=this.range.from;let r=t.getRenderableFromVisualIndex(s),a=i.getRenderableFromVisualIndex(o);const l=r===null;re(ye,this).setPosition(0,0),r===null&&(r=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(s,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const h=r===null,u=a===null;r=r??0,a=a??0;const{rootWindow:c,view:{_wt:d}}=this.hot,{wtTable:g}=d,w=d.getCell({row:r,col:a},!0),E=this.getCommentMeta(s,o,zp);E?re(ye,this).setSize(E.width,E.height):re(ye,this).resetSize();const C=u?0:g.getColumnWidth(a),A=l&&!h?Ts(w):0,{left:T,top:k,width:K,height:$}=w.getBoundingClientRect(),{width:x,height:N}=re(ye,this).getSize(),{innerWidth:q,innerHeight:ee}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,Y=sh(this.hot.rootDocument),Q=Pv(this.hot.rootWindow)?Y:0,fe=_v(this.hot.rootWindow)?Y:0;let j=T+c.scrollX+C,L=k+c.scrollY+A;this.hot.isRtl()&&(j-=x+C),this.hot.isLtr()&&T+K+x>q-Q?j=T+c.scrollX-x-1:this.hot.isRtl()&&j<-(O.scrollWidth-O.clientWidth)&&(j=T+c.scrollX+C+1),k+N>ee-fe&&(L-=N-$+1),re(ye,this).setPosition(j,L),re(ye,this).setReadOnlyState(this.getCommentMeta(s,o,cl)),re(ye,this).observeSize()}focusEditor(){re(ye,this).focus()}updateCommentMeta(e,t,i){const s=this.hot.getCellMeta(e,t)[si];let o;s?(o=xs(s),Pm(o,i)):o=i,this.hot.setCellMeta(e,t,si,o)}getCommentMeta(e,t,i){const s=this.hot.getCellMeta(e,t);if(s[si])return s[si][i]}addToContextMenu(e){e.items.push({name:ae},XM(this),ZM(this),JM(this))}getEditorInputElement(){return re(ye,this).getInputElement()}destroy(){var e,t;(e=re(ye,this))===null||e===void 0||e.destroy(),(t=re(On,this))===null||t===void 0||t.destroy(),super.destroy()}}function oP(n){if(!(!this.hot.view||!this.hot.view._wt)&&!re(Ch,this)&&!this.targetIsCommentTextArea(n)){const e=Hr(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function rP(n){n.stopPropagation()}function aP(n){const{rootDocument:e}=this.hot;if(!(re(Ch,this)||re(ye,this).isFocused()||Ne(n.target,"wtBorder")||re(wc,this)===n.target||!re(ye,this)))if(Di(wc,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));re(On,this).show(t)}else ll(n.target,e)&&!this.targetIsCommentTextArea(n)&&re(On,this).hide()}function lP(){Di(Ch,this,!1)}function hP(n,e){e[si]&&e[si][mr]&&U(n,e.commentedCellClassName)}function uP(){Di(Hl,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function cP(){Di(Hl,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(pc)}function dP(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[zp]:{width:n,height:e}})}function fP(n){re(ye,this).isFocused()&&Os(n)}function gP(){re(dl,this)||this.hide()}function mP(){const n=re(ye,this).getEditorElement();Ee(n,/ht-theme-.*/g),U(n,this.hot.getCurrentThemeName())}function qh(n,e,t){return(e=pP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pP(n){var e=wP(n,"string");return typeof e=="symbol"?e:e+""}function wP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Kp{constructor(e){qh(this,"hot",void 0),qh(this,"commands",{}),qh(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];const o=e.split(":"),r=o[0],a=o.length===2?o[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(a&&l.submenu&&(l=CP(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||jt(l,"submenu"))return;const h=[];typeof l.callback=="function"&&h.push(l.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),i.unshift(o.join(":")),S(h,u=>u.apply(this.hot,i))}}function CP(n,e){let t;return S(e,i=>{const s=i.key?i.key.split(":"):null;if(Array.isArray(s)&&s[1]===n)return t=i,!1}),t}function Xh(n,e,t){return(e=vP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vP(n){var e=SP(n,"string");return typeof e=="symbol"?e:e+""}function SP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qp{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Xh(this,"hot",void 0),Xh(this,"predefinedItems",Yp()),Xh(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,yt(e,(i,s)=>{let o="";i.name===ae?(t[ae]=i,o=ae):isNaN(parseInt(s,10))?(i.key=i.key===void 0?s:i.key,t[s]=i,o=i.key):(t[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return bP(e,this.defaultOrderPattern,this.predefinedItems)}}function bP(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let s=n;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),Me(s)?yt(s,(o,r)=>{let a=t[typeof o=="string"?o:r];a||(a=o),Me(o)?Nt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=r),i.push(a)}):S(s,(o,r)=>{let a=t[o];!a&&KM.indexOf(o)>=0||(a||(a={name:o,key:`${r}`}),Me(o)&&Nt(a,o),a.key===void 0&&(a.key=r),i.push(a))}),i}function pi(n,e,t){return(e=yP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yP(n){var e=RP(n,"string");return typeof e=="symbol"?e:e+""}function RP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EP{constructor(e,t){pi(this,"top",void 0),pi(this,"topRelative",void 0),pi(this,"left",void 0),pi(this,"leftRelative",void 0),pi(this,"scrollTop",void 0),pi(this,"scrollLeft",void 0),pi(this,"cellHeight",void 0),pi(this,"cellWidth",void 0);const i=t.scrollY,s=t.scrollX;let o,r,a,l,h,u;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),h=e.height||0,u=e.width||0,r=o,l=a,o+=i,a+=s):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),h=e.target.clientHeight,u=e.target.clientWidth,r=o-i,l=a-s),this.top=o,this.topRelative=r,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=s,this.cellHeight=h,this.cellWidth=u}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Uo(n,e,t){MP(n,e),e.set(n,t)}function MP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(n,e){return n.get(Xp(n,e))}function pa(n,e,t){return n.set(Xp(n,e),t),t}function Xp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mt=new WeakMap,bn=new WeakMap,Et=new WeakMap,Zh=new WeakMap,js=new WeakMap;class PP{constructor(e){Uo(this,mt,void 0),Uo(this,bn,void 0),Uo(this,Et,void 0),Uo(this,Zh,!1),Uo(this,js,{above:0,below:0,left:0,right:0}),pa(Zh,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return le(js,this)[e]=t,this}setElement(e){return pa(mt,this,e),this}setParentElement(e){return pa(bn,this,e),this}updatePosition(e){pa(Et,this,new EP(e,le(mt,this).ownerDocument.defaultView)),le(Zh,this)?(le(Et,this).fitsBelow(le(mt,this))?this.setPositionBelowCursor():le(Et,this).fitsAbove(le(mt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){le(mt,this).dir==="rtl"?le(Et,this).fitsOnLeft(le(mt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():le(Et,this).fitsOnRight(le(mt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=le(js,this).above+le(Et,this).top-le(mt,this).offsetHeight;le(bn,this)&&(e=le(Et,this).top+le(Et,this).cellHeight-le(mt,this).offsetHeight+3),le(mt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=le(js,this).below+le(Et,this).top+1;le(bn,this)&&(e=le(Et,this).top-1),le(mt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=le(Et,this).left;if(le(bn,this)){const t=le(bn,this).ownerDocument.defaultView,i=Number.parseInt(t.getComputedStyle(le(bn,this).querySelector(".htCore")).borderRightWidth,10);e+=le(Et,this).cellWidth+i}else e+=le(js,this).right;le(mt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=le(js,this).left+le(Et,this).left-le(mt,this).offsetWidth;if(le(bn,this)){const t=le(bn,this).ownerDocument.defaultView,i=Number.parseInt(t.getComputedStyle(le(bn,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}le(mt,this).style.left=`${e}px`}}function Zp(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:i=()=>{},onClear:s=()=>{}}=n;const o=new Set;let r=Yt(e,-1,w()-1);function a(C,A){const T=w()-1;return C<0&&(C=T),C>T&&(C=0),o.has(C)?-1:(o.add(C),i(C,!1)===!1&&(C=a(A===1?++C:--C,A)),C)}function l(C){C>-1&&C<w()&&i(C,!0)!==!1&&(r=C)}function h(){return r}function u(){w()>0&&(o.clear(),r=a(0,1))}function c(){w()>0&&(o.clear(),r=a(w()-1,-1))}function d(){w()>0&&(o.clear(),r=a(++r,1))}function g(){w()>0&&(o.clear(),r=a(--r,-1))}function w(){return Math.max(t(),0)}function E(){o.clear(),r=e,s()}return{setCurrentPage:l,getCurrentPage:h,toFirstItem:u,toLastItem:c,toNextItem:d,toPreviousItem:g,getSize:w,clear:E}}function _P(n){return Te(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Cc(n){return jt(n,"submenu")}function vc(n){return new RegExp(ae,"i").test(n.name)}function fl(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function kf(n){return jt(n,"disableSelection")}function IP(n){return Ne(n,"htSeparator")}function TP(n){return Ne(n,"htSubmenu")}function xP(n){return Ne(n,"htDisabled")}function AP(n){return Ne(n,"htSelectionDisabled")}function NP(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function Jp(n,e){const t=n.slice(0);for(let i=0;i<t.length&&t[i].name===e;)t.shift();return t}function OP(n,e){let t=n.slice(0);return t.reverse(),t=Jp(t,e),t.reverse(),t}function HP(n){const e=[];return S(n,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function DP(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae,t=n.slice(0);return t=Jp(t,e),t=OP(t,e),t=HP(t),t}function $P(n){return n.checkable===!0}function LP(n){return Zp({size:()=>n.countRows(),onItemSelect(e,t){const i=n.getCell(e,0);if(!i||IP(i)||xP(i)||AP(i))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function kP(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,s)=>{const o=e.getSettings(),r=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;s.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=t.getSelectedLast();if(i){const s=n.openSubMenu(i[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const s=t.getSelectedLast();s&&(t.getSourceDataAtRow(s[0]).submenu?n.openSubMenu(s[0]).getNavigator().toFirstItem():(n.executeCommand(i),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const Qp="menu",Ff=Qp;function FP(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];i(kP(n)),e.forEach(h=>{let{shortcuts:u,contextName:c}=h;s(u,c)});function i(h,u){a(u).addShortcuts(h,{group:Qp})}function s(h,u){const c=a(u);h.forEach(d=>{let{keys:g}=d;g.forEach(w=>c.removeShortcutsByKeys(w))}),t.push({shortcuts:h,contextName:u}),i(h,u)}function o(){return[...t]}function r(h){return h?`${Ff}:${h}`:Ff}function a(h){var u;const c=n.hotMenu.getShortcutManager(),d=r(h);return(u=c.getContext(d))!==null&&u!==void 0?u:c.addContext(d)}function l(h){n.hotMenu.getShortcutManager().setActiveContextName(r(h))}return{addCustomShortcuts:s,getCustomShortcuts:o,getContext:a,listen:l}}function WP(n){return(e,t,i,s,o,r)=>{const a=e.getSourceDataAtRow(i),l=n.rootDocument.createElement("div"),h=typeof r=="function"?r.call(n):r,u=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,c=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(oh(t),U(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!fl(a,n)&&!kf(a)&&!vc(a);Oe(t,[...$P(a)?[Iv(),yl(u),Im(c)]:[Tv(),yl(h)],...d?[$m(-1)]:[],...fl(a,n)?[xv()]:[],...Cc(a)?[sn(!1)]:[]])}t.className="",t.appendChild(l),vc(a)?U(t,"htSeparator"):typeof a.renderer=="function"?(U(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,i,s,o,h))):Yr(l,h),fl(a,n)?U(t,"htDisabled"):kf(a)?U(t,"htSelectionDisabled"):Cc(a)&&U(t,"htSubmenu")}}function Jh(n,e,t){BP(n,e),e.set(n,t)}function BP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(n,e,t){return(e=VP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VP(n){var e=UP(n,"string");return typeof e=="symbol"?e:e+""}function UP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qh(n,e,t){return n.set(ew(n,e),t),t}function ts(n,e){return n.get(ew(n,e))}function ew(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Wf=215;var jo=new WeakMap,wa=new WeakMap,Ca=new WeakMap;class Ho{get tableBorderWidth(){return ts(Ca,this)===void 0&&this.hotMenu&&Qh(Ca,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ts(Ca,this)}constructor(e,t){var i=this;yn(this,"hot",void 0),yn(this,"options",void 0),yn(this,"eventManager",new No(this)),yn(this,"container",void 0),yn(this,"positioner",void 0),yn(this,"hotMenu",null),yn(this,"hotSubMenus",{}),yn(this,"parentMenu",void 0),yn(this,"menuItems",null),yn(this,"origOutsideClickDeselects",null),Jh(this,jo,void 0),Jh(this,wa,void 0),Jh(this,Ca,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Wf,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new PP(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(s,o)=>{if(!o){var r;(r=this.hotMenu)===null||r===void 0||r.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Lm(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ts(jo,this)}getKeyboardShortcutsCtrl(){return ts(wa,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Dm(a=>this.openSubMenu(a),300),t=this.options.minWidth||Wf;let i=!1,s=Or(this.menuItems,a=>(a.key===$r&&(i=!0),NP(a,this.hot)));if(s.length<1&&!i)s.push(Yp()[$r]);else if(s.length===0)return;s=DP(s,ae);let o=!1;const r={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return pe(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:WP(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(a,l)=>{ts(jo,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Kd()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,h,u,c)=>{this.hotMenu.view.isMouseDown()&&(c.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Kd()||!rh(a))&&o&&this.hasSelectedItem()&&(Bc()||Nv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Qh(jo,this,LP(this.hotMenu)),Qh(wa,this,FP(this)),ts(wa,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ts(jo,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const i=this.parentMenu.hotMenu.getCell(t[0],0);Oe(i,[sn(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!TP(t))return!1;const i=this.hotMenu.getSourceDataAtRow(e),s=new Ho(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(i.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[i.key]=s,this.hot.getSettings().ariaTags&&Oe(t,[sn(!0)]),s}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[t.key];if(i){i.destroy(),delete this.hotSubMenus[t.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Oe(s,[sn(!1)])}}closeAllSubMenus(){S(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const i=this.hot.getSelectedRange(),s=i?_P(i):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){return e.isCommand===!1||vc(e)||fl(e,this.hot)||Cc(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,s=t.hider.style,o=t.holder.style,r=parseInt(s.width,10),a=ji(i,(l,h,u)=>{const d=this.hotMenu.getCell(u,0)?Ts(this.hotMenu.getCell(u,0)):0;return l+(h.name===ae?1:d)},0);e.isClassicTheme()?(o.width=`${r+3}px`,o.height=`${a+3}px`):(o.width=`${r}px`,o.height=`${a}px`),s.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let i=e,s;return i&&(Hm(i)&&(i=i.call(this.hot),i===null||Vn(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,s=t.querySelector(`.${this.options.className}.${i}`)),s||(s=t.createElement("div"),U(s,`htMenu handsontable ${this.options.className}`),i&&U(s,i),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Oe(this.hotMenu.rootElement,[Av(),$m(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ll(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ll(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ne(e.target,"htCore")&&ll(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Vi(Ho,Ui);function jP(n,e){YP(n,e),e.add(n)}function YP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eu(n,e,t){return(e=GP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GP(n){var e=zP(n,"string");return typeof e=="symbol"?e:e+""}function zP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function va(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pr="contextMenu",KP=70,Bf=pr;X.getSingleton().register("afterContextMenuDefaultOptions");X.getSingleton().register("beforeContextMenuShow");X.getSingleton().register("afterContextMenuShow");X.getSingleton().register("afterContextMenuHide");X.getSingleton().register("afterContextMenuExecute");var Yo=new WeakSet;class vh extends de{constructor(){super(...arguments),jP(this,Yo),eu(this,"commandExecutor",new Kp(this.hot)),eu(this,"itemsFactory",null),eu(this,"menu",null)}static get PLUGIN_KEY(){return pr}static get PLUGIN_PRIORITY(){return KP}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[mh,ph,ae,Zr,Jr,ae,gh,ea,ae,wh,fh,ae,Qr,ae,Zt]}isEnabled(){return!!this.hot.getSettings()[pr]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[pr];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Ho(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>va(Yo,this,XP).call(this)),this.menu.addLocalHook("afterOpen",()=>va(Yo,this,ZP).call(this)),this.menu.addLocalHook("afterClose",()=>va(Yo,this,JP).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",i=>va(Yo,this,qP).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=ch(this.menu.container,this.hot.rootDocument);this.open({left:t.left+i.left,top:t.top+i.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:Bf})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Bf)}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();const s=this.menu.tableBorderWidth>0;yt(i,(o,r)=>{const a=["below","right"].includes(r)?o+1:o-1;this.menu.setOffset(r,s?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new qp(this.hot,vh.DEFAULT_ITEMS);const e=this.hot.getSettings()[pr],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),S(i,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function qP(n){const e=this.hot.getSettings(),t=e.rowHeaders,i=e.colHeaders;function s(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=n.target;if(this.close(),Ne(o,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||i)&&!s(o)&&!(Ne(o,"current")&&Ne(o,"wtBorder"))))return;const r=ch(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+r.top,left:n.clientX+r.left})}function XP(){this.hot.runHooks("beforeContextMenuShow",this)}function ZP(){this.hot.runHooks("afterContextMenuShow",this)}function JP(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}vh.SEPARATOR={name:ae};function QP(n){return{key:"copy",name(){return this.getTranslatedPhrase(Ov)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function e_(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Yt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Hv,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function t_(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Yt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Dv,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function n_(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Yt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($v,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function i_(n){return{key:"cut",name(){return this.getTranslatedPhrase(Lv)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class s_{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class o_{constructor(){this.clipboardData=new s_}preventDefault(){}}function r_(n,e){tw(n,e),e.add(n)}function Ys(n,e,t){tw(n,e),e.set(n,t)}function tw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(n,e){return n.get(Co(n,e))}function Gs(n,e,t){return n.set(Co(n,e),t),t}function Co(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var wi=new WeakMap,tu=new WeakMap,Go=new WeakMap,Sc=new WeakMap,bc=new WeakMap,zo=new WeakMap,Ko=new WeakSet;class a_{constructor(e){let{countRows:t,countColumns:i,rowsLimit:s,columnsLimit:o,countColumnHeaders:r}=e;r_(this,Ko),Ys(this,wi,void 0),Ys(this,tu,void 0),Ys(this,Go,void 0),Ys(this,Sc,void 0),Ys(this,bc,void 0),Ys(this,zo,void 0),Gs(tu,this,t),Gs(Go,this,i),Gs(Sc,this,s),Gs(bc,this,o),Gs(zo,this,r)}setSelectedRange(e){Gs(wi,this,e)}getCellsRange(){if(Ct(tu,this).call(this)===0||Ct(Go,this).call(this)===0)return null;const{row:e,col:t}=Ct(wi,this).getTopStartCorner(),{row:i,col:s}=Ct(wi,this).getBottomEndCorner(),o=Co(Ko,this,l_).call(this,e,i),r=Co(Ko,this,nu).call(this,t,s);return{isRangeTrimmed:i!==o||s!==r,startRow:e,startCol:t,endRow:o,endCol:r}}getMostBottomColumnHeadersRange(){if(Ct(Go,this).call(this)===0||Ct(zo,this).call(this)===0)return null;const{col:e}=Ct(wi,this).getTopStartCorner(),{col:t}=Ct(wi,this).getBottomEndCorner(),i=Co(Ko,this,nu).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Ct(Go,this).call(this)===0||Ct(zo,this).call(this)===0)return null;const{col:e}=Ct(wi,this).getTopStartCorner(),{col:t}=Ct(wi,this).getBottomEndCorner(),i=Co(Ko,this,nu).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-Ct(zo,this).call(this),startCol:e,endRow:-1,endCol:i}}}function nu(n,e){return Math.min(e,Math.max(n+Ct(bc,this).call(this)-1,n))}function l_(n,e){return Math.min(e,Math.max(n+Ct(Sc,this).call(this)-1,n))}function nw(n){const e=[],t=[];return S(n,i=>{const s=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);ne(s,o,l=>{e.indexOf(l)===-1&&e.push(l)});const r=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);ne(r,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function h_(n,e){iw(n,e),e.add(n)}function Ci(n,e,t){iw(n,e),e.set(n,t)}function iw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(n,e,t){return(e=u_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u_(n){var e=c_(n,"string");return typeof e=="symbol"?e:e+""}function c_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function It(n,e){return n.get(Tt(n,e))}function cn(n,e,t){return n.set(Tt(n,e),t),t}function Tt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("afterCopyLimit");X.getSingleton().register("modifyCopyableRange");X.getSingleton().register("beforeCut");X.getSingleton().register("afterCut");X.getSingleton().register("beforePaste");X.getSingleton().register("afterPaste");X.getSingleton().register("beforeCopy");X.getSingleton().register("afterCopy");const iu="copyPaste",d_=80,f_=["fragmentSelection"],Vf=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var yc=new WeakMap,Rc=new WeakMap,Ec=new WeakMap,zs=new WeakMap,Sa=new WeakMap,ba=new WeakMap,Ks=new WeakMap,Dl=new WeakMap,kt=new WeakSet;class g_ extends de{constructor(){super(...arguments),h_(this,kt),qo(this,"columnsLimit",1/0),qo(this,"rowsLimit",1/0),qo(this,"pasteMode","overwrite"),qo(this,"uiContainer",this.hot.rootDocument.body),Ci(this,yc,!1),Ci(this,Rc,!1),Ci(this,Ec,!1),Ci(this,zs,"cells-only"),Ci(this,Sa,!1),Ci(this,ba,!1),Ci(this,Ks,new a_({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ci(this,Dl,!1),qo(this,"copyableRanges",[])}static get PLUGIN_KEY(){return iu}static get SETTING_KEYS(){return[iu,...f_]}static get PLUGIN_PRIORITY(){return d_}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[iu]}enablePlugin(){var e,t,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),cn(yc,this,this.getSetting("copyColumnHeaders")),cn(Rc,this,this.getSetting("copyColumnGroupHeaders")),cn(Ec,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(t=this.getSetting("uiContainer"))!==null&&t!==void 0?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>Tt(kt,this,w_).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return Tt(kt,i,C_).call(i,...o)}),this.addHook("afterSelectionEnd",()=>Tt(kt,this,v_).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),km()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return Tt(kt,i,S_).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return Tt(kt,i,b_).call(i,...o)}),this.addHook("afterSelection",()=>Tt(kt,this,y_).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";cn(zs,this,e),cn(Sa,this,!0),Tt(kt,this,Uf).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){cn(ba,this,!0),Tt(kt,this,Uf).call(this,"cut")}getRangedCopyableData(e){return Ih(this.getRangedData(e))}getRangedData(e){const t=[],{rows:i,columns:s}=nw(e);return S(i,o=>{const r=[];S(s,a=>{o<0?r.push(this.hot.getColHeader(a,o)):r.push(this.hot.getCopyableData(o,a))}),t.push(r)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const i=new o_;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}It(Ks,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);It(zs,this)==="column-headers-only"?t.set("headers",It(Ks,this).getMostBottomColumnHeadersRange()):(It(zs,this)==="with-column-headers"?t.set("headers",It(Ks,this).getMostBottomColumnHeadersRange()):It(zs,this)==="with-column-group-headers"&&t.set("headers",It(Ks,this).getAllColumnHeadersRange()),t.set("cells",It(Ks,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:o,startCol:r,endRow:a,endCol:l}=s;return{startRow:o,startCol:r,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=t.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:s,startCol:o,endRow:r,endCol:a}=i;this.hot.runHooks("afterCopyLimit",r-s+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,s=e[0].length,o=[],{row:r,col:a}=t.getTopStartCorner(),{row:l,col:h}=t.getBottomEndCorner();let u=r,c=a,d=r,g=a;for(;o.length<i||u<=l;){const{skipRowOnPaste:w,visualRow:E}=this.hot.getCellMeta(u,a);if(u=E+1,w===!0)continue;d=E,c=a;const C=[],A=o.length%i;for(;C.length<s||c<=h;){const{skipColumnOnPaste:T,visualCol:k}=this.hot.getCellMeta(r,c);if(c=k+1,T===!0)continue;g=k;const K=C.length%s;C.push(e[A][K])}o.push(C)}return cn(Dl,this,!0),this.hot.populateFromArray(r,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,a,d,g]}onCopy(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!It(Sa,this)||this.isEditorOpened()||al(e.target)&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&!Th(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),cn(Sa,this,!1);const o=this.getRangedData(this.copyableRanges),r=Tt(kt,this,m_).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,r)){const l=Ih(o);if(e&&e.clipboardData){const h=qd(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[Vf,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,r)}cn(zs,this,"cells-only")}onCut(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!It(ba,this)||this.isEditorOpened()||al(e.target)&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&!Th(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),cn(ba,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Ih(o);if(e&&e.clipboardData){const l=qd(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[Vf,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||al(e.target)&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&!Th(e.target,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const u=kv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});u&&/(<table)|(<TABLE)/g.test(u)?o=Fv(u,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Wv(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[r,a,l,h]=this.populateValues(o);this.hot.selectCell(r,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function Uf(n){if(km()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:i}=e.highlight,s=this.hot.getCell(t,i,!0);s&&Bv(s,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function m_(n){const{rows:e}=nw(n);let t=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)t+=1;return{columnHeadersCount:t}}function p_(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i&&Uv(i)}}}function sw(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i!=null&&i.hasAttribute("contenteditable")&&Vv(i)}}}function w_(n){n.items.push({name:"---------"},QP(this)),It(yc,this)&&n.items.push(n_(this)),It(Rc,this)&&n.items.push(t_(this)),It(Ec,this)&&n.items.push(e_(this)),n.items.push(i_(this))}function C_(n,e,t,i,s){It(Dl,this)&&(s.value=!0),cn(Dl,this,!1)}function v_(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function S_(){Tt(kt,this,sw).call(this)}function b_(){Tt(kt,this,p_).call(this)}function y_(){Tt(kt,this,sw).call(this)}function ow(n,e){return`border_row${n}col${e}`}function wr(){return{width:1,color:"#000"}}function ai(){return{hide:!0}}function R_(){return{width:1,color:"#000",cornerVisible:!1}}function su(n){if(pe(n.start)||pe(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(pe(n.end)||pe(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Xo(n){return pe(n.start)&&(n.left=n.start),pe(n.end)&&(n.right=n.end),n}function ou(n,e){return{id:ow(n,e),border:R_(),row:n,col:e,top:ai(),bottom:ai(),start:ai(),end:ai()}}function E_(n,e){return jt(e,"border")&&e.border&&(n.border=e.border),jt(e,"top")&&pe(e.top)&&(e.top?(Me(e.top)||(e.top=wr()),n.top=e.top):(e.top=ai(),n.top=e.top)),jt(e,"bottom")&&pe(e.bottom)&&(e.bottom?(Me(e.bottom)||(e.bottom=wr()),n.bottom=e.bottom):(e.bottom=ai(),n.bottom=e.bottom)),jt(e,"start")&&pe(e.start)&&(e.start?(Me(e.start)||(e.start=wr()),n.start=e.start):(e.start=ai(),n.start=e.start)),jt(e,"end")&&pe(e.end)&&(e.end?(Me(e.end)||(e.end=wr()),n.end=e.end):(e.end=ai(),n.end=e.end)),n}function di(n,e){let t=!1;return S(n.getSelectedRange(),i=>{i.forAll((s,o)=>{if(s<0||o<0)return;const r=n.getCellMeta(s,o).borders;if(r)if(e){if(!jt(r[e],"hide")||r[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function Sh(n){return`<span class="selected">✓</span>${n}`}function M_(n){return n.some(e=>pe(e.left)||pe(e.right))}function P_(n){return n.some(e=>pe(e.start)||pe(e.end))}const __=new Map([["left","start"],["right","end"]]);function I_(n){var e;return(e=__.get(n))!==null&&e!==void 0?e:n}function T_(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(jv);return di(this,"bottom")&&(e=Sh(e)),e},callback(e,t){const i=di(this,"bottom");n.prepareBorder(t,"bottom",i)}}}function x_(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Yv);return di(this,e)&&(t=Sh(t)),t},callback(t,i){const s=di(this,e);n.prepareBorder(i,e,s)}}}function A_(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Gv)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!di(this)}}}function N_(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(zv);return di(this,e)&&(t=Sh(t)),t},callback(t,i){const s=di(this,e);n.prepareBorder(i,e,s)}}}function O_(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(Kv);return di(this,"top")&&(e=Sh(e)),e},callback(e,t){const i=di(this,"top");n.prepareBorder(t,"top",i)}}}function H_(n,e){D_(n,e),e.add(n)}function D_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $_(n,e,t){return(e=L_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L_(n){var e=k_(n,"string");return typeof e=="symbol"?e:e+""}function k_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const gl="customBorders",F_=90;var ru=new WeakSet;class W_ extends de{constructor(){super(...arguments),H_(this,ru),$_(this,"savedBorders",[])}static get PLUGIN_KEY(){return gl}static get PLUGIN_PRIORITY(){return F_}isEnabled(){return!!this.hot.getSettings()[gl]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>jf(ru,this,B_).call(this,e)),this.addHook("init",()=>jf(ru,this,V_).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),s=su(t));const o=Xd(e),r=Zd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});S(e,a=>{r(a).forAll((l,h)=>{S(i,u=>{this.prepareBorderFromCustomAdded(l,h,s,I_(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Xd(e),i=Zd(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return S(e,o=>{i(o).forAll((r,a)=>{S(this.savedBorders,l=>{l.row===r&&l.col===a&&s.push(Xo(l))})})}),s}clearBorders(e){e?this.setBorders(e):(S(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,i,s){const o=this.hot.countRows(),r=this.hot.countCols();if(e>=o||t>=r)return;let a=ou(e,t);i&&(a=E_(a,i),S(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Xo(a)),this.insertBorderIntoSettings(a,s)}prepareBorderFromCustomAddedRange(e,t){const i=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);ne(e.from.row,i,o=>{ne(e.from.col,s,r=>{const a=ou(o,r);let l=0;o===e.from.row&&jt(t,"top")&&(l+=1,a.top=t.top),o===e.to.row&&jt(t,"bottom")&&(l+=1,a.bottom=t.bottom),r===e.from.col&&jt(t,"start")&&(l+=1,a.start=t.start),r===e.to.col&&jt(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(o,r,"borders",Xo(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const i=ow(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,s){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=ou(e,t):o=su(o),s?(o[i]=ai(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,i,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",Xo(o)))):(o[i]=wr(),this.checkCustomSelectionsFromContextMenu(o,i,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",Xo(o)))}prepareBorder(e,t,i){S(e,s=>{let{start:o,end:r}=s;if(o.row===r.row&&o.col===r.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,i);else switch(t){case"noBorders":ne(o.col,r.col,a=>{ne(o.row,r.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ne(o.col,r.col,a=>{this.setBorder(o.row,a,t,i)});break;case"bottom":ne(o.col,r.col,a=>{this.setBorder(r.row,a,t,i)});break;case"start":ne(o.row,r.row,a=>{this.setBorder(a,o.col,t,i)});break;case"end":ne(o.row,r.row,a=>{this.setBorder(a,r.col,t,i)});break}})}createCustomBorders(e){S(e,t=>{const i=su(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,i):this.prepareBorderFromCustomAdded(t.row,t.col,i)})}countHide(e){const{top:t,bottom:i,start:s,end:o}=e;return ji([t,i,s,o],(a,l)=>{let h=a;return l&&l.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=Te(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){S(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){S(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=Te(this.savedBorders,i=>i.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):S(this.savedBorders,(s,o)=>{if(e.id===s.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let s=!1;return S(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const r=this.hot.view._wt.selectionManager.getBorderInstances(o);return S(r,a=>{a.toggleHiddenClass(t,i)}),s=!0,!1}}),s}checkCustomSelections(e,t,i){const s=this.countHide(e);let o=!1;return s===4?(this.removeAllBorders(e.row,e.col),o=!0):S(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(r);S(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[gl];if(Array.isArray(e)){const t=xs(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=M_(e),i=P_(e);if(t&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function B_(n){this.hot.getSettings()[gl]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(qv)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[O_(this),N_(this),T_(this),x_(this),A_(this)]}})}function V_(){this.changeBorderSettings()}function U_(n,e){j_(n,e),e.add(n)}function j_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function au(n,e,t){return(e=Y_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Y_(n){var e=G_(n,"string");return typeof e=="symbol"?e:e+""}function G_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Yf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Gf="dragToScroll",z_=100;var lu=new WeakSet;class K_ extends de{constructor(){super(...arguments),U_(this,lu),au(this,"boundaries",null),au(this,"callback",null),au(this,"listening",!1)}static get PLUGIN_KEY(){return Gf}static get PLUGIN_PRIORITY(){return z_}isEnabled(){return!!this.hot.getSettings()[Gf]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Yf(lu,this,zf).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Yf(lu,this,zf).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",i=>this.onMouseMove(i)),t=Lm(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function zf(n){if(rh(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var s,o;const r=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(r+Math.sign(t)*50,a+Math.sign(i)*20)}),this.listen()}function q_(n,e){rw(n,e),e.add(n)}function X_(n,e,t){rw(n,e),e.set(n,t)}function rw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hu(n,e,t){return(e=Z_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z_(n){var e=J_(n,"string");return typeof e=="symbol"?e:e+""}function J_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Q_(n,e){return n.get(Jt(n,e))}function aw(n,e,t){return n.set(Jt(n,e),t),t}function Jt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("afterDropdownMenuDefaultOptions");X.getSingleton().register("beforeDropdownMenuShow");X.getSingleton().register("afterDropdownMenuShow");X.getSingleton().register("afterDropdownMenuHide");X.getSingleton().register("afterDropdownMenuExecute");const ml="dropdownMenu",eI=230,Lr="changeType",uu=ml;var bh=new WeakMap,fn=new WeakSet;class yh extends de{static get PLUGIN_KEY(){return ml}static get PLUGIN_PRIORITY(){return eI}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Zr,Jr,ae,ea,ae,dh,ae,Qr,ae,Zt]}constructor(e){super(e),q_(this,fn),hu(this,"commandExecutor",new Kp(this.hot)),hu(this,"itemsFactory",null),hu(this,"menu",null),X_(this,bh,!1),this.hot.addHook("afterGetColHeader",(t,i)=>Jt(fn,this,nI).call(this,t,i))}isEnabled(){return this.hot.getSettings()[ml]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new qp(this.hot,yh.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return Jt(fn,e,lI).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return Jt(fn,e,aI).call(e,...o)});const t=this.hot.getSettings()[ml],i={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Ho(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>Jt(fn,this,iI).call(this)),this.menu.addLocalHook("afterOpen",()=>Jt(fn,this,sI).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Jt(fn,this,oI).call(this,o)),this.menu.addLocalHook("afterClose",()=>Jt(fn,this,rI).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e.executeCommand.call(e,...r)}),S(s,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),o=ch(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,s.col,!0).querySelector(`.${Lr}`),a=r.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+r.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:uu},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:uu}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uu)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Jt(fn,this,tI).call(this,e))}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),yt(i,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lw(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function tI(n){if(Ne(n.target,Lr)){const e=ch(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),aw(bh,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function nI(n,e){const t=e.parentNode;if(!t)return;const i=t.parentNode.childNodes,s=Array.prototype.indexOf.call(i,t);if(n<0||s!==i.length-1)return;const o=e.querySelector(`.${Lr}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const r=this.hot.rootDocument.createElement("button");r.className=Lr,r.type="button",r.tabIndex=-1,this.hot.getSettings().ariaTags&&(Oe(r,[Ao(),yl(" ")]),Oe(e,[Em("menu")])),r.onclick=function(){return!1},e.firstChild.insertBefore(r,e.firstChild.firstChild)}function iI(){this.hot.runHooks("beforeDropdownMenuShow",this)}function sI(){this.hot.runHooks("afterDropdownMenuShow",this),Jt(fn,this,lw).call(this,this.menu)}function oI(n){Jt(fn,this,lw).call(this,n)}function rI(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function aI(n){return Q_(bh,this)?null:n}function lI(n){Ne(n.target,Lr)&&aw(bh,this,!0)}yh.SEPARATOR={name:ae};function Kf(n,e,t){return(e=hI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hI(n){var e=uI(n,"string");return typeof e=="symbol"?e:e+""}function uI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cI{constructor(e){Kf(this,"hot",void 0),Kf(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:i,endCol:s}=this._getDataRange(),o=this.options,r=[];return ne(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(ne(t,s,h=>{!o.exportHiddenColumns&&this._isHiddenColumn(h)||l.push(this.hot.getDataAtCell(a,h))}),r.push(l))}),r}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:i}=this._getDataRange(),s=this.hot.getRowHeader();ne(t,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(s[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:i}=this._getDataRange(),s=this.hot.getColHeader();ne(t,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(s[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[i=0,s=0,o=t,r=e]=this.options.range;return i=Math.max(i,0),s=Math.max(s,0),o=Math.min(o,t),r=Math.min(r,e),{startRow:i,startCol:s,endRow:o,endCol:r}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function qf(n,e,t){return(e=dI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dI(n){var e=fI(n,"string");return typeof e=="symbol"?e:e+""}function fI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pd{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){qf(this,"dataProvider",void 0),qf(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Un(this.constructor.DEFAULT_OPTIONS);const i=new Date;return t=Nt(Un(pd.DEFAULT_OPTIONS),t),t=Nt(t,e),t.filename=Xv(t.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),t}}const gI="\r",mI='"',pI=`
`;class wI extends pd{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const s=i.length>0,o=this.dataProvider.getRowHeaders(),r=o.length>0;let a=e.bom?"\uFEFF":"";return s&&(i=Te(i,l=>this._escapeCell(l,!0)),r&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),S(t,(l,h)=>{h>0&&(a+=e.rowDelimiter),r&&(a+=this._escapeCell(o[h])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=tt(e);return i!==""&&(t||i.indexOf(gI)>=0||i.indexOf(mI)>=0||i.indexOf(pI)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const CI="csv",Mc={[CI]:wI};function vI(n,e,t){return typeof Mc[n]=="function"?new Mc[n](e,t):null}const SI="exportFile",bI=240;class yI extends de{static get PLUGIN_KEY(){return SI}static get PLUGIN_PRIORITY(){return bI}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:s}=this.hot,o=this._createTypeFormatter(e,t),r=this._createBlob(o),a=s.URL||s.webkitURL,l=i.createElement("a"),h=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(r);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",h),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Mc[e])throw new Error(`Export format type "${e}" is not supported.`);return vI(e,new cI(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function qs(n,e,t){return(e=RI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RI(n){var e=EI(n,"string");return typeof e=="symbol"?e:e+""}function EI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ta{constructor(e,t){let{id:i,stateless:s=!0}=t;qs(this,"hot",void 0),qs(this,"id",void 0),qs(this,"elements",[]),qs(this,"hidden",!1),qs(this,"stateId",""),qs(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Uc)}getElements(){return this.elements}reset(){S(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),S(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Vi(ta,Ui);const kr={};function Wi(n,e){if(!kr[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:i}=kr[n];let s=e;return i.inputValuesDecorator&&(s=i.inputValuesDecorator(s)),function(o){return t.apply(o.meta.instance,[].concat([o],[s]))}}function Ms(n){if(!kr[n])throw Error(`Filter condition "${n}" does not exist.`);return kr[n].descriptor}function Ze(n,e,t){t.key=n,kr[n]={condition:e,descriptor:t}}const st="none";function MI(){return!0}Ze(st,MI,{name:Fm,inputsCount:0,showOperators:!1});const Sr="empty";function PI(n){return Rt(n.value)}Ze(Sr,PI,{name:Zv,inputsCount:0,showOperators:!0});const pl="not_empty";function _I(n,e){return!Wi(Sr,e)(n)}Ze(pl,_I,{name:Jv,inputsCount:0,showOperators:!0});const br="eq";function II(n,e){let[t]=e;return tt(n.value).toLocaleLowerCase(n.meta.locale)===tt(t)}Ze(br,II,{name:Qv,inputsCount:1,showOperators:!0});const wl="neq";function TI(n,e){return!Wi(br,e)(n)}Ze(wl,TI,{name:eS,inputsCount:1,showOperators:!0});const hw="gt";function xI(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>i}Ze(hw,xI,{name:tS,inputsCount:1,showOperators:!0});const uw="gte";function AI(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>=i}Ze(uw,AI,{name:nS,inputsCount:1,showOperators:!0});const cw="lt";function NI(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<i}Ze(cw,NI,{name:iS,inputsCount:1,showOperators:!0});const dw="lte";function OI(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<=i}Ze(dw,OI,{name:sS,inputsCount:1,showOperators:!0});const wd="date_after";function HI(n,e){let[t]=e;const i=ve(n.value,n.meta.dateFormat),s=ve(t,n.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)>=0}Ze(wd,HI,{name:oS,inputsCount:1,showOperators:!0});const Cd="date_before";function DI(n,e){let[t]=e;const i=ve(n.value,n.meta.dateFormat),s=ve(t,n.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)<=0}Ze(Cd,DI,{name:rS,inputsCount:1,showOperators:!0});const $l="between";function $I(n,e){let[t,i]=e,s=t,o=i;if(n.meta.type==="numeric"){const r=parseFloat(s,10),a=parseFloat(o,10);s=Math.min(r,a),o=Math.max(r,a)}else if(n.meta.type==="date"){const r=Wi(Cd,[o]),a=Wi(wd,[s]);return r(n)&&a(n)}return n.value>=s&&n.value<=o}Ze($l,$I,{name:aS,inputsCount:2,showOperators:!0});const fw="not_between";function LI(n,e){return!Wi($l,e)(n)}Ze(fw,LI,{name:lS,inputsCount:2,showOperators:!0});const gw="begins_with";function kI(n,e){let[t]=e;return tt(n.value).toLocaleLowerCase(n.meta.locale).startsWith(tt(t))}Ze(gw,kI,{name:hS,inputsCount:1,showOperators:!0});const mw="ends_with";function FI(n,e){let[t]=e;return tt(n.value).toLocaleLowerCase(n.meta.locale).endsWith(tt(t))}Ze(mw,FI,{name:uS,inputsCount:1,showOperators:!0});const vd="contains";function WI(n,e){let[t]=e;return tt(n.value).toLocaleLowerCase(n.meta.locale).indexOf(tt(t))>=0}Ze(vd,WI,{name:cS,inputsCount:1,showOperators:!0});const pw="not_contains";function BI(n,e){return!Wi(vd,e)(n)}Ze(pw,BI,{name:dS,inputsCount:1,showOperators:!0});const ww="date_tomorrow";function VI(n){const e=ve(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ve().subtract(-1,"days").startOf("day"),"d"):!1}Ze(ww,VI,{name:fS,inputsCount:0});const Cw="date_today";function UI(n){const e=ve(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ve().startOf("day"),"d"):!1}Ze(Cw,UI,{name:gS,inputsCount:0});const vw="date_yesterday";function jI(n){const e=ve(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ve().subtract(1,"days").startOf("day"),"d"):!1}Ze(vw,jI,{name:mS,inputsCount:0});pS();function YI(n,e){let t=n;return t===""&&(t=`(${e})`),t}function na(n){const e=new Set(n);return function(t){return e.has(t)}}function Sd(n){return n??""}function Pc(n){return Array.from(new Set(n)).map(e=>Sd(e)).sort((e,t)=>typeof e=="number"&&typeof t=="number"?e-t:e===t?0:e>t?1:-1)}function Xf(n,e,t,i){const s=[],o=n===e;let r;return o||(r=na(e)),n.forEach(a=>{let l=!1;(o||r(a))&&(l=!0);const h={checked:l,value:a,visualValue:YI(a,t)};i&&i(h),s.push(h)}),s}const Ps="by_value";function GI(n,e){let[t]=e;return t(n.value)}Ze(Ps,GI,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[na(e)]},showOperators:!1});const Fr={};function zI(n){if(!Fr[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Fr[n].func;return function(t,i){return e(t,i)}}function KI(n){return Fr[n].name}function bd(n,e,t){Fr[n]={name:e,func:t}}const ki="conjunction",qI=wS;function XI(n,e){return n.every(t=>t.func(e))}bd(ki,qI,XI);const Ll="disjunction",ZI=Wm;function JI(n,e){return n.some(t=>t.func(e))}bd(Ll,ZI,JI);const yd="disjunctionWithExtraCondition",QI=Wm;function eT(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}bd(yd,QI,eT);const tT="numeric",Sw="text",nT="date",Zf={[tT]:[st,ae,Sr,pl,ae,br,wl,ae,hw,uw,cw,dw,$l,fw],[Sw]:[st,ae,Sr,pl,ae,br,wl,ae,gw,mw,ae,vd,pw],[nT]:[st,ae,Sr,pl,ae,br,wl,ae,Cd,wd,$l,ae,ww,Cw,vw]};function iT(n){const e=[];let t=n;return Zf[t]||(t=Sw),S(Zf[t],i=>{let s;i===ae?s={name:ae}:s=Un(Ms(i)),e.push(s)}),e}function Zo(n,e,t){return(e=sT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sT(n){var e=oT(n,"string");return typeof e=="symbol"?e:e+""}function oT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const cu="built",du="building",Jf=["click","input","keydown","keypress","keyup","focus","blur","change"];let wn=class bw{static get DEFAULTS(){return Un({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){Zo(this,"hot",void 0),Zo(this,"eventManager",new No(this)),Zo(this,"options",void 0),Zo(this,"_element",void 0),Zo(this,"buildState",void 0),this.hot=e,this.options=Nt(bw.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===du?this._element:this.buildState===cu?(this.update(),this._element):(this.buildState=du,this.build(),this.buildState=cu,this._element)}isBuilt(){return this.buildState===cu}translateIfPossible(e){return typeof e=="string"&&e.startsWith(CS)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,i)=>{this.eventManager.addEventListener(t,i,s=>this.runLocalHooks(i,s,this))};if(this.buildState||(this.buildState=du),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&U(this._element,this.options.className),this.options.children.length)S(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),yt(this.options,(i,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(i))}),this._element.appendChild(t),S(Jf,i=>e(t,i))}else S(Jf,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Vi(wn,Ui);function rT(n,e){yw(n,e),e.add(n)}function aT(n,e,t){yw(n,e),e.set(n,t)}function yw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ya(n,e){return n.get(Rd(n,e))}function lT(n,e,t){return n.set(Rd(n,e),t),t}function Rd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xs=new WeakMap,Qf=new WeakSet;class Fi extends wn{static get DEFAULTS(){return Un({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,Nt(Fi.DEFAULTS,t)),rT(this,Qf),aT(this,Xs,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Rd(Qf,this,hT).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");lT(Xs,this,this._element.firstChild),U(this._element,"htUIInput"),U(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ya(Xs,this).type=this.options.type,ya(Xs,this).placeholder=this.translateIfPossible(this.options.placeholder),ya(Xs,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ya(Xs,this).focus()}}function hT(n){this.options.value=n.target.value}function uT(n,e){Rw(n,e),e.add(n)}function Jo(n,e,t){Rw(n,e),e.set(n,t)}function Rw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(n,e,t){return n.set(yr(n,e),t),t}function Le(n,e){return n.get(yr(n,e))}function yr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Qe=new WeakMap,Ra=new WeakMap,Ea=new WeakMap,fu=new WeakMap,Ma=new WeakMap,Pa=new WeakSet;class Wr extends wn{static get DEFAULTS(){return Un({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,Nt(Wr.DEFAULTS,t)),uT(this,Pa),Jo(this,Qe,null),Jo(this,Ra,[]),Jo(this,Ea,void 0),Jo(this,fu,void 0),Jo(this,Ma,void 0),this.registerHooks()}getMenu(){return Le(Qe,this)}registerHooks(){this.addLocalHook("click",()=>yr(Pa,this,fT).call(this))}setItems(e){Zs(Ra,this,this.translateNames(e)),Le(Qe,this)&&Le(Qe,this).setMenuItems(Le(Ra,this))}translateNames(e){return S(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Zs(Qe,this,new Ho(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Le(Qe,this).setMenuItems(Le(Ra,this));const e=new wn(this.hot,{className:"htUISelectCaption"}),t=new wn(this.hot,{className:"htUISelectDropdown"});Zs(Ea,this,e),Zs(fu,this,e.element),Zs(Ma,this,t),this.hot.getSettings().ariaTags&&(Oe(t.element,[Ao()]),Oe(this._element,[Mm()])),S([e,t],i=>this._element.appendChild(i.element)),Le(Qe,this).addLocalHook("select",i=>yr(Pa,this,cT).call(this,i)),Le(Qe,this).addLocalHook("afterClose",()=>yr(Pa,this,dT).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Le(Qe,this).hot.getTranslatedPhrase(Fm),Le(fu,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Le(Qe,this)&&(Le(Qe,this).open(),Le(Qe,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Le(Qe,this).getNavigator().toFirstItem(),Le(Qe,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Le(Qe,this)&&Le(Qe,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Le(Qe,this)&&(Le(Qe,this).destroy(),Zs(Qe,this,null)),Le(Ea,this)&&Le(Ea,this).destroy(),Le(Ma,this)&&Le(Ma,this).destroy(),super.destroy()}}function cT(n){n.name!==ae&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function dT(){this.runLocalHooks("afterClose")}function fT(){this.openOptions()}function gT(n,e){mT(n,e),e.add(n)}function mT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eg(n,e,t){return(e=pT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pT(n){var e=wT(n,"string");return typeof e=="symbol"?e:e+""}function wT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function tg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var gu=new WeakSet;class _c extends ta{constructor(e,t){super(e,{id:t.id,stateless:!1}),gT(this,gu),eg(this,"name",""),eg(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new Wr(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Fi(this.hot,{placeholder:vS})),this.elements.push(new Fi(this.hot,{placeholder:SS})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>tg(gu,this,CT).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),S(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>tg(gu,this,vT).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=Un(e.command);t.name.startsWith(bS)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),S(e.args,(i,s)=>{if(s>t.inputsCount-1)return!1;const o=this.getInputElement(s);o.setValue(i),o[t.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ms(st),t=[];return S(this.getInputElements(),(i,s)=>{e.inputsCount>s&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){const i=Ms(e?e.name:st);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||S(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Wr)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fi)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,s,o,r)=>{U(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&U(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return U(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||S(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Ms(st)];if(e!==null){const{visualIndex:i}=e;t=iT(this.hot.getDataType(0,i,this.hot.countRows(),i))}S(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function CT(n){S(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function vT(n){ah(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Os(n))}function ng(n,e,t){ST(n,e),e.set(n,t)}function ST(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(n,e){return n.get(Ew(n,e))}function ig(n,e,t){return n.set(Ew(n,e),t),t}function Ew(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Js=new WeakMap,mu=new WeakMap;class kl extends wn{static get DEFAULTS(){return Un({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Nt(kl.DEFAULTS,t)),ng(this,Js,void 0),ng(this,mu,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),ig(mu,this,e),ig(Js,this,this._element.firstChild),Qo(Js,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Qo(mu,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Qo(Js,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Qo(Js,this).checked=e)}focus(){this.isBuilt()&&Qo(Js,this).focus()}}function bT(n,e){yT(n,e),e.add(n)}function yT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RT(n,e,t){return(e=ET(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ET(n){var e=MT(n,"string");return typeof e=="symbol"?e:e+""}function MT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function PT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const sg=0;var og=new WeakSet;class _T extends ta{constructor(e,t){super(e,{id:t.id,stateless:!1}),bT(this,og),RT(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(U(t.parentNode,"htFiltersMenuOperators"),S(this.elements,i=>t.appendChild(i.element)),t)}}buildOperatorsElement(){const e=[ki,Ll];S(e,t=>{const i=new kl(this.hot,{name:"operator",label:{htmlFor:t,textContent:KI(t)},value:t,checked:t===e[sg],id:t});i.addLocalHook("change",s=>PT(og,this,IT).call(this,s)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(ot`Radio button with index ${e} doesn't exist.`);S(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof kl&&t.isChecked());return e?e.getValue():ki}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&S(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ki,t=arguments.length>1?arguments[1]:void 0,i=e;i===yd&&(i=Ll),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(sg)}}function IT(n){this.setState(n.target.value)}function TT(n,e,t){xT(n,e),e.set(n,t)}function xT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(n,e){return n.get(Mw(n,e))}function AT(n,e,t){return n.set(Mw(n,e),t),t}function Mw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var er=new WeakMap;class Br extends wn{static get DEFAULTS(){return Un({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,Nt(Br.DEFAULTS,t)),TT(this,er,void 0)}build(){super.build(),AT(er,this,this._element.firstChild)}update(){this.isBuilt()&&(pu(er,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&pu(er,this).focus()}activate(){pu(er,this).click()}}function NT(n,e){Pw(n,e),e.add(n)}function Qs(n,e,t){Pw(n,e),e.set(n,t)}function Pw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oe(n,e){return n.get(vo(n,e))}function an(n,e,t){return n.set(vo(n,e),t),t}function vo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const rg="multipleSelect.itemBox";var gn=new WeakMap,Ke=new WeakMap,wu=new WeakMap,qn=new WeakMap,vi=new WeakMap,Si=new WeakMap,tr=new WeakSet;class Vr extends wn{static get DEFAULTS(){return Un({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Nt(Vr.DEFAULTS,t)),NT(this,tr),Qs(this,gn,[]),Qs(this,Ke,void 0),Qs(this,wu,void 0),Qs(this,qn,void 0),Qs(this,vi,void 0),Qs(this,Si,void 0),an(qn,this,new Fi(this.hot,{placeholder:yS,className:"htUIMultipleSelectSearch"})),an(vi,this,new Br(this.hot,{textContent:RS,className:"htUISelectAll"})),an(Si,this,new Br(this.hot,{textContent:ES,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return oe(Ke,this)}registerHooks(){oe(qn,this).addLocalHook("keydown",e=>vo(tr,this,HT).call(this,e)),oe(qn,this).addLocalHook("input",e=>vo(tr,this,OT).call(this,e)),oe(vi,this).addLocalHook("click",e=>vo(tr,this,DT).call(this,e)),oe(Si,this).addLocalHook("click",e=>vo(tr,this,$T).call(this,e))}setItems(e){var t;an(gn,this,e),(t=oe(Ke,this))===null||t===void 0||t.loadData(oe(gn,this))}setLocale(e){an(wu,this,e)}getLocale(){return oe(wu,this)}getItems(){return[...oe(gn,this)]}getValue(){return kT(oe(gn,this))}getSearchInputElement(){return oe(qn,this)}getSelectAllElement(){return oe(vi,this)}getClearAllElement(){return oe(Si,this)}isSelectedAllValues(){return oe(gn,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),i=new wn(this.hot,{className:"htUISelectionControls",children:[oe(vi,this),oe(Si,this)]});this._element.appendChild(oe(qn,this).element),this._element.appendChild(i.element),this._element.appendChild(t);const s=o=>{var r;if(!this._element)return;(r=oe(Ke,this))===null||r===void 0||r.destroy(),U(o,"htUIMultipleSelectHot"),an(Ke,this,new this.hot.constructor(o,{data:oe(gn,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(h,u,c,d,g,w)=>{h.title=w.instance.getDataAtRowProp(u,w.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{oe(Ke,this).listen()},colWidths:()=>oe(Ke,this).container.scrollWidth-sh(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),oe(Ke,this).init(),this.hot.addHook("afterSetTheme",(h,u)=>{u||oe(Ke,this).useTheme(h)});const l=oe(Ke,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:h=>{this.runLocalHooks("keydown",h,this)},group:rg}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:h=>{oe(Ke,this).deselectCell(),this.runLocalHooks("keydown",h,this),this.runLocalHooks("listTabKeydown",h,this)},group:rg})};s(t),this.hot._registerTimeout(()=>s(t),100)}focus(){this.isBuilt()&&oe(Ke,this).listen()}reset(){oe(qn,this).reset(),oe(vi,this).reset(),oe(Si,this).reset()}update(){this.isBuilt()&&(oe(Ke,this).loadData(LT(oe(gn,this),this.options.value)),super.update())}destroy(){var e;(e=oe(Ke,this))===null||e===void 0||e.destroy(),oe(qn,this).destroy(),oe(Si,this).destroy(),oe(vi,this).destroy(),an(qn,this,null),an(Si,this,null),an(vi,this,null),an(Ke,this,null),an(gn,this,null),super.destroy()}}function OT(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...oe(gn,this)]:t=oe(gn,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),oe(Ke,this).loadData(t)}function HT(n){this.runLocalHooks("keydown",n,this),MS(ah,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),Os(n),oe(Ke,this).listen(),oe(Ke,this).selectCell(0,0))}function DT(n){const e=[];n.preventDefault(),oe(Ke,this).getSourceData().forEach((t,i)=>{t.checked=!0,e.push(Bm(t,i)[0])}),oe(Ke,this).setSourceDataAtCell(e)}function $T(n){const e=[];n.preventDefault(),oe(Ke,this).getSourceData().forEach((t,i)=>{t.checked=!1,e.push(Bm(t,i)[0])}),oe(Ke,this).setSourceDataAtCell(e)}function LT(n,e){const t=na(e);return n.map(i=>(i.checked=t(i.value),i))}function kT(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function FT(n,e){WT(n,e),e.add(n)}function WT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BT(n,e,t){return(e=VT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VT(n){var e=UT(n,"string");return typeof e=="symbol"?e:e+""}function UT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _a(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var nr=new WeakSet;class jT extends ta{constructor(e,t){super(e,{id:t.id,stateless:!1}),FT(this,nr),BT(this,"name",""),this.name=t.name,this.elements.push(new Vr(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_a(nr,this,YT).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>_a(nr,this,GT).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ps){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?st:Ps},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(i,s,o,r,a)=>{const[l]=Or(s,c=>c.name===Ps),h={},u=this.hot.getTranslatedPhrase(Jd);if(l){const c=r(i,a),d=Te(c,T=>T.value),g=new Map(c.map(T=>[T.value,this.hot.getCellMeta(T.meta.visualRow,T.meta.visualCol)])),w=Pc(d);o&&(l.args[0]=o);const E=[],C=Xf(w,l.args[0],u,T=>{T.checked&&E.push(T.value),_a(nr,this,ag).call(this,T,g)}),A=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,A).locale,h.args=[E],h.command=Ms(Ps),h.itemsSnapshot=C}else h.args=[],h.command=Ms(st);this.state.setValueAtIndex(i,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Vr)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,s,o,r)=>{U(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return U(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||S(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(Jd),t=this._getColumnVisibleValues(),i=t.map(l=>l.value),s=new Map(t.map(l=>[l.value,l.meta])),o=Pc(i),r=Xf(o,o,e,l=>{_a(nr,this,ag).call(this,l,s)});this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Te(this.hot.getDataAtCol(e.visualIndex),(t,i)=>({value:Sd(t),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function YT(n){ah(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Os(n))}function ag(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function GT(n,e){switch(e.type){case"numeric":return Cp(n,e);default:return n}}var _w;function zT(n,e){KT(n,e),e.add(n)}function KT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qT(n,e,t){return(e=XT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XT(n){var e=ZT(n,"string");return typeof e=="symbol"?e:e+""}function ZT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function JT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var lg=new WeakSet;class Ur extends ta{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),zT(this,lg),qT(this,"name",""),this.name=t.name,this.elements.push(new Fi(this.hot,{type:"button",value:PS,className:"htUIButton htUIButtonOK",identifier:Ur.BUTTON_OK})),this.elements.push(new Fi(this.hot,{type:"button",value:_S,className:"htUIButton htUIButtonCancel",identifier:Ur.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){S(this.elements,e=>{e.addLocalHook("click",(t,i)=>JT(lg,this,QT).call(this,t,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(U(t.parentNode,"htFiltersMenuActionBar"),S(this.elements,i=>t.appendChild(i.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_w=Ur;function QT(n,e){e.options.identifier===_w.BUTTON_OK?this.accept():this.cancel()}function Cu(n,e,t){return(e=ex(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ex(n){var e=tx(n,"string");return typeof e=="symbol"?e:e+""}function tx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const hg="ConditionCollection.filteringStates";class Ed{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Cu(this,"hot",void 0),Cu(this,"isMapRegistrable",void 0),Cu(this,"filteringStates",new Uc),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(hg,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var i;const s=this.filteringStates.getValueAtIndex(t),o=(i=s==null?void 0:s.conditions)!==null&&i!==void 0?i:[],r=s==null?void 0:s.operation;return this.isMatchInConditions(o,e,r)}isMatchInConditions(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ki;return e.length?zI(i)(e,t):!0}addCondition(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ki,s=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,r=t.args.map(u=>typeof u=="string"?u.toLocaleLowerCase(o):u),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(ot`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Vn(Fr[i]))throw new Error(ot`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:r,func:Wi(a,r)}]},s):h.push({name:a,args:r,func:Wi(a,r)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return(t=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[i,{operation:s,conditions:o}]=t;return e.push({column:i,operation:s,conditions:o.map(r=>{let{name:a,args:l}=r;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(t=>{t.conditions.forEach(i=>this.addCondition(t.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const i=this.getConditions(e);return t?i.some(s=>s.name===t):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(hg),this.filteringStates=null,this.clearLocalHooks()}}Vi(Ed,Ui);function ug(n,e,t){return(e=nx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nx(n){var e=ix(n,"string");return typeof e=="symbol"?e:e+""}function ix(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Iw{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];ug(this,"conditionCollection",void 0),ug(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return S(this.conditionCollection.getFilteredColumns(),(t,i)=>{let s=this.columnDataFactory(t);i&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return S(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&i.push(s)}),i}_getIntersectData(e,t){const i=[];return S(t,s=>{const o=s.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function sx(n,e){ox(n,e),e.add(n)}function ox(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ns(n,e,t){return(e=rx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rx(n){var e=ax(n,"string");return typeof e=="symbol"?e:e+""}function ax(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ia=new WeakSet;class Tw{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];sx(this,Ia),ns(this,"hot",void 0),ns(this,"conditionCollection",void 0),ns(this,"columnDataFactory",void 0),ns(this,"changes",[]),ns(this,"grouping",!1),ns(this,"latestEditedColumnPosition",-1),ns(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",s=>vu(Ia,this,lx).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>vu(Ia,this,hx).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>vu(Ia,this,ux).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,S(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const r=s.slice(0,o),a=s.slice(o);a.length&&a[0].column===e&&a.shift();const l=IS(function(u,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new Ed(i.hot,!1),w=[].concat(u,d);g.importAllConditions(w);const E=i.columnDataFactory(c);let C;g.isEmpty()?C=E:C=new Iw(g,T=>i.columnDataFactory(T)).filter(),C=Te(C,T=>T.meta.visualRow);const A=na(C);return g.destroy(),Or(E,T=>A(T.meta.visualRow))})(r),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),yt(this,(e,t)=>{this[t]=null})}}function lx(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function hx(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function ux(){S(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}Vi(Tw,Ui);function cx(n){return Zp({initialPage:0,size:()=>n.length,onItemSelect:(t,i)=>{const s=n[t];if(s instanceof Vr)return i;if(s.element&&!TS(s.element))return!1;s.focus()}})}const ir="filters";function dx(n,e){let t=-1,i;const s=cx(e),o=c=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(ir),s.setCurrentPage(e.indexOf(c))};e.forEach(c=>{c instanceof wn&&(c.addLocalHook("click",o(c)),c.addLocalHook("focus",o(c)),c.addLocalHook("afterClose",o(c)))}),l(n);function r(c){const d=i.getKeyboardShortcutsCtrl(),g=c.getKeyboardShortcutsCtrl();s.clear(),g.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(ir),callback:()=>{c.isSubMenu()&&c.close(),d.listen(ir)}}]),!c.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:w=>{const E=i.getNavigator();E.getCurrentPage()>-1&&(t=E.getCurrentPage()),E.clear(),w.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:w=>{const E=e[s.getCurrentPage()];E instanceof Wr&&(E.openOptions(),w.preventDefault()),E instanceof Br&&(E.activate(),w.preventDefault()),E instanceof wn||w.preventDefault()}}],ir)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(ir)}function l(c){c.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||s.clear()}),c.addLocalHook("afterSubmenuOpen",r),c.addLocalHook("afterOpen",r),i=c}function h(){return i}function u(){return t}return{...s,listen:a,setMenu:l,getMenu:h,getLastMenuPage:u}}function fx(n,e){xw(n,e),e.add(n)}function Su(n,e,t){xw(n,e),e.set(n,t)}function xw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(n,e,t){return(e=gx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gx(n){var e=mx(n,"string");return typeof e=="symbol"?e:e+""}function mx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ic(n,e,t){return n.set(_t(n,e),t),t}function Qt(n,e){return n.get(_t(n,e))}function _t(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Tc="filters",px=250,cg=Tc;var ti=new WeakMap,xc=new WeakMap,So=new WeakMap,Ot=new WeakSet;class wx extends de{static get PLUGIN_KEY(){return Tc}static get PLUGIN_PRIORITY(){return px}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t;super(e),t=this,fx(this,Ot),sr(this,"dropdownMenuPlugin",null),sr(this,"conditionCollection",null),sr(this,"conditionUpdateObserver",null),sr(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),sr(this,"filtersRowsMap",null),Su(this,ti,void 0),Su(this,xc,new WeakSet),Su(this,So,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return _t(Ot,t,Ex).call(t,...s)})}isEnabled(){return!!this.hot.getSettings()[Tc]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new jc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,i=t&&t.uiContainer||this.hot.rootDocument.body,s=a=>(a.addLocalHook("accept",()=>_t(Ot,this,dg).call(this,"accept")),a.addLocalHook("cancel",()=>_t(Ot,this,dg).call(this,"cancel")),a.addLocalHook("change",l=>_t(Ot,this,Rx).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(xS)}:`,r=()=>`${this.hot.getTranslatedPhrase(AS)}:`;if(!this.components.get("filter_by_condition")){const a=new _c(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>_t(Ot,this,fg).call(this)),this.components.set("filter_by_condition",s(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new _T(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new _c(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>_t(Ot,this,fg).call(this)),this.components.set("filter_by_condition2",s(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new jT(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new Ur(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Ed(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Tw(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>_t(Ot,this,Mx).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return _t(Ot,e,yx).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>_t(Ot,this,bx).call(this)),this.addHook("afterDropdownMenuShow",()=>_t(Ot,this,vx).call(this)),this.addHook("afterDropdownMenuHide",()=>_t(Ot,this,Sx).call(this)),this.addHook("afterChange",a=>_t(Ot,this,Cx).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Qt(ti,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const h=Qt(ti,this).getMenu(),u=h.getNavigator(),c=Qt(ti,this).getLastMenuPage();h.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(h=>{let[,u]=h;return u.getElements()}).flat()];Ic(ti,this,dx(this.dropdownMenuPlugin.menu,a));const l=h=>{Qt(ti,this).listen(),h.preventDefault(),ah(h.keyCode,"TAB")&&(h.shiftKey?Qt(ti,this).toPreviousItem():Qt(ti,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,i)=>{t.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:cg})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cg)}addCondition(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ki;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:i},s)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let s=[];const o=this.exportConditions();if(this.hot.runHooks("beforeFilter",o,Qt(So,this))!==!1){if(i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=Te(t.filter(),h=>h.meta.visualRow);const l=na(s);ne(this.hot.countSourceRows()-1,h=>{l(h)||a.push(h)}),S(a,h=>{this.filtersRowsMap.setValueAtIndex(h,!0)})},!0),!e&&!s.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();Ic(So,this,this.exportConditions()),this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render()}else this.importConditions(Qt(So,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),i=[];return S(this.hot.getSourceDataAtCol(t),(s,o)=>{var r;const{row:a,col:l,visualCol:h,visualRow:u,type:c,instance:d,dateFormat:g,locale:w}=this.hot.getCellMeta(o,t),E=(r=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&r!==void 0?r:s;i.push({meta:{row:a,col:l,visualCol:h,visualRow:u,type:c,instance:d,dateFormat:g,locale:w},value:Sd(E)})}),i}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),i=Pc(t);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var t;const i=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,i,s){let o=e;return o===Ll&&t.command.key!==st&&i.command.key!==st&&s.command.key!==st?o=yd:s.command.key!==st&&(t.command.key===st||i.command.key===st)&&(o=ki),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Iw(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return S(s,r=>{S(t.menuItems,(a,l)=>{a.key===r.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,s=i.getPlugin("hiddenRows");for(var o=arguments.length,r=new Array(o>1?o-1:0),a=1;a<o;a++)r[a-1]=arguments[a];const l=this.getIndexesOfComponents(...r);e?s.showRows(l):s.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Cx(n){n&&S(n,e=>{const[,t]=e,i=this.hot.propToCol(t);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function vx(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function Sx(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function bx(){const n=this.dropdownMenuPlugin.menu;Qt(xc,this).has(n)||Qt(ti,this).setMenu(n),Qt(xc,this).add(n)}function yx(n){n.items.push({name:ae}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function dg(n){var e;if(n==="accept"){const i=this.getSelectedColumn();if(i===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:s}=i,o=this.components.get("filter_by_condition").getState(),r=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,r,a);this.conditionUpdateObserver.groupChanges();let h=this.conditionCollection.getColumnStackPosition(s);h===-1&&(h=void 0),this.conditionCollection.removeConditions(s),o.command.key!==st&&(this.conditionCollection.addCondition(s,o,l,h),r.command.key!==st&&this.conditionCollection.addCondition(s,r,l,h)),a.command.key!==st&&this.conditionCollection.addCondition(s,a,l,h),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(s)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Rx(n,e){const t=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),n.constructor===_c&&!e.inputsCount&&this.setListeningDropdownMenu(),t.updateMenuDimensions()}function fg(){this.setListeningDropdownMenu()}function Ex(n,e,t){const i=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(i)&&t===this.hot.view.getColumnHeadersCount()-1?U(e,"htFiltersActive"):Ee(e,"htFiltersActive")}function Mx(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:i},conditionArgsChange:s}=n;Array.isArray(s)&&Ic(So,this,Qt(So,this).map(a=>(a.column===i&&t.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...s]])}),a)));const o=t.filter(a=>a.name===Ps),r=t.filter(a=>a.name!==Ps);if(o.length>=2||r.length>=3)$e(ot`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(r[0],i),this.components.get("filter_by_condition2").updateState(r[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(n)}}const Aw="internal-use-in-handsontable",Ac={licenseKey:Aw,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Nw(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[ft])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Ow(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function Px(n){var e;const t=n[ft],i=Ow(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=Nw(n);return{...Ac,...i,...s}}function _x(n){var e;const t=n[ft],i=Ow(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=Nw(n);return{...i,...s}}function Ix(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function Rh(){const n="engine_relationship",e=zr(ft);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function Md(){const n="shared_engine_usage",e=zr(ft);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function Tx(n){const e=n.getSettings(),t=e[ft],i=t==null?void 0:t.engine;if(t===!0||Vn(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var s;return xx((s=i.hyperformula)!==null&&s!==void 0?s:i,e,n)}else if(typeof i=="object"&&Vn(i.hyperformula)){const o=Rh(),r=Md().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(n),r&&r.push(n.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:Aw}),(i.getConfig().leapYear1900!==Ac.leapYear1900||NS(i.getConfig().nullDate,Ac.nullDate)===!1)&&$e(ot`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function xx(n,e,t){const i=e[ft],s=Px(e),o=Rh(),r=Md();Ax(n,i.functions),Nx(n,i.language);const a=n.buildEmpty(s);return o.set(a,[t]),r.set(a,[t.guid]),Ox(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function gg(n){var e;const t=Rh(),i=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(i.map(s=>[s.getPlugin("formulas").sheetId,s]))}function mg(n,e){if(n){const t=Rh(),i=t.get(n),s=Md(),o=s.get(n);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&t.delete(n)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(s.delete(n),n.destroy()))}}function Ax(n,e){e&&e.forEach(t=>{const{name:i,plugin:s,translations:o}=t;try{n.registerFunction(i,s,o)}catch(r){$e(r.message)}})}function Nx(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(i){$e(i.message)}}}function Ox(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:i,expression:s,scope:o,options:r}=t;try{n.addNamedExpression(i,s,o,r)}catch(a){$e(a.message)}}),n.resumeEvaluation())}function Hx(n,e){return(Vn(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const Hw="DD/MM/YYYY";function Dw(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function Dx(n){return Dw(n)?n.substr(1):n}function $x(n){return typeof n=="string"&&n.startsWith("=")}function Pd(n,e){return typeof n=="string"&&e==="date"}function $w(n,e){return ve(n,e,!0).isValid()}function Lw(n,e){return ve(n,e,!0).format(Hw)}function Lx(n,e){return ve(n,Hw,!0).format(e)}function kw(n,e){const i=new Date(Date.UTC(0,0,n+-1));return ve(i).format(e)}function kx(n,e,t){const i=Array.from(Array(t).keys()).filter(o=>n.includes(o)===!1);if(e===0){var s;return(s=i[e])!==null&&s!==void 0?s:0}return i[e-1]+1}function Fx(n,e){const t=[];return n.forEach(i=>{const s={from:i,to:e};t.forEach(o=>{const r=o.from>o.to,a=o.to<=s.from;o.from>s.from&&a&&r&&(s.from+=1)}),s.from>=e&&(e+=1),t.push(s)}),t}function Wx(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(s=>{const o=s.from<s.to;s.from>e.from&&o&&(s.from-=1)})}),n}function _d(n,e,t){const i=Fx(n,kx(n,e,t));return Wx(i)}function is(n,e,t){Bx(n,e),e.set(n,t)}function Bx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(n,e){return n.get(Fw(n,e))}function bi(n,e,t){return n.set(Fw(n,e),t),t}function Fw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var or=new WeakMap,yi=new WeakMap,Ht=new WeakMap,Ta=new WeakMap,bu=new WeakMap,yu=new WeakMap,xa=new WeakMap;class pg{constructor(e,t,i){is(this,or,void 0),is(this,yi,void 0),is(this,Ht,void 0),is(this,Ta,[]),is(this,bu,[]),is(this,yu,void 0),is(this,xa,[]),bi(or,this,e),bi(yi,this,t),bi(Ht,this,i)}setRemovedHfIndexes(e){return bi(xa,this,e.map(t=>{const i=De(yi,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(i)})),De(xa,this)}getRemovedHfIndexes(){return De(xa,this)}getHfIndexFromVisualIndex(e){const t=De(yi,this).getIndexesSequence(),i=De(yi,this).getNotTrimmedIndexes();return t.indexOf(i[e])}syncMoves(e){const i=`move${Cn(De(or,this))}s`;De(Ht,this).getEngine().batch(()=>{e.forEach(s=>{const o=s.from!==s.to,r=s.from+1!==s.to;o&&r&&De(Ht,this).getEngine()[i](De(Ht,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,i){i!==!1&&(bi(bu,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),bi(yu,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(De(Ht,this).isPerformingUndoRedo()||e===!1||t===!1)return;const i=_d(De(bu,this),De(yu,this),De(yi,this).getNumberOfIndexes());De(Ht,this).getSheetId()===null?De(Ht,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Cn(De(or,this))}Order`;return t=>{if(De(Ht,this).isPerformingUndoRedo())return;const i=De(yi,this).getIndexesSequence();if(t==="update"&&i.length>0){const s=De(Ta,this).map(l=>i.indexOf(l)),o=De(Ht,this).getEngine().getSheetDimensions(De(Ht,this).getSheetId());let r;De(or,this)==="row"?r=o.height:r=o.width;const a=s.length;for(let l=a;l<r;l+=1)s.push(l);De(Ht,this).getEngine()[e](De(Ht,this).getSheetId(),s)}bi(Ta,this,i)}}init(){bi(Ta,this,De(yi,this).getIndexesSequence())}}function ss(n,e,t){Vx(n,e),e.set(n,t)}function Vx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xn(n,e){return n.get(Ww(n,e))}function os(n,e,t){return n.set(Ww(n,e),t),t}function Ww(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Aa=new WeakMap,Na=new WeakMap,Ru=new WeakMap,Eu=new WeakMap,Mu=new WeakMap,Pu=new WeakMap,_u=new WeakMap;class Ux{constructor(e,t,i){ss(this,Aa,void 0),ss(this,Na,void 0),ss(this,Ru,void 0),ss(this,Eu,!1),ss(this,Mu,!1),ss(this,Pu,null),ss(this,_u,null),os(Aa,this,new pg("row",e,this)),os(Na,this,new pg("column",t,this)),os(Ru,this,i)}getForAxis(e){return e==="row"?Xn(Aa,this):Xn(Na,this)}setPerformUndo(e){os(Eu,this,e)}setPerformRedo(e){os(Mu,this,e)}isPerformingUndoRedo(){return Xn(Eu,this)||Xn(Mu,this)}getSheetId(){return Xn(_u,this)}getEngine(){return Xn(Pu,this)}getPostponeAction(){return Xn(Ru,this)}setupSyncEndpoint(e,t){os(Pu,this,e),os(_u,this,t),Xn(Aa,this).init(),Xn(Na,this).init()}}function jx(n,e){Bw(n,e),e.add(n)}function eo(n,e,t){return(e=Yx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yx(n){var e=Gx(n,"string");return typeof e=="symbol"?e:e+""}function Gx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Iu(n,e,t){Bw(n,e),e.set(n,t)}function Bw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(n,e,t){return n.set(Ie(n,e),t),t}function Ro(n,e){return n.get(Ie(n,e))}function Ie(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ft="formulas",zx=["maxRows","maxColumns","language"],Kx=260;X.getSingleton().register("afterNamedExpressionAdded");X.getSingleton().register("afterNamedExpressionRemoved");X.getSingleton().register("afterSheetAdded");X.getSingleton().register("afterSheetRemoved");X.getSingleton().register("afterSheetRenamed");X.getSingleton().register("afterFormulasValuesUpdate");const Do=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var fi=new WeakMap,Id=new WeakMap,rr=new WeakMap,Ae=new WeakSet;class qx extends de{constructor(){var e;super(...arguments),e=this,jx(this,Ae),Iu(this,fi,!1),Iu(this,Id,!1),Iu(this,rr,[["valuesUpdated",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,cA).call(e,...i)}],["namedExpressionAdded",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,dA).call(e,...i)}],["namedExpressionRemoved",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,fA).call(e,...i)}],["sheetAdded",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,gA).call(e,...i)}],["sheetRenamed",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,mA).call(e,...i)}],["sheetRemoved",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ie(Ae,e,pA).call(e,...i)}]]),eo(this,"staticRegister",zr("formulas")),eo(this,"engine",null),eo(this,"sheetName",null),eo(this,"indexSyncer",null),eo(this,"rowAxisSyncer",null),eo(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return ft}static get PLUGIN_PRIORITY(){return Kx}static get SETTING_KEYS(){return[ft,...zx]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[ft]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=Tx(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){$e("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,wg).call(t,...s)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Cg).call(t,...s)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,wg).call(t,...s)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Cg).call(t,...s)}),this.addHook("modifyData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Qx).call(t,...s)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,eA).call(t,...s)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Xx).call(t,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,tA).call(t,...s)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,vg).call(t,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,vg).call(t,...s)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,nA).call(t,...s)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,iA).call(t,...s)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,rA).call(t,...s)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,aA).call(t,...s)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,sA).call(t,...s)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,oA).call(t,...s)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,lA).call(t,...s)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,hA).call(t,...s)}),this.indexSyncer=new Ux(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,s,o,r)=>{this.rowAxisSyncer.storeMovesInformation(i,s,r)}),this.hot.addHook("beforeColumnMove",(i,s,o,r)=>{this.columnAxisSyncer.storeMovesInformation(i,s,r)}),this.hot.addHook("afterRowMove",(i,s,o,r,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("afterColumnMove",(i,s,o,r,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("beforeColumnFreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Jx).call(t,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,uA).call(t,...s)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ie(Ae,t,Zx).call(t,...s)}),Ro(rr,this).forEach(i=>{let[s,o]=i;return this.engine.on(s,o)}),super.enablePlugin()}}disablePlugin(){Ro(rr,this).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),mg(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=_x(this.hot.getSettings());Ix(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const i=this.hot.getSettings()[ft];if(pe(i)&&pe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[ft].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Ro(rr,this).forEach(e=>{var t;let[i,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(i,s)}),Bi(rr,this,null),mg(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(pe(t)&&!OS(t))return $e("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return $e("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(i){return $e(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Vm(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${Cn(ft)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return s!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(s=>{var o;const r=s==null||(o=s.address)===null||o===void 0?void 0:o.sheet;r!==void 0&&(i.has(r)||i.add(r))}),gg(this.engine).forEach((s,o)=>{if((t||o!==this.sheetId)&&i.has(o)){var r;s.render(),(r=s.view)===null||r===void 0||r.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var r;const{row:a,col:l,sheet:h}=(r=o==null?void 0:o.address)!==null&&r!==void 0?r:{};return pe(h)?`${h}:${a}x${l}`:""},s=new Set(t.map(o=>i(o)));e.forEach(o=>{var r,a;const{row:l,col:h}=(r=o.address)!==null&&r!==void 0?r:{};if(pe(l)===!1||pe(h)===!1||l>=this.hot.countRows()||h>=this.hot.countCols())return;const u=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,c=i(o);if(u!==void 0&&!s.has(c)){const d=gg(this.engine).get(u);if(!d)return;d.validateCell(d.getDataAtCell(l,h),d.getCellMeta(l,h),()=>{})}})}syncChangeWithEngine(e,t,i){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){$e(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const o=this.hot.getCellMeta(e,t);return Pd(i,o.type)&&($w(i,o.dateFormat)?i=Lw(i,o.dateFormat):$x(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(s,i)}}function Xx(n,e,t){const i=this.hot.propToCol(t);if(this.isFormulaCellType(e,i)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let r=this.engine.getCellValue(s);return o.type==="date"&&Ut(r)&&(r=kw(r,o.dateFormat)),typeof r=="object"&&r!==null?r.value:r}return n}function Zx(n,e,t){const{row:i,col:s}=e.getTopStartCorner(),{row:o,col:r}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:h,col:u}=t.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(c,d),{row:w,col:E}=c.start,{row:C,col:A}=c.end,T=C-w+1,k=A-E+1;for(let K=0;K<g.length;K+=1)for(let $=0;$<g[K].length;$+=1){const x=g[K][$],N=w+K%T,q=E+$%k,ee=this.hot.getCellMeta(N,q);Pd(x,ee.type)&&(x.startsWith("'")?g[K][$]=x.slice(1):this.isFormulaCellType(N,q,this.sheetId)===!1&&(g[K][$]=Lx(x,ee.dateFormat)))}return g}function wg(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Cn(ft))||Bi(Id,this,Vn(this.hot.getSettings().data))}function Jx(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,i)=>{t.forEach((s,o)=>{const r=this.hot.getCellMeta(i,o),a=r.dateFormat;Pd(s,r.type)&&(e=!0,$w(s,a)?n[i][o]=Lw(s,a):this.isFormulaCellType(i,o)===!1&&(n[i][o]=`'${s}`))})}),e===!0&&(Bi(fi,this,!0),this.engine.setSheetContent(this.sheetId,n),Bi(fi,this,!1))}function Cg(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Cn(ft)))if(this.sheetName=Hx(this.engine,this.hot.getSettings()[ft].sheetName),Ro(Id,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Bi(fi,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Bi(fi,this,!1)}}}function Qx(n,e,t,i){if(i!=="get"||Ro(fi,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(n);if(s===null||e===null)return;if(!this.isFormulaCellType(s,e)&&this.getCellType(s,e)!=="ARRAY"){Dw(t.value)&&(t.value=Dx(t.value));return}const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(r),l=this.hot.getCellsMeta().find(u=>u.visualRow===s&&u.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Ut(a)&&(a=kw(a,l.dateFormat));const h=typeof a=="object"&&a!==null?a.value:a;t.value=h}function eA(n,e,t,i){if(i!=="get"||Ro(fi,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(n),o=this.hot.propToCol(e);if(s===null||o===null||!this.isFormulaCellType(s,o)&&this.getCellType(s,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function vg(n,e){if(Do(e))return;const t=[],i=[],s=this.engine.batch(()=>{n.forEach(o=>{let[r,a,,l]=o;const h=this.hot.propToCol(a),u=this.hot.toPhysicalRow(r),c=this.hot.toPhysicalColumn(h),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};u!==null&&c!==null?this.syncChangeWithEngine(r,h,l):t.push([r,h,l]),i.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{t.forEach(r=>{let[a,l,h]=r;this.syncChangeWithEngine(a,l,h)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,i)}function tA(n,e){if(Do(e))return;const t=[],i=[];n.forEach(s=>{let[o,r,,a]=s;const l=this.hot.propToCol(r);if(!Ut(l))return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(h)){$e(`Not possible to set source cell data at ${JSON.stringify(h)}`);return}i.push({address:h}),t.push(...this.engine.setCellContents(h,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,i)}function nA(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function iA(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function sA(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function oA(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function rA(n,e,t){if(Do(t))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function aA(n,e,t){if(Do(t))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function lA(n,e,t,i){if(Do(i))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((r,a)=>a-r),o=this.engine.batch(()=>{s.forEach(r=>{this.engine.removeRows(this.sheetId,[r,1])})});this.renderDependentSheets(o)}function hA(n,e,t,i){if(Do(i))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((r,a)=>a-r),o=this.engine.batch(()=>{s.forEach(r=>{this.engine.removeColumns(this.sheetId,[r,1])})});this.renderDependentSheets(o)}function uA(n,e,t){var i;Bi(fi,this,!0);const s=this.hot.getSourceDataArray(t,0,t+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Bi(fi,this,!1),s.forEach((o,r)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+r,sheet:this.sheetId},[[a]])})})}function cA(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function dA(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function fA(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function gA(n){this.hot.runHooks("afterSheetAdded",n)}function mA(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function pA(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function wA(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,i,,s]=e;i-s!==0&&(t=1)}return this.getTranslatedPhrase(HS,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),o=[];for(let l=i;l<=s;l+=1)o.push(l);n.hideColumns(o);const r=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function CA(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(DS,t)},callback(){var t,i;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countCols()||this.selectColumns(s,o)},disabled:!1,hidden(){const t=Te(n.getHiddenColumns(),c=>this.toPhysicalColumn(c));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,r=this.columnIndexMapper,a=r.getRenderableFromVisualIndex(s),l=r.getRenderableFromVisualIndex(o),h=r.getNotTrimmedIndexes(),u=[];if(s!==o){const c=o-s+1,d=l-a+1;if(c>d){const g=h.slice(s,o+1);u.push(...g.filter(w=>t.includes(w)))}}else if(a===0&&a<s)u.push(...h.slice(0,s));else if(a===null)u.push(...h.slice(0,this.countCols()));else{const c=this.countCols()-1,d=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));l===d&&c>o&&u.push(...h.slice(o+1))}return S(u,c=>{e.push(this.toVisualColumn(c))}),e.length===0}}}function vA(n,e){Vw(n,e),e.add(n)}function SA(n,e,t){Vw(n,e),e.set(n,t)}function Vw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rs(n,e){return n.get(_i(n,e))}function Sg(n,e,t){return n.set(_i(n,e),t),t}function _i(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeHideColumns");X.getSingleton().register("afterHideColumns");X.getSingleton().register("beforeUnhideColumns");X.getSingleton().register("afterUnhideColumns");const bg="hiddenColumns",bA=310;var Rn=new WeakMap,as=new WeakSet;class yA extends de{constructor(){super(...arguments),vA(this,as),SA(this,Rn,null)}static get PLUGIN_KEY(){return bg}static get PLUGIN_PRIORITY(){return bA}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[bg]}enablePlugin(){var e=this;this.enabled||(Sg(Rn,this,new Um),rs(Rn,this).addLocalHook("init",()=>_i(as,this,IA).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,rs(Rn,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return _i(as,e,_A).call(e,...i)}),this.addHook("afterGetCellMeta",(t,i,s)=>_i(as,this,EA).call(this,t,i,s)),this.addHook("modifyColWidth",(t,i)=>_i(as,this,RA).call(this,t,i),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return _i(as,e,PA).call(e,...i)}),this.addHook("modifyCopyableRange",t=>_i(as,this,MA).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let s=t;const o=rs(Rn,this).getValues().slice(),r=e.length>0;if(i&&r){const l=e.map(h=>this.hot.toPhysicalColumn(h));S(l,h=>{o[h]=!1}),s=ji(o,(h,u,c)=>(u&&h.push(this.hot.toVisualColumn(c)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,s,i&&r)!==!1&&(i&&r&&rs(Rn,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,i&&r,i&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{S(e,r=>{rs(Rn,this).setValueAtIndex(this.hot.toPhysicalColumn(r),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,i,i&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return Te(rs(Rn,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return rs(Rn,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){S(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Sg(Rn,this,null),super.destroy()}}function RA(n,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function EA(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const i=t.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenColumn");s>-1&&i.splice(s,1),t.className=i.join(" ")}}}function MA(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(i,s,o,r)=>{e.push({startRow:i,endRow:s,startCol:o,endCol:r})};return S(n,i=>{let s=!0,o=0;ne(i.startCol,i.endCol,r=>{this.isHidden(r)?(s||t(i.startRow,i.endRow,o,r-1),s=!0):(s&&(o=r),r===i.endCol&&t(i.startRow,i.endRow,o,r),s=!1)})}),e}function PA(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),U(e,t)}function _A(n){n.items.push({name:ae},wA(this),CA(this))}function IA(){const n=this.getSetting("columns");Array.isArray(n)&&this.hideColumns(n)}function TA(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[i,,s]=e;i-s!==0&&(t=1)}return this.getTranslatedPhrase($S,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),o=[];for(let l=i;l<=s;l+=1)o.push(l);n.hideRows(o);const r=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function xA(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(LS,t)},callback(){var t,i;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),o-s+1===this.countRows()||this.selectRows(s,o)},disabled:!1,hidden(){const t=Te(n.getHiddenRows(),c=>this.toPhysicalRow(c));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,r=this.rowIndexMapper,a=r.getRenderableFromVisualIndex(s),l=r.getRenderableFromVisualIndex(o),h=r.getNotTrimmedIndexes(),u=[];if(s!==o){const c=o-s+1,d=l-a+1;if(c>d){const g=h.slice(s,o+1);u.push(...g.filter(w=>t.includes(w)))}}else if(a===0&&a<s)u.push(...h.slice(0,s));else if(a===null)u.push(...h.slice(0,this.countRows()));else{const c=this.countRows()-1,d=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));l===d&&c>o&&u.push(...h.slice(o+1))}return S(u,c=>{e.push(this.toVisualRow(c))}),e.length===0}}}function AA(n,e){Uw(n,e),e.add(n)}function NA(n,e,t){Uw(n,e),e.set(n,t)}function Uw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ls(n,e){return n.get(Ii(n,e))}function yg(n,e,t){return n.set(Ii(n,e),t),t}function Ii(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeHideRows");X.getSingleton().register("afterHideRows");X.getSingleton().register("beforeUnhideRows");X.getSingleton().register("afterUnhideRows");const Rg="hiddenRows",OA=320;var En=new WeakMap,hs=new WeakSet;class HA extends de{constructor(){super(...arguments),AA(this,hs),NA(this,En,null)}static get PLUGIN_KEY(){return Rg}static get PLUGIN_PRIORITY(){return OA}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[Rg]}enablePlugin(){var e=this;this.enabled||(yg(En,this,new Um),ls(En,this).addLocalHook("init",()=>Ii(hs,this,WA).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ls(En,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ii(hs,e,FA).call(e,...i)}),this.addHook("afterGetCellMeta",(t,i,s)=>Ii(hs,this,$A).call(this,t,i,s)),this.addHook("modifyRowHeight",(t,i)=>Ii(hs,this,DA).call(this,t,i)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ii(hs,e,kA).call(e,...i)}),this.addHook("modifyCopyableRange",t=>Ii(hs,this,LA).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let s=t;const o=ls(En,this).getValues().slice(),r=e.length>0;if(i&&r){const l=e.map(h=>this.hot.toPhysicalRow(h));S(l,h=>{o[h]=!1}),s=ji(o,(h,u,c)=>(u&&h.push(this.hot.toVisualRow(c)),h),[])}this.hot.runHooks("beforeUnhideRows",t,s,i&&r)!==!1&&(i&&r&&ls(En,this).setValues(o),this.hot.runHooks("afterUnhideRows",t,s,i&&r,i&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{S(e,r=>{ls(En,this).setValueAtIndex(this.hot.toPhysicalRow(r),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,i,i&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return Te(ls(En,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ls(En,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){S(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){yg(En,this,null),super.destroy()}}function DA(n,e){return this.isHidden(e)?0:n}function $A(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const i=t.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenRow");s>-1&&i.splice(s,1),t.className=i.join(" ")}}}function LA(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(i,s,o,r)=>{e.push({startRow:i,endRow:s,startCol:o,endCol:r})};return S(n,i=>{let s=!0,o=0;ne(i.startRow,i.endRow,r=>{this.isHidden(r)?(s||t(o,r-1,i.startCol,i.endCol),s=!0):(s&&(o=r),r===i.endRow&&t(o,r,i.startCol,i.endCol),s=!1)})}),e}function kA(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),U(e,t)}function FA(n){n.items.push({name:ae},TA(this),xA(this))}function WA(){const n=this.getSetting("rows");Array.isArray(n)&&this.hideRows(n)}function BA(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(kS)},callback(e,t){const[{start:{col:i}}]=t;n.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function VA(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(FS)},callback(e,t){const[{start:{col:i}}]=t;n.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function UA(n,e){jw(n,e),e.add(n)}function jA(n,e,t){jw(n,e),e.set(n,t)}function jw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nc(n,e){return n.get(Fl(n,e))}function Tu(n,e,t){return n.set(Fl(n,e),t),t}function Fl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeColumnFreeze");X.getSingleton().register("afterColumnFreeze");X.getSingleton().register("beforeColumnUnfreeze");X.getSingleton().register("afterColumnUnfreeze");const Eg="manualColumnFreeze",YA=110;var bs=new WeakMap,xu=new WeakSet;class GA extends de{constructor(){super(...arguments),UA(this,xu),jA(this,bs,!1)}static get PLUGIN_KEY(){return Eg}static get PLUGIN_PRIORITY(){return YA}isEnabled(){return!!this.hot.getSettings()[Eg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Fl(xu,this,zA).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>Fl(xu,this,KA).call(this,e,t)),super.enablePlugin())}disablePlugin(){Tu(bs,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;Nc(bs,this)||Tu(bs,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;Nc(bs,this)||Tu(bs,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function zA(n){n.items.push({name:"---------"},BA(this),VA(this))}function KA(n,e){if(Nc(bs,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(i=>i<t))return!1}}function Oa(n,e,t){return(e=qA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qA(n){var e=XA(n,"string");return typeof e=="symbol"?e:e+""}function XA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Au=0,Mg=1,Pg=2,to="px";let Yw=class{constructor(e){Oa(this,"hot",void 0),Oa(this,"_element",null),Oa(this,"state",Au),Oa(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Pg}build(){this.state===Au&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Mg)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Au}isAppended(){return this.state===Pg}isBuilt(){return this.state>=Mg}setPosition(e,t){Ut(e)&&(this._element.style.top=e+to),Ut(t)&&(this._element.style[this.inlineProperty]=t+to)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Ut(e)&&(this._element.style.width=e+to),Ut(t)&&(this._element.style.height=t+to)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Ut(e)&&(this._element.style.marginTop=e+to),Ut(t)&&(this._element.style[`margin${Cn(this.inlineProperty)}`]=t+to)}getOffset(){const e=this._element.style,t=`margin${Cn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const ZA="ht__manualColumnMove--backlight";let JA=class extends Yw{build(){super.build(),U(this._element,ZA)}};const QA="ht__manualColumnMove--guideline";let e1=class extends Yw{build(){super.build(),U(this._element,QA)}};function t1(n,e){Gw(n,e),e.add(n)}function ln(n,e,t){Gw(n,e),e.set(n,t)}function Gw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(n,e,t){return n.set(Ti(n,e),t),t}function z(n,e){return n.get(Ti(n,e))}function Ti(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeColumnMove");X.getSingleton().register("afterColumnMove");const Nu="manualColumnMove",n1=120,_g="ht__manualColumnMove",Wl="show-ui",Oc="on-moving--columns",Hc="after-selection--columns";var St=new WeakMap,Ai=new WeakMap,li=new WeakMap,Cl=new WeakMap,$i=new WeakMap,vt=new WeakMap,Ha=new WeakMap,Xt=new WeakMap,mo=new WeakMap,Bl=new WeakMap,Rr=new WeakMap,us=new WeakSet;class i1 extends de{constructor(){super(...arguments),t1(this,us),ln(this,St,new JA(this.hot)),ln(this,Ai,new e1(this.hot)),ln(this,li,[]),ln(this,Cl,0),ln(this,$i,!1),ln(this,vt,{}),ln(this,Ha,void 0),ln(this,Xt,void 0),ln(this,mo,void 0),ln(this,Bl,void 0),ln(this,Rr,void 0)}static get PLUGIN_KEY(){return Nu}static get PLUGIN_PRIORITY(){return n1}isEnabled(){return!!this.hot.getSettings()[Nu]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ti(us,e,s1).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ti(us,e,r1).call(e,...i)}),this.addHook("afterScrollVertically",()=>Ti(us,this,l1).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ti(us,e,h1).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),U(this.hot.rootElement,_g),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ee(this.hot.rootElement,_g),this.unregisterEvents(),z(St,this).destroy(),z(Ai,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const i=z(Ha,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,i,s);if(xt(Ha,this,void 0),o===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,t);const r=s&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,s,r),r}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const i=this.countFinalIndex(e,t);return xt(Ha,this,t),this.moveColumns(e,i)}isMovePossible(e,t){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>i,o=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=i);return!(s||o||r||a)}isColumnOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}countFinalIndex(e,t){const i=ji(e,(s,o)=>(o<t&&(s+=1),s),0);return t-i}getColumnsWidth(e,t){const i=this.hot.columnIndexMapper;let s=0;for(let o=e;o<=t;o+=1){const r=i.getRenderableFromVisualIndex(o);o<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:r!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(r)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Nu];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const i=[];return ne(e,t,s=>{i.push(s)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(z(Xt,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,z(Xt,this)-1);const r=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=z(St,this).getOffset().start,h=z(St,this).getSize().width;let u=0,c=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,E=Is(this.hot.rootElement),C=w.innerWidth-z(mo,this)-E;c=w.innerWidth-z(vt,this).eventPageX-C-(i.scrollX===void 0?s:0)}else c=z(vt,this).eventPageX-(z(mo,this)-(i.scrollX===void 0?s:0));if(z(Bl,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(z(Xt,this))&&(o+=s),o+=u,z(Xt,this)<0)z(Rr,this)>0?z(vt,this).col=0:z(vt,this).col=e>0?e-1:e;else if(z(vt,this).TD.offsetWidth/2+o<=c){const w=z(Xt,this)>=z(Cl,this)?z(Cl,this)-1:z(Xt,this);z(vt,this).col=w+1,o+=z(vt,this).TD.offsetWidth}else z(vt,this).col=z(Xt,this);let d=c,g=o;c+h+l>=r?d=r-h-l:c+l<a+u&&(d=a+u+Math.abs(l)),o>=r-1?g=r-1:g===0?g=1:i.scrollX!==void 0&&z(Xt,this)<z(Rr,this)&&(g-=z(mo,this)<=i.scrollX?z(mo,this):0),z(St,this).setPosition(null,d),z(Ai,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Ti(us,this,o1).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Ti(us,this,a1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){z(St,this).build(),z(Ai,this).build()}destroy(){z(St,this).destroy(),z(Ai,this).destroy(),super.destroy()}}function s1(n,e,t,i){const s=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),r=this.hot.getSelectedRangeLast(),a=Ne(n.target,"sortAction");if(!r||!o||z($i,this)||n.button!==0||a){xt($i,this,!1),z(li,this).length=0,Ee(this.hot.rootElement,[Oc,Wl]);return}const l=z(Ai,this).isBuilt()&&!z(Ai,this).isAppended(),h=z(St,this).isBuilt()&&!z(St,this).isAppended();l&&h&&(z(Ai,this).appendTo(s.hider),z(St,this).appendTo(s.hider));const{from:u,to:c}=r,d=Math.min(u.col,c.col),g=Math.max(u.col,c.col);if(e.row<0&&e.col>=d&&e.col<=g){i.column=!0,xt($i,this,!0);const w=t.firstChild?WS(n,t.firstChild).x:n.offsetX;z(vt,this).eventPageX=n.pageX,xt(Xt,this,e.col),z(vt,this).TD=t,z(vt,this).col=e.col,xt(li,this,this.prepareColumnsToMoving(d,g)),xt(Bl,this,!!this.hot.getSettings().rowHeaders),xt(Cl,this,this.hot.countCols()),xt(Rr,this,this.hot.getSettings().fixedColumnsStart),xt(mo,this,Ml(this.hot.rootElement).left);const E=z(Bl,this)?-1:0,C=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,A=e.col<z(Rr,this),T=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),k=Math.abs(w-(this.hot.isRtl()?t.offsetWidth:0)),K=this.getColumnsWidth(d,e.col-1)+k,$=this.getColumnsWidth(E,d-1)+(A?T:0)+K;z(St,this).setPosition(C,$),z(St,this).setSize(this.getColumnsWidth(d,g),s.hider.offsetHeight-C),z(St,this).setOffset(null,-K),U(this.hot.rootElement,Oc)}else Ee(this.hot.rootElement,Hc),xt($i,this,!1),z(li,this).length=0}function o1(n){z($i,this)&&(z(vt,this).eventPageX=n.pageX,this.refreshPositions())}function r1(n,e,t,i){!this.hot.getSelectedRangeLast()||!z($i,this)||(z(li,this).indexOf(e.col)>-1?Ee(this.hot.rootElement,Wl):U(this.hot.rootElement,Wl),i.row=!0,i.column=!0,i.cell=!0,xt(Xt,this,e.col),z(vt,this).TD=t)}function a1(){const n=z(vt,this).col,e=z(li,this).length;if(xt(Xt,this,void 0),xt($i,this,!1),Ee(this.hot.rootElement,[Oc,Wl,Hc]),this.hot.selection.isSelectedByColumnHeader()&&U(this.hot.rootElement,Hc),e<1||n===void 0)return;const t=z(li,this)[0],i=this.hot.toPhysicalColumn(t),s=this.dragColumns(z(li,this),n);if(z(li,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(i),r=o+e-1;this.hot.selectColumns(o,r)}}function l1(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,i=e+t;z(St,this).setPosition(i),z(St,this).setSize(null,n.hider.offsetHeight-i)}function h1(){this.moveBySettingsOrLoad()}function u1(n,e){zw(n,e),e.add(n)}function ut(n,e,t){zw(n,e),e.set(n,t)}function zw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(n,e,t){return n.set(mn(n,e),t),t}function B(n,e){return n.get(mn(n,e))}function mn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Vl="manualColumnResize",c1=130,Ig="manualColumnWidths";var oi=new WeakMap,Da=new WeakMap,Wt=new WeakMap,Ul=new WeakMap,Fn=new WeakMap,d1=new WeakMap,Eo=new WeakMap,$a=new WeakMap,Pt=new WeakMap,ni=new WeakMap,As=new WeakMap,jl=new WeakMap,Er=new WeakMap,Mr=new WeakMap,Vt=new WeakMap,Pr=new WeakMap,Mn=new WeakSet;class f1 extends de{static get PLUGIN_KEY(){return Vl}static get PLUGIN_PRIORITY(){return c1}constructor(e){super(e),u1(this,Mn),ut(this,oi,null),ut(this,Da,null),ut(this,Wt,[]),ut(this,Ul,null),ut(this,Fn,null),ut(this,d1,null),ut(this,Eo,null),ut(this,$a,null),ut(this,Pt,this.hot.rootDocument.createElement("DIV")),ut(this,ni,this.hot.rootDocument.createElement("DIV")),ut(this,As,null),ut(this,jl,!1),ut(this,Er,0),ut(this,Mr,null),ut(this,Vt,void 0),ut(this,Pr,void 0),U(B(Pt,this),"manualColumnResizer"),U(B(ni,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Vl]}enablePlugin(){var e=this;this.enabled||(qe(Vt,this,new Gr),B(Vt,this).addLocalHook("init",()=>mn(Mn,this,g1).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,B(Vt,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return mn(Mn,e,S1).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return mn(Mn,e,b1).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return mn(Mn,e,y1).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qe(Pr,this,B(Vt,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Ig,B(Vt,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Ig,e),e.value}setManualSize(e,t){const i=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return B(Vt,this).setValueAtIndex(s,i),i}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);B(Vt,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;qe(oi,this,e);const{_wt:t}=this.hot.view,i=t.wtTable.getCoords(B(oi,this)),s=i.col;if(s<0)return;const o=Ts(B(oi,this)),r=B(oi,this).getBoundingClientRect(),a=s<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(B(oi,this),i.row,i.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(B(oi,this),i.row,i.col)),qe(Da,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),qe(Wt,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const u=this.hot.getSelectedRange();S(u,c=>{const d=c.getTopStartCorner().col,g=c.getBottomEndCorner().col;ne(d,g,w=>{B(Wt,this).includes(w)||B(Wt,this).push(w)})})}B(Wt,this).includes(B(Da,this))||qe(Wt,this,[B(Da,this)]),qe($a,this,l.start-6),qe(Eo,this,parseInt(r.width,10)),B(Pt,this).style.top=`${l.top}px`,B(Pt,this).style[this.inlineDir]=`${B($a,this)+B(Eo,this)}px`,B(Pt,this).style.height=`${o}px`,this.hot.rootElement.appendChild(B(Pt,this))}refreshHandlePosition(){B(Pt,this).style[this.inlineDir]=`${B($a,this)+B(Ul,this)}px`}setupGuidePosition(){const e=parseInt(Ts(B(Pt,this)),10),t=parseInt(B(Pt,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);U(B(Pt,this),"active"),U(B(ni,this),"active"),B(ni,this).style.top=`${t}px`,this.refreshGuidePosition(),B(ni,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(B(ni,this))}refreshGuidePosition(){B(ni,this).style[this.inlineDir]=B(Pt,this).style[this.inlineDir]}hideHandleAndGuide(){Ee(B(Pt,this),"active"),Ee(B(ni,this),"active")}checkIfColumnHeader(e){const t=Hr(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,s)=>{const o=this.hot.runHooks("beforeColumnResize",B(Fn,this),i,!0);o!==void 0&&qe(Fn,this,o),this.setManualSize(i,B(Fn,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",B(Fn,this),i,!0),s&&e()};B(Er,this)>=2&&(B(Wt,this).length>1?(S(B(Wt,this),s=>{t(s)}),e()):S(B(Wt,this),s=>{t(s,!0)})),qe(Er,this,0),qe(Mr,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",i=>mn(Mn,this,m1).call(this,i)),this.eventManager.addEventListener(t,"mousedown",i=>mn(Mn,this,p1).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>mn(Mn,this,w1).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>mn(Mn,this,C1).call(this)),this.eventManager.addEventListener(B(Pt,this),"contextmenu",()=>mn(Mn,this,v1).call(this))}destroy(){super.destroy()}}function g1(){const n=this.hot.getSettings()[Vl],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,i)=>{B(Vt,this).setValueAtIndex(i,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,i)=>{B(Vt,this).setValueAtIndex(i,t)})},!0),qe(Pr,this,n)):n===!0&&Array.isArray(B(Pr,this))&&this.hot.batchExecution(()=>{B(Pr,this).forEach((t,i)=>{B(Vt,this).setValueAtIndex(i,t)})},!0)}function m1(n){if(!jm(n.target)&&B(jl,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(B(As,this)||this.setupHandlePosition(e))}}function p1(n){n.target.parentNode===this.hot.rootElement&&Ne(n.target,"manualColumnResizer")&&(this.setupHandlePosition(B(oi,this)),this.setupGuidePosition(),qe(As,this,!0),B(Mr,this)===null&&(qe(Mr,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(B(Mr,this))),qe(Er,this,B(Er,this)+1),this.startX=n.pageX,qe(Fn,this,B(Eo,this)))}function w1(n){if(B(As,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();qe(Ul,this,B(Eo,this)+e),S(B(Wt,this),t=>{qe(Fn,this,this.setManualSize(t,B(Ul,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function C1(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeColumnResize",B(Fn,this),t,!1),i&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",B(Fn,this),t,!1)};B(As,this)&&(this.hideHandleAndGuide(),qe(As,this,!1),B(Fn,this)!==B(Eo,this)&&(B(Wt,this).length>1?(S(B(Wt,this),i=>{e(i)}),n()):S(B(Wt,this),i=>{e(i,!0)})),this.setupHandlePosition(B(oi,this)))}function v1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(B(Pt,this)),this.hot.rootElement.removeChild(B(ni,this)),qe(As,this,!1),qe(jl,this,!0),this.hot._registerImmediate(()=>{qe(jl,this,!1)})}function S1(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalColumn(e),s=B(Vt,this).getValueAtIndex(i);this.hot.getSettings()[Vl]&&s&&(t=s)}return t}function b1(n,e){const t=B(Vt,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof t=="number"?t:n}function y1(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Ou(n,e,t){return(e=R1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function R1(n){var e=E1(n,"string");return typeof e=="symbol"?e:e+""}function E1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Hu=0,Tg=1,xg=2,no="px";let Kw=class{constructor(e){Ou(this,"hot",void 0),Ou(this,"_element",null),Ou(this,"state",Hu),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=xg}build(){this.state===Hu&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Tg)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Hu}isAppended(){return this.state===xg}isBuilt(){return this.state>=Tg}setPosition(e,t){e!==void 0&&(this._element.style.top=e+no),t!==void 0&&(this._element.style.left=t+no)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+no),t&&(this._element.style.height=t+no)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+no),t&&(this._element.style.marginLeft=t+no)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const M1="ht__manualRowMove--backlight";class P1 extends Kw{build(){super.build(),U(this._element,M1)}}const _1="ht__manualRowMove--guideline";class I1 extends Kw{build(){super.build(),U(this._element,_1)}}function T1(n,e){qw(n,e),e.add(n)}function io(n,e,t){qw(n,e),e.set(n,t)}function qw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _s(n,e,t){return n.set(xi(n,e),t),t}function se(n,e){return n.get(xi(n,e))}function xi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeRowMove");X.getSingleton().register("afterRowMove");const Du="manualRowMove",x1=140,Ag="ht__manualRowMove",Yl="show-ui",Dc="on-moving--rows",$c="after-selection--rows";var bt=new WeakMap,Ni=new WeakMap,hi=new WeakMap,Li=new WeakMap,At=new WeakMap,La=new WeakMap,cs=new WeakSet;class A1 extends de{constructor(){super(...arguments),T1(this,cs),io(this,bt,new P1(this.hot)),io(this,Ni,new I1(this.hot)),io(this,hi,[]),io(this,Li,void 0),io(this,At,{}),io(this,La,void 0)}static get PLUGIN_KEY(){return Du}static get PLUGIN_PRIORITY(){return x1}isEnabled(){return!!this.hot.getSettings()[Du]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return xi(cs,e,N1).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return xi(cs,e,H1).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>xi(cs,this,$1).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return xi(cs,e,L1).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),U(this.hot.rootElement,Ag),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ee(this.hot.rootElement,Ag),this.unregisterEvents(),se(bt,this).destroy(),se(Ni,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const i=se(La,this),s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,i,s);if(_s(La,this,void 0),o===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,t);const r=s&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,s,r),r}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const i=this.countFinalIndex(e,t);return _s(La,this,t),this.moveRows(e,i)}isMovePossible(e,t){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>i,o=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=i);return!(s||o||r||a)}isRowOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}countFinalIndex(e,t){const i=ji(e,(s,o)=>(o<t&&(s+=1),s),0);return t-i}getRowsHeight(e,t){const i=this.hot.rowIndexMapper;let s=0;for(let o=e;o<=t;o++){const r=i.getRenderableFromVisualIndex(o);r!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(r)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Du];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:i,to:s}=e,o=Math.min(i.row,s.row),r=Math.max(i.row,s.row);return ne(o,r,a=>{t.push(a)}),t}refreshPositions(){const e=se(At,this).coords,t=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&i<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,r=se(At,this).TD,a=this.hot.rootElement,l=Ml(a),h=BS(a),u=o.holder.scrollTop,c=this.hot.rootWindow!==h?h.scrollTop:0,d=l.top-c,g=se(At,this).eventPageY-d+u,w=o.hider.offsetHeight,E=o.TBODY.offsetTop,C=se(bt,this).getOffset().top,A=se(bt,this).getSize().height,T=r.offsetHeight/2,k=r.offsetHeight;let K=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const $=g>=K+T;this.isFixedRowTop(e.row)&&(K+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?se(At,this).row=t>0?t-1:t:$?(se(At,this).row=e.row+1,K+=e.row===0?k-1:k):se(At,this).row=e.row;let x=g,N=K;g+A+C>=w?x=w-A-C:g+C<E&&(x=E+Math.abs(C)),K>=w-1&&(N=w-1),se(bt,this).setPosition(x),se(Ni,this).setPosition(N)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>xi(cs,this,O1).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>xi(cs,this,D1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){se(bt,this).build(),se(Ni,this).build()}destroy(){se(bt,this).destroy(),se(Ni,this).destroy(),super.destroy()}}function N1(n,e,t,i){const{wtTable:s,wtViewport:o}=this.hot.view._wt,r=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!r||se(Li,this)||n.button!==0){_s(Li,this,!1),se(hi,this).length=0,Ee(this.hot.rootElement,[Dc,Yl]);return}const l=se(Ni,this).isBuilt()&&!se(Ni,this).isAppended(),h=se(bt,this).isBuilt()&&!se(bt,this).isAppended();l&&h&&(se(Ni,this).appendTo(s.hider),se(bt,this).appendTo(s.hider));const{from:u,to:c}=a,d=Math.min(u.row,c.row),g=Math.max(u.row,c.row);if(e.col<0&&e.row>=d&&e.row<=g){i.row=!0,_s(Li,this,!0),se(At,this).eventPageY=n.pageY,se(At,this).coords=e,se(At,this).TD=t,_s(hi,this,this.prepareRowsToMoving());const w=s.holder.scrollLeft+o.getRowHeaderWidth(),E=this.getRowsHeight(d,e.row-1)+(n.clientY-t.getBoundingClientRect().top);se(bt,this).setPosition(null,w),se(bt,this).setSize(s.hider.offsetWidth-w,this.getRowsHeight(d,g)),se(bt,this).setOffset(-E,null),U(this.hot.rootElement,Dc),this.refreshPositions()}else Ee(this.hot.rootElement,$c),_s(Li,this,!1),se(hi,this).length=0}function O1(n){se(Li,this)&&(se(At,this).eventPageY=n.pageY,this.refreshPositions())}function H1(n,e,t,i){!this.hot.getSelectedRangeLast()||!se(Li,this)||(se(hi,this).indexOf(e.row)>-1?Ee(this.hot.rootElement,Yl):U(this.hot.rootElement,Yl),i.row=!0,i.column=!0,i.cell=!0,se(At,this).coords=e,se(At,this).TD=t)}function D1(){const n=se(At,this).row,e=se(hi,this).length;if(_s(Li,this,!1),Ee(this.hot.rootElement,[Dc,Yl,$c]),this.hot.selection.isSelectedByRowHeader()&&U(this.hot.rootElement,$c),e<1||n===void 0)return;const t=se(hi,this)[0],i=this.hot.toPhysicalRow(t),s=this.dragRows(se(hi,this),n);if(se(hi,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(i),r=o+e-1;this.hot.selectRows(o,r)}}function $1(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,i=e+t;se(bt,this).setPosition(null,i),se(bt,this).setSize(n.hider.offsetWidth-i)}function L1(){this.moveBySettingsOrLoad()}function k1(n,e){Xw(n,e),e.add(n)}function ct(n,e,t){Xw(n,e),e.set(n,t)}function Xw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function We(n,e,t){return n.set(ri(n,e),t),t}function W(n,e){return n.get(ri(n,e))}function ri(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Gl="manualRowResize",F1=30,Ng="manualRowHeights";var Hn=new WeakMap,ka=new WeakMap,Bt=new WeakMap,_r=new WeakMap,Oi=new WeakMap,Td=new WeakMap,Mo=new WeakMap,Fa=new WeakMap,wt=new WeakMap,Nn=new WeakMap,Ns=new WeakMap,zl=new WeakMap,Ir=new WeakMap,Tr=new WeakMap,pn=new WeakMap,xr=new WeakMap,Ri=new WeakSet;class W1 extends de{static get PLUGIN_KEY(){return Gl}static get PLUGIN_PRIORITY(){return F1}constructor(e){super(e),k1(this,Ri),ct(this,Hn,null),ct(this,ka,null),ct(this,Bt,[]),ct(this,_r,null),ct(this,Oi,null),ct(this,Td,null),ct(this,Mo,null),ct(this,Fa,null),ct(this,wt,this.hot.rootDocument.createElement("DIV")),ct(this,Nn,this.hot.rootDocument.createElement("DIV")),ct(this,Ns,!1),ct(this,zl,!1),ct(this,Ir,0),ct(this,Tr,null),ct(this,pn,void 0),ct(this,xr,void 0),U(W(wt,this),"manualRowResizer"),U(W(Nn,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Gl]}enablePlugin(){this.enabled||(We(pn,this,new Gr),W(pn,this).addLocalHook("init",()=>ri(Ri,this,z1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,W(pn,this)),this.addHook("modifyRowHeight",(e,t)=>ri(Ri,this,G1).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){We(xr,this,W(pn,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Ng,W(pn,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Ng,e),e.value}setManualSize(e,t){const i=this.hot.toPhysicalRow(e),s=Math.max(t,this.hot.view.getDefaultRowHeight());return W(pn,this).setValueAtIndex(i,s),s}getLastDesiredRowHeight(){return W(_r,this)}setupHandlePosition(e){We(Hn,this,e);const{view:t}=this.hot,{_wt:i}=t,s=i.wtTable.getCoords(W(Hn,this)),o=s.row;if(o<0)return;const r=Is(W(Hn,this)),a=W(Hn,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),h=o>=t.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let u;l?u=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(W(Hn,this),s.row,s.col):h&&(u=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(W(Hn,this),s.row,s.col)),u||(u=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(W(Hn,this),s.row,s.col)),We(ka,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),We(Bt,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();S(d,g=>{const w=g.getTopStartCorner().row,E=g.getBottomStartCorner().row;ne(w,E,C=>{W(Bt,this).includes(C)||W(Bt,this).push(C)})})}W(Bt,this).includes(W(ka,this))||We(Bt,this,[W(ka,this)]),We(Fa,this,u.top-6),We(Mo,this,parseInt(a.height,10)),W(wt,this).style.top=`${W(Fa,this)+W(Mo,this)}px`,W(wt,this).style[this.inlineDir]=`${u.start}px`,W(wt,this).style.width=`${r}px`,this.hot.rootElement.appendChild(W(wt,this))}refreshHandlePosition(){W(wt,this).style.top=`${W(Fa,this)+W(_r,this)}px`}setupGuidePosition(){const e=parseInt(Is(W(wt,this)),10),t=parseInt(W(wt,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);U(W(wt,this),"active"),U(W(Nn,this),"active"),W(Nn,this).style.top=W(wt,this).style.top,W(Nn,this).style[this.inlineDir]=`${t}px`,W(Nn,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(W(Nn,this))}refreshGuidePosition(){W(Nn,this).style.top=W(wt,this).style.top}hideHandleAndGuide(){Ee(W(wt,this),"active"),Ee(W(Nn,this),"active")}checkIfRowHeader(e){const t=Hr(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,s.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&W(Oi,this)<t?t:W(Oi,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,s)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&We(Oi,this,o),this.setManualSize(i,W(Oi,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),s&&e()};W(Ir,this)>=2&&(W(Bt,this).length>1?(S(W(Bt,this),s=>{t(s)}),e()):S(W(Bt,this),s=>{t(s,!0)})),We(Ir,this,0),We(Tr,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>ri(Ri,this,B1).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>ri(Ri,this,V1).call(this,i)),this.eventManager.addEventListener(t,"mousemove",i=>ri(Ri,this,U1).call(this,i)),this.eventManager.addEventListener(t,"mouseup",()=>ri(Ri,this,j1).call(this)),this.eventManager.addEventListener(W(wt,this),"contextmenu",()=>ri(Ri,this,Y1).call(this))}destroy(){super.destroy()}}function B1(n){if(!jm(n.target)&&W(zl,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(W(Ns,this)||this.setupHandlePosition(e))}}function V1(n){Ne(n.target,"manualRowResizer")&&(this.setupHandlePosition(W(Hn,this)),this.setupGuidePosition(),We(Ns,this,!0),W(Tr,this)===null&&(We(Tr,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(W(Tr,this))),We(Ir,this,W(Ir,this)+1),We(Td,this,n.pageY),We(Oi,this,W(Mo,this)))}function U1(n){W(Ns,this)&&(We(_r,this,W(Mo,this)+(n.pageY-W(Td,this))),S(W(Bt,this),e=>{We(Oi,this,this.setManualSize(e,W(_r,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function j1(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),i&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};W(Ns,this)&&(this.hideHandleAndGuide(),We(Ns,this,!1),W(Oi,this)!==W(Mo,this)&&(W(Bt,this).length>1?(S(W(Bt,this),i=>{e(i)}),n()):S(W(Bt,this),i=>{e(i,!0)})),this.setupHandlePosition(W(Hn,this)))}function Y1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(W(wt,this)),this.hot.rootElement.removeChild(W(Nn,this)),We(Ns,this,!1),We(zl,this,!0),this.hot._registerImmediate(()=>{We(zl,this,!1)})}function G1(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalRow(e),s=W(pn,this).getValueAtIndex(i);this.hot.getSettings()[Gl]&&s&&(t=s)}return t}function z1(){const n=this.hot.getSettings()[Gl],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,i)=>{W(pn,this).setValueAtIndex(i,t)}):Array.isArray(n)?(n.forEach((t,i)=>{W(pn,this).setValueAtIndex(i,t)}),We(xr,this,n)):n===!0&&Array.isArray(W(xr,this))&&W(xr,this).forEach((t,i)=>{W(pn,this).setValueAtIndex(i,t)})},!0)}var Og={},Hg;function K1(){if(Hg)return Og;Hg=1;var n=VS();return n("flatMap"),Og}K1();var Dg={},$g={},$u,Lg;function q1(){if(Lg)return $u;Lg=1;var n=Ym(),e=Gm(),t=zm(),i=US();return $u=function(s,o){(!o||typeof s!="string")&&e(s);var r=i(s);return t(e(r!==void 0?n(r,s):s))},$u}var kg;function X1(){if(kg)return $g;kg=1;var n=Km(),e=Ym(),t=jS(),i=Gm(),s=zm(),o=q1(),r=YS(),a=GS(),l=zS(),h=r(function(){for(var u=this.iterator,c=this.mapper,d,g;;){if(g=this.inner)try{if(d=i(e(g.next,g.iterator)),!d.done)return d.value;this.inner=null}catch(w){a(u,"throw",w)}if(d=i(e(this.next,u)),this.done=!!d.done)return;try{this.inner=o(c(d.value,this.counter++),!1)}catch(w){a(u,"throw",w)}}});return n({target:"Iterator",proto:!0,real:!0,forced:l},{flatMap:function(c){return i(this),t(c),new h(s(this),{mapper:c,inner:null})}}),$g}var Fg;function Z1(){return Fg||(Fg=1,X1()),Dg}Z1();function J1(n,e,t){Q1(n,e),e.set(n,t)}function Q1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(n,e,t){return(e=eN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eN(n){var e=tN(n,"string");return typeof e=="symbol"?e:e+""}function tN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wg(n,e){return n.get(Zw(n,e))}function Wa(n,e,t){return n.set(Zw(n,e),t),t}function Zw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var fs=new WeakMap;class Dn{constructor(e,t,i,s,o,r){ds(this,"row",void 0),ds(this,"col",void 0),ds(this,"rowspan",void 0),ds(this,"colspan",void 0),ds(this,"removed",!1),ds(this,"cellCoordsFactory",void 0),ds(this,"cellRangeFactory",void 0),J1(this,fs,null),this.row=e,this.col=t,this.rowspan=i,this.colspan=s,this.cellCoordsFactory=o,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:i,rowspan:s,colspan:o}=e;return ot`The merged cell declared with {row: ${t}, col: ${i},\x20
      rowspan: ${s}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:i}=e;return ot`The merged cell declared at [${t}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:i}=e;return ot`The merged cell declared at [${t}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:i}=e;return ot`The merged cell declared at [${t}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:i,rowspan:s,colspan:o}=e;return t<0||i<0||s<0||o<0}static isSingleCell(e){let{rowspan:t,colspan:i}=e;return i===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:i}=e;return i===0||t===0}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Wa(fs,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const i=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",r=e[0]?"col":"row",a=Math.min(t,s),l=Math.max(t,s),h=this[r],u=this[r]+this[o]-1;if(h>=t&&(this[r]+=i),i>0)t<=u&&t>h&&(this[o]+=i);else if(i<0){if(a<=h&&l>=u)return this.removed=!0,Wa(fs,this,null),!1;if(h>=a&&h<=l){const c=l-h+1,d=Math.abs(i)-c;this[r]-=d+i,this[o]-=c}else if(h<=a&&u>=l)this[o]+=i;else if(h<=a&&u>=a&&u<l){const c=u-a+1;this[o]-=c}}return Wa(fs,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return Wg(fs,this)||Wa(fs,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),Wg(fs,this)}}function nN(n,e){iN(n,e),e.add(n)}function iN(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(n,e,t){return(e=sN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sN(n){var e=oN(n,"string");return typeof e=="symbol"?e:e+""}function oN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ei=new WeakSet;class Kl{constructor(e){nN(this,Ei),Ba(this,"plugin",void 0),Ba(this,"mergedCells",[]),Ba(this,"mergedCellsMatrix",new Map),Ba(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:i}=e;return ot`The merged cell declared at [${t}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(t))!==null&&i!==void 0?i:!1}getByRange(e){const{row:t,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),r=this.mergedCells.length;let a=!1;for(let l=0;l<r;l++){const h=this.mergedCells[l],{row:u,col:c,rowspan:d,colspan:g}=h;if(u>=t&&u+d-1<=s&&c>=i&&c+g-1<=o){a=h;break}}return a}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(s=>{const{row:o,col:r,colspan:a,rowspan:l}=s;for(let h=o;h<o+l;h++)for(let u=r;u<r+a;u++)t.add(`r${h},c${u}`)}),e.filter(s=>{const{row:o,col:r,colspan:a,rowspan:l}=s,h=new Set;let u=!1;for(let c=o;c<o+l;c++){for(let d=r;d<r+a;d++){const g=`r${c},c${d}`;if(t.has(g)){$e(Kl.IS_OVERLAPPING_WARNING(s)),u=!0;break}h.add(g)}if(u)break}return u||t.add(...h),!u})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:s}=e.getTopStartCorner(),{row:o,col:r}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let h=s;h<=r;h++){const u=this.get(l,h);u&&(t||!t&&u.row===l&&u.col===h)&&a.push(u)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,s=e.col,o=e.rowspan,r=e.colspan,a=new Dn(i,s,o,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,s),h=t?!1:this.isOverlapping(a);return!l&&!h?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),gs(Ei,this,Bg).call(this,a),a):(h&&$e(Kl.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const i=this.get(e,t),s=i?this.mergedCells.indexOf(i):-1;return i&&s!==-1?(this.mergedCells.splice(s,1),gs(Ei,this,rN).call(this,i),i):!1}clear(){S(this.mergedCells,e=>{let{row:t,col:i,rowspan:s,colspan:o}=e;ne(t,t+s,r=>{ne(i,i+o,a=>{const l=this.hot.getCell(r,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const i=this.get(e,t);if(!i)return!1;const{row:s,col:o,rowspan:r,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),h=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),u=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),c=Yt(h,s,s+r-1),d=Yt(u,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(c,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===t}getFirstRenderableCoords(e,t){const i=this.get(e,t);if(!i||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(s,o)}getStartMostColumnIndex(e,t){const i=gs(Ei,this,Va).call(this,e,"col",-1);let s=t;for(let o=0;o<i.length;o++)if(i[o]<=t){s=i[o];break}return s}getEndMostColumnIndex(e,t){const i=gs(Ei,this,Va).call(this,e,"col",1);let s=t;for(let o=0;o<i.length;o++)if(i[o]>=t){s=i[o];break}return s}getTopMostRowIndex(e,t){const i=gs(Ei,this,Va).call(this,e,"row",-1);let s=t;for(let o=0;o<i.length;o++)if(i[o]<=t){s=i[o];break}return s}getBottomMostRowIndex(e,t){const i=gs(Ei,this,Va).call(this,e,"row",1);let s=t;for(let o=0;o<i.length;o++)if(i[o]>=t){s=i[o];break}return s}shiftCollections(e,t,i){const s=[0,0];switch(e){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break}const o=[];this.mergedCells.forEach(r=>{r.shift(s,t),r.removed&&o.push(r)}),o.forEach(r=>{this.mergedCells.splice(this.mergedCells.indexOf(r),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(r=>{gs(Ei,this,Bg).call(this,r)})}}function Va(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,s=t===1?n.getTopStartCorner():n.getBottomEndCorner(),o=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let r=s.row;t===1?r<=o.row:r>=o.row;r+=t)for(let a=s.col;t===1?a<=o.col:a>=o.col;a+=t){const l=e==="row"?r:a,h=this.get(r,a);let u=l;h&&(u=t===1?h[e]+h[`${e}span`]-1:h[e]),i.has(l)||i.set(l,new Set),i.get(l).add(u)}return Array.from(new Set(Array.from(i.entries()).filter(r=>{let[,a]=r;return a.size===1}).flatMap(r=>{let[,a]=r;return Array.from(a)})))}function Bg(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function rN(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function Lu(n,e,t){return(e=aN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aN(n){var e=lN(n,"string");return typeof e=="symbol"?e:e+""}function lN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hN{constructor(e){Lu(this,"plugin",void 0),Lu(this,"mergedCellsCollection",void 0),Lu(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?i="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?i="up":t[1]===e[1]&&t[2]===e[2]?i="right":i="left",i}snapDragArea(e,t,i,s){const o=t.slice(0),r=this.getAutofillSize(e,t,i),[a,l,h,u]=e,d=["up","down"].indexOf(i)>-1?h-a+1:u-l+1,g=Math.floor(r/d)*d,w=r-g,E=this.getFarthestCollection(e,t,i,s);if(E){if(i==="down"){const C=E.row+E.rowspan-a-w;o[2]+C>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?C:0}else if(i==="right"){const C=E.col+E.colspan-l-w;o[3]+C>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?C:0}else if(i==="up"){const C=h-w-E.row+1;o[0]+C<0?o[0]+=w:o[0]-=w?C:0}else if(i==="left"){const C=u-w-E.col+1;o[1]+C<0?o[1]+=w:o[1]-=w?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:s,fillSize:r,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Nt(this.currentFillData,e)}getAutofillSize(e,t,i){const[s,o,r,a]=e,[l,h,u,c]=t;switch(i){case"up":return s-l;case"down":return u-r;case"left":return o-h;case"right":return c-a;default:return null}}getDragArea(e,t,i){const[s,o,r,a]=e,[l,h,u,c]=t;switch(i){case"up":return[l,h,s-1,a];case"down":{const d=this.mergedCellsCollection.get(u,a),g=d?d.rowspan-1:0;return[r+1,o,u+g,a]}case"left":return[l,h,r,o-1];case"right":{const d=this.mergedCellsCollection.get(u,a),g=d?d.colspan-1:0;return[s,a+g,u,c]}default:return null}}getFarthestCollection(e,t,i,s){const[o,r,a,l]=e,h=["up","down"].indexOf(i)>-1,u=h?a:l,c=h?o:r,d=this.getAutofillSize(e,t,i),g=h?a-o+1:l-r+1,w=Math.floor(d/g)*g,E=d-w;let C=null,A=null,T=null;switch(i){case"up":C="includesVertically",T=u-E+1;break;case"left":C="includesHorizontally",T=u-E+1;break;case"down":C="includesVertically",T=c+E-1;break;case"right":C="includesHorizontally",T=c+E-1;break}return S(s,k=>{k[C](T)&&k.isFarther(A,i)&&(A=k)}),A}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,o=(h,u)=>{switch(s){case"up":return h.row-u>=t.from.row;case"down":return h.row+h.rowspan-1+u<=t.to.row;case"left":return h.col-u>=t.from.column;case"right":return h.col+h.colspan-1+u<=t.to.column;default:return null}};let r=0,a=null,l=1;do for(let h=0;h<i.length;h+=1){if(a=i[h],r=l*this.currentFillData.cycleLength,o(a,r))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:a.row-r,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+r,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-r,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+r,colspan:a.colspan},!0);break}h===i.length-1&&(l+=1)}while(o(a,r));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},i={min:null,max:null};return S(e,s=>{const o=s[0],r=this.plugin.hot.propToCol(s[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(i.min===null||r<i.min)&&(i.min=r),(i.max===null||r>i.max)&&(i.max=r)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){const s=this.getDragArea(e,t,i),[o,r,a,l]=s,h=this.plugin.hot._createCellCoords(o,r),u=this.plugin.hot._createCellCoords(a,l),c=this.plugin.hot._createCellRange(h,h,u);if(this.mergedCellsCollection.getWithinRange(c,!0).length===0)return!1;const g=this.mergedCellsCollection.getWithinRange(c,!1);return g.length===0?!0:i==="up"||i==="down"?!g.every(w=>{let{colspan:E}=w;return E===c.getWidth()}):!g.every(w=>{let{rowspan:E}=w;return E===c.getHeight()})}}function ku(n,e,t){return(e=uN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uN(n){var e=cN(n,"string");return typeof e=="symbol"?e:e+""}function cN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class dN{constructor(e){ku(this,"plugin",void 0),ku(this,"hot",void 0),ku(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,i,s){const o=Math.min(i[0],i[2]),r=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const u=this.plugin.mergedCellsCollection.get(e,t);if(!u)return;const c=u.getLastRow(),d=u.getLastColumn();if(o<=u.row&&r<=u.col&&a>=c&&l>=d)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const i=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+s,e.col+o));for(let s=0;s<i.length;s+=1){const o=[];for(let r=0;r<t.length;r+=1)o[r]=t[r].includes(i[s]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function fN(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(KS)}return this.getTranslatedPhrase(qS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Dn.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Ar(n,e,t){return(e=gN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gN(n){var e=mN(n,"string");return typeof e=="symbol"?e:e+""}function mN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vg{constructor(e){Ar(this,"data",void 0),Ar(this,"next",null),Ar(this,"prev",null),this.data=e}}class Ua{constructor(){Ar(this,"first",null),Ar(this,"last",null)}push(e){const t=new Vg(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.last;this.last=t,t.prev=i,i.next=t}return t}unshift(e){const t=new Vg(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.first;this.first=t,t.next=i,i.prev=t}}inorder(e){let t=this.first;for(;t;){const i=e(t);if(t===this.last||i===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,i,s;for(;t;){if(t.data===e)return i=t.next,s=t.prev,i&&(i.prev=s),s&&(s.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=s),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,s){s&&(e(s,s.next),s.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,i;for(;e;)i=e.next,e.next=t,t.prev=e,t=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=t,this.last=i}}function pN(n,e){Jw(n,e),e.add(n)}function ms(n,e,t){Jw(n,e),e.set(n,t)}function Jw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(n,e){return n.get(ql(n,e))}function Dt(n,e,t){return n.set(ql(n,e),t),t}function ql(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,_n=new WeakMap,In=new WeakMap,Tn=new WeakMap,Lc=new WeakMap,ja=new WeakMap,Ya=new WeakMap,Fu=new WeakSet;class wN{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:i,columnIndexMapper:s}=e;pN(this,Fu),ms(this,Pn,new Ua),ms(this,_n,new Ua),ms(this,In,null),ms(this,Tn,null),ms(this,Lc,null),ms(this,ja,null),ms(this,Ya,null),Dt(Lc,this,t),Dt(ja,this,i),Dt(Ya,this,s)}getCurrentVerticalNode(){return we(Tn,this).data}getFirstVerticalNode(){return we(_n,this).first.data}getNextVerticalNode(){return we(Tn,this).next.data}getPrevVerticalNode(){return we(Tn,this).prev.data}getCurrentHorizontalNode(){return we(In,this).data}getFirstHorizontalNode(){return we(Pn,this).first.data}getNextHorizontalNode(){return we(In,this).next.data}getPrevHorizontalNode(){return we(In,this).prev.data}setPrevNodeAsActive(){Dt(Tn,this,we(Tn,this).prev),Dt(In,this,we(In,this).prev)}setNextNodeAsActive(){Dt(Tn,this,we(Tn,this).next),Dt(In,this,we(In,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),i=e.getBottomEndCorner(),s=new WeakSet;Dt(Pn,this,new Ua);for(let r=t.row;r<=i.row;r++)if(!we(ja,this).isHidden(r))for(let a=t.col;a<=i.col;a++){if(we(Ya,this).isHidden(a))continue;const l=ql(Fu,this,Ug).call(this,e,we(Pn,this),s,r,a);l&&Dt(In,this,l)}we(Pn,this).first&&(we(Pn,this).first.prev=we(Pn,this).last,we(Pn,this).last.next=we(Pn,this).first);const o=new WeakSet;Dt(_n,this,new Ua);for(let r=t.col;r<=i.col;r++)if(!we(Ya,this).isHidden(r))for(let a=t.row;a<=i.row;a++){if(we(ja,this).isHidden(a))continue;const l=ql(Fu,this,Ug).call(this,e,we(_n,this),o,a,r);l&&Dt(Tn,this,l)}we(_n,this).first&&(we(_n,this).first.prev=we(_n,this).last,we(_n,this).last.next=we(_n,this).first)}setActiveNode(e,t){return we(Pn,this).inorder(i=>{const{rowStart:s,rowEnd:o,colStart:r,colEnd:a}=i.data;if(e>=s&&e<=o&&t>=r&&t<=a)return Dt(In,this,i),!1}),we(_n,this).inorder(i=>{const{rowStart:s,rowEnd:o,colStart:r,colEnd:a}=i.data;if(e>=s&&e<=o&&t>=r&&t<=a)return Dt(Tn,this,i),!1}),this}}function Ug(n,e,t,i,s){const o=n.getTopStartCorner(),r=n.getBottomEndCorner(),a=n.highlight.clone().normalize(),l=we(Lc,this).call(this,i,s);if(l&&t.has(l))return null;const h={colStart:s,colEnd:s,rowStart:i,rowEnd:i};if(l){if(t.add(l),l.row<o.row||l.row+l.rowspan-1>r.row||l.col<o.col||l.col+l.colspan-1>r.col)return null;h.colStart=l.col,h.colEnd=l.col+l.colspan-1,h.rowStart=l.row,h.rowEnd=l.row+l.rowspan-1}const u=e.push(h);return i===a.row&&s===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function CN(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:i}=e;function s(){}function o(r,a,l){const h=n.mergedCellsCollection.get(a,l);if(!Me(h)){r.removeAttribute("rowspan"),r.removeAttribute("colspan"),r.style.display="";return}const{row:u,col:c,colspan:d,rowspan:g}=h,[w,E]=n.translateMergedCellToRenderable(u,g,c,d),C=n.getSetting("virtualized"),A=t.getRenderableFromVisualIndex(a),T=i.getRenderableFromVisualIndex(l),k=w-A+1,K=E-T+1;let $=t.getNearestNotHiddenIndex(u,1),x=i.getNearestNotHiddenIndex(c,1);if(C){const ee=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(ee)||($=Math.max($,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(ee)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const N=Math.min(g,k),q=Math.min(d,K);$===a&&x===l?(r.setAttribute("rowspan",N),r.setAttribute("colspan",q)):(r.removeAttribute("rowspan"),r.removeAttribute("colspan"),r.style.display="none")}return{before:s,after:o}}function vN(n,e){Qw(n,e),e.add(n)}function Ga(n,e,t){Qw(n,e),e.set(n,t)}function Qw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wu(n,e,t){return(e=SN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function SN(n){var e=bN(n,"string");return typeof e=="symbol"?e:e+""}function bN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jr(n,e,t){return n.set(Ce(n,e),t),t}function He(n,e){return n.get(Ce(n,e))}function Ce(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}X.getSingleton().register("beforeMergeCells");X.getSingleton().register("afterMergeCells");X.getSingleton().register("beforeUnmergeCells");X.getSingleton().register("afterUnmergeCells");const kc="mergeCells",yN=150,jg=kc;var tn=new WeakMap,nn=new WeakMap,Wn=new WeakMap,Yg=new WeakMap,be=new WeakSet;class RN extends de{constructor(){super(...arguments),vN(this,be),Wu(this,"mergedCellsCollection",null),Wu(this,"autofillCalculations",null),Wu(this,"selectionCalculations",null),Ga(this,tn,null),Ga(this,nn,{row:0,col:0}),Ga(this,Wn,new wN({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Ga(this,Yg,CN(this))}static get PLUGIN_KEY(){return kc}static get PLUGIN_PRIORITY(){return yN}static get DEFAULT_SETTINGS(){return{[Rp]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[kc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Kl(this),this.autofillCalculations=new hN(this),this.selectionCalculations=new dN(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,EN).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,PN).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,_N).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,IN).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,TN).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,zg).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,zg).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,AN).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,NN).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,ON).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,Gg).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,Gg).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,MN).call(e,...i)}),this.addHook("afterRenderer",function(){return He(Yg,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,xN).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,HN).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,DN).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,$N).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,LN).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,kN).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,FN).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,WN).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,BN).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,VN).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,UN).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,jN).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,YN).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,GN).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return Ce(be,e,zN).call(e,...i)}),this.addHook("beforeUndoStackChange",(t,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!XS())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:s,rowspan:o}=i;for(let r=s+1;r<s+o;r++)t.push(r)}),t=[...new Set(t)],t.forEach(i=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const r=o.getRow(s);r&&(r.style.background=Qd(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=Qd(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Dn.containsNegativeValues(e)?($e(Dn.NEGATIVE_VALUES_WARNING(e)),!1):Dn.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?($e(Dn.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Dn.isSingleCell(e)?($e(Dn.IS_SINGLE_CELL(e)),!1):Dn.containsZeroSpan(e)?($e(Dn.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];t.forEach(s=>{const{row:o,col:r,rowspan:a,colspan:l}=s,h=this.hot._createCellCoords(o,r),u=this.hot._createCellCoords(o+a-1,r+l-1),c=this.hot._createCellRange(h,h,u);this.mergeRange(c,!0,!0);for(let d=o;d<o+a;d++)for(let g=r;g<r+l;g++)(d!==o||g!==r)&&i.push([d,g,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),o=e.getBottomEndCorner(),r={row:s.row,col:s.col,rowspan:o.row-s.row+1,colspan:o.col-s.col+1},a=[];let l=null;return this.canMergeRange(r,t)?(this.hot.runHooks("beforeMergeCells",e,t),ne(0,r.rowspan-1,u=>{ne(0,r.colspan-1,c=>{let d=null;a[u]||(a[u]=[]),u===0&&c===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+u,r.col+c,"hidden",!0),a[u][c]=d})}),this.hot.setCellMeta(r.row,r.col,"spanned",!0),this.mergedCellsCollection.add(r,t)?(i?l=[r.row,r.col,a]:this.hot.populateFromArray(r.row,r.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,r,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),S(i,s=>{this.mergedCellsCollection.remove(s.row,s.col),ne(0,s.rowspan-1,o=>{ne(0,s.colspan-1,r=>{this.hot.removeCellMeta(s.row+o,s.col+r,"hidden"),this.hot.removeCellMeta(s.row+o,s.col+r,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,s){const o=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(i,s);this.mergeRange(this.hot._createCellRange(o,o,r))}unmerge(e,t,i,s){const o=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(i,s);this.unmergeRange(this.hot._createCellRange(o,o,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:jg})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jg)}modifyViewportRowStart(e,t){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const r=this.mergedCellsCollection.get(s,o);if(Me(r)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const r=this.mergedCellsCollection.get(s,o);if(Me(r)){const a=r.row+r.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const r=this.mergedCellsCollection.get(o,s);if(Me(r)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const r=this.mergedCellsCollection.get(o,s);if(Me(r)){const a=r.col+r.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,s){const{rowIndexMapper:o,columnIndexMapper:r}=this.hot;let a,l;t===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+t-1,-1),s===0?l=r.getNearestNotHiddenIndex(i,1):l=r.getNearestNotHiddenIndex(i+s-1,-1);const h=e>=0?o.getRenderableFromVisualIndex(a):e,u=i>=0?r.getRenderableFromVisualIndex(l):i;return[h,u]}}function EN(){this.generateFromSettings(),this.hot.render()}function MN(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner(),s=t.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&s.row===e[o].row+e[o].rowspan-1&&s.col===e[o].col+e[o].colspan-1)return!1}return n}function PN(n){He(nn,this).row=n.row,He(nn,this).col=n.col}function _N(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot;He(tn,this)&&(s.getRenderableFromVisualIndex(He(tn,this).row)!==null&&(t.row=He(tn,this).row),i.getRenderableFromVisualIndex(He(tn,this).col)!==null&&(t.col=He(tn,this).col),jr(tn,this,null));const o=this.mergedCellsCollection.get(t.row,t.col);if(!o)return;const r=o.col,a=o.col+o.colspan-1;if(n.col<0){const u=t.col>=r&&t.col<=a?r-1:a,c=i.getNearestNotHiddenIndex(u,-1);c===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,t.col)-1,1)}else if(n.col>0){const u=t.col>=r&&t.col<=a?a+1:r,c=i.getNearestNotHiddenIndex(u,1);c===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,c)-1,1)}const l=o.row,h=o.row+o.rowspan-1;if(n.row<0){const u=t.row>=l&&t.row<=h?l-1:h,c=s.getNearestNotHiddenIndex(u,-1);c===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,t.row)-1,1)}else if(n.row>0){const u=t.row>=l&&t.row<=h?h+1:l,c=s.getNearestNotHiddenIndex(u,1);c===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,c)-1,1)}}function IN(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:i}=e,{columnIndexMapper:s,rowIndexMapper:o}=this.hot,r=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let h=0;h<this.mergedCellsCollection.mergedCells.length;h+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[h].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+n.col;r(i.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+n.col;r(i.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+n.row;r(a,i.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+n.row;r(a,i.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function TN(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){jr(tn,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);jr(tn,this,e.clone()),t&&e.assign(t)}function Gg(n,e,t,i){if(n<0||e<0)return;const s=this.mergedCellsCollection.get(n,e);if(!s)return;const{row:o,col:r,colspan:a,rowspan:l}=s,h=o,u=r,c=o+l-1,d=r+a-1;if(i==="render"&&this.getSetting("virtualized")){const g=this.hot.view.getActiveOverlayName(),w=["top","top_inline_start_corner"].includes(g)?0:this.hot.getFirstRenderedVisibleRow(),E=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(g)?0:this.hot.getFirstRenderedVisibleColumn();return[Yt(w,h,c),Yt(E,u,d),Yt(this.hot.getLastRenderedVisibleRow(),h,c),Yt(this.hot.getLastRenderedVisibleColumn(),u,d)]}return[h,u,c,d]}function xN(n){n.items.push({name:"---------"},fN(this))}function zg(){jr(tn,this,null)}function AN(){if(He(tn,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),i=He(tn,this).clone().normalize();He(Wn,this).setActiveNode(i.row,i.col),He(nn,this).row>0||He(nn,this).col>0?He(Wn,this).setPrevNodeAsActive():(t==="E-W"&&He(nn,this).col<0||e==="S-N"&&He(nn,this).row<0)&&He(Wn,this).setNextNodeAsActive()}function NN(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:s}=this.hot;let o=null,r=null;if(He(nn,this).col<0){const{rowEnd:a,colEnd:l}=He(Wn,this).getPrevHorizontalNode();r=i.getNearestNotHiddenIndex(l,-1),o=s.getNearestNotHiddenIndex(a,-1)}else if(He(nn,this).col>0){const{rowStart:a,colStart:l}=He(Wn,this).getNextHorizontalNode();r=i.getNearestNotHiddenIndex(l,1),o=s.getNearestNotHiddenIndex(a,1)}else if(He(nn,this).row<0){const{rowEnd:a,colEnd:l}=He(Wn,this).getPrevVerticalNode();r=i.getNearestNotHiddenIndex(l,-1),o=s.getNearestNotHiddenIndex(a,-1)}else if(He(nn,this).row>0){const{rowStart:a,colStart:l}=He(Wn,this).getNextVerticalNode();r=i.getNearestNotHiddenIndex(l,1),o=s.getNearestNotHiddenIndex(a,1)}if(o!==null||r!==null){const a=this.hot._createCellCoords(o,r),l=this.mergedCellsCollection.get(a.row,a.col),h=this.hot.selection.highlight.getFocus();n=a.row,e=a.col,l?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):t.highlight.assign(a),h.clear(),h.add(a).commit()}He(Wn,this).setActiveNode(n,e),jr(nn,this,{row:0,col:0})}function ON(){this.hot.getSelectedRangeLast().isHeader()||He(Wn,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function HN(n,e,t){const i=this.mergedCellsCollection.get(n,e);i&&(i.row!==n||i.col!==e?t.copyable=!1:(t.rowspan=i.rowspan,t.colspan=i.colspan))}function DN(n){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function $N(n){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function LN(n,e){const t=this.autofillCalculations.getDirection(e,n);if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,t))return e;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),r=this.mergedCellsCollection.getWithinRange(o);return r.length===0?n:this.autofillCalculations.snapDragArea(e,n,t,r)}function kN(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function FN(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function WN(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function BN(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function VN(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function UN(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(t);S(i,s=>{t.getBottomEndCorner().row===s.getLastRow()&&t.getBottomEndCorner().col===s.getLastColumn()&&(n[2]=s.row,n[3]=s.col)})}}function jN(n,e,t,i){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,i)}function YN(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function GN(n,e,t,i){if(!(i instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(s);if(!o)return;const r=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(r,r,a))}function zN(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let i,s;if(t==="master")i=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return n;const r=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,s),l=this.hot._createCellRange(r,r,a),h=this.mergedCellsCollection.getWithinRange(l,!0),u=h.reduce((d,g)=>{let{rowspan:w}=g;return Math.max(d,w)},1);let c=0;return h.length>1&&h[0].rowspan<u&&(c=u-h[0].rowspan),h.forEach(d=>{let{rowspan:g}=d,w=0;t==="top"||t==="top_inline_start_corner"?w=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):w=g-c,n=Math.max(n??0,Ce(be,this,KN).call(this,e,w))}),n}function KN(n,e){const{view:t,rowIndexMapper:i}=this.hot,s=t.getStylesHandler(),o=t.getDefaultRowHeight();let r=0;for(let l=n;l<n+e;l++)if(!i.isHidden(l)){var a;r+=(a=this.hot.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!s.isClassicTheme()&&(r+=1)}return r}function qN(n,e){return function(t,i){const[,...s]=t,[,...o]=i;return function r(a){const l=n[a],h=e[a],u=s[a],c=o[a],d=h.multiColumnSorting,w=(d.compareFunctionFactory?d.compareFunctionFactory:xp(h.type))(l,h,d)(u,c);if(w===Bn){const E=a+1;if(typeof e[E]<"u")return r(E)}return w}(0)}}const eC="sort";function XN(n,e,t){const i=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&i.push(`${eC}-${n.getIndexOfColumnInSortQueue(e)+1}`),i}function ZN(n){const e=n.className.split(" "),t=new RegExp(`^${eC}-[0-9]{1,2}$`);return e.filter(i=>t.test(i))}function JN(n,e,t){return(e=QN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QN(n){var e=eO(n,"string");return typeof e=="symbol"?e:e+""}function eO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Xl="multiColumnSorting",tO=170,Kg=Xl;Tp(Xl,qN);class nO extends Fp{constructor(){super(...arguments),JN(this,"pluginKey",Xl)}static get PLUGIN_KEY(){return Xl}static get PLUGIN_PRIORITY(){return tO}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Al)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:xo,position:"before",group:Kg})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kg)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];super.updateHeaderClasses(e,...i),Ee(e,ZN(e)),this.enabled!==!1&&U(e,XN(...i))}onAfterOnCellMouseDown(e,t){gd(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Al))):this.sort(this.getColumnNextConfig(t.col)))}}function qg(n,e,t){return(e=iO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iO(n){var e=sO(n,"string");return typeof e=="symbol"?e:e+""}function sO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const oO="multipleSelectionHandles",rO=160;class aO extends de{constructor(){super(...arguments),qg(this,"dragged",[]),qg(this,"lastSetCell",null)}static get PLUGIN_KEY(){return oO}static get PLUGIN_PRIORITY(){return rO}isEnabled(){return Bc()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function i(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(s);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let o;if(Ne(s.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1;if(Ne(s.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if(Ne(s.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(Ne(s.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{const{rootDocument:o}=this.hot;let r,a,l,h,u,c;if(e.dragged.length===0)return;const d=o.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(r=e.hot.getCoords(d),r.col===-1&&(r.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),h=a.getHeight(),u=a.getDirection(),l===1&&h===1&&e.hot.selection.setRangeEnd(r),c=e.getCurrentRangeCoords(a,r,e.touchStartRange.direction,u,e.dragged[0]),c.start!==null&&e.hot.selection.setRangeStart(c.start),e.hot.selection.setRangeEnd(c.end),e.lastSetCell=d),s.preventDefault())})}getCurrentRangeCoords(e,t,i,s,o){const r=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),h=e.getTopEndCorner();let u={start:null,end:null};switch(i){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":o==="top"?u={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,r.col)};break;case"SE-NW":o==="bottom"&&(u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,r.col)});break}break;case"NW-SE":switch(s){case"NE-SW":o==="top"?u={start:t,end:l}:u.end=t;break;case"NW-SE":o==="top"?u={start:t,end:a}:u.end=t;break;case"SE-NW":o==="top"?u={start:t,end:r}:u.end=t;break;case"SW-NE":o==="top"?u={start:t,end:h}:u.end=t;break}break;case"SW-NE":switch(s){case"NW-SE":o==="bottom"?u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(r.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":o==="top"?u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(r.row,t.col)};break;case"SE-NW":o==="bottom"?u={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(r.row,t.col)}:o==="top"&&(u={start:l,end:t});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(u.end=t);break;case"SE-NW":o==="top"?u.end=t:u={start:t,end:r};break}break}return u}isDragged(){return this.dragged.length>0}}function Fc(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:i=!1,crossHiddenColumns:s=[],isCollapsed:o=!1,isHidden:r=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:h=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:i,isCollapsed:o,crossHiddenColumns:s,isHidden:r,isRoot:a,isPlaceholder:l,headerClassNames:h}}function tC(){return{label:"",isPlaceholder:!0}}function lO(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;S(n,s=>{const o=[];let r=0;t.push(o),S(s,a=>{const l=Fc();if(Me(a)){const{label:u,colspan:c,headerClassName:d}=a;l.label=tt(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=tt(a);r+=l.origColspan;let h=!1;if(r>=e&&(l.colspan=l.origColspan-(r-e),l.origColspan=l.colspan,h=!0),o.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)o.push(tC());return!h})});const i=Math.max(...Te(t,s=>s.length));return S(t,s=>{if(s.length<i){const o=Te(new Array(i-s.length),()=>Fc());s.splice(s.length,0,...o)}}),t}function Bu(n,e,t){hO(n,e),e.set(n,t)}function hO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hn(n,e){return n.get(nC(n,e))}function ar(n,e,t){return n.set(nC(n,e),t),t}function nC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Xg=["label","collapsible"];var Zn=new WeakMap,ps=new WeakMap,Vu=new WeakMap;class uO{constructor(){Bu(this,Zn,[]),Bu(this,ps,0),Bu(this,Vu,1/0)}setColumnsLimit(e){ar(Vu,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ar(Zn,this,lO(e,hn(Vu,this))),ar(ps,this,hn(Zn,this).length)}getData(){return hn(Zn,this)}mergeWith(e){S(e,t=>{let{row:i,col:s,...o}=t;const r=this.getHeaderSettings(i,s);r!==null&&Nt(r,o,Xg)})}map(e){S(hn(Zn,this),t=>{S(t,i=>{const s=e({...i});Me(s)&&Nt(i,s,Xg)})})}getHeaderSettings(e,t){var i;if(e>=hn(ps,this)||e<0)return null;const s=hn(Zn,this)[e];return Array.isArray(s)===!1||t>=s.length?null:(i=s[t])!==null&&i!==void 0?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=hn(ps,this)||e<0)return s;const o=hn(Zn,this)[e];let r=0;for(let a=t;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=l.colspan,s.push(l),l.colspan>1&&(a+=l.colspan-1),r===i)break;if(r>i)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return hn(ps,this)}getColumnsCount(){return hn(ps,this)>0?hn(Zn,this)[0].length:0}clear(){ar(Zn,this,[]),ar(ps,this,0)}}function Uu(n,e,t){return(e=cO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cO(n){var e=dO(n,"string");return typeof e=="symbol"?e:e+""}function dO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const iC="DF-pre-order";function sC(n,e){let t=n.call(e,this);for(let i=0;i<this.childs.length;i++){if(t===!1)return!1;t=sC.call(this.childs[i],n,e)}return t}const fO="DF-post-order";function oC(n,e){for(let t=0;t<this.childs.length;t++)if(oC.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const rC="BF";function gO(n,e){const t=[this];function i(){if(t.length===0)return;const s=t.shift();t.push(...s.childs),n.call(e,s)!==!1&&i()}i()}const mO=rC,Zg=new Map([[iC,sC],[fO,oC],[rC,gO]]);class Zl{constructor(e){Uu(this,"data",{}),Uu(this,"parent",null),Uu(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Zl({...e.data});for(let i=0;i<e.childs.length;i++)t.addChild(this.cloneTree(e.childs[i]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mO;if(!Zg.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);Zg.get(t).call(this,e,this)}walkUp(e){const t=this,i=s=>{e.call(t,s)!==!1&&s.parent!==null&&i(s.parent)};i(this)}}function ju(n,e,t){pO(n,e),e.set(n,t)}function pO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(n,e){return n.get(aC(n,e))}function wO(n,e,t){return n.set(aC(n,e),t),t}function aC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var so=new WeakMap,ws=new WeakMap,oo=new WeakMap;class CO{constructor(e){ju(this,so,new Map),ju(this,ws,new Map),ju(this,oo,null),wO(oo,this,e)}getRoots(){return Array.from(pt(so,this).values())}getRootByColumn(e){let t;return pt(ws,this).has(e)&&(t=pt(so,this).get(pt(ws,this).get(e))),t}getNode(e,t){const i=this.getRootByColumn(t);if(!i)return;const s=t-pt(ws,this).get(t);let o=0,r;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:h}}=a;if(e===h){if(s>=o&&s<=o+l-1)return r=a,r.data.isRoot=t===r.data.columnIndex,!1;o+=l}}),r}rebuildTreeIndex(){let e=0;pt(ws,this).clear(),S(pt(so,this),t=>{let[,{data:{colspan:i}}]=t;for(let s=e;s<e+i;s++)pt(ws,this).set(s,e);e+=i})}buildTree(){this.clear();const e=pt(oo,this).getColumnsCount();let t=0;for(;t<e;){const i=pt(oo,this).getHeaderSettings(0,t),s=new Zl;pt(so,this).set(t,s),this.buildLeaves(s,t,0,i.origColspan),t+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=pt(oo,this).getHeadersSettings(i,t,s);i+=1,S(o,r=>{const a={...r,headerLevel:i-1,columnIndex:t};let l;i===1?(e.data=a,l=e):(l=new Zl(a),e.addChild(l)),i<pt(oo,this).getLayersCount()&&this.buildLeaves(l,t,i,r.origColspan),t+=r.origColspan})}clear(){pt(so,this).clear(),pt(ws,this).clear()}}function lC(n,e){n.walkDown(t=>{let{data:i,childs:s}=t;if(!i.isHidden&&(e(i.columnIndex),s.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function Jl(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Ql(n){return Jl(n,"origColspan")===n.data.origColspan}function xd(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ql(n))return xd(t[0]);e.isCollapsed=!1;const s=t.slice(1),o=new Set;let r=0;if(s.length>0)S(s,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;r+=l.colspan,lC(a,h=>{o.add(h)})});else{const{colspan:a,origColspan:l,columnIndex:h}=e;r=l-a;for(let u=1;u<l;u++)o.add(h+u)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=r,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Ql(a)&&(l.isCollapsed=Jl(a,"isCollapsed"))}),{rollbackModification:()=>Ad(n),affectedColumns:Array.from(o),colspanCompensation:r}}function Ad(n){var e;const{data:t,childs:i}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ql(n))return Ad(i[0]);t.isCollapsed=!0;const o=i.slice(1),r=new Set;if(o.length>0)S(o,l=>{lC(l,h=>{r.add(h)}),l.data.clonedTree=l.cloneTree(),l.walkDown(h=>{let{data:u}=h;u.isHidden=!0})});else{const{origColspan:l,columnIndex:h}=t;for(let u=1;u<l;u++){const c=h+u;r.add(c)}}const a=t.colspan-((e=Jl(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:h}=l;h.colspan-=a,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):Ql(l)&&(h.isCollapsed=Jl(l,"isCollapsed"))}),{rollbackModification:()=>xd(n),affectedColumns:Array.from(r),colspanCompensation:a}}function vO(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let i=!1;n.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return i=!0,!1}),!i&&n.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function SO(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let i=!1;n.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return i=!0,!1}),!i&&n.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const Jg=new Map([["collapse",Ad],["expand",xd],["hide-column",vO],["show-column",SO]]);function bO(n,e,t){if(!Jg.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return Jg.get(n)(e,t)}function za(n){const e=[];return S(n,t=>{t.walkDown(i=>{const s=i.data,{origColspan:o,columnIndex:r,headerLevel:a,crossHiddenColumns:l}=s,h=RO(e,a);let u=!1;for(let c=r;c<r+o;c++)if(l.includes(c)||u)h.push(tC());else{const g=yO(s);g.isRoot=!0,h.push(g),u=!0}})}),e}function yO(n){const{crossHiddenColumns:e,...t}=Fc(n);return t}function RO(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function Yu(n,e,t){EO(n,e),e.set(n,t)}function EO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(n,e,t){return n.set(hC(n,e),t),t}function ke(n,e){return n.get(hC(n,e))}function hC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xn=new WeakMap,Mt=new WeakMap,Cs=new WeakMap;class MO{constructor(){Yu(this,xn,new uO),Yu(this,Mt,new CO(ke(xn,this))),Yu(this,Cs,[[]])}setState(e){ke(xn,this).setData(e);let t=!1;try{ke(Mt,this).buildTree()}catch{ke(Mt,this).clear(),ke(xn,this).clear(),t=!0}return lr(Cs,this,za(ke(Mt,this).getRoots())),t}setColumnsLimit(e){ke(xn,this).setColumnsLimit(e)}mergeStateWith(e){const t=Te(e,i=>{let{row:s,...o}=i;return{row:s<0?this.rowCoordsToLevel(s):s,...o}});ke(xn,this).mergeWith(t),ke(Mt,this).buildTree(),lr(Cs,this,za(ke(Mt,this).getRoots()))}mapState(e){ke(xn,this).map(e),ke(Mt,this).buildTree(),lr(Cs,this,za(ke(Mt,this).getRoots()))}mapNodes(e){return ji(ke(Mt,this).getRoots(),(t,i)=>(i.walkDown(s=>{const o=e(s.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,i){t<0&&(t=this.rowCoordsToLevel(t));const s=ke(Mt,this).getNode(t,i);let o;return s&&(o=bO(e,s,i),lr(Cs,this,za(ke(Mt,this).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(s=ke(Cs,this)[e])===null||s===void 0?void 0:s[t])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,t){const i=this.getHeaderTreeNode(e,t);return i?{...i.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=ke(Mt,this).getNode(e,t);return i||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=t-e+1;let s=!1,o=null;for(let r=e;r<=t;r++){const a=ke(Mt,this).getRootByColumn(r);if(!a)break;s=!0,a.walkDown(l=>{const{columnIndex:h,headerLevel:u,origColspan:c,isHidden:d}=l.data;d||c<=i&&h>=e&&h+c-1<=t&&(o===null||u<o)&&(o=u)},iC)}return s&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,t){var i;const{isRoot:s}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0};if(s)return t;let o=t-1;for(;o>=0;){var r;const{isRoot:a}=(r=this.getHeaderSettings(e,o))!==null&&r!==void 0?r:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,t){var i;const{isRoot:s,origColspan:o}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(s)return t+o-1;let r=t+1;for(;r<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,r))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;r+=1}return r-1}getLayersCount(){return ke(xn,this).getLayersCount()}getColumnsCount(){return ke(xn,this).getColumnsCount()}clear(){lr(Cs,this,[]),ke(xn,this).clear(),ke(Mt,this).clear()}}function hr(n,e,t){return(e=PO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PO(n){var e=_O(n,"string");return typeof e=="symbol"?e:e+""}function _O(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class IO{constructor(e,t){hr(this,"hot",void 0),hr(this,"nestedHeaderSettingsGetter",void 0),hr(this,"layersCount",0),hr(this,"container",void 0),hr(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),i=t.length;this.widthsMap.clear();for(let s=0;s<i;s++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),r=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(r,t[s].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:i}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const h=t.createElement("tr");for(let u=0;u<a;u++){let c=i.getVisualFromRenderableIndex(u);c===null&&(c=u);const d=t.createElement("th"),g=this.nestedHeaderSettingsGetter(l,c);if(g&&(!g.isPlaceholder||g.isHidden)){let w=g.label;r&&(w+='<button class="changeType"></button>'),Yr(d,w),d.colSpan=g.colspan,h.appendChild(d)}}o.appendChild(h)}s.appendChild(o),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function TO(n,e){uC(n,e),e.add(n)}function Qg(n,e,t){return(e=xO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xO(n){var e=AO(n,"string");return typeof e=="symbol"?e:e+""}function AO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ur(n,e,t){uC(n,e),e.set(n,t)}function uC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(n,e,t){return n.set(Fe(n,e),t),t}function ue(n,e){return n.get(Fe(n,e))}function Fe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const em="nestedHeaders",NO=280;var Re=new WeakMap,Mi=new WeakMap,Nr=new WeakMap,Eh=new WeakMap,eh=new WeakMap,Ge=new WeakSet;class OO extends de{constructor(){super(...arguments),TO(this,Ge),ur(this,Re,new MO),ur(this,Mi,null),ur(this,Nr,null),ur(this,Eh,!1),ur(this,eh,null),Qg(this,"ghostTable",new IO(this.hot,(e,t)=>this.getHeaderSettings(e,t))),Qg(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return em}static get PLUGIN_PRIORITY(){return NO}isEnabled(){return!!this.hot.getSettings()[em]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&$e(ot`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Fe(Ge,this,qO).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,XO).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,LO).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,kO).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,FO).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,WO).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,BO).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,VO).call(e,...s)}),this.addHook("afterSelection",()=>Fe(Ge,this,Ka).call(this)),this.addHook("afterSelectionFocusSet",()=>Fe(Ge,this,Ka).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,HO).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",i=>Fe(Ge,this,jO).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,GO).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,zO).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,DO).call(e,...s)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,$O).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,UO).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,YO).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Fe(Ge,e,KO).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Fe(Ge,this,Ka).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Fe(Ge,this,Ka).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ue(Re,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ue(Re,this).setState(e)),this.detectedOverlappedHeaders&&$e(ot`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,i)=>{const s=t===!0?"hide-column":"show-column";ue(Re,this).triggerColumnModification(s,i)}),!ue(Mi,this)&&this.enabled&&ui(Mi,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(i=>{let{op:s,index:o,newValue:r}=i;if(s==="replace"){const a=r===!0?"hide-column":"show-column";ue(Re,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ue(Re,this).clear(),ue(Mi,this).unsubscribe(),ui(Mi,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ue(Re,this)}getLayersCount(){return ue(Re,this).getLayersCount()}getHeaderSettings(e,t){return ue(Re,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<t;r++){const a=i.childNodes[r];if(!a)break;const l=s.childNodes[r],h=o?o.childNodes[r]:null;for(let u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),Ee(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),Ee(l.childNodes[u],"hiddenHeader")),o&&h&&h.childNodes[u]&&(h.childNodes[u].removeAttribute("colspan"),Ee(h.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,o)=>{var r;const{columnIndexMapper:a,view:l}=this.hot;let h=a.getVisualFromRenderableIndex(s);h===null&&(h=s),o.removeAttribute("colspan"),Ee(o,"hiddenHeader"),Ee(o,"hiddenHeaderText");const{colspan:u,isHidden:c,isPlaceholder:d,headerClassNames:g}=(r=ue(Re,this).getHeaderSettings(e,h))!==null&&r!==void 0?r:{};if(d||c)U(o,"hiddenHeader");else if(u>1){var w,E,C;const{wtOverlays:A}=l._wt,T=(w=A.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),k=(E=A.inlineStartOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(o);((C=A.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&h<i&&U(o,"hiddenHeaderText");const $=T||k?Math.min(u,i-s):u;$>1&&o.setAttribute("colspan",$)}if(this.hot.view.appendColHeader(h,o,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!c){const A=o.querySelector("div.relative");A&&g&&g.length>0&&(Ee(A,this.hot.getColumnMeta(h).headerClassName),U(A,g))}}}getColumnHeaderValue(e,t){var i;const{isHidden:s,isPlaceholder:o}=(i=ue(Re,this).getHeaderSettings(t,e))!==null&&i!==void 0?i:{};return o||s?"":this.hot.getColHeader(e,t)}destroy(){ui(Re,this,null),ue(Mi,this)!==null&&(ue(Mi,this).unsubscribe(),ui(Mi,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ue(Re,this).getHeaderTreeNodeData(e.row,e.col)}}function Ka(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const s=ue(Re,this).findLeftMostColumnIndex(t.row,t.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}}function HO(n,e){var t;const i=this.hot.getSelectedRangeLast();if(!i)return n;const{highlight:s}=i,{navigableHeaders:o}=this.hot.getSettings(),r=this.hot.selection.isSelectedByColumnHeader(),a=o?s.row:(t=ue(eh,this))===null||t===void 0?void 0:t.row,l=r?n:s.col,h=a<0&&l>=0;if(ui(eh,this,null),!h)return n;const u=this.hot.getFirstFullyVisibleColumn(),c=this.hot.getLastFullyVisibleColumn(),d=c-u+1,g=ue(Re,this).findLeftMostColumnIndex(a,l),w=ue(Re,this).findRightMostColumnIndex(a,l),E=w-g+1;if(g<u&&w>c)return g;if(r){let C=null;return g>=u&&w>c?E>d?(e.value="start",C=g):(e.value="end",C=w):g<u&&w<=c&&(E>d?(e.value="end",C=w):(e.value="start",C=g)),C}return g<=u?g:w}function DO(n,e,t){const i=ue(Re,this).getHeaderTreeNodeData(e,n);if(!i)return n;const{columnCursor:s,selectionType:o,selectionWidth:r}=t,{isRoot:a,colspan:l}=ue(Re,this).getHeaderSettings(e,n);if(o===ZS){if(!a)return i.columnIndex}else if(o===JS&&(l>r-s||!a))return null;return n}function $O(n,e,t){let{columnHeadersCount:i}=t;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:r,startCol:a,endRow:l,endCol:h}=e[o],u=l-r+1,c=a-h+1;if(r>=0||c===1)break;for(let d=a;d<=h;d++)for(let g=r;g<=l;g++){var s;const w=u+g,E=d-a;if(E===0)continue;((s=ue(Re,this).getHeaderTreeNodeData(g,d))===null||s===void 0?void 0:s.isRoot)===!1&&(n[w][E]="")}}}function LO(n,e,t,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function kO(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;ui(Nr,this,e.clone()),ui(Eh,this,!0);const{selection:i}=this.hot,s=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:r,origColspan:a}=t,l=!i.inInSelection(e);n.shiftKey&&s?e.col<s.from.col?o.push(s.getTopEndCorner().col,r,e.row):e.col>s.from.col?o.push(s.getTopStartCorner().col,r+a-1,e.row):o.push(r,r+a-1,e.row):(QS(n)||rh(n)&&l||eb(n))&&o.push(r,r+a-1,e.row),i.selectColumns(...o)}function FO(n,e,t,i){if(!this.hot.view.isMouseDown()||i.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:o,origColspan:r}=s,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),h=a.getBottomEndCorner(),{from:u}=a;i.column=!0,i.cell=!0;const c=[],d=Yt(e.row,-1/0,-1);e.col<u.col?c.push(h.col,o,d):e.col>u.col?c.push(l.col,o+r-1,d):c.push(o,o+r-1,d),this.hot.selection.selectColumns(...c)}function WO(){ui(Eh,this,!1)}function BO(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ue(Eh,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:s,origColspan:o}=ue(Re,this).getHeaderTreeNodeData(ue(Nr,this).row,ue(Nr,this).col);if(e.setHighlight(ue(Nr,this)),o>e.getWidth()||s<t||s+o-1>i){const r=ue(Re,this).findTopMostEntireHeaderLevel(Yt(t,s,s+o-1),Yt(i,s,s+o-1));e.highlight.row=r,e.highlight.col=e.from.col}}function VO(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const s=ue(Re,this).findLeftMostColumnIndex(t.row,t.col),o=ue(Re,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const r=e.col>=s&&e.col<=o?s-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const r=e.col>=s&&e.col<=o?o+1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function UO(n,e,t){const i=n.row,s=this._getHeaderTreeNodeDataByCoords({row:i,col:n.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});ui(eh,this,t.clone()),e.col<n.col?(s&&(n.col=s.columnIndex+s.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=n.col&&(s&&(n.col=s.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function jO(n){if(ue(Re,this).getLayersCount()>0){n.length=0;for(let e=0;e<ue(Re,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}}function YO(n){const e=ue(Re,this).getLayersCount();let t=n.startColumn,i=!!e;for(let s=0;s<e;s++){const o=ue(Re,this).findLeftMostColumnIndex(s,n.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Ut(r)&&r<n.startColumn){t=r;break}}n.startColumn=i?ue(Re,this).getHeaderTreeNodeData(0,t).columnIndex:t}function GO(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function zO(n,e,t){var i;const{label:s}=(i=ue(Re,this).getHeaderTreeNodeData(t,e))!==null&&i!==void 0?i:{label:""};return s}function KO(n,e){if(n<0)return this.hot.getCell(n,ue(Re,this).findLeftMostColumnIndex(n,e),!0)}function qO(){this.updatePlugin()}function XO(n,e){e||this.updatePlugin()}function cr(n,e,t){return(e=ZO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZO(n){var e=JO(n,"string");return typeof e=="symbol"?e:e+""}function JO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class QO{constructor(e,t){cr(this,"hot",void 0),cr(this,"data",null),cr(this,"plugin",void 0),cr(this,"parentReference",new WeakMap),cr(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ne(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&S(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,i,s){let o=!1,r=t;if(isNaN(r)&&r.end)return r;let a=e;return a||(a={__children:this.data},o=!0,r-=1),i!=null&&r===i?{result:a,end:!0}:s!=null&&a===s?{result:r,end:!0}:(r+=1,a.__children&&S(a.__children,l=>{if(this.parentReference.set(l,o?null:a),r=this.readTreeNodes(l,r,i,s),isNaN(r)&&r.end)return!1}),r)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return yt(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(S(i.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var i;return((i=e.__children)===null||i===void 0?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((t=i.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const r=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let s=i,o;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);s=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),s=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(s,o+1,null);break;case"above":this.addChildAtIndex(s,o,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const s=[];Array.isArray(e)?(ne(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);s.push(this.getDataObject(g))}),ne(0,s.length-2,d=>{this.detachFromParent(s[d],!1)}),i=s[s.length-1]):i=e;const o=this.getRowIndex(i),r=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),h=this.getRowParent(l),u=this.getRowIndex(h);let c=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",o,r+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,r+1,d,this.plugin.pluginName),h){c=u+this.countChildren(h);const g=this.getChild(h,this.countChildren(h)-1),w=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",w+1,r+1,this.plugin.pluginName),h.__children.push(i)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){const s=[];S(i,o=>{s.push(this.getDataObject(o))}),S(s,o=>{const r=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(r,1):a.__children.splice(r,1)}),this.rewriteCache()}spliceData(e,t,i){const s=this.getDataObject(e-1);let o=null,r=e;s&&s.__children&&s.__children.length===0?(o=s,r=0):e<this.countAllRows()&&(o=this.getRowParent(e),r=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(r,t,...i):o.__children.splice(r,t):i?this.data.splice(r,t,...i):this.data.splice(r,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=null;do i=this.getRowParent(i),i!==null&&(t=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,s){const o=t===this.hot.countRows(),r=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=r.__children.slice(a,a+1),h=e>t;let u=o?this.getRowParent(t-1):this.getRowParent(t);u==null&&(u=this.getRowParent(t-1)),u==null&&(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);const c=o||i||s?u.__children.length:this.getRowIndexWithinParent(t),d=r===u;u.__children.splice(c,0,l[0]),r.__children.splice(a+(h&&d?1:0),1),this.syncRowWithRawSource(r),d||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function tm(n,e,t){return(e=eH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eH(n){var e=tH(n,"string");return typeof e=="symbol"?e:e+""}function tH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Nd{constructor(e,t){tm(this,"hot",void 0),tm(this,"plugin",void 0),this.hot=t,this.plugin=e}}class kn extends Nd{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const i=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),r=t.getElementsByTagName("DIV")[0],a=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),h=this.hot.getSettings().ariaTags;if(S(l,u=>{u&&r.removeChild(u)}),U(t,kn.CSS_CLASSES.indicatorContainer),s){const{rootDocument:u}=this.hot,c=a.cloneNode(!0);r.innerHTML="",ne(0,s-1,()=>{const d=u.createElement("SPAN");U(d,kn.CSS_CLASSES.emptyIndicator),r.appendChild(d)}),r.appendChild(c)}if(this.dataManager.hasChildren(o)){const u=this.hot.rootDocument.createElement("DIV");h&&Oe(u,[Ao()]),U(t,kn.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(U(u,`${kn.CSS_CLASSES.button} ${kn.CSS_CLASSES.expandButton}`),h&&Oe(t,[sn(!1)])):(U(u,`${kn.CSS_CLASSES.button} ${kn.CSS_CLASSES.collapseButton}`),h&&Oe(t,[sn(!0)])),r.appendChild(u)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let s=11;i.isClassicTheme()||(s=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*t+25),this.hot.render()}}class nH extends Nd{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,o){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),S(i.lastCollapsedRows,(a,l)=>{a>=s&&a<o&&(i.lastCollapsedRows[l]=a+r)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:(s,o)=>{ne(s,s+o-1,r=>{const a=this.lastCollapsedRows.indexOf(r);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,r=null,a=null;return isNaN(e)?(o=e,r=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),r=e),this.dataManager.hasChildren(o)&&S(o.__children,l=>{s.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(s,!0,!1),i&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(r)===-1&&this.collapsedRows.push(r),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];S(e,o=>{s.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return S(e,o=>{s.push(o),t&&this.collapseChildRows(o,s)}),i&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);S(s.__children,o=>{const r=this.dataManager.getRowIndex(o);t.push(r),this.collapseChildRows(r,t)})}i&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return S(e,o=>{s.push(o),t&&this.expandChildRows(o,s)}),i&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);S(s.__children,o=>{if(!this.isAnyParentCollapsed(o)){const r=this.dataManager.getRowIndex(o);t.push(r),this.expandChildRows(r,t)}})}i&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,r=null,a=null;return isNaN(e)?(o=e,r=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),r=e),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(o)&&S(o.__children,l=>{const h=this.dataManager.getRowIndex(l);s.push(h)}),a=this.expandRows(s,!0,!1),i&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];S(e,o=>{s.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];S(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];S(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{S(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{S(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&S(t.__children,s=>{const o=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const i=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const i=this.translateTrimmedRow(t.row);Ne(e.target,kn.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Os(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function iH(n,e,t){sH(n,e),e.set(n,t)}function sH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oH(n,e,t){return(e=rH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rH(n){var e=aH(n,"string");return typeof e=="symbol"?e:e+""}function aH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lH(n,e){return n.get(hH(n,e))}function hH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var nm=new WeakMap;class uH extends Nd{constructor(){super(...arguments),oH(this,"dataManager",this.plugin.dataManager),iH(this,nm,{row_above:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(tb)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(i);this.dataManager.addChild(s)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(nb)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(s)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ne(0,e.items.length-1,i=>{if(i===0)return S(t,(s,o)=>{e.items.splice(i+o,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ne(0,e.items.length-1,t=>{const i=lH(nm,this)[e.items[t].key];i!=null&&(e.items[t].callback=i)}),e}}function qa(n,e,t){return(e=cH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cH(n){var e=dH(n,"string");return typeof e=="symbol"?e:e+""}function dH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fH{constructor(e){qa(this,"plugin",void 0),qa(this,"hot",void 0),qa(this,"dataManager",void 0),qa(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:s}))return!1;this.movedToCollapsed=!1;const r=i===this.hot.countRows(),a=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const h=e.map(w=>{if(!l)return!1;const E=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(E,a),E}),u=h.indexOf(a)===-1;if(!l||!u)return!1;const c=this.getBaseParent(h),d=this.getTargetParent(r,a),g=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,a,g),this.moveRows(h,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(h,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:i,dropIndex:s,movePossible:o}=e;let r=!1;return Vn(s)&&($e(ot`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,s,o,!1),r=!0),r}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return i==null&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){const s=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){const i=[],s=Math.max(...e)<t;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?i.length:0),0,...i)}selectCells(e,t){const i=e.length;let s=0,o=0;if(this.movedToCollapsed){let r=null;e[i-1]<t?r=this.dataManager.translateTrimmedRow(t-i):r=this.dataManager.translateTrimmedRow(t);const a=this.dataManager.getRowParent(r===null?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(a);s=this.dataManager.untranslateTrimmedRow(l),o=s}else e[i-1]<t?(o=t-1,s=o-i+1):(s=t,o=s+i-1);this.hot.selectCells([[s,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((i,s)=>i-s!==t)}}function gH(n,e){cC(n,e),e.add(n)}function im(n,e,t){cC(n,e),e.set(n,t)}function cC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gu(n,e,t){return(e=mH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mH(n){var e=pH(n,"string");return typeof e=="symbol"?e:e+""}function pH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vl(n,e){return n.get(et(n,e))}function th(n,e,t){return n.set(et(n,e),t),t}function et(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const nh="nestedRows",wH=300,sm=nh,CH="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Mh=new WeakMap,ro=new WeakMap,it=new WeakSet;class vH extends de{constructor(){super(...arguments),gH(this,it),Gu(this,"dataManager",null),Gu(this,"headersUI",null),Gu(this,"collapsedRowsMap",null),im(this,Mh,!1),im(this,ro,!1)}static get PLUGIN_KEY(){return nh}static get PLUGIN_PRIORITY(){return wH}isEnabled(){return!!this.hot.getSettings()[nh]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new jc),this.dataManager=new QO(this,this.hot),this.collapsingUI=new nH(this,this.hot),this.headersUI=new kn(this,this.hot),this.contextMenuUI=new uH(this,this.hot),this.rowMoveController=new fH(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,OH).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,HH).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,yH).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,RH).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,EH).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,bH).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,_H).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,PH).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,IH).call(e,...i)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,TH).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,xH).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,AH).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,MH).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,NH).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return et(it,e,SH).call(e,...i)}),this.addHook("beforeLoadData",t=>et(it,this,om).call(this,t)),this.addHook("beforeUpdateData",t=>et(it,this,om).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:sm,relativeToGroup:xo,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sm)}disableCoreAPIModifiers(){th(ro,this,!0)}enableCoreAPIModifiers(){th(ro,this,!1)}onModifyRowData(e){if(!vl(ro,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!vl(ro,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return vl(ro,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,i),!1)}destroy(){super.destroy()}}function SH(n,e,t,i){return this.rowMoveController.onBeforeRowMove(n,e,t,i)}function bH(n,e,t){this.collapsingUI.toggleState(n,e,t)}function yH(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),th(Mh,this,!0),this.dataManager.getData().slice()}function RH(n){return this.contextMenuUI.appendOptions(n)}function EH(n,e){this.headersUI.appendLevelIndicators(n,e)}function MH(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function PH(n,e,t,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{th(Mh,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _H(n,e,t){const i=Array.from(t.reduce((s,o)=>{if(this.dataManager.isParent(o)){const r=this.dataManager.getDataObject(o).__children;return s.add(o),Array.isArray(r)&&r.forEach(a=>s.add(this.dataManager.getRowIndex(a))),s}return s.add(o)},new Set));t.length=0,t.push(...i)}function IH(){this.collapsingUI.collapsedRowsStash.stash()}function TH(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function xH(){this.collapsingUI.collapsedRowsStash.stash()}function AH(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function NH(){this.dataManager.rewriteCache()}function OH(){this.headersUI.updateRowHeaderWidth()}function HH(n,e){vl(Mh,this)&&(e.skipRender=!0)}function om(n){if(!ib(n)){Vm(CH),this.hot.getSettings()[nh]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function zu(n,e,t){return(e=DH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DH(n){var e=$H(n,"string");return typeof e=="symbol"?e:e+""}function $H(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class LH{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;zu(this,"rootWindow",void 0),zu(this,"prefix",void 0),zu(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const i=typeof e>"u"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){S(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function kH(n,e,t){return(e=FH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FH(n){var e=WH(n,"string");return typeof e=="symbol"?e:e+""}function WH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}X.getSingleton().register("persistentStateSave");X.getSingleton().register("persistentStateLoad");X.getSingleton().register("persistentStateReset");const rm="persistentState",BH=0;class VH extends de{constructor(){super(...arguments),kH(this,"storage",void 0)}static get PLUGIN_KEY(){return rm}static get PLUGIN_PRIORITY(){return BH}isEnabled(){return!!this.hot.getSettings()[rm]}enablePlugin(){this.enabled||(this.storage||(this.storage=new LH(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function UH(n,e){jH(n,e),e.add(n)}function jH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(n,e,t){return(e=YH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YH(n){var e=GH(n,"string");return typeof e=="symbol"?e:e+""}function GH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function am(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const qu="search",zH=190,KH="htSearchResult",qH=function(n,e,t,i,s){n.getCellMeta(e,t).isSearchResult=s},XH=function(n,e,t){return Vn(n)||n===null||!n.toLocaleLowerCase||n.length===0||Vn(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var Xu=new WeakSet;class ZH extends de{constructor(){super(...arguments),UH(this,Xu),Ku(this,"callback",qH),Ku(this,"queryMethod",XH),Ku(this,"searchResultClass",KH)}static get PLUGIN_KEY(){return qu}static get PLUGIN_PRIORITY(){return zH}isEnabled(){return this.hot.getSettings()[qu]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[qu];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return am(Xu,e,lm).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return am(Xu,e,lm).call(e,...s)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),o=this.hot.countCols(),r=[],a=this.hot;return ne(0,s-1,l=>{ne(0,o-1,h=>{const u=this.hot.getDataAtCell(l,h),c=this.hot.getCellMeta(l,h),d=c.search.callback||t,w=(c.search.queryMethod||i)(e,u,c);if(w){const E={row:l,col:h,data:u};r.push(E)}d&&d(a,l,h,u,w)})}),r}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Me(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function lm(n,e,t,i,s,o){const r=o.className||[];let a=[];typeof r=="string"?a=r.split(" "):a.push(...r),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Xa(n,e,t){return(e=JH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JH(n){var e=QH(n,"string");return typeof e=="symbol"?e:e+""}function QH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class dC{constructor(e){Xa(this,"viewportWidth",void 0),Xa(this,"overwriteColumnWidthFn",void 0),Xa(this,"baseWidths",new Map),Xa(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class eD extends dC{calculate(){const e=Array.from(this.baseWidths).reduce((c,d)=>{let[,g]=d;return c+g},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,s=[],o=[];let r=this.viewportWidth,a=0;if(this.baseWidths.forEach((c,d)=>{const g=Math.round(c*i),w=this.overwriteColumnWidthFn(g,d);g===w&&g>=Rl?(s.push([d,w]),a+=w):g!==w&&(s.push([d,w]),o.push(d),r-=w)}),r<=Rl){this.stretchedWidths.clear();return}const l=r/a;let h=-1,u=0;s.forEach((c,d)=>{let[g,w]=c,E=w;o.includes(g)||(E=Math.round(w*l)),this.stretchedWidths.set(g,E),h=g,d<s.length-1&&(u+=E)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(h,Math.round(this.viewportWidth-u))}}function hm(n,e,t){tD(n,e),e.set(n,t)}function tD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zu(n,e){return n.get(fC(n,e))}function Za(n,e,t){return n.set(fC(n,e),t),t}function fC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ja=new WeakMap,dr=new WeakMap;class nD extends dC{constructor(){super(...arguments),hm(this,Ja,0),hm(this,dr,-1)}prepare(e){super.prepare(e),Za(Ja,this,0),Za(dr,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),Za(dr,this,e),Za(Ja,this,t)}calculate(){if(Zu(dr,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,s)=>{let[,o]=s;return i+o},0),t=Math.max(this.viewportWidth-e+Zu(Ja,this),0);this.stretchedWidths.set(Zu(dr,this),t)}}function iD(n,e){gC(n,e),e.add(n)}function Qa(n,e,t){gC(n,e),e.set(n,t)}function gC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(n,e){return n.get(bo(n,e))}function Ju(n,e,t){return n.set(bo(n,e),t),t}function bo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const sD="stretchColumns";var dt=new WeakMap,ao=new WeakMap,Qu=new WeakMap,el=new WeakMap,fr=new WeakSet;class oD{constructor(e){iD(this,fr),Qa(this,dt,void 0),Qa(this,ao,void 0),Qa(this,Qu,new Map([["all",new eD(bo(fr,this,um).bind(this))],["last",new nD(bo(fr,this,um).bind(this))]])),Qa(this,el,"none"),Ju(dt,this,e),Ju(ao,this,ze(dt,this).columnIndexMapper.createAndRegisterIndexMap(sD,"physicalIndexToValue"))}useStrategy(e){Ju(el,this,ze(Qu,this).has(e)?e:"none")}refreshStretching(){if(ze(el,this)==="none"){ze(ao,this).clear();return}ze(dt,this).batchExecution(()=>{ze(ao,this).clear();const e=ze(Qu,this).get(ze(el,this));let i=ze(dt,this).view.getViewportWidth();bo(fr,this,rD).call(this)&&(i-=sh(ze(dt,this).rootDocument)),e.prepare({viewportWidth:i});for(let s=0;s<ze(dt,this).countCols();s++)ze(dt,this).columnIndexMapper.isHidden(ze(dt,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,bo(fr,this,aD).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[o,r]=s;ze(ao,this).setValueAtIndex(ze(dt,this).toPhysicalColumn(o),r)})},!0)}getStretchedWidth(e){return ze(ao,this).getValueAtIndex(ze(dt,this).toPhysicalColumn(e))}}function rD(){const{view:n}=ze(dt,this);if(n.isVerticallyScrollableByWindow())return!1;const e=n.getViewportHeight(),t=ze(dt,this).countRows(),i=n.getStylesHandler().getDefaultRowHeight();let s=0,o=!1;for(let a=0;a<t;a++){var r;if(s+=((r=ze(dt,this).getRowHeight(a))!==null&&r!==void 0?r:i)+(a===0?1:0),s>e){o=!0;break}}return o}function aD(n){var e;return(e=ze(dt,this).getColWidth(n,"StretchColumns"))!==null&&e!==void 0?e:Rl}function um(n,e){return ze(dt,this).runHooks("beforeStretchingColumnWidth",n,e)}function lD(n,e){mC(n,e),e.add(n)}function ec(n,e,t){mC(n,e),e.set(n,t)}function mC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tc(n,e,t){return n.set(ih(n,e),t),t}function ii(n,e){return n.get(ih(n,e))}function ih(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hD="stretchColumns",uD=155;var po=new WeakMap,tl=new WeakMap,gr=new WeakMap,nc=new WeakSet;class cD extends de{constructor(){super(...arguments),lD(this,nc),ec(this,po,new oD(this.hot)),ec(this,tl,null),ec(this,gr,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;(t=this.hot)!==null&&t!==void 0&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:s}=i;ii(tl,this)!==null&&ii(tl,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),tc(tl,this,s.width)})})}))}static get PLUGIN_KEY(){return hD}static get PLUGIN_PRIORITY(){return uD}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(ii(po,this).useStrategy(this.hot.getSettings().stretchH),ii(gr,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return ih(nc,e,fD).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return ih(nc,e,dD).call(e,...i)},10),super.enablePlugin())}updatePlugin(){ii(po,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),ii(gr,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return ii(po,this).getStretchedWidth(e)}destroy(){ii(gr,this).disconnect(),tc(gr,this,null),tc(po,this,null),super.destroy()}}function dD(n,e,t){if(t===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:n}function fD(n){n&&ii(po,this).refreshStretching()}function gD(n,e){mD(n,e),e.add(n)}function mD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(n,e,t){return(e=pD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pD(n){var e=wD(n,"string");return typeof e=="symbol"?e:e+""}function wD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ic(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const CD="touchScroll",vD=200;var il=new WeakSet;class SD extends de{constructor(){super(...arguments),gD(this,il),nl(this,"scrollbars",[]),nl(this,"clones",[]),nl(this,"lockedCollection",!1),nl(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return CD}static get PLUGIN_PRIORITY(){return vD}static get SETTING_KEYS(){return!0}isEnabled(){return sb()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>ic(il,this,bD).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>ic(il,this,yD).call(this)),this.addHook("afterMomentumScroll",()=>ic(il,this,RD).call(this))}}function bD(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),i&&this.scrollbars.push(i),s&&s.clone&&this.scrollbars.push(s),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function yD(){this.freezeOverlays=!0,S(this.clones,n=>{U(n,"hide-tween")})}function RD(){this.freezeOverlays=!1,S(this.clones,n=>{Ee(n,"hide-tween"),U(n,"show-tween")}),this.hot._registerTimeout(()=>{S(this.clones,n=>{Ee(n,"show-tween")})},400),S(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ED(n,e){MD(n,e),e.add(n)}function MD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PD(n,e,t){return(e=_D(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _D(n){var e=ID(n,"string");return typeof e=="symbol"?e:e+""}function ID(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function TD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Sl="trimRows",xD=330;var cm=new WeakSet;class AD extends de{constructor(){super(...arguments),ED(this,cm),PD(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Sl}static get PLUGIN_PRIORITY(){return xD}isEnabled(){return!!this.hot.getSettings()[Sl]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new jc),this.trimmedRowsMap.addLocalHook("init",()=>TD(cm,this,ND).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Sl];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),S(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let s=t;i&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{S(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,i,i&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let s=t;const o=this.trimmedRowsMap.getValues().slice(),r=e.length>0;i&&r&&(S(e,l=>{o[l]=!1}),s=ji(o,(l,h,u)=>(h&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",t,s,i&&r)!==!1&&(i&&r&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,s,i&&r,i&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<t)}destroy(){super.destroy()}}function ND(){const n=this.hot.getSettings()[Sl];Array.isArray(n)&&this.hot.batchExecution(()=>{S(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function OD(n,e,t){return(e=HD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function HD(n){var e=DD(n,"string");return typeof e=="symbol"?e:e+""}function DD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class on{constructor(e){OD(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function sl(n,e,t){return(e=$D(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $D(n){var e=LD(n,"string");return typeof e=="symbol"?e:e+""}function LD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Od extends on{constructor(e){let{stateBefore:t,range:i,type:s,alignment:o}=e;super("cell_alignment"),sl(this,"stateBefore",void 0),sl(this,"range",void 0),sl(this,"type",void 0),sl(this,"alignment",void 0),this.stateBefore=t,this.range=i,this.type=s,this.alignment=o}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(i,s,o,r)=>{t.done(()=>new Od({stateBefore:i,range:s,type:o,alignment:r}))})}undo(e,t){S(this.range,i=>{i.forAll((s,o)=>{s>=0&&o>=0&&e.setCellMeta(s,o,"className",this.stateBefore[s][o]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){Pi(this.range,this.type,this.alignment,(i,s)=>e.getCellMeta(i,s),(i,s,o,r)=>e.setCellMeta(i,s,o,r)),e.addHookOnce("afterViewRender",t),e.render()}}function dm(n,e,t){return(e=kD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kD(n){var e=FD(n,"string");return typeof e=="symbol"?e:e+""}function FD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Hd extends on{constructor(e){let{columns:t,finalIndex:i}=e;super("col_move"),dm(this,"columns",void 0),dm(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(i,s)=>{i!==!1&&t.done(()=>new Hd({columns:i,finalIndex:s}))})}undo(e,t){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),_d(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:r,to:a}=o;r<a&&(a-=1),i.moveColumn(a,r)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function fm(n,e,t){return(e=WD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WD(n){var e=BD(n,"string");return typeof e=="symbol"?e:e+""}function BD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dd extends on{constructor(e){let{currentSortState:t,newSortState:i}=e;super("col_sort"),fm(this,"previousSortState",void 0),fm(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=i}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(i,s,o)=>{o&&t.done(()=>new Dd({currentSortState:i,newSortState:s}))})}undo(e,t){const i=e.getPlugin("columnSorting"),s=e.getPlugin("multiColumnSorting"),o=s.isEnabled()?s:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),t()}redo(e,t){const i=e.getPlugin("columnSorting"),s=e.getPlugin("multiColumnSorting");(s.isEnabled()?s:i).sort(this.nextSortState),t()}}function gm(n,e,t){return(e=VD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VD(n){var e=UD(n,"string");return typeof e=="symbol"?e:e+""}function UD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $d extends on{constructor(e){let{index:t,amount:i}=e;super("insert_col"),gm(this,"index",void 0),gm(this,"amount",void 0),this.index=t,this.amount=i}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(i,s,o)=>{t.done(()=>new $d({index:i,amount:s}),o)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function mm(n,e,t){return(e=jD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jD(n){var e=YD(n,"string");return typeof e=="symbol"?e:e+""}function YD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ld extends on{constructor(e){let{index:t,amount:i}=e;super("insert_row"),mm(this,"index",void 0),mm(this,"amount",void 0),this.index=t,this.amount=i}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(i,s,o)=>{t.done(()=>new Ld({index:i,amount:s}),o)})}undo(e,t){const i=e.countRows(),s=e.getSettings().minSpareRows;this.index>=i&&this.index-s<i&&(this.index-=s),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function ol(n,e,t){return(e=GD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GD(n){var e=zD(n,"string");return typeof e=="symbol"?e:e+""}function zD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kd extends on{constructor(e){let{changes:t,selected:i,countCols:s,countRows:o}=e;super("change"),ol(this,"changes",void 0),ol(this,"selected",void 0),ol(this,"countCols",void 0),ol(this,"countRows",void 0),this.changes=t,this.selected=i,this.countCols=s,this.countRows=o}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(i,s){const o=i&&i.length;if(!o||!i.find(l=>{const[,,h,u]=l;return h!==u}))return;const a=()=>{const l=i.reduce((u,c)=>(u.push([...c]),u),[]);l.forEach(u=>{u[1]=e.propToCol(u[1])});const h=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new kd({changes:l,selected:h,countCols:e.countCols(),countRows:e.countRows()})};t.done(a,s)})}undo(e,t){const i=xs(this.changes);for(let r=0,a=i.length;r<a;r++)i[r].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.undo");const s=e.countRows()-this.countRows;s>0&&e.alter("remove_row",null,s,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){const i=xs(this.changes);for(let s=0,o=i.length;s<o;s++)i[s].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function pm(n,e,t){return(e=KD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KD(n){var e=qD(n,"string");return typeof e=="symbol"?e:e+""}function qD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Fd extends on{constructor(e){let{conditionsStack:t,previousConditionsStack:i}=e;super("filter"),pm(this,"conditionsStack",void 0),pm(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=i}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(i,s)=>{t.done(()=>new Fd({conditionsStack:i,previousConditionsStack:s}))})}undo(e,t){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,t){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),i.importConditions(this.conditionsStack),i.filter()}}function XD(n,e,t){return(e=ZD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZD(n){var e=JD(n,"string");return typeof e=="symbol"?e:e+""}function JD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Wd extends on{constructor(e){let{data:t,cellRange:i}=e;super("merge_cells"),XD(this,"cellRange",void 0),this.cellRange=i,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(i,s)=>{if(s)return;const o=i.getTopStartCorner(),r=i.getBottomEndCorner(),a=e.getData(o.row,o.col,r.row,r.col);t.done(()=>new Wd({data:a,cellRange:i}))})}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}}var wm={},Cm;function QD(){if(Cm)return wm;Cm=1;var n=Km(),e=ob(),t=rb();return n({target:"Object",stat:!0},{fromEntries:function(s){var o={};return e(s,function(r,a){t(o,r,a)},{AS_ENTRIES:!0}),o}}),wm}QD();function pC(n,e,t,i,s){const o=["visualRow","visualCol","row","col","prop"],r=o.length,a=[];return ne(i,s,l=>{ne(e,t,h=>{const u=n.getCellMeta(h,l);if(Object.keys(u).length!==r){const c=Object.fromEntries(Object.entries(u).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([u.visualRow,u.visualCol,c])}})}),a}function Jn(n,e,t){return(e=e$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e$(n){var e=t$(n,"string");return typeof e=="symbol"?e:e+""}function t$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Bd extends on{constructor(e){let{index:t,indexes:i,data:s,amount:o,headers:r,columnPositions:a,rowPositions:l,fixedColumnsStart:h,removedCellMetas:u}=e;super("remove_col"),Jn(this,"index",void 0),Jn(this,"indexes",void 0),Jn(this,"data",void 0),Jn(this,"amount",void 0),Jn(this,"headers",void 0),Jn(this,"columnPositions",void 0),Jn(this,"rowPositions",void 0),Jn(this,"fixedColumnsStart",void 0),Jn(this,"removedCellMetas",void 0),this.index=t,this.indexes=i,this.data=s,this.amount=o,this.headers=r,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=h,this.removedCellMetas=u}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(i,s,o,r)=>{const a=()=>{const l=e.getSourceDataArray(),h=(e.countCols()+i)%e.countCols(),u=h+s-1,c=[],d=[],g=[];ne(l.length-1,C=>{const A=[],T=l[C];ne(h,u,k=>{A.push(T[e.toPhysicalColumn(k)])}),c.push(A)}),ne(s-1,C=>{g.push(e.toPhysicalColumn(h+C))}),Array.isArray(e.getSettings().colHeaders)&&ne(s-1,C=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(h+C)]||null)});const w=e.columnIndexMapper.getIndexesSequence(),E=e.rowIndexMapper.getIndexesSequence();return new Bd({index:h,indexes:g,data:c,amount:s,headers:d,columnPositions:w,rowPositions:E,fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:pC(e,0,e.countRows(),h,u)})};t.done(a,r)})}undo(e,t){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const s=this.indexes.slice(0).sort(),o=(u,c,d)=>d[this.indexes.indexOf(s[c])],r=this.data.length,a=[];for(let u=0;u<r;u++)a.push(Te(this.data[u],o));const l=Te(this.headers,o),h=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),S(e.getSourceDataArray(),(u,c)=>{S(s,(d,g)=>{u[d]=a[c][g],h.push([c,d,u[d]])})}),e.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&S(l,(u,c)=>{e.getSettings().colHeaders[s[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,d,g]=u;e.setCellMetaObject(c,d,g)}),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function lo(n,e,t){return(e=n$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n$(n){var e=i$(n,"string");return typeof e=="symbol"?e:e+""}function i$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vd extends on{constructor(e){let{index:t,data:i,fixedRowsBottom:s,fixedRowsTop:o,rowIndexesSequence:r,removedCellMetas:a}=e;super("remove_row"),lo(this,"index",void 0),lo(this,"data",void 0),lo(this,"fixedRowsBottom",void 0),lo(this,"fixedRowsTop",void 0),lo(this,"rowIndexesSequence",void 0),lo(this,"removedCellMetas",void 0),this.index=t,this.data=i,this.fixedRowsBottom=s,this.fixedRowsTop=o,this.rowIndexesSequence=r,this.removedCellMetas=a}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(i,s,o,r)=>{const a=()=>{const l=e.toPhysicalRow(i),h=l+s-1,u=xs(e.getSourceData(l,0,l+s-1,e.countSourceCols()-1));return new Vd({index:l,data:u,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:pC(e,l,h,0,e.countCols()-1)})};t.done(a,r)})}undo(e,t){const i=e.getSettings(),s=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,r)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);s.push([this.index+r,isNaN(l)?a:l,o[a]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[r,a,l]=o;e.setCellMetaObject(r,a,l)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(s,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function vm(n,e,t){return(e=s$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s$(n){var e=o$(n,"string");return typeof e=="symbol"?e:e+""}function o$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ud extends on{constructor(e){let{rows:t,finalIndex:i}=e;super("row_move"),vm(this,"rows",void 0),vm(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(i,s)=>{i!==!1&&t.done(()=>new Ud({rows:i,finalIndex:s}))})}undo(e,t){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),_d(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:r,to:a}=o;r<a&&(a-=1),i.moveRow(a,r)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function r$(n,e,t){return(e=a$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a$(n){var e=l$(n,"string");return typeof e=="symbol"?e:e+""}function l$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jd extends on{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),r$(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(i,s)=>{s||t.done(()=>new jd({cellRange:i}))})}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}}function h$(n,e){[Od,Hd,Dd,$d,Ld,kd,Fd,Wd,Bd,Vd,Ud,jd].forEach(t=>t.startRegisteringEvents(n,e))}function u$(n,e){c$(n,e),e.add(n)}function c$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sc(n,e,t){return(e=d$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d$(n){var e=f$(n,"string");return typeof e=="symbol"?e:e+""}function f$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function oc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Sm="undoRedo",g$="undoRedo",m$=1e3;X.getSingleton().register("beforeUndo");X.getSingleton().register("afterUndo");X.getSingleton().register("beforeRedo");X.getSingleton().register("afterRedo");const bm=new Set;var rl=new WeakSet;class p$ extends de{static get PLUGIN_KEY(){return g$}static get PLUGIN_PRIORITY(){return m$}static get SETTING_KEYS(){return!0}constructor(e){super(e),u$(this,rl),sc(this,"doneActions",[]),sc(this,"undoneActions",[]),sc(this,"ignoreNewActions",!1),h$(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return oc(rl,e,w$).call(e,...i)}),this.registerShortcuts(),oc(rl,this,C$).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),oc(rl,this,v$).call(this)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),s={runOnlyIf:o=>!o.altKey,group:Sm};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],s)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Sm)}done(e,t){if(this.ignoreNewActions||t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto")return;const s=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",s,t)===!1)return;const r=e(),a=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=xs(t);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=xs(t);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function w$(n,e){e==="loadData"&&this.clear()}function C$(){const n=e=>{bm.has(e)||($e(ot`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),bm.add(e))};this.hot.undo=()=>{n("undo"),this.undo()},this.hot.redo=()=>{n("redo"),this.redo()},this.hot.isUndoAvailable=()=>(n("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(n("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{n("clear"),this.clear()},this.hot.undoRedo=this}function v$(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function S$(){ce(Cr),ce(k0),ce(vr),ce(wE),ce(ME),ce(Fp),ce(SM),ce(sP),ce(vh),ce(g_),ce(W_),ce(K_),ce(yh),ce(yI),ce(wx),ce(qx),ce(yA),ce(HA),ce(GA),ce(i1),ce(f1),ce(A1),ce(W1),ce(RN),ce(nO),ce(aO),ce(OO),ce(vH),ce(VH),ce(ZH),ce(cD),ce(SD),ce(AD),ce(p$)}function b$(){ly(),AR(),WR(),r0(),S$()}function y$(n){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const i=this.first();let s=i.data("handsontable");if(typeof t!="string"){const h=t||{};return s?s.updateSettings(h):(s=new n.Core(i[0],h),i.data("handsontable",s),s.init()),i}let o;if(s)if(typeof s[t]<"u"){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];o=s[t].call(s,...a),t==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return o})}var rc,ac,lc,hc,uc;b$();y$(he);he.__GhostTable=cd;he._getListenersCounter=ab;he._getRegisteredMapsCounter=lb;he.EventManager=No;const R$=[hb,ub,cb,OR,db,fb,gb,mb,pb,wb,Cb,vb],E$=[Sb,bb];he.helper={};he.dom={};S(R$,n=>{S(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(he.helper[e]=n[e])})});S(E$,n=>{S(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(he.dom[e]=n[e])})});he.cellTypes=(rc=he.cellTypes)!==null&&rc!==void 0?rc:{};S(yb(),n=>{he.cellTypes[n]=qm(n)});he.cellTypes.registerCellType=un;he.cellTypes.getCellType=qm;he.editors=(ac=he.editors)!==null&&ac!==void 0?ac:{};S(Rb(),n=>{he.editors[`${Cn(n)}Editor`]=Xm(n)});he.editors.registerEditor=Kt;he.editors.getEditor=Xm;he.renderers=(lc=he.renderers)!==null&&lc!==void 0?lc:{};S(Eb(),n=>{const e=Zm(n);n==="base"&&(he.renderers.cellDecorator=e),he.renderers[`${Cn(n)}Renderer`]=e});he.renderers.registerRenderer=qt;he.renderers.getRenderer=Zm;he.validators=(hc=he.validators)!==null&&hc!==void 0?hc:{};S(Mb(),n=>{he.validators[`${Cn(n)}Validator`]=Jm(n)});he.validators.registerValidator=ho;he.validators.getValidator=Jm;he.plugins=(uc=he.plugins)!==null&&uc!==void 0?uc:{};S(Tm(),n=>{he.plugins[n]=Qm(n)});he.plugins[`${Cn(de.PLUGIN_KEY)}Plugin`]=de;he.plugins.registerPlugin=ce;he.plugins.getPlugin=Qm;const M$=[{ID:4,RuleName:"YYWW",Color:"orange",YearRule:null,YearLength:12.4654,Action:!0,RuleDescr:"YYWW(四位數字)",Editor:"IEC060397",Cdt:"2017-06-14 13:42:20.000"},{ID:5,RuleName:"(D)YYWW",Color:null,YearRule:"https://day.js.org/docs/en/parse/string-format",YearLength:2.36,Action:null,RuleDescr:"一碼前置開頭，后接四位數字一碼前置開頭，后接四位數字",Editor:"IEC123456",Cdt:"2017-06-14 13:42:20.000"},{ID:6,RuleName:"(DD)YYWW",Color:"red",YearRule:"",YearLength:4577.021,Action:!0,RuleDescr:"兩碼前置開頭，后接四位數字",Editor:"admin",Cdt:"2017-06-14 13:42:20.000"},{ID:7,RuleName:"(10D)YYWW",Color:null,YearRule:"https://handsontable.com/docs/12.0/api/",YearLength:24567896,Action:null,RuleDescr:"以10D開頭，后接四位數字",Editor:"admin",Cdt:"2017-06-14 13:42:20.000"},{ID:8,RuleName:"(T)YYWW",Color:null,YearRule:null,YearLength:7452.7985464,Action:!0,RuleDescr:"以T開頭，后接四位數字",Editor:"IEC123456",Cdt:"2017-06-14 13:42:20.000"}];var bl={exports:{}},P$=bl.exports,ym;function _$(){return ym||(ym=1,function(n,e){(function(t,i){n.exports=i()})(P$,function(){var t=1e3,i=6e4,s=36e5,o="millisecond",r="second",a="minute",l="hour",h="day",u="week",c="month",d="quarter",g="year",w="date",E="Invalid Date",C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,T={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(j){var L=["th","st","nd","rd"],F=j%100;return"["+j+(L[(F-20)%10]||L[F]||L[0])+"]"}},k=function(j,L,F){var G=String(j);return!G||G.length>=L?j:""+Array(L+1-G.length).join(F)+j},K={s:k,z:function(j){var L=-j.utcOffset(),F=Math.abs(L),G=Math.floor(F/60),V=F%60;return(L<=0?"+":"-")+k(G,2,"0")+":"+k(V,2,"0")},m:function j(L,F){if(L.date()<F.date())return-j(F,L);var G=12*(F.year()-L.year())+(F.month()-L.month()),V=L.clone().add(G,c),ie=F-V<0,te=L.clone().add(G+(ie?-1:1),c);return+(-(G+(F-V)/(ie?V-te:te-V))||0)},a:function(j){return j<0?Math.ceil(j)||0:Math.floor(j)},p:function(j){return{M:c,y:g,w:u,d:h,D:w,h:l,m:a,s:r,ms:o,Q:d}[j]||String(j||"").toLowerCase().replace(/s$/,"")},u:function(j){return j===void 0}},$="en",x={};x[$]=T;var N="$isDayjsObject",q=function(j){return j instanceof Q||!(!j||!j[N])},ee=function j(L,F,G){var V;if(!L)return $;if(typeof L=="string"){var ie=L.toLowerCase();x[ie]&&(V=ie),F&&(x[ie]=F,V=ie);var te=L.split("-");if(!V&&te.length>1)return j(te[0])}else{var Se=L.name;x[Se]=L,V=Se}return!G&&V&&($=V),V||!G&&$},O=function(j,L){if(q(j))return j.clone();var F=typeof L=="object"?L:{};return F.date=j,F.args=arguments,new Q(F)},Y=K;Y.l=ee,Y.i=q,Y.w=function(j,L){return O(j,{locale:L.$L,utc:L.$u,x:L.$x,$offset:L.$offset})};var Q=function(){function j(F){this.$L=ee(F.locale,null,!0),this.parse(F),this.$x=this.$x||F.x||{},this[N]=!0}var L=j.prototype;return L.parse=function(F){this.$d=function(G){var V=G.date,ie=G.utc;if(V===null)return new Date(NaN);if(Y.u(V))return new Date;if(V instanceof Date)return new Date(V);if(typeof V=="string"&&!/Z$/i.test(V)){var te=V.match(C);if(te){var Se=te[2]-1||0,Pe=(te[7]||"0").substring(0,3);return ie?new Date(Date.UTC(te[1],Se,te[3]||1,te[4]||0,te[5]||0,te[6]||0,Pe)):new Date(te[1],Se,te[3]||1,te[4]||0,te[5]||0,te[6]||0,Pe)}}return new Date(V)}(F),this.init()},L.init=function(){var F=this.$d;this.$y=F.getFullYear(),this.$M=F.getMonth(),this.$D=F.getDate(),this.$W=F.getDay(),this.$H=F.getHours(),this.$m=F.getMinutes(),this.$s=F.getSeconds(),this.$ms=F.getMilliseconds()},L.$utils=function(){return Y},L.isValid=function(){return this.$d.toString()!==E},L.isSame=function(F,G){var V=O(F);return this.startOf(G)<=V&&V<=this.endOf(G)},L.isAfter=function(F,G){return O(F)<this.startOf(G)},L.isBefore=function(F,G){return this.endOf(G)<O(F)},L.$g=function(F,G,V){return Y.u(F)?this[G]:this.set(V,F)},L.unix=function(){return Math.floor(this.valueOf()/1e3)},L.valueOf=function(){return this.$d.getTime()},L.startOf=function(F,G){var V=this,ie=!!Y.u(G)||G,te=Y.p(F),Se=function(rt,f){var m=Y.w(V.$u?Date.UTC(V.$y,f,rt):new Date(V.$y,f,rt),V);return ie?m:m.endOf(h)},Pe=function(rt,f){return Y.w(V.toDate()[rt].apply(V.toDate("s"),(ie?[0,0,0,0]:[23,59,59,999]).slice(f)),V)},Ue=this.$W,D=this.$M,lt=this.$D,Yn="set"+(this.$u?"UTC":"");switch(te){case g:return ie?Se(1,0):Se(31,11);case c:return ie?Se(1,D):Se(0,D+1);case u:var rn=this.$locale().weekStart||0,nt=(Ue<rn?Ue+7:Ue)-rn;return Se(ie?lt-nt:lt+(6-nt),D);case h:case w:return Pe(Yn+"Hours",0);case l:return Pe(Yn+"Minutes",1);case a:return Pe(Yn+"Seconds",2);case r:return Pe(Yn+"Milliseconds",3);default:return this.clone()}},L.endOf=function(F){return this.startOf(F,!1)},L.$set=function(F,G){var V,ie=Y.p(F),te="set"+(this.$u?"UTC":""),Se=(V={},V[h]=te+"Date",V[w]=te+"Date",V[c]=te+"Month",V[g]=te+"FullYear",V[l]=te+"Hours",V[a]=te+"Minutes",V[r]=te+"Seconds",V[o]=te+"Milliseconds",V)[ie],Pe=ie===h?this.$D+(G-this.$W):G;if(ie===c||ie===g){var Ue=this.clone().set(w,1);Ue.$d[Se](Pe),Ue.init(),this.$d=Ue.set(w,Math.min(this.$D,Ue.daysInMonth())).$d}else Se&&this.$d[Se](Pe);return this.init(),this},L.set=function(F,G){return this.clone().$set(F,G)},L.get=function(F){return this[Y.p(F)]()},L.add=function(F,G){var V,ie=this;F=Number(F);var te=Y.p(G),Se=function(D){var lt=O(ie);return Y.w(lt.date(lt.date()+Math.round(D*F)),ie)};if(te===c)return this.set(c,this.$M+F);if(te===g)return this.set(g,this.$y+F);if(te===h)return Se(1);if(te===u)return Se(7);var Pe=(V={},V[a]=i,V[l]=s,V[r]=t,V)[te]||1,Ue=this.$d.getTime()+F*Pe;return Y.w(Ue,this)},L.subtract=function(F,G){return this.add(-1*F,G)},L.format=function(F){var G=this,V=this.$locale();if(!this.isValid())return V.invalidDate||E;var ie=F||"YYYY-MM-DDTHH:mm:ssZ",te=Y.z(this),Se=this.$H,Pe=this.$m,Ue=this.$M,D=V.weekdays,lt=V.months,Yn=V.meridiem,rn=function(f,m,p,M){return f&&(f[m]||f(G,ie))||p[m].slice(0,M)},nt=function(f){return Y.s(Se%12||12,f,"0")},rt=Yn||function(f,m,p){var M=f<12?"AM":"PM";return p?M.toLowerCase():M};return ie.replace(A,function(f,m){return m||function(p){switch(p){case"YY":return String(G.$y).slice(-2);case"YYYY":return Y.s(G.$y,4,"0");case"M":return Ue+1;case"MM":return Y.s(Ue+1,2,"0");case"MMM":return rn(V.monthsShort,Ue,lt,3);case"MMMM":return rn(lt,Ue);case"D":return G.$D;case"DD":return Y.s(G.$D,2,"0");case"d":return String(G.$W);case"dd":return rn(V.weekdaysMin,G.$W,D,2);case"ddd":return rn(V.weekdaysShort,G.$W,D,3);case"dddd":return D[G.$W];case"H":return String(Se);case"HH":return Y.s(Se,2,"0");case"h":return nt(1);case"hh":return nt(2);case"a":return rt(Se,Pe,!0);case"A":return rt(Se,Pe,!1);case"m":return String(Pe);case"mm":return Y.s(Pe,2,"0");case"s":return String(G.$s);case"ss":return Y.s(G.$s,2,"0");case"SSS":return Y.s(G.$ms,3,"0");case"Z":return te}return null}(f)||te.replace(":","")})},L.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},L.diff=function(F,G,V){var ie,te=this,Se=Y.p(G),Pe=O(F),Ue=(Pe.utcOffset()-this.utcOffset())*i,D=this-Pe,lt=function(){return Y.m(te,Pe)};switch(Se){case g:ie=lt()/12;break;case c:ie=lt();break;case d:ie=lt()/3;break;case u:ie=(D-Ue)/6048e5;break;case h:ie=(D-Ue)/864e5;break;case l:ie=D/s;break;case a:ie=D/i;break;case r:ie=D/t;break;default:ie=D}return V?ie:Y.a(ie)},L.daysInMonth=function(){return this.endOf(c).$D},L.$locale=function(){return x[this.$L]},L.locale=function(F,G){if(!F)return this.$L;var V=this.clone(),ie=ee(F,G,!0);return ie&&(V.$L=ie),V},L.clone=function(){return Y.w(this.$d,this)},L.toDate=function(){return new Date(this.valueOf())},L.toJSON=function(){return this.isValid()?this.toISOString():null},L.toISOString=function(){return this.$d.toISOString()},L.toString=function(){return this.$d.toUTCString()},j}(),fe=Q.prototype;return O.prototype=fe,[["$ms",o],["$s",r],["$m",a],["$H",l],["$W",h],["$M",c],["$y",g],["$D",w]].forEach(function(j){fe[j[1]]=function(L){return this.$g(L,j[0],j[1])}}),O.extend=function(j,L){return j.$i||(j(L,Q,O),j.$i=!0),O},O.locale=ee,O.isDayjs=q,O.unix=function(j){return O(1e3*j)},O.en=x[$],O.Ls=x,O.p={},O})}(bl)),bl.exports}_$();const I$={id:"example2"},L$={__name:"HandsontableTest",setup(n){const e=ef({data:[],colHeaders:!0,rowHeaders:!0,minRows:10,fixedColumnsStart:2,colWidths:100,columns:[{data:"ID",title:"ID",type:"text",indicator:!0},{data:"RuleName",title:"RuleName",type:"text"},{data:"Color",title:"Color",type:"dropdown",source:["yellow","red","orange","green","blue","gray","black","white"]},{data:"YearRule",title:"YearRule",renderer(a,l,h,u,c,d,g){if(d){const w=`<a href="${d}" target="_BLANK">${d}</a>`;he.renderers.HtmlRenderer.apply(this,[a,l,h,u,c,w,g])}}},{data:"YearLength",title:"YearLength",type:"numeric",numericFormat:{pattern:{mantissa:2}}},{data:"Action",title:"Action",readOnly:!0,renderer(a,l,h,u,c,d,g){if(d){he.renderers.TextRenderer.apply(this,[a,l,h,u,c,d,g]),l.innerHTML="";const w=document.createElement("button");w.textContent=h,w.removeEventListener("click",t),w.addEventListener("click",t),l.appendChild(w)}}},{data:"RuleDescr",title:"RuleDescr",type:"text"},{data:"Editor",title:"Editor",type:"text"},{data:"Cdt",title:"Cdt",type:"text"},{data:"ErrorText",title:"ErrorText",type:"text",readOnly:!0,width:250}],cells:(a,l)=>{const h={};return(l===7||l===6)&&(h.renderer=function(u,c,d,g,w,E,C){he.renderers.TextRenderer(u,c,d,g,w,E,C),c.style.backgroundColor="rgb(254, 255, 196)"}),h},readOnly:!1,allowInsertRow:!0,allowRemoveRow:!0,allowInsertColumn:!1,allowRemoveColumn:!1,className:"htCenter htMiddle",autoWrapRow:!1,autoWrapCol:!1,stretchH:"all",search:!0,persistentState:!0,manualColumnMove:!0,manualRowMove:!0,manualColumnResize:!0,manualRowResize:!0,undo:!0,copyPaste:!0,comments:!0,renderAllRows:!1,viewportColumnRenderingOffset:5,viewportRowRenderingOffset:10,licenseKey:"non-commercial-and-evaluation",fillHandle:{autoInsertRow:!0,direction:"vertical"}});function t(){alert("Action Success!!!!")}const i=ef(null);function s(){const a=i.value.hotInstance;a&&a.loadData(M$)}function o(a){const l=["ID","RuleName","Color","YearRule","YearLength","Action","RuleDescr","Editor","Cdt"];return a.map(h=>{let u={};return l.forEach((c,d)=>{u[c]=h[d]}),u}).filter(h=>h.ID!==null)}function r(){const a=i.value.hotInstance;if(a){const l=a.getData(),h=o(l);return console.log(h),h}else return console.error("Handsontable instance not found."),[]}return(a,l)=>(xb(),_b("div",I$,[Ib(Tb(Pb),{ref_key:"hotTableComponent",ref:i,settings:e.value},null,8,["settings"]),tf("button",{onClick:s},"input data"),tf("button",{onClick:r},"get data")]))}};export{L$ as default};
