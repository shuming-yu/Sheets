import{c as computed,h,w as withDirectives,a as createComponent,g as getCurrentInstance,i as isRuntimeSsrPreHydration,r as ref,o as onMounted,b as watch,d as onBeforeUpdate,e as inject,f as onBeforeUnmount,j as formKey,k as debounce,l as injectProp,s as stopAndPrevent,n as nextTick,m as onDeactivated,p as onActivated,q as prevent,T as Transition,u as unref,t as createDirective,v as cleanEvt,x as addEvt,y as isKeyCode,z as stop,A as position,P as Platform,B as listenOpts,C as globalConfig,D as onUnmounted,E as Teleport,F as client,H as History,G as getEventPath,I as onBeforeMount,J as noop,K as isDeepEqual,L as shouldIgnoreKey,M as onUpdated,N as toRaw,O as isNumber,Q as isDate,R as isObject,S as injectMultipleProps,U as quasarKey,V as defineComponent,W as createElementBlock,X as openBlock,Y as useI18n,Z as reactive,_ as createVNode,$ as withCtx,a0 as Fragment,a1 as createBaseVNode,a2 as normalizeStyle,a3 as toDisplayString,a4 as createTextVNode}from"./index-KpW1kW7M.js";import{g as getDefaultExportFromCjs}from"./_commonjsHelpers-Cpj98o6Y.js";const useSizeDefaults={xs:18,sm:24,md:32,lg:38,xl:46},useSizeProps={size:String};function useSize(e,o=useSizeDefaults){return computed(()=>e.size!==void 0?{fontSize:e.size in o?`${o[e.size]}px`:e.size}:null)}function hSlot(e,o){return e!==void 0&&e()||o}function hUniqueSlot(e,o){if(e!==void 0){const r=e();if(r!=null)return r.slice()}return o}function hMergeSlot(e,o){return e!==void 0?o.concat(e()):o}function hMergeSlotSafely(e,o){return e===void 0?o:o!==void 0?o.concat(e()):e()}function hDir(e,o,r,l,b,E){o.key=l+b;const O=h(e,o,r);return b===!0?withDirectives(O,E()):O}const defaultViewBox="0 0 24 24",sameFn=e=>e,ionFn=e=>`ionicons ${e}`,libMap={"mdi-":e=>`mdi ${e}`,"icon-":sameFn,"bt-":e=>`bt ${e}`,"eva-":e=>`eva ${e}`,"ion-md":ionFn,"ion-ios":ionFn,"ion-logo":ionFn,"iconfont ":sameFn,"ti-":e=>`themify-icon ${e}`,"bi-":e=>`bootstrap-icons ${e}`,"i-":sameFn},matMap={o_:"-outlined",r_:"-round",s_:"-sharp"},symMap={sym_o_:"-outlined",sym_r_:"-rounded",sym_s_:"-sharp"},libRE=new RegExp("^("+Object.keys(libMap).join("|")+")"),matRE=new RegExp("^("+Object.keys(matMap).join("|")+")"),symRE=new RegExp("^("+Object.keys(symMap).join("|")+")"),mRE=/^[Mm]\s?[-+]?\.?\d/,imgRE=/^img:/,svgUseRE=/^svguse:/,ionRE=/^ion-/,faRE=/^(fa-(classic|sharp|solid|regular|light|brands|duotone|thin)|[lf]a[srlbdk]?) /,QIcon=createComponent({name:"QIcon",props:{...useSizeProps,tag:{type:String,default:"i"},name:String,color:String,left:Boolean,right:Boolean},setup(e,{slots:o}){const{proxy:{$q:r}}=getCurrentInstance(),l=useSize(e),b=computed(()=>"q-icon"+(e.left===!0?" on-left":"")+(e.right===!0?" on-right":"")+(e.color!==void 0?` text-${e.color}`:"")),E=computed(()=>{let O,d=e.name;if(d==="none"||!d)return{none:!0};if(r.iconMapFn!==null){const S=r.iconMapFn(d);if(S!==void 0)if(S.icon!==void 0){if(d=S.icon,d==="none"||!d)return{none:!0}}else return{cls:S.cls,content:S.content!==void 0?S.content:" "}}if(mRE.test(d)===!0){const[S,I=defaultViewBox]=d.split("|");return{svg:!0,viewBox:I,nodes:S.split("&&").map(m=>{const[s,v,j]=m.split("@@");return h("path",{style:v,d:s,transform:j})})}}if(imgRE.test(d)===!0)return{img:!0,src:d.substring(4)};if(svgUseRE.test(d)===!0){const[S,I=defaultViewBox]=d.split("|");return{svguse:!0,src:S.substring(7),viewBox:I}}let u=" ";const f=d.match(libRE);if(f!==null)O=libMap[f[1]](d);else if(faRE.test(d)===!0)O=d;else if(ionRE.test(d)===!0)O=`ionicons ion-${r.platform.is.ios===!0?"ios":"md"}${d.substring(3)}`;else if(symRE.test(d)===!0){O="notranslate material-symbols";const S=d.match(symRE);S!==null&&(d=d.substring(6),O+=symMap[S[1]]),u=d}else{O="notranslate material-icons";const S=d.match(matRE);S!==null&&(d=d.substring(2),O+=matMap[S[1]]),u=d}return{cls:O,content:u}});return()=>{const O={class:b.value,style:l.value,"aria-hidden":"true"};return E.value.none===!0?h(e.tag,O,hSlot(o.default)):E.value.img===!0?h(e.tag,O,hMergeSlot(o.default,[h("img",{src:E.value.src})])):E.value.svg===!0?h(e.tag,O,hMergeSlot(o.default,[h("svg",{viewBox:E.value.viewBox||"0 0 24 24"},E.value.nodes)])):E.value.svguse===!0?h(e.tag,O,hMergeSlot(o.default,[h("svg",{viewBox:E.value.viewBox},[h("use",{"xlink:href":E.value.src})])])):(E.value.cls!==void 0&&(O.class+=" "+E.value.cls),h(e.tag,O,hMergeSlot(o.default,[E.value.content])))}}}),useSpinnerProps={size:{type:[String,Number],default:"1em"},color:String};function useSpinner(e){return{cSize:computed(()=>e.size in useSizeDefaults?`${useSizeDefaults[e.size]}px`:e.size),classes:computed(()=>"q-spinner"+(e.color?` text-${e.color}`:""))}}const QSpinner=createComponent({name:"QSpinner",props:{...useSpinnerProps,thickness:{type:Number,default:5}},setup(e){const{cSize:o,classes:r}=useSpinner(e);return()=>h("svg",{class:r.value+" q-spinner-mat",width:o.value,height:o.value,viewBox:"25 25 50 50"},[h("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"currentColor","stroke-width":e.thickness,"stroke-miterlimit":"10"})])}});let buf,bufIdx=0;const hexBytes=new Array(256);for(let e=0;e<256;e++)hexBytes[e]=(e+256).toString(16).substring(1);const randomBytes=(()=>{const e=typeof crypto<"u"?crypto:typeof window<"u"?window.crypto||window.msCrypto:void 0;if(e!==void 0){if(e.randomBytes!==void 0)return e.randomBytes;if(e.getRandomValues!==void 0)return o=>{const r=new Uint8Array(o);return e.getRandomValues(r),r}}return o=>{const r=[];for(let l=o;l>0;l--)r.push(Math.floor(Math.random()*256));return r}})(),BUFFER_SIZE=4096;function uid(){(buf===void 0||bufIdx+16>BUFFER_SIZE)&&(bufIdx=0,buf=randomBytes(BUFFER_SIZE));const e=Array.prototype.slice.call(buf,bufIdx,bufIdx+=16);return e[6]=e[6]&15|64,e[8]=e[8]&63|128,hexBytes[e[0]]+hexBytes[e[1]]+hexBytes[e[2]]+hexBytes[e[3]]+"-"+hexBytes[e[4]]+hexBytes[e[5]]+"-"+hexBytes[e[6]]+hexBytes[e[7]]+"-"+hexBytes[e[8]]+hexBytes[e[9]]+"-"+hexBytes[e[10]]+hexBytes[e[11]]+hexBytes[e[12]]+hexBytes[e[13]]+hexBytes[e[14]]+hexBytes[e[15]]}function parseValue(e){return e??null}function getId(e,o){return e??(o===!0?`f_${uid()}`:null)}function useId({getValue:e,required:o=!0}={}){if(isRuntimeSsrPreHydration.value===!0){const r=e!==void 0?ref(parseValue(e())):ref(null);return o===!0&&r.value===null&&onMounted(()=>{r.value=`f_${uid()}`}),e!==void 0&&watch(e,l=>{r.value=getId(l,o)}),r}return e!==void 0?computed(()=>getId(e(),o)):ref(`f_${uid()}`)}const listenerRE=/^on[A-Z]/;function useSplitAttrs(){const{attrs:e,vnode:o}=getCurrentInstance(),r={listeners:ref({}),attributes:ref({})};function l(){const b={},E={};for(const O in e)O!=="class"&&O!=="style"&&listenerRE.test(O)===!1&&(b[O]=e[O]);for(const O in o.props)listenerRE.test(O)===!0&&(E[O]=o.props[O]);r.attributes.value=b,r.listeners.value=E}return onBeforeUpdate(l),l(),r}const useDarkProps={dark:{type:Boolean,default:null}};function useDark(e,o){return computed(()=>e.dark===null?o.dark.isActive:e.dark)}function useFormChild({validate:e,resetValidation:o,requiresQForm:r}){const l=inject(formKey,!1);if(l!==!1){const{props:b,proxy:E}=getCurrentInstance();Object.assign(E,{validate:e,resetValidation:o}),watch(()=>b.disable,O=>{O===!0?(typeof o=="function"&&o(),l.unbindComponent(E)):l.bindComponent(E)}),onMounted(()=>{b.disable!==!0&&l.bindComponent(E)}),onBeforeUnmount(()=>{b.disable!==!0&&l.unbindComponent(E)})}else r===!0&&console.error("Parent QForm not found on useFormChild()!")}const hex=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,hexa=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,hexOrHexa=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,rgb=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,rgba=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,testPattern={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>hex.test(e),hexaColor:e=>hexa.test(e),hexOrHexaColor:e=>hexOrHexa.test(e),rgbColor:e=>rgb.test(e),rgbaColor:e=>rgba.test(e),rgbOrRgbaColor:e=>rgb.test(e)||rgba.test(e),hexOrRgbColor:e=>hex.test(e)||rgb.test(e),hexaOrRgbaColor:e=>hexa.test(e)||rgba.test(e),anyColor:e=>hexOrHexa.test(e)||rgb.test(e)||rgba.test(e)},lazyRulesValues=[!0,!1,"ondemand"],useValidateProps={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>lazyRulesValues.includes(e)}};function useValidate(e,o){const{props:r,proxy:l}=getCurrentInstance(),b=ref(!1),E=ref(null),O=ref(!1);useFormChild({validate:j,resetValidation:v});let d=0,u;const f=computed(()=>r.rules!==void 0&&r.rules!==null&&r.rules.length!==0),S=computed(()=>r.disable!==!0&&f.value===!0&&o.value===!1),I=computed(()=>r.error===!0||b.value===!0),m=computed(()=>typeof r.errorMessage=="string"&&r.errorMessage.length!==0?r.errorMessage:E.value);watch(()=>r.modelValue,()=>{O.value=!0,S.value===!0&&r.lazyRules===!1&&g()});function s(){r.lazyRules!=="ondemand"&&S.value===!0&&O.value===!0&&g()}watch(()=>r.reactiveRules,T=>{T===!0?u===void 0&&(u=watch(()=>r.rules,s,{immediate:!0,deep:!0})):u!==void 0&&(u(),u=void 0)},{immediate:!0}),watch(()=>r.lazyRules,s),watch(e,T=>{T===!0?O.value=!0:S.value===!0&&r.lazyRules!=="ondemand"&&g()});function v(){d++,o.value=!1,O.value=!1,b.value=!1,E.value=null,g.cancel()}function j(T=r.modelValue){if(r.disable===!0||f.value===!1)return!0;const D=++d,L=o.value!==!0?()=>{O.value=!0}:()=>{},_=(M,B)=>{M===!0&&L(),b.value=M,E.value=B||null,o.value=!1},F=[];for(let M=0;M<r.rules.length;M++){const B=r.rules[M];let K;if(typeof B=="function"?K=B(T,testPattern):typeof B=="string"&&testPattern[B]!==void 0&&(K=testPattern[B](T)),K===!1||typeof K=="string")return _(!0,K),!1;K!==!0&&K!==void 0&&F.push(K)}return F.length===0?(_(!1),!0):(o.value=!0,Promise.all(F).then(M=>{if(M===void 0||Array.isArray(M)===!1||M.length===0)return D===d&&_(!1),!0;const B=M.find(K=>K===!1||typeof K=="string");return D===d&&_(B!==void 0,B),B===void 0},M=>(D===d&&(console.error(M),_(!0)),!1)))}const g=debounce(j,0);return onBeforeUnmount(()=>{u==null||u(),g.cancel()}),Object.assign(l,{resetValidation:v,validate:j}),injectProp(l,"hasError",()=>I.value),{isDirtyModel:O,hasRules:f,hasError:I,errorMessage:m,validate:j,resetValidation:v}}let queue=[],waitFlags=[];function clearFlag(e){waitFlags=waitFlags.filter(o=>o!==e)}function addFocusWaitFlag(e){clearFlag(e),waitFlags.push(e)}function removeFocusWaitFlag(e){clearFlag(e),waitFlags.length===0&&queue.length!==0&&(queue[queue.length-1](),queue=[])}function addFocusFn(e){waitFlags.length===0?e():queue.push(e)}function removeFocusFn(e){queue=queue.filter(o=>o!==e)}function fieldValueIsFilled(e){return e!=null&&(""+e).length!==0}const useNonInputFieldProps={...useDarkProps,...useValidateProps,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},useFieldProps={...useNonInputFieldProps,maxlength:[Number,String]},useFieldEmits=["update:modelValue","clear","focus","blur"];function useFieldState({requiredForAttr:e=!0,tagProp:o,changeEvent:r=!1}={}){const{props:l,proxy:b}=getCurrentInstance(),E=useDark(l,b.$q),O=useId({required:e,getValue:()=>l.for});return{requiredForAttr:e,changeEvent:r,tag:o===!0?computed(()=>l.tag):{value:"label"},isDark:E,editable:computed(()=>l.disable!==!0&&l.readonly!==!0),innerLoading:ref(!1),focused:ref(!1),hasPopupOpen:!1,splitAttrs:useSplitAttrs(),targetUid:O,rootRef:ref(null),targetRef:ref(null),controlRef:ref(null)}}function useField(e){const{props:o,emit:r,slots:l,attrs:b,proxy:E}=getCurrentInstance(),{$q:O}=E;let d=null;e.hasValue===void 0&&(e.hasValue=computed(()=>fieldValueIsFilled(o.modelValue))),e.emitValue===void 0&&(e.emitValue=Ae=>{r("update:modelValue",Ae)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:H,onFocusout:te}),Object.assign(e,{clearValue:se,onControlFocusin:H,onControlFocusout:te,focus:B}),e.computedCounter===void 0&&(e.computedCounter=computed(()=>{if(o.counter!==!1){const Ae=typeof o.modelValue=="string"||typeof o.modelValue=="number"?(""+o.modelValue).length:Array.isArray(o.modelValue)===!0?o.modelValue.length:0,Ne=o.maxlength!==void 0?o.maxlength:o.maxValues;return Ae+(Ne!==void 0?" / "+Ne:"")}}));const{isDirtyModel:u,hasRules:f,hasError:S,errorMessage:I,resetValidation:m}=useValidate(e.focused,e.innerLoading),s=e.floatingLabel!==void 0?computed(()=>o.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):computed(()=>o.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),v=computed(()=>o.bottomSlots===!0||o.hint!==void 0||f.value===!0||o.counter===!0||o.error!==null),j=computed(()=>o.filled===!0?"filled":o.outlined===!0?"outlined":o.borderless===!0?"borderless":o.standout?"standout":"standard"),g=computed(()=>`q-field row no-wrap items-start q-field--${j.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(o.rounded===!0?" q-field--rounded":"")+(o.square===!0?" q-field--square":"")+(s.value===!0?" q-field--float":"")+(D.value===!0?" q-field--labeled":"")+(o.dense===!0?" q-field--dense":"")+(o.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(S.value===!0?" q-field--error":"")+(S.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(o.hideBottomSpace!==!0&&v.value===!0?" q-field--with-bottom":"")+(o.disable===!0?" q-field--disabled":o.readonly===!0?" q-field--readonly":"")),T=computed(()=>"q-field__control relative-position row no-wrap"+(o.bgColor!==void 0?` bg-${o.bgColor}`:"")+(S.value===!0?" text-negative":typeof o.standout=="string"&&o.standout.length!==0&&e.focused.value===!0?` ${o.standout}`:o.color!==void 0?` text-${o.color}`:"")),D=computed(()=>o.labelSlot===!0||o.label!==void 0),L=computed(()=>"q-field__label no-pointer-events absolute ellipsis"+(o.labelColor!==void 0&&S.value!==!0?` text-${o.labelColor}`:"")),_=computed(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:s.value,modelValue:o.modelValue,emitValue:e.emitValue})),F=computed(()=>{const Ae={};return e.targetUid.value&&(Ae.for=e.targetUid.value),o.disable===!0&&(Ae["aria-disabled"]="true"),Ae});function M(){var Fe;const Ae=document.activeElement;let Ne=(Fe=e.targetRef)==null?void 0:Fe.value;Ne&&(Ae===null||Ae.id!==e.targetUid.value)&&(Ne.hasAttribute("tabindex")===!0||(Ne=Ne.querySelector("[tabindex]")),Ne!==Ae&&(Ne==null||Ne.focus({preventScroll:!0})))}function B(){addFocusFn(M)}function K(){removeFocusFn(M);const Ae=document.activeElement;Ae!==null&&e.rootRef.value.contains(Ae)&&Ae.blur()}function H(Ae){d!==null&&(clearTimeout(d),d=null),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,r("focus",Ae))}function te(Ae,Ne){d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,!(document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1))&&(e.focused.value===!0&&(e.focused.value=!1,r("blur",Ae)),Ne==null||Ne())})}function se(Ae){var Ne;stopAndPrevent(Ae),O.platform.is.mobile!==!0?(((Ne=e.targetRef)==null?void 0:Ne.value)||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),o.type==="file"&&(e.inputRef.value.value=null),r("update:modelValue",null),e.changeEvent===!0&&r("change",null),r("clear",o.modelValue),nextTick(()=>{const Fe=u.value;m(),u.value=Fe})}function Q(Ae){[13,32].includes(Ae.keyCode)&&se(Ae)}function pe(){const Ae=[];return l.prepend!==void 0&&Ae.push(h("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:prevent},l.prepend())),Ae.push(h("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},fe())),S.value===!0&&o.noErrorIcon===!1&&Ae.push(oe("error",[h(QIcon,{name:O.iconSet.field.error,color:"negative"})])),o.loading===!0||e.innerLoading.value===!0?Ae.push(oe("inner-loading-append",l.loading!==void 0?l.loading():[h(QSpinner,{color:o.color})])):o.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&Ae.push(oe("inner-clearable-append",[h(QIcon,{class:"q-field__focusable-action",name:o.clearIcon||O.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":O.lang.label.clear,onKeyup:Q,onClick:se})])),l.append!==void 0&&Ae.push(h("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:prevent},l.append())),e.getInnerAppend!==void 0&&Ae.push(oe("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&Ae.push(e.getControlChild()),Ae}function fe(){const Ae=[];return o.prefix!==void 0&&o.prefix!==null&&Ae.push(h("div",{class:"q-field__prefix no-pointer-events row items-center"},o.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&Ae.push(e.getShadowControl()),e.getControl!==void 0?Ae.push(e.getControl()):l.rawControl!==void 0?Ae.push(l.rawControl()):l.control!==void 0&&Ae.push(h("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":o.autofocus===!0||void 0},l.control(_.value))),D.value===!0&&Ae.push(h("div",{class:L.value},hSlot(l.label,o.label))),o.suffix!==void 0&&o.suffix!==null&&Ae.push(h("div",{class:"q-field__suffix no-pointer-events row items-center"},o.suffix)),Ae.concat(hSlot(l.default))}function me(){let Ae,Ne;S.value===!0?I.value!==null?(Ae=[h("div",{role:"alert"},I.value)],Ne=`q--slot-error-${I.value}`):(Ae=hSlot(l.error),Ne="q--slot-error"):(o.hideHint!==!0||e.focused.value===!0)&&(o.hint!==void 0?(Ae=[h("div",o.hint)],Ne=`q--slot-hint-${o.hint}`):(Ae=hSlot(l.hint),Ne="q--slot-hint"));const Fe=o.counter===!0||l.counter!==void 0;if(o.hideBottomSpace===!0&&Fe===!1&&Ae===void 0)return;const je=h("div",{key:Ne,class:"q-field__messages col"},Ae);return h("div",{class:"q-field__bottom row items-start q-field__bottom--"+(o.hideBottomSpace!==!0?"animated":"stale"),onClick:prevent},[o.hideBottomSpace===!0?je:h(Transition,{name:"q-transition--field-message"},()=>je),Fe===!0?h("div",{class:"q-field__counter"},l.counter!==void 0?l.counter():e.computedCounter.value):null])}function oe(Ae,Ne){return Ne===null?null:h("div",{key:Ae,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},Ne)}let Pe=!1;return onDeactivated(()=>{Pe=!0}),onActivated(()=>{Pe===!0&&o.autofocus===!0&&E.focus()}),o.autofocus===!0&&onMounted(()=>{E.focus()}),onBeforeUnmount(()=>{d!==null&&clearTimeout(d)}),Object.assign(E,{focus:B,blur:K}),function(){const Ne=e.getControl===void 0&&l.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":o.autofocus===!0||void 0,...F.value}:F.value;return h(e.tag.value,{ref:e.rootRef,class:[g.value,b.class],style:b.style,...Ne},[l.before!==void 0?h("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:prevent},l.before()):null,h("div",{class:"q-field__inner relative-position col self-stretch"},[h("div",{ref:e.controlRef,class:T.value,tabindex:-1,...e.controlEvents},pe()),v.value===!0?me():null]),l.after!==void 0?h("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:prevent},l.after()):null])}}const QField=createComponent({name:"QField",inheritAttrs:!1,props:{...useFieldProps,tag:{type:String,default:"label"}},emits:useFieldEmits,setup(){return useField(useFieldState({tagProp:!0}))}});function css(e,o){const r=e.style;for(const l in o)r[l]=o[l]}function getElement(e){if(e==null)return;if(typeof e=="string")try{return document.querySelector(e)||void 0}catch{return}const o=unref(e);if(o)return o.$el||o}function childHasFocus(e,o){if(e==null||e.contains(o)===!0)return!0;for(let r=e.nextElementSibling;r!==null;r=r.nextElementSibling)if(r.contains(o))return!0;return!1}function throttle(e,o=250){let r=!1,l;return function(){return r===!1&&(r=!0,setTimeout(()=>{r=!1},o),l=e.apply(this,arguments)),l}}function showRipple(e,o,r,l){r.modifiers.stop===!0&&stop(e);const b=r.modifiers.color;let E=r.modifiers.center;E=E===!0||l===!0;const O=document.createElement("span"),d=document.createElement("span"),u=position(e),{left:f,top:S,width:I,height:m}=o.getBoundingClientRect(),s=Math.sqrt(I*I+m*m),v=s/2,j=`${(I-s)/2}px`,g=E?j:`${u.left-f-v}px`,T=`${(m-s)/2}px`,D=E?T:`${u.top-S-v}px`;d.className="q-ripple__inner",css(d,{height:`${s}px`,width:`${s}px`,transform:`translate3d(${g},${D},0) scale3d(.2,.2,1)`,opacity:0}),O.className=`q-ripple${b?" text-"+b:""}`,O.setAttribute("dir","ltr"),O.appendChild(d),o.appendChild(O);const L=()=>{O.remove(),clearTimeout(_)};r.abort.push(L);let _=setTimeout(()=>{d.classList.add("q-ripple__inner--enter"),d.style.transform=`translate3d(${j},${T},0) scale3d(1,1,1)`,d.style.opacity=.2,_=setTimeout(()=>{d.classList.remove("q-ripple__inner--enter"),d.classList.add("q-ripple__inner--leave"),d.style.opacity=0,_=setTimeout(()=>{O.remove(),r.abort.splice(r.abort.indexOf(L),1)},275)},250)},50)}function updateModifiers(e,{modifiers:o,value:r,arg:l}){const b=Object.assign({},e.cfg.ripple,o,r);e.modifiers={early:b.early===!0,stop:b.stop===!0,center:b.center===!0,color:b.color||l,keyCodes:[].concat(b.keyCodes||13)}}const Ripple=createDirective({name:"ripple",beforeMount(e,o){const r=o.instance.$.appContext.config.globalProperties.$q.config||{};if(r.ripple===!1)return;const l={cfg:r,enabled:o.value!==!1,modifiers:{},abort:[],start(b){l.enabled===!0&&b.qSkipRipple!==!0&&b.type===(l.modifiers.early===!0?"pointerdown":"click")&&showRipple(b,e,l,b.qKeyEvent===!0)},keystart:throttle(b=>{l.enabled===!0&&b.qSkipRipple!==!0&&isKeyCode(b,l.modifiers.keyCodes)===!0&&b.type===`key${l.modifiers.early===!0?"down":"up"}`&&showRipple(b,e,l,!0)},300)};updateModifiers(l,o),e.__qripple=l,addEvt(l,"main",[[e,"pointerdown","start","passive"],[e,"click","start","passive"],[e,"keydown","keystart","passive"],[e,"keyup","keystart","passive"]])},updated(e,o){if(o.oldValue!==o.value){const r=e.__qripple;r!==void 0&&(r.enabled=o.value!==!1,r.enabled===!0&&Object(o.value)===o.value&&updateModifiers(r,o))}},beforeUnmount(e){const o=e.__qripple;o!==void 0&&(o.abort.forEach(r=>{r()}),cleanEvt(o,"main"),delete e._qripple)}}),defaultSizes$2={xs:8,sm:10,md:14,lg:20,xl:24},QChip=createComponent({name:"QChip",props:{...useDarkProps,...useSizeProps,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:o,emit:r}){const{proxy:{$q:l}}=getCurrentInstance(),b=useDark(e,l),E=useSize(e,defaultSizes$2),O=computed(()=>e.selected===!0||e.icon!==void 0),d=computed(()=>e.selected===!0?e.iconSelected||l.iconSet.chip.selected:e.icon),u=computed(()=>e.iconRemove||l.iconSet.chip.remove),f=computed(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),S=computed(()=>{const g=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(g?` text-${g} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(f.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(b.value===!0?" q-chip--dark q-dark":"")}),I=computed(()=>{const g=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},T={...g,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||l.lang.label.remove};return{chip:g,remove:T}});function m(g){g.keyCode===13&&s(g)}function s(g){e.disable||(r("update:selected",!e.selected),r("click",g))}function v(g){(g.keyCode===void 0||g.keyCode===13)&&(stopAndPrevent(g),e.disable===!1&&(r("update:modelValue",!1),r("remove")))}function j(){const g=[];f.value===!0&&g.push(h("div",{class:"q-focus-helper"})),O.value===!0&&g.push(h(QIcon,{class:"q-chip__icon q-chip__icon--left",name:d.value}));const T=e.label!==void 0?[h("div",{class:"ellipsis"},[e.label])]:void 0;return g.push(h("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},hMergeSlotSafely(o.default,T))),e.iconRight&&g.push(h(QIcon,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&g.push(h(QIcon,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:u.value,...I.value.remove,onClick:v,onKeyup:v})),g}return()=>{if(e.modelValue===!1)return;const g={class:S.value,style:E.value};return f.value===!0&&Object.assign(g,I.value.chip,{onClick:s,onKeyup:m}),hDir("div",g,j(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Ripple,e.ripple]])}}});function getParentProxy(e){if(Object(e.$parent)===e.$parent)return e.$parent;let{parent:o}=e.$;for(;Object(o)===o;){if(Object(o.proxy)===o.proxy)return o.proxy;o=o.parent}}function vmHasRouter(e){return e.appContext.config.globalProperties.$router!==void 0}function vmIsDestroyed(e){return e.isUnmounted===!0||e.isDeactivated===!0}function getOriginalPath(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}function isSameRouteRecord(e,o){return(e.aliasOf||e)===(o.aliasOf||o)}function includesParams(e,o){for(const r in o){const l=o[r],b=e[r];if(typeof l=="string"){if(l!==b)return!1}else if(Array.isArray(b)===!1||b.length!==l.length||l.some((E,O)=>E!==b[O]))return!1}return!0}function isEquivalentArray(e,o){return Array.isArray(o)===!0?e.length===o.length&&e.every((r,l)=>r===o[l]):e.length===1&&e[0]===o}function isSameRouteLocationParamsValue(e,o){return Array.isArray(e)===!0?isEquivalentArray(e,o):Array.isArray(o)===!0?isEquivalentArray(o,e):e===o}function isSameRouteLocationParams(e,o){if(Object.keys(e).length!==Object.keys(o).length)return!1;for(const r in e)if(isSameRouteLocationParamsValue(e[r],o[r])===!1)return!1;return!0}const useRouterLinkNonMatchingProps={to:[String,Object],replace:Boolean,href:String,target:String,disable:Boolean},useRouterLinkProps={...useRouterLinkNonMatchingProps,exact:Boolean,activeClass:{type:String,default:"q-router-link--active"},exactActiveClass:{type:String,default:"q-router-link--exact-active"}};function useRouterLink({fallbackTag:e,useDisableForRouterLinkProps:o=!0}={}){const r=getCurrentInstance(),{props:l,proxy:b,emit:E}=r,O=vmHasRouter(r),d=computed(()=>l.disable!==!0&&l.href!==void 0),u=o===!0?computed(()=>O===!0&&l.disable!==!0&&d.value!==!0&&l.to!==void 0&&l.to!==null&&l.to!==""):computed(()=>O===!0&&d.value!==!0&&l.to!==void 0&&l.to!==null&&l.to!==""),f=computed(()=>u.value===!0?D(l.to):null),S=computed(()=>f.value!==null),I=computed(()=>d.value===!0||S.value===!0),m=computed(()=>l.type==="a"||I.value===!0?"a":l.tag||e||"div"),s=computed(()=>d.value===!0?{href:l.href,target:l.target}:S.value===!0?{href:f.value.href,target:l.target}:{}),v=computed(()=>{if(S.value===!1)return-1;const{matched:F}=f.value,{length:M}=F,B=F[M-1];if(B===void 0)return-1;const K=b.$route.matched;if(K.length===0)return-1;const H=K.findIndex(isSameRouteRecord.bind(null,B));if(H!==-1)return H;const te=getOriginalPath(F[M-2]);return M>1&&getOriginalPath(B)===te&&K[K.length-1].path!==te?K.findIndex(isSameRouteRecord.bind(null,F[M-2])):H}),j=computed(()=>S.value===!0&&v.value!==-1&&includesParams(b.$route.params,f.value.params)),g=computed(()=>j.value===!0&&v.value===b.$route.matched.length-1&&isSameRouteLocationParams(b.$route.params,f.value.params)),T=computed(()=>S.value===!0?g.value===!0?` ${l.exactActiveClass} ${l.activeClass}`:l.exact===!0?"":j.value===!0?` ${l.activeClass}`:"":"");function D(F){try{return b.$router.resolve(F)}catch{}return null}function L(F,{returnRouterError:M,to:B=l.to,replace:K=l.replace}={}){if(l.disable===!0)return F.preventDefault(),Promise.resolve(!1);if(F.metaKey||F.altKey||F.ctrlKey||F.shiftKey||F.button!==void 0&&F.button!==0||l.target==="_blank")return Promise.resolve(!1);F.preventDefault();const H=b.$router[K===!0?"replace":"push"](B);return M===!0?H:H.then(()=>{}).catch(()=>{})}function _(F){if(S.value===!0){const M=B=>L(F,B);E("click",F,M),F.defaultPrevented!==!0&&M()}else E("click",F)}return{hasRouterLink:S,hasHrefLink:d,hasLink:I,linkTag:m,resolvedLink:f,linkIsActive:j,linkIsExactActive:g,linkClass:T,linkAttrs:s,getLink:D,navigateToRouterLink:L,navigateOnClick:_}}const QItem=createComponent({name:"QItem",props:{...useDarkProps,...useRouterLinkProps,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:o,emit:r}){const{proxy:{$q:l}}=getCurrentInstance(),b=useDark(e,l),{hasLink:E,linkAttrs:O,linkClass:d,linkTag:u,navigateOnClick:f}=useRouterLink(),S=ref(null),I=ref(null),m=computed(()=>e.clickable===!0||E.value===!0||e.tag==="label"),s=computed(()=>e.disable!==!0&&m.value===!0),v=computed(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(b.value===!0?" q-item--dark":"")+(E.value===!0&&e.active===null?d.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(s.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),j=computed(()=>e.insetLevel===void 0?null:{["padding"+(l.lang.rtl===!0?"Right":"Left")]:16+e.insetLevel*56+"px"});function g(L){s.value===!0&&(I.value!==null&&L.qAvoidFocus!==!0&&(L.qKeyEvent!==!0&&document.activeElement===S.value?I.value.focus():document.activeElement===I.value&&S.value.focus()),f(L))}function T(L){if(s.value===!0&&isKeyCode(L,[13,32])===!0){stopAndPrevent(L),L.qKeyEvent=!0;const _=new MouseEvent("click",L);_.qKeyEvent=!0,S.value.dispatchEvent(_)}r("keyup",L)}function D(){const L=hUniqueSlot(o.default,[]);return s.value===!0&&L.unshift(h("div",{class:"q-focus-helper",tabindex:-1,ref:I})),L}return()=>{const L={ref:S,class:v.value,style:j.value,role:"listitem",onClick:g,onKeyup:T};return s.value===!0?(L.tabindex=e.tabindex||"0",Object.assign(L,O.value)):m.value===!0&&(L["aria-disabled"]="true"),h(u.value,L,D())}}}),QItemSection=createComponent({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:o}){const r=computed(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>h("div",{class:r.value},hSlot(o.default))}}),QItemLabel=createComponent({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:o}){const r=computed(()=>parseInt(e.lines,10)),l=computed(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(r.value===1?" ellipsis":"")),b=computed(()=>e.lines!==void 0&&r.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":r.value}:null);return()=>h("div",{style:b.value,class:l.value},hSlot(o.default))}});function clearSelection(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),Platform.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const useAnchorStaticProps={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},useAnchorProps={...useAnchorStaticProps,contextMenu:Boolean};function useAnchor({showing:e,avoidEmit:o,configureAnchorEl:r}){const{props:l,proxy:b,emit:E}=getCurrentInstance(),O=ref(null);let d=null;function u(s){return O.value===null?!1:s===void 0||s.touches===void 0||s.touches.length<=1}const f={};r===void 0&&(Object.assign(f,{hide(s){b.hide(s)},toggle(s){b.toggle(s),s.qAnchorHandled=!0},toggleKey(s){isKeyCode(s,13)===!0&&f.toggle(s)},contextClick(s){b.hide(s),prevent(s),nextTick(()=>{b.show(s),s.qAnchorHandled=!0})},prevent,mobileTouch(s){if(f.mobileCleanup(s),u(s)!==!0)return;b.hide(s),O.value.classList.add("non-selectable");const v=s.target;addEvt(f,"anchor",[[v,"touchmove","mobileCleanup","passive"],[v,"touchend","mobileCleanup","passive"],[v,"touchcancel","mobileCleanup","passive"],[O.value,"contextmenu","prevent","notPassive"]]),d=setTimeout(()=>{d=null,b.show(s),s.qAnchorHandled=!0},300)},mobileCleanup(s){O.value.classList.remove("non-selectable"),d!==null&&(clearTimeout(d),d=null),e.value===!0&&s!==void 0&&clearSelection()}}),r=function(s=l.contextMenu){if(l.noParentEvent===!0||O.value===null)return;let v;s===!0?b.$q.platform.is.mobile===!0?v=[[O.value,"touchstart","mobileTouch","passive"]]:v=[[O.value,"mousedown","hide","passive"],[O.value,"contextmenu","contextClick","notPassive"]]:v=[[O.value,"click","toggle","passive"],[O.value,"keyup","toggleKey","passive"]],addEvt(f,"anchor",v)});function S(){cleanEvt(f,"anchor")}function I(s){for(O.value=s;O.value.classList.contains("q-anchor--skip");)O.value=O.value.parentNode;r()}function m(){if(l.target===!1||l.target===""||b.$el.parentNode===null)O.value=null;else if(l.target===!0)I(b.$el.parentNode);else{let s=l.target;if(typeof l.target=="string")try{s=document.querySelector(l.target)}catch{s=void 0}s!=null?(O.value=s.$el||s,r()):(O.value=null,console.error(`Anchor: target "${l.target}" not found`))}}return watch(()=>l.contextMenu,s=>{O.value!==null&&(S(),r(s))}),watch(()=>l.target,()=>{O.value!==null&&S(),m()}),watch(()=>l.noParentEvent,s=>{O.value!==null&&(s===!0?S():r())}),onMounted(()=>{m(),o!==!0&&l.modelValue===!0&&O.value===null&&E("update:modelValue",!1)}),onBeforeUnmount(()=>{d!==null&&clearTimeout(d),S()}),{anchorEl:O,canShow:u,anchorEvents:f}}function useScrollTarget(e,o){const r=ref(null);let l;function b(d,u){const f=`${u!==void 0?"add":"remove"}EventListener`,S=u!==void 0?u:l;d!==window&&d[f]("scroll",S,listenOpts.passive),window[f]("scroll",S,listenOpts.passive),l=u}function E(){r.value!==null&&(b(r.value),r.value=null)}const O=watch(()=>e.noParentEvent,()=>{r.value!==null&&(E(),o())});return onBeforeUnmount(O),{localScrollTarget:r,unconfigureScrollTarget:E,changeScrollEvent:b}}const useModelToggleProps={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},useModelToggleEmits=["beforeShow","show","beforeHide","hide"];function useModelToggle({showing:e,canShow:o,hideOnRouteChange:r,handleShow:l,handleHide:b,processOnMount:E}){const O=getCurrentInstance(),{props:d,emit:u,proxy:f}=O;let S;function I(D){e.value===!0?v(D):m(D)}function m(D){if(d.disable===!0||(D==null?void 0:D.qAnchorHandled)===!0||o!==void 0&&o(D)!==!0)return;const L=d["onUpdate:modelValue"]!==void 0;L===!0&&(u("update:modelValue",!0),S=D,nextTick(()=>{S===D&&(S=void 0)})),(d.modelValue===null||L===!1)&&s(D)}function s(D){e.value!==!0&&(e.value=!0,u("beforeShow",D),l!==void 0?l(D):u("show",D))}function v(D){if(d.disable===!0)return;const L=d["onUpdate:modelValue"]!==void 0;L===!0&&(u("update:modelValue",!1),S=D,nextTick(()=>{S===D&&(S=void 0)})),(d.modelValue===null||L===!1)&&j(D)}function j(D){e.value!==!1&&(e.value=!1,u("beforeHide",D),b!==void 0?b(D):u("hide",D))}function g(D){d.disable===!0&&D===!0?d["onUpdate:modelValue"]!==void 0&&u("update:modelValue",!1):D===!0!==e.value&&(D===!0?s:j)(S)}watch(()=>d.modelValue,g),r!==void 0&&vmHasRouter(O)===!0&&watch(()=>f.$route.fullPath,()=>{r.value===!0&&e.value===!0&&v()}),onMounted(()=>{g(d.modelValue)});const T={show:m,hide:v,toggle:I};return Object.assign(f,T),T}let portalIndex=1,target=document.body;function createGlobalNode(e,o){const r=document.createElement("div");if(r.id=o!==void 0?`q-portal--${o}--${portalIndex++}`:e,globalConfig.globalNodes!==void 0){const l=globalConfig.globalNodes.class;l!==void 0&&(r.className=l)}return target.appendChild(r),r}function removeGlobalNode(e){e.remove()}const portalProxyList=[];function getPortalProxy(e){return portalProxyList.find(o=>o.contentEl!==null&&o.contentEl.contains(e))}function closePortalMenus(e,o){do{if(e.$options.name==="QMenu"){if(e.hide(o),e.$props.separateClosePopup===!0)return getParentProxy(e)}else if(e.__qPortal===!0){const r=getParentProxy(e);return(r==null?void 0:r.$options.name)==="QPopupProxy"?(e.hide(o),r):e}e=getParentProxy(e)}while(e!=null)}function closePortals(e,o,r){for(;r!==0&&e!==void 0&&e!==null;){if(e.__qPortal===!0){if(r--,e.$options.name==="QMenu"){e=closePortalMenus(e,o);continue}e.hide(o)}e=getParentProxy(e)}}const QPortal=createComponent({name:"QPortal",setup(e,{slots:o}){return()=>o.default()}});function isOnGlobalDialog(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function usePortal(e,o,r,l){const b=ref(!1),E=ref(!1);let O=null;const d={},u=l==="dialog"&&isOnGlobalDialog(e);function f(I){if(I===!0){removeFocusWaitFlag(d),E.value=!0;return}E.value=!1,b.value===!1&&(u===!1&&O===null&&(O=createGlobalNode(!1,l)),b.value=!0,portalProxyList.push(e.proxy),addFocusWaitFlag(d))}function S(I){if(E.value=!1,I!==!0)return;removeFocusWaitFlag(d),b.value=!1;const m=portalProxyList.indexOf(e.proxy);m!==-1&&portalProxyList.splice(m,1),O!==null&&(removeGlobalNode(O),O=null)}return onUnmounted(()=>{S(!0)}),e.proxy.__qPortal=!0,injectProp(e.proxy,"contentEl",()=>o.value),{showPortal:f,hidePortal:S,portalIsActive:b,portalIsAccessible:E,renderPortal:()=>u===!0?r():b.value===!0?[h(Teleport,{to:O},h(QPortal,r))]:void 0}}const useTransitionProps={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function useTransition(e,o=()=>{},r=()=>{}){return{transitionProps:computed(()=>{const l=`q-transition--${e.transitionShow||o()}`,b=`q-transition--${e.transitionHide||r()}`;return{appear:!0,enterFromClass:`${l}-enter-from`,enterActiveClass:`${l}-enter-active`,enterToClass:`${l}-enter-to`,leaveFromClass:`${b}-leave-from`,leaveActiveClass:`${b}-leave-active`,leaveToClass:`${b}-leave-to`}}),transitionStyle:computed(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}function useTick(){let e;const o=getCurrentInstance();function r(){e=void 0}return onDeactivated(r),onBeforeUnmount(r),{removeTick:r,registerTick(l){e=l,nextTick(()=>{e===l&&(vmIsDestroyed(o)===!1&&e(),e=void 0)})}}}function useTimeout(){let e=null;const o=getCurrentInstance();function r(){e!==null&&(clearTimeout(e),e=null)}return onDeactivated(r),onBeforeUnmount(r),{removeTimeout:r,registerTimeout(l,b){r(),vmIsDestroyed(o)===!1&&(e=setTimeout(()=>{e=null,l()},b))}}}const scrollTargetProp=[Element,String],scrollTargets=[null,document,document.body,document.scrollingElement,document.documentElement];function getScrollTarget(e,o){let r=getElement(o);if(r===void 0){if(e==null)return window;r=e.closest(".scroll,.scroll-y,.overflow-auto")}return scrollTargets.includes(r)?window:r}function getVerticalScrollPosition(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function getHorizontalScrollPosition(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}let size;function getScrollbarWidth(){if(size!==void 0)return size;const e=document.createElement("p"),o=document.createElement("div");css(e,{width:"100%",height:"200px"}),css(o,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),o.appendChild(e),document.body.appendChild(o);const r=e.offsetWidth;o.style.overflow="scroll";let l=e.offsetWidth;return r===l&&(l=o.clientWidth),o.remove(),size=r-l,size}function hasScrollbar(e,o=!0){return!e||e.nodeType!==Node.ELEMENT_NODE?!1:o?e.scrollHeight>e.clientHeight&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-y"])):e.scrollWidth>e.clientWidth&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-x"]))}const handlers$1=[];let escDown;function onKeydown(e){escDown=e.keyCode===27}function onBlur(){escDown===!0&&(escDown=!1)}function onKeyup(e){escDown===!0&&(escDown=!1,isKeyCode(e,27)===!0&&handlers$1[handlers$1.length-1](e))}function update(e){window[e]("keydown",onKeydown),window[e]("blur",onBlur),window[e]("keyup",onKeyup),escDown=!1}function addEscapeKey(e){client.is.desktop===!0&&(handlers$1.push(e),handlers$1.length===1&&update("addEventListener"))}function removeEscapeKey(e){const o=handlers$1.indexOf(e);o!==-1&&(handlers$1.splice(o,1),handlers$1.length===0&&update("removeEventListener"))}const handlers=[];function trigger(e){handlers[handlers.length-1](e)}function addFocusout(e){client.is.desktop===!0&&(handlers.push(e),handlers.length===1&&document.body.addEventListener("focusin",trigger))}function removeFocusout(e){const o=handlers.indexOf(e);o!==-1&&(handlers.splice(o,1),handlers.length===0&&document.body.removeEventListener("focusin",trigger))}const{notPassiveCapture}=listenOpts,registeredList=[];function globalHandler(e){const o=e.target;if(o===void 0||o.nodeType===8||o.classList.contains("no-pointer-events")===!0)return;let r=portalProxyList.length-1;for(;r>=0;){const l=portalProxyList[r].$;if(l.type.name==="QTooltip"){r--;continue}if(l.type.name!=="QDialog")break;if(l.props.seamless!==!0)return;r--}for(let l=registeredList.length-1;l>=0;l--){const b=registeredList[l];if((b.anchorEl.value===null||b.anchorEl.value.contains(o)===!1)&&(o===document.body||b.innerRef.value!==null&&b.innerRef.value.contains(o)===!1))e.qClickOutside=!0,b.onClickOutside(e);else return}}function addClickOutside(e){registeredList.push(e),registeredList.length===1&&(document.addEventListener("mousedown",globalHandler,notPassiveCapture),document.addEventListener("touchstart",globalHandler,notPassiveCapture))}function removeClickOutside(e){const o=registeredList.findIndex(r=>r===e);o!==-1&&(registeredList.splice(o,1),registeredList.length===0&&(document.removeEventListener("mousedown",globalHandler,notPassiveCapture),document.removeEventListener("touchstart",globalHandler,notPassiveCapture)))}let vpLeft,vpTop;function validatePosition(e){const o=e.split(" ");return o.length!==2?!1:["top","center","bottom"].includes(o[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(o[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function validateOffset(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const horizontalPos={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{horizontalPos[`${e}#ltr`]=e,horizontalPos[`${e}#rtl`]=e});function parsePosition(e,o){const r=e.split(" ");return{vertical:r[0],horizontal:horizontalPos[`${r[1]}#${o===!0?"rtl":"ltr"}`]}}function getAnchorProps(e,o){let{top:r,left:l,right:b,bottom:E,width:O,height:d}=e.getBoundingClientRect();return o!==void 0&&(r-=o[1],l-=o[0],E+=o[1],b+=o[0],O+=o[0],d+=o[1]),{top:r,bottom:E,height:d,left:l,right:b,width:O,middle:l+(b-l)/2,center:r+(E-r)/2}}function getAbsoluteAnchorProps(e,o,r){let{top:l,left:b}=e.getBoundingClientRect();return l+=o.top,b+=o.left,r!==void 0&&(l+=r[1],b+=r[0]),{top:l,bottom:l+1,height:1,left:b,right:b+1,width:1,middle:b,center:l}}function getTargetProps(e,o){return{top:0,center:o/2,bottom:o,left:0,middle:e/2,right:e}}function getTopLeftProps(e,o,r,l){return{top:e[r.vertical]-o[l.vertical],left:e[r.horizontal]-o[l.horizontal]}}function setPosition(e,o=0){if(e.targetEl===null||e.anchorEl===null||o>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{setPosition(e,o+1)},10);return}const{targetEl:r,offset:l,anchorEl:b,anchorOrigin:E,selfOrigin:O,absoluteOffset:d,fit:u,cover:f,maxHeight:S,maxWidth:I}=e;if(client.is.ios===!0&&window.visualViewport!==void 0){const M=document.body.style,{offsetLeft:B,offsetTop:K}=window.visualViewport;B!==vpLeft&&(M.setProperty("--q-pe-left",B+"px"),vpLeft=B),K!==vpTop&&(M.setProperty("--q-pe-top",K+"px"),vpTop=K)}const{scrollLeft:m,scrollTop:s}=r,v=d===void 0?getAnchorProps(b,f===!0?[0,0]:l):getAbsoluteAnchorProps(b,d,l);Object.assign(r.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:I,maxHeight:S,visibility:"visible"});const{offsetWidth:j,offsetHeight:g}=r,{elWidth:T,elHeight:D}=u===!0||f===!0?{elWidth:Math.max(v.width,j),elHeight:f===!0?Math.max(v.height,g):g}:{elWidth:j,elHeight:g};let L={maxWidth:I,maxHeight:S};(u===!0||f===!0)&&(L.minWidth=v.width+"px",f===!0&&(L.minHeight=v.height+"px")),Object.assign(r.style,L);const _=getTargetProps(T,D);let F=getTopLeftProps(v,_,E,O);if(d===void 0||l===void 0)applyBoundaries(F,v,_,E,O);else{const{top:M,left:B}=F;applyBoundaries(F,v,_,E,O);let K=!1;if(F.top!==M){K=!0;const H=2*l[1];v.center=v.top-=H,v.bottom-=H+2}if(F.left!==B){K=!0;const H=2*l[0];v.middle=v.left-=H,v.right-=H+2}K===!0&&(F=getTopLeftProps(v,_,E,O),applyBoundaries(F,v,_,E,O))}L={top:F.top+"px",left:F.left+"px"},F.maxHeight!==void 0&&(L.maxHeight=F.maxHeight+"px",v.height>F.maxHeight&&(L.minHeight=L.maxHeight)),F.maxWidth!==void 0&&(L.maxWidth=F.maxWidth+"px",v.width>F.maxWidth&&(L.minWidth=L.maxWidth)),Object.assign(r.style,L),r.scrollTop!==s&&(r.scrollTop=s),r.scrollLeft!==m&&(r.scrollLeft=m)}function applyBoundaries(e,o,r,l,b){const E=r.bottom,O=r.right,d=getScrollbarWidth(),u=window.innerHeight-d,f=document.body.clientWidth;if(e.top<0||e.top+E>u)if(b.vertical==="center")e.top=o[l.vertical]>u/2?Math.max(0,u-E):0,e.maxHeight=Math.min(E,u);else if(o[l.vertical]>u/2){const S=Math.min(u,l.vertical==="center"?o.center:l.vertical===b.vertical?o.bottom:o.top);e.maxHeight=Math.min(E,S),e.top=Math.max(0,S-E)}else e.top=Math.max(0,l.vertical==="center"?o.center:l.vertical===b.vertical?o.top:o.bottom),e.maxHeight=Math.min(E,u-e.top);if(e.left<0||e.left+O>f)if(e.maxWidth=Math.min(O,f),b.horizontal==="middle")e.left=o[l.horizontal]>f/2?Math.max(0,f-O):0;else if(o[l.horizontal]>f/2){const S=Math.min(f,l.horizontal==="middle"?o.middle:l.horizontal===b.horizontal?o.right:o.left);e.maxWidth=Math.min(O,S),e.left=Math.max(0,S-e.maxWidth)}else e.left=Math.max(0,l.horizontal==="middle"?o.middle:l.horizontal===b.horizontal?o.left:o.right),e.maxWidth=Math.min(O,f-e.left)}const QMenu=createComponent({name:"QMenu",inheritAttrs:!1,props:{...useAnchorProps,...useModelToggleProps,...useDarkProps,...useTransitionProps,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:validatePosition},self:{type:String,validator:validatePosition},offset:{type:Array,validator:validateOffset},scrollTarget:scrollTargetProp,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...useModelToggleEmits,"click","escapeKey"],setup(e,{slots:o,emit:r,attrs:l}){let b=null,E,O,d;const u=getCurrentInstance(),{proxy:f}=u,{$q:S}=f,I=ref(null),m=ref(!1),s=computed(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),v=useDark(e,S),{registerTick:j,removeTick:g}=useTick(),{registerTimeout:T}=useTimeout(),{transitionProps:D,transitionStyle:L}=useTransition(e),{localScrollTarget:_,changeScrollEvent:F,unconfigureScrollTarget:M}=useScrollTarget(e,Ce),{anchorEl:B,canShow:K}=useAnchor({showing:m}),{hide:H}=useModelToggle({showing:m,canShow:K,handleShow:Fe,handleHide:je,hideOnRouteChange:s,processOnMount:!0}),{showPortal:te,hidePortal:se,renderPortal:Q}=usePortal(u,I,ke,"menu"),pe={anchorEl:B,innerRef:I,onClickOutside(Ee){if(e.persistent!==!0&&m.value===!0)return H(Ee),(Ee.type==="touchstart"||Ee.target.classList.contains("q-dialog__backdrop"))&&stopAndPrevent(Ee),!0}},fe=computed(()=>parsePosition(e.anchor||(e.cover===!0?"center middle":"bottom start"),S.lang.rtl)),me=computed(()=>e.cover===!0?fe.value:parsePosition(e.self||"top start",S.lang.rtl)),oe=computed(()=>(e.square===!0?" q-menu--square":"")+(v.value===!0?" q-menu--dark q-dark":"")),Pe=computed(()=>e.autoClose===!0?{onClick:Be}:{}),Ae=computed(()=>m.value===!0&&e.persistent!==!0);watch(Ae,Ee=>{Ee===!0?(addEscapeKey(Me),addClickOutside(pe)):(removeEscapeKey(Me),removeClickOutside(pe))});function Ne(){addFocusFn(()=>{let Ee=I.value;Ee&&Ee.contains(document.activeElement)!==!0&&(Ee=Ee.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||Ee.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||Ee.querySelector("[autofocus], [data-autofocus]")||Ee,Ee.focus({preventScroll:!0}))})}function Fe(Ee){if(b=e.noRefocus===!1?document.activeElement:null,addFocusout(et),te(),Ce(),E=void 0,Ee!==void 0&&(e.touchPosition||e.contextMenu)){const Ye=position(Ee);if(Ye.left!==void 0){const{top:Ge,left:lt}=B.value.getBoundingClientRect();E={left:Ye.left-lt,top:Ye.top-Ge}}}O===void 0&&(O=watch(()=>S.screen.width+"|"+S.screen.height+"|"+e.self+"|"+e.anchor+"|"+S.lang.rtl,ye)),e.noFocus!==!0&&document.activeElement.blur(),j(()=>{ye(),e.noFocus!==!0&&Ne()}),T(()=>{S.platform.is.ios===!0&&(d=e.autoClose,I.value.click()),ye(),te(!0),r("show",Ee)},e.transitionDuration)}function je(Ee){g(),se(),P(!0),b!==null&&(Ee===void 0||Ee.qClickOutside!==!0)&&((((Ee==null?void 0:Ee.type.indexOf("key"))===0?b.closest('[tabindex]:not([tabindex^="-"])'):void 0)||b).focus(),b=null),T(()=>{se(!0),r("hide",Ee)},e.transitionDuration)}function P(Ee){E=void 0,O!==void 0&&(O(),O=void 0),(Ee===!0||m.value===!0)&&(removeFocusout(et),M(),removeClickOutside(pe),removeEscapeKey(Me)),Ee!==!0&&(b=null)}function Ce(){(B.value!==null||e.scrollTarget!==void 0)&&(_.value=getScrollTarget(B.value,e.scrollTarget),F(_.value,ye))}function Be(Ee){d!==!0?(closePortalMenus(f,Ee),r("click",Ee)):d=!1}function et(Ee){Ae.value===!0&&e.noFocus!==!0&&childHasFocus(I.value,Ee.target)!==!0&&Ne()}function Me(Ee){e.noEscDismiss!==!0&&(r("escapeKey"),H(Ee))}function ye(){setPosition({targetEl:I.value,offset:e.offset,anchorEl:B.value,anchorOrigin:fe.value,selfOrigin:me.value,absoluteOffset:E,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ke(){return h(Transition,D.value,()=>m.value===!0?h("div",{role:"menu",...l,ref:I,tabindex:-1,class:["q-menu q-position-engine scroll"+oe.value,l.class],style:[l.style,L.value],...Pe.value},hSlot(o.default)):null)}return onBeforeUnmount(P),Object.assign(f,{focus:Ne,updatePosition:ye}),Q}});function useHistory(e,o,r){let l;function b(){l!==void 0&&(History.remove(l),l=void 0)}return onBeforeUnmount(()=>{e.value===!0&&b()}),{removeFromHistory:b,addToHistory(){l={condition:()=>r.value===!0,handler:o},History.add(l)}}}let registered=0,scrollPositionX,scrollPositionY,maxScrollTop,vpPendingUpdate=!1,bodyLeft,bodyTop,href,closeTimer=null;function onWheel(e){shouldPreventScroll(e)&&stopAndPrevent(e)}function shouldPreventScroll(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const o=getEventPath(e),r=e.shiftKey&&!e.deltaX,l=!r&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),b=r||l?e.deltaY:e.deltaX;for(let E=0;E<o.length;E++){const O=o[E];if(hasScrollbar(O,l))return l?b<0&&O.scrollTop===0?!0:b>0&&O.scrollTop+O.clientHeight===O.scrollHeight:b<0&&O.scrollLeft===0?!0:b>0&&O.scrollLeft+O.clientWidth===O.scrollWidth}return!0}function onAppleScroll(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function onAppleResize(e){vpPendingUpdate!==!0&&(vpPendingUpdate=!0,requestAnimationFrame(()=>{vpPendingUpdate=!1;const{height:o}=e.target,{clientHeight:r,scrollTop:l}=document.scrollingElement;(maxScrollTop===void 0||o!==window.innerHeight)&&(maxScrollTop=r-o,document.scrollingElement.scrollTop=l),l>maxScrollTop&&(document.scrollingElement.scrollTop-=Math.ceil((l-maxScrollTop)/8))}))}function apply(e){const o=document.body,r=window.visualViewport!==void 0;if(e==="add"){const{overflowY:l,overflowX:b}=window.getComputedStyle(o);scrollPositionX=getHorizontalScrollPosition(window),scrollPositionY=getVerticalScrollPosition(window),bodyLeft=o.style.left,bodyTop=o.style.top,href=window.location.href,o.style.left=`-${scrollPositionX}px`,o.style.top=`-${scrollPositionY}px`,b!=="hidden"&&(b==="scroll"||o.scrollWidth>window.innerWidth)&&o.classList.add("q-body--force-scrollbar-x"),l!=="hidden"&&(l==="scroll"||o.scrollHeight>window.innerHeight)&&o.classList.add("q-body--force-scrollbar-y"),o.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,client.is.ios===!0&&(r===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",onAppleResize,listenOpts.passiveCapture),window.visualViewport.addEventListener("scroll",onAppleResize,listenOpts.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",onAppleScroll,listenOpts.passiveCapture))}client.is.desktop===!0&&client.is.mac===!0&&window[`${e}EventListener`]("wheel",onWheel,listenOpts.notPassive),e==="remove"&&(client.is.ios===!0&&(r===!0?(window.visualViewport.removeEventListener("resize",onAppleResize,listenOpts.passiveCapture),window.visualViewport.removeEventListener("scroll",onAppleResize,listenOpts.passiveCapture)):window.removeEventListener("scroll",onAppleScroll,listenOpts.passiveCapture)),o.classList.remove("q-body--prevent-scroll"),o.classList.remove("q-body--force-scrollbar-x"),o.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,o.style.left=bodyLeft,o.style.top=bodyTop,window.location.href===href&&window.scrollTo(scrollPositionX,scrollPositionY),maxScrollTop=void 0)}function preventScroll(e){let o="add";if(e===!0){if(registered++,closeTimer!==null){clearTimeout(closeTimer),closeTimer=null;return}if(registered>1)return}else{if(registered===0||(registered--,registered>0))return;if(o="remove",client.is.ios===!0&&client.is.nativeMobile===!0){closeTimer!==null&&clearTimeout(closeTimer),closeTimer=setTimeout(()=>{apply(o),closeTimer=null},100);return}}apply(o)}function usePreventScroll(){let e;return{preventBodyScroll(o){o!==e&&(e!==void 0||o===!0)&&(e=o,preventScroll(o))}}}let maximizedModals=0;const positionClass={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},defaultTransitions={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},QDialog=createComponent({name:"QDialog",inheritAttrs:!1,props:{...useModelToggleProps,...useTransitionProps,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...useModelToggleEmits,"shake","click","escapeKey"],setup(e,{slots:o,emit:r,attrs:l}){const b=getCurrentInstance(),E=ref(null),O=ref(!1),d=ref(!1);let u=null,f=null,S,I;const m=computed(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:s}=usePreventScroll(),{registerTimeout:v}=useTimeout(),{registerTick:j,removeTick:g}=useTick(),{transitionProps:T,transitionStyle:D}=useTransition(e,()=>defaultTransitions[e.position][0],()=>defaultTransitions[e.position][1]),L=computed(()=>D.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:_,hidePortal:F,portalIsAccessible:M,renderPortal:B}=usePortal(b,E,et,"dialog"),{hide:K}=useModelToggle({showing:O,hideOnRouteChange:m,handleShow:me,handleHide:oe,processOnMount:!0}),{addToHistory:H,removeFromHistory:te}=useHistory(O,K,m),se=computed(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${positionClass[e.position]}`+(d.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),Q=computed(()=>O.value===!0&&e.seamless!==!0),pe=computed(()=>e.autoClose===!0?{onClick:P}:{}),fe=computed(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${Q.value===!0?"modal":"seamless"}`,l.class]);watch(()=>e.maximized,Me=>{O.value===!0&&je(Me)}),watch(Q,Me=>{s(Me),Me===!0?(addFocusout(Be),addEscapeKey(Ne)):(removeFocusout(Be),removeEscapeKey(Ne))});function me(Me){var ye;H(),f=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,je(e.maximized),_(),d.value=!0,e.noFocus!==!0?((ye=document.activeElement)==null||ye.blur(),j(Pe)):g(),v(()=>{if(b.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:ke,bottom:Ee}=document.activeElement.getBoundingClientRect(),{innerHeight:Ye}=window,Ge=window.visualViewport!==void 0?window.visualViewport.height:Ye;ke>0&&Ee>Ge/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-Ge,Ee>=Ye?1/0:Math.ceil(document.scrollingElement.scrollTop+Ee-Ge/2))),document.activeElement.scrollIntoView()}I=!0,E.value.click(),I=!1}_(!0),d.value=!1,r("show",Me)},e.transitionDuration)}function oe(Me){g(),te(),Fe(!0),d.value=!0,F(),f!==null&&((((Me==null?void 0:Me.type.indexOf("key"))===0?f.closest('[tabindex]:not([tabindex^="-"])'):void 0)||f).focus(),f=null),v(()=>{F(!0),d.value=!1,r("hide",Me)},e.transitionDuration)}function Pe(Me){addFocusFn(()=>{let ye=E.value;if(ye!==null){if(Me!==void 0){const ke=ye.querySelector(Me);if(ke!==null){ke.focus({preventScroll:!0});return}}ye.contains(document.activeElement)!==!0&&(ye=ye.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||ye.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||ye.querySelector("[autofocus], [data-autofocus]")||ye,ye.focus({preventScroll:!0}))}})}function Ae(Me){Me&&typeof Me.focus=="function"?Me.focus({preventScroll:!0}):Pe(),r("shake");const ye=E.value;ye!==null&&(ye.classList.remove("q-animate--scale"),ye.classList.add("q-animate--scale"),u!==null&&clearTimeout(u),u=setTimeout(()=>{u=null,E.value!==null&&(ye.classList.remove("q-animate--scale"),Pe())},170))}function Ne(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&Ae():(r("escapeKey"),K()))}function Fe(Me){u!==null&&(clearTimeout(u),u=null),(Me===!0||O.value===!0)&&(je(!1),e.seamless!==!0&&(s(!1),removeFocusout(Be),removeEscapeKey(Ne))),Me!==!0&&(f=null)}function je(Me){Me===!0?S!==!0&&(maximizedModals<1&&document.body.classList.add("q-body--dialog"),maximizedModals++,S=!0):S===!0&&(maximizedModals<2&&document.body.classList.remove("q-body--dialog"),maximizedModals--,S=!1)}function P(Me){I!==!0&&(K(Me),r("click",Me))}function Ce(Me){e.persistent!==!0&&e.noBackdropDismiss!==!0?K(Me):e.noShake!==!0&&Ae()}function Be(Me){e.allowFocusOutside!==!0&&M.value===!0&&childHasFocus(E.value,Me.target)!==!0&&Pe('[tabindex]:not([tabindex="-1"])')}Object.assign(b.proxy,{focus:Pe,shake:Ae,__updateRefocusTarget(Me){f=Me||null}}),onBeforeUnmount(Fe);function et(){return h("div",{role:"dialog","aria-modal":Q.value===!0?"true":"false",...l,class:fe.value},[h(Transition,{name:"q-transition--fade",appear:!0},()=>Q.value===!0?h("div",{class:"q-dialog__backdrop fixed-full",style:L.value,"aria-hidden":"true",tabindex:-1,onClick:Ce}):null),h(Transition,T.value,()=>O.value===!0?h("div",{ref:E,class:se.value,style:D.value,tabindex:-1,...pe.value},hSlot(o.default)):null)])}return B}});let rtlHasScrollBug=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const o=document.createElement("div");Object.assign(o.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(o),e.scrollLeft=-1e3,rtlHasScrollBug=e.scrollLeft>=0,e.remove()}const aggBucketSize=1e3,scrollToEdges=["start","center","end","start-force","center-force","end-force"],filterProto=Array.prototype.filter,setOverflowAnchor=window.getComputedStyle(document.body).overflowAnchor===void 0?noop:function(e,o){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const r=e.children||[];filterProto.call(r,b=>b.dataset&&b.dataset.qVsAnchor!==void 0).forEach(b=>{delete b.dataset.qVsAnchor});const l=r[o];l!=null&&l.dataset&&(l.dataset.qVsAnchor="")}))};function sumFn(e,o){return e+o}function getScrollDetails(e,o,r,l,b,E,O,d){const u=e===window?document.scrollingElement||document.documentElement:e,f=b===!0?"offsetWidth":"offsetHeight",S={scrollStart:0,scrollViewSize:-O-d,scrollMaxSize:0,offsetStart:-O,offsetEnd:-d};if(b===!0?(e===window?(S.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,S.scrollViewSize+=document.documentElement.clientWidth):(S.scrollStart=u.scrollLeft,S.scrollViewSize+=u.clientWidth),S.scrollMaxSize=u.scrollWidth,E===!0&&(S.scrollStart=(rtlHasScrollBug===!0?S.scrollMaxSize-S.scrollViewSize:0)-S.scrollStart)):(e===window?(S.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,S.scrollViewSize+=document.documentElement.clientHeight):(S.scrollStart=u.scrollTop,S.scrollViewSize+=u.clientHeight),S.scrollMaxSize=u.scrollHeight),r!==null)for(let I=r.previousElementSibling;I!==null;I=I.previousElementSibling)I.classList.contains("q-virtual-scroll--skip")===!1&&(S.offsetStart+=I[f]);if(l!==null)for(let I=l.nextElementSibling;I!==null;I=I.nextElementSibling)I.classList.contains("q-virtual-scroll--skip")===!1&&(S.offsetEnd+=I[f]);if(o!==e){const I=u.getBoundingClientRect(),m=o.getBoundingClientRect();b===!0?(S.offsetStart+=m.left-I.left,S.offsetEnd-=m.width):(S.offsetStart+=m.top-I.top,S.offsetEnd-=m.height),e!==window&&(S.offsetStart+=S.scrollStart),S.offsetEnd+=S.scrollMaxSize-S.offsetStart}return S}function setScroll(e,o,r,l){o==="end"&&(o=(e===window?document.body:e)[r===!0?"scrollWidth":"scrollHeight"]),e===window?r===!0?(l===!0&&(o=(rtlHasScrollBug===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-o),window.scrollTo(o,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,o):r===!0?(l===!0&&(o=(rtlHasScrollBug===!0?e.scrollWidth-e.offsetWidth:0)-o),e.scrollLeft=o):e.scrollTop=o}function sumSize(e,o,r,l){if(r>=l)return 0;const b=o.length,E=Math.floor(r/aggBucketSize),O=Math.floor((l-1)/aggBucketSize)+1;let d=e.slice(E,O).reduce(sumFn,0);return r%aggBucketSize!==0&&(d-=o.slice(E*aggBucketSize,r).reduce(sumFn,0)),l%aggBucketSize!==0&&l!==b&&(d-=o.slice(l,O*aggBucketSize).reduce(sumFn,0)),d}const commonVirtScrollProps={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},commonVirtScrollPropsList=Object.keys(commonVirtScrollProps),useVirtualScrollProps={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...commonVirtScrollProps};function useVirtualScroll({virtualScrollLength:e,getVirtualScrollTarget:o,getVirtualScrollEl:r,virtualScrollItemSizeComputed:l}){const b=getCurrentInstance(),{props:E,emit:O,proxy:d}=b,{$q:u}=d;let f,S,I,m=[],s;const v=ref(0),j=ref(0),g=ref({}),T=ref(null),D=ref(null),L=ref(null),_=ref({from:0,to:0}),F=computed(()=>E.tableColspan!==void 0?E.tableColspan:100);l===void 0&&(l=computed(()=>E.virtualScrollItemSize));const M=computed(()=>l.value+";"+E.virtualScrollHorizontal),B=computed(()=>M.value+";"+E.virtualScrollSliceRatioBefore+";"+E.virtualScrollSliceRatioAfter);watch(B,()=>{oe()}),watch(M,K);function K(){me(S,!0)}function H(je){me(je===void 0?S:je)}function te(je,P){const Ce=o();if(Ce==null||Ce.nodeType===8)return;const Be=getScrollDetails(Ce,r(),T.value,D.value,E.virtualScrollHorizontal,u.lang.rtl,E.virtualScrollStickySizeStart,E.virtualScrollStickySizeEnd);I!==Be.scrollViewSize&&oe(Be.scrollViewSize),Q(Ce,Be,Math.min(e.value-1,Math.max(0,parseInt(je,10)||0)),0,scrollToEdges.indexOf(P)!==-1?P:S!==-1&&je>S?"end":"start")}function se(){const je=o();if(je==null||je.nodeType===8)return;const P=getScrollDetails(je,r(),T.value,D.value,E.virtualScrollHorizontal,u.lang.rtl,E.virtualScrollStickySizeStart,E.virtualScrollStickySizeEnd),Ce=e.value-1,Be=P.scrollMaxSize-P.offsetStart-P.offsetEnd-j.value;if(f===P.scrollStart)return;if(P.scrollMaxSize<=0){Q(je,P,0,0);return}I!==P.scrollViewSize&&oe(P.scrollViewSize),pe(_.value.from);const et=Math.floor(P.scrollMaxSize-Math.max(P.scrollViewSize,P.offsetEnd)-Math.min(s[Ce],P.scrollViewSize/2));if(et>0&&Math.ceil(P.scrollStart)>=et){Q(je,P,Ce,P.scrollMaxSize-P.offsetEnd-m.reduce(sumFn,0));return}let Me=0,ye=P.scrollStart-P.offsetStart,ke=ye;if(ye<=Be&&ye+P.scrollViewSize>=v.value)ye-=v.value,Me=_.value.from,ke=ye;else for(let Ee=0;ye>=m[Ee]&&Me<Ce;Ee++)ye-=m[Ee],Me+=aggBucketSize;for(;ye>0&&Me<Ce;)ye-=s[Me],ye>-P.scrollViewSize?(Me++,ke=ye):ke=s[Me]+ye;Q(je,P,Me,ke)}function Q(je,P,Ce,Be,et){const Me=typeof et=="string"&&et.indexOf("-force")!==-1,ye=Me===!0?et.replace("-force",""):et,ke=ye!==void 0?ye:"start";let Ee=Math.max(0,Ce-g.value[ke]),Ye=Ee+g.value.total;Ye>e.value&&(Ye=e.value,Ee=Math.max(0,Ye-g.value.total)),f=P.scrollStart;const Ge=Ee!==_.value.from||Ye!==_.value.to;if(Ge===!1&&ye===void 0){Ae(Ce);return}const{activeElement:lt}=document,at=L.value;Ge===!0&&at!==null&&at!==lt&&at.contains(lt)===!0&&(at.addEventListener("focusout",fe),setTimeout(()=>{at==null||at.removeEventListener("focusout",fe)})),setOverflowAnchor(at,Ce-Ee);const ft=ye!==void 0?s.slice(Ee,Ce).reduce(sumFn,0):0;if(Ge===!0){const vt=Ye>=_.value.from&&Ee<=_.value.to?_.value.to:Ye;_.value={from:Ee,to:vt},v.value=sumSize(m,s,0,Ee),j.value=sumSize(m,s,Ye,e.value),requestAnimationFrame(()=>{_.value.to!==Ye&&f===P.scrollStart&&(_.value={from:_.value.from,to:Ye},j.value=sumSize(m,s,Ye,e.value))})}requestAnimationFrame(()=>{if(f!==P.scrollStart)return;Ge===!0&&pe(Ee);const vt=s.slice(Ee,Ce).reduce(sumFn,0),jt=vt+P.offsetStart+v.value,Tt=jt+s[Ce];let At=jt+Be;if(ye!==void 0){const Dt=vt-ft,Lt=P.scrollStart+Dt;At=Me!==!0&&Lt<jt&&Tt<Lt+P.scrollViewSize?Lt:ye==="end"?Tt-P.scrollViewSize:jt-(ye==="start"?0:Math.round((P.scrollViewSize-s[Ce])/2))}f=At,setScroll(je,At,E.virtualScrollHorizontal,u.lang.rtl),Ae(Ce)})}function pe(je){const P=L.value;if(P){const Ce=filterProto.call(P.children,Ee=>Ee.classList&&Ee.classList.contains("q-virtual-scroll--skip")===!1),Be=Ce.length,et=E.virtualScrollHorizontal===!0?Ee=>Ee.getBoundingClientRect().width:Ee=>Ee.offsetHeight;let Me=je,ye,ke;for(let Ee=0;Ee<Be;){for(ye=et(Ce[Ee]),Ee++;Ee<Be&&Ce[Ee].classList.contains("q-virtual-scroll--with-prev")===!0;)ye+=et(Ce[Ee]),Ee++;ke=ye-s[Me],ke!==0&&(s[Me]+=ke,m[Math.floor(Me/aggBucketSize)]+=ke),Me++}}}function fe(){var je;(je=L.value)==null||je.focus()}function me(je,P){const Ce=1*l.value;(P===!0||Array.isArray(s)===!1)&&(s=[]);const Be=s.length;s.length=e.value;for(let Me=e.value-1;Me>=Be;Me--)s[Me]=Ce;const et=Math.floor((e.value-1)/aggBucketSize);m=[];for(let Me=0;Me<=et;Me++){let ye=0;const ke=Math.min((Me+1)*aggBucketSize,e.value);for(let Ee=Me*aggBucketSize;Ee<ke;Ee++)ye+=s[Ee];m.push(ye)}S=-1,f=void 0,v.value=sumSize(m,s,0,_.value.from),j.value=sumSize(m,s,_.value.to,e.value),je>=0?(pe(_.value.from),nextTick(()=>{te(je)})):Ne()}function oe(je){if(je===void 0&&typeof window<"u"){const ye=o();ye!=null&&ye.nodeType!==8&&(je=getScrollDetails(ye,r(),T.value,D.value,E.virtualScrollHorizontal,u.lang.rtl,E.virtualScrollStickySizeStart,E.virtualScrollStickySizeEnd).scrollViewSize)}I=je;const P=parseFloat(E.virtualScrollSliceRatioBefore)||0,Ce=parseFloat(E.virtualScrollSliceRatioAfter)||0,Be=1+P+Ce,et=je===void 0||je<=0?1:Math.ceil(je/l.value),Me=Math.max(1,et,Math.ceil((E.virtualScrollSliceSize>0?E.virtualScrollSliceSize:10)/Be));g.value={total:Math.ceil(Me*Be),start:Math.ceil(Me*P),center:Math.ceil(Me*(.5+P)),end:Math.ceil(Me*(1+P)),view:et}}function Pe(je,P){const Ce=E.virtualScrollHorizontal===!0?"width":"height",Be={["--q-virtual-scroll-item-"+Ce]:l.value+"px"};return[je==="tbody"?h(je,{class:"q-virtual-scroll__padding",key:"before",ref:T},[h("tr",[h("td",{style:{[Ce]:`${v.value}px`,...Be},colspan:F.value})])]):h(je,{class:"q-virtual-scroll__padding",key:"before",ref:T,style:{[Ce]:`${v.value}px`,...Be}}),h(je,{class:"q-virtual-scroll__content",key:"content",ref:L,tabindex:-1},P.flat()),je==="tbody"?h(je,{class:"q-virtual-scroll__padding",key:"after",ref:D},[h("tr",[h("td",{style:{[Ce]:`${j.value}px`,...Be},colspan:F.value})])]):h(je,{class:"q-virtual-scroll__padding",key:"after",ref:D,style:{[Ce]:`${j.value}px`,...Be}})]}function Ae(je){S!==je&&(E.onVirtualScroll!==void 0&&O("virtualScroll",{index:je,from:_.value.from,to:_.value.to-1,direction:je<S?"decrease":"increase",ref:d}),S=je)}oe();const Ne=debounce(se,u.platform.is.ios===!0?120:35);onBeforeMount(()=>{oe()});let Fe=!1;return onDeactivated(()=>{Fe=!0}),onActivated(()=>{if(Fe!==!0)return;const je=o();f!==void 0&&je!==void 0&&je!==null&&je.nodeType!==8?setScroll(je,f,E.virtualScrollHorizontal,u.lang.rtl):te(S)}),onBeforeUnmount(()=>{Ne.cancel()}),Object.assign(d,{scrollTo:te,reset:K,refresh:H}),{virtualScrollSliceRange:_,virtualScrollSliceSizeComputed:g,setVirtualScrollSize:oe,onVirtualScrollEvt:Ne,localResetVirtualScroll:me,padVirtualScroll:Pe,scrollTo:te,reset:K,refresh:H}}const useFormProps={name:String};function useFormInject(e={}){return(o,r,l)=>{o[r](h("input",{class:"hidden"+(l||""),...e.value}))}}function useFormInputNameAttr(e){return computed(()=>e.name||e.for)}const isJapanese=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,isChinese=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,isKorean=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,isPlainText=/[a-z0-9_ -]$/i;function useKeyComposition(e){return function(r){if(r.type==="compositionend"||r.type==="change"){if(r.target.qComposing!==!0)return;r.target.qComposing=!1,e(r)}else r.type==="compositionupdate"&&r.target.qComposing!==!0&&typeof r.data=="string"&&(client.is.firefox===!0?isPlainText.test(r.data)===!1:isJapanese.test(r.data)===!0||isChinese.test(r.data)===!0||isKorean.test(r.data)===!0)===!0&&(r.target.qComposing=!0)}}function normalizeToInterval(e,o,r){if(r<=o)return o;const l=r-o+1;let b=o+(e-o)%l;return b<o&&(b=l+b),b===0?0:b}const validateNewValueMode=e=>["add","add-unique","toggle"].includes(e),reEscapeList=".*+?^${}()|[]\\",fieldPropsList=Object.keys(useFieldProps);function getPropValueFn(e,o){if(typeof e=="function")return e;const r=e!==void 0?e:o;return l=>l!==null&&typeof l=="object"&&r in l?l[r]:l}const QSelect=createComponent({name:"QSelect",inheritAttrs:!1,props:{...useVirtualScrollProps,...useFormProps,...useFieldProps,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:validateNewValueMode},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:useVirtualScrollProps.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...useFieldEmits,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:o,emit:r}){const{proxy:l}=getCurrentInstance(),{$q:b}=l,E=ref(!1),O=ref(!1),d=ref(-1),u=ref(""),f=ref(!1),S=ref(!1);let I=null,m=null,s,v,j,g=null,T,D,L,_;const F=ref(null),M=ref(null),B=ref(null),K=ref(null),H=ref(null),te=useFormInputNameAttr(e),se=useKeyComposition(ne),Q=computed(()=>Array.isArray(e.options)?e.options.length:0),pe=computed(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:fe,virtualScrollSliceSizeComputed:me,localResetVirtualScroll:oe,padVirtualScroll:Pe,onVirtualScrollEvt:Ae,scrollTo:Ne,setVirtualScrollSize:Fe}=useVirtualScroll({virtualScrollLength:Q,getVirtualScrollTarget:$e,getVirtualScrollEl:ze,virtualScrollItemSizeComputed:pe}),je=useFieldState(),P=computed(()=>{const ue=e.mapOptions===!0&&e.multiple!==!0,Oe=e.modelValue!==void 0&&(e.modelValue!==null||ue===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const He=e.mapOptions===!0&&s!==void 0?s:[],We=Oe.map(ht=>Y(ht,He));return e.modelValue===null&&ue===!0?We.filter(ht=>ht!==null):We}return Oe}),Ce=computed(()=>{const ue={};return fieldPropsList.forEach(Oe=>{const He=e[Oe];He!==void 0&&(ue[Oe]=He)}),ue}),Be=computed(()=>e.optionsDark===null?je.isDark.value:e.optionsDark),et=computed(()=>fieldValueIsFilled(P.value)),Me=computed(()=>{let ue="q-field__input q-placeholder col";return e.hideSelected===!0||P.value.length===0?[ue,e.inputClass]:(ue+=" q-field__input--padding",e.inputClass===void 0?ue:[ue,e.inputClass])}),ye=computed(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),ke=computed(()=>Q.value===0),Ee=computed(()=>P.value.map(ue=>wt.value(ue)).join(", ")),Ye=computed(()=>e.displayValue!==void 0?e.displayValue:Ee.value),Ge=computed(()=>e.optionsHtml===!0?()=>!0:ue=>(ue==null?void 0:ue.html)===!0),lt=computed(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||P.value.some(Ge.value))),at=computed(()=>je.focused.value===!0?e.tabindex:-1),ft=computed(()=>{const ue={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":E.value===!0?"true":"false","aria-controls":`${je.targetUid.value}_lb`};return d.value>=0&&(ue["aria-activedescendant"]=`${je.targetUid.value}_${d.value}`),ue}),vt=computed(()=>({id:`${je.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),jt=computed(()=>P.value.map((ue,Oe)=>({index:Oe,opt:ue,html:Ge.value(ue),selected:!0,removeAtIndex:W,toggleOption:ie,tabindex:at.value}))),Tt=computed(()=>{if(Q.value===0)return[];const{from:ue,to:Oe}=fe.value;return e.options.slice(ue,Oe).map((He,We)=>{const ht=St.value(He)===!0,ct=ee(He)===!0,ut=ue+We,yt={clickable:!0,active:ct,activeClass:Lt.value,manualFocus:!0,focused:!1,disable:ht,tabindex:-1,dense:e.optionsDense,dark:Be.value,role:"option","aria-selected":ct===!0?"true":"false",id:`${je.targetUid.value}_${ut}`,onClick:()=>{ie(He)}};return ht!==!0&&(d.value===ut&&(yt.focused=!0),b.platform.is.desktop===!0&&(yt.onMousemove=()=>{E.value===!0&&V(ut)})),{index:ut,opt:He,html:Ge.value(He),label:wt.value(He),selected:yt.active,focused:yt.focused,toggleOption:ie,setOptionIndex:V,itemProps:yt}})}),At=computed(()=>e.dropdownIcon!==void 0?e.dropdownIcon:b.iconSet.arrow.dropdown),Dt=computed(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Lt=computed(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),pt=computed(()=>getPropValueFn(e.optionValue,"value")),wt=computed(()=>getPropValueFn(e.optionLabel,"label")),St=computed(()=>getPropValueFn(e.optionDisable,"disable")),A=computed(()=>P.value.map(pt.value)),k=computed(()=>{const ue={onInput:ne,onChange:se,onKeydown:Re,onKeyup:ve,onKeypress:xe,onFocus:ce,onClick(Oe){v===!0&&stop(Oe)}};return ue.onCompositionstart=ue.onCompositionupdate=ue.onCompositionend=se,ue});watch(P,ue=>{s=ue,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&je.innerLoading.value!==!0&&(O.value!==!0&&E.value!==!0||et.value!==!0)&&(j!==!0&&le(),(O.value===!0||E.value===!0)&&X(""))},{immediate:!0}),watch(()=>e.fillInput,le),watch(E,De),watch(Q,Le);function p(ue){return e.emitValue===!0?pt.value(ue):ue}function a(ue){if(ue!==-1&&ue<P.value.length)if(e.multiple===!0){const Oe=e.modelValue.slice();r("remove",{index:ue,value:Oe.splice(ue,1)[0]}),r("update:modelValue",Oe)}else r("update:modelValue",null)}function W(ue){a(ue),je.focus()}function ae(ue,Oe){const He=p(ue);if(e.multiple!==!0){e.fillInput===!0&&U(wt.value(ue),!0,!0),r("update:modelValue",He);return}if(P.value.length===0){r("add",{index:0,value:He}),r("update:modelValue",e.multiple===!0?[He]:He);return}if(Oe===!0&&ee(ue)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const We=e.modelValue.slice();r("add",{index:We.length,value:He}),We.push(He),r("update:modelValue",We)}function ie(ue,Oe){var ct;if(je.editable.value!==!0||ue===void 0||St.value(ue)===!0)return;const He=pt.value(ue);if(e.multiple!==!0){Oe!==!0&&(U(e.fillInput===!0?wt.value(ue):"",!0,!0),tt()),(ct=M.value)==null||ct.focus(),(P.value.length===0||isDeepEqual(pt.value(P.value[0]),He)!==!0)&&r("update:modelValue",e.emitValue===!0?He:ue);return}if((v!==!0||f.value===!0)&&je.focus(),ce(),P.value.length===0){const ut=e.emitValue===!0?He:ue;r("add",{index:0,value:ut}),r("update:modelValue",e.multiple===!0?[ut]:ut);return}const We=e.modelValue.slice(),ht=A.value.findIndex(ut=>isDeepEqual(ut,He));if(ht!==-1)r("remove",{index:ht,value:We.splice(ht,1)[0]});else{if(e.maxValues!==void 0&&We.length>=e.maxValues)return;const ut=e.emitValue===!0?He:ue;r("add",{index:We.length,value:ut}),We.push(ut)}r("update:modelValue",We)}function V(ue){if(b.platform.is.desktop!==!0)return;const Oe=ue!==-1&&ue<Q.value?ue:-1;d.value!==Oe&&(d.value=Oe)}function N(ue=1,Oe){if(E.value===!0){let He=d.value;do He=normalizeToInterval(He+ue,-1,Q.value-1);while(He!==-1&&He!==d.value&&St.value(e.options[He])===!0);d.value!==He&&(V(He),Ne(He),Oe!==!0&&e.useInput===!0&&e.fillInput===!0&&be(He>=0?wt.value(e.options[He]):T,!0))}}function Y(ue,Oe){const He=We=>isDeepEqual(pt.value(We),ue);return e.options.find(He)||Oe.find(He)||ue}function ee(ue){const Oe=pt.value(ue);return A.value.find(He=>isDeepEqual(He,Oe))!==void 0}function ce(ue){e.useInput===!0&&M.value!==null&&(ue===void 0||M.value===ue.target&&ue.target.value===Ee.value)&&M.value.select()}function Se(ue){isKeyCode(ue,27)===!0&&E.value===!0&&(stop(ue),tt(),le()),r("keyup",ue)}function ve(ue){const{value:Oe}=ue.target;if(ue.keyCode!==void 0){Se(ue);return}if(ue.target.value="",I!==null&&(clearTimeout(I),I=null),m!==null&&(clearTimeout(m),m=null),le(),typeof Oe=="string"&&Oe.length!==0){const He=Oe.toLocaleLowerCase(),We=ct=>{const ut=e.options.find(yt=>String(ct.value(yt)).toLocaleLowerCase()===He);return ut===void 0?!1:(P.value.indexOf(ut)===-1?ie(ut):tt(),!0)},ht=ct=>{We(pt)!==!0&&ct!==!0&&We(wt)!==!0&&X(Oe,!0,()=>ht(!0))};ht()}else je.clearValue(ue)}function xe(ue){r("keypress",ue)}function Re(ue){if(r("keydown",ue),shouldIgnoreKey(ue)===!0)return;const Oe=u.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),He=ue.shiftKey!==!0&&e.disableTabSelection!==!0&&e.multiple!==!0&&(d.value!==-1||Oe===!0);if(ue.keyCode===27){prevent(ue);return}if(ue.keyCode===9&&He===!1){Ve();return}if(ue.target===void 0||ue.target.id!==je.targetUid.value||je.editable.value!==!0)return;if(ue.keyCode===40&&je.innerLoading.value!==!0&&E.value===!1){stopAndPrevent(ue),Ue();return}if(ue.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&u.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?a(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&r("update:modelValue",null);return}(ue.keyCode===35||ue.keyCode===36)&&(typeof u.value!="string"||u.value.length===0)&&(stopAndPrevent(ue),d.value=-1,N(ue.keyCode===36?1:-1,e.multiple)),(ue.keyCode===33||ue.keyCode===34)&&me.value!==void 0&&(stopAndPrevent(ue),d.value=Math.max(-1,Math.min(Q.value,d.value+(ue.keyCode===33?-1:1)*me.value.view)),N(ue.keyCode===33?1:-1,e.multiple)),(ue.keyCode===38||ue.keyCode===40)&&(stopAndPrevent(ue),N(ue.keyCode===38?-1:1,e.multiple));const We=Q.value;if((L===void 0||_<Date.now())&&(L=""),We>0&&e.useInput!==!0&&ue.key!==void 0&&ue.key.length===1&&ue.altKey===!1&&ue.ctrlKey===!1&&ue.metaKey===!1&&(ue.keyCode!==32||L.length!==0)){E.value!==!0&&Ue(ue);const ht=ue.key.toLocaleLowerCase(),ct=L.length===1&&L[0]===ht;_=Date.now()+1500,ct===!1&&(stopAndPrevent(ue),L+=ht);const ut=new RegExp("^"+L.split("").map(It=>reEscapeList.indexOf(It)!==-1?"\\"+It:It).join(".*"),"i");let yt=d.value;if(ct===!0||yt<0||ut.test(wt.value(e.options[yt]))!==!0)do yt=normalizeToInterval(yt+1,-1,We-1);while(yt!==d.value&&(St.value(e.options[yt])===!0||ut.test(wt.value(e.options[yt]))!==!0));d.value!==yt&&nextTick(()=>{V(yt),Ne(yt),yt>=0&&e.useInput===!0&&e.fillInput===!0&&be(wt.value(e.options[yt]),!0)});return}if(!(ue.keyCode!==13&&(ue.keyCode!==32||e.useInput===!0||L!=="")&&(ue.keyCode!==9||He===!1))){if(ue.keyCode!==9&&stopAndPrevent(ue),d.value!==-1&&d.value<We){ie(e.options[d.value]);return}if(Oe===!0){const ht=(ct,ut)=>{var It;if(ut){if(validateNewValueMode(ut)!==!0)return}else ut=e.newValueMode;if(U("",e.multiple!==!0,!0),ct==null)return;(ut==="toggle"?ie:ae)(ct,ut==="add-unique"),e.multiple!==!0&&((It=M.value)==null||It.focus(),tt())};if(e.onNewValue!==void 0?r("newValue",u.value,ht):ht(u.value),e.multiple!==!0)return}E.value===!0?Ve():je.innerLoading.value!==!0&&Ue()}}function ze(){return v===!0?H.value:B.value!==null&&B.value.contentEl!==null?B.value.contentEl:void 0}function $e(){return ze()}function Je(){return e.hideSelected===!0?[]:o["selected-item"]!==void 0?jt.value.map(ue=>o["selected-item"](ue)).slice():o.selected!==void 0?[].concat(o.selected()):e.useChips===!0?jt.value.map((ue,Oe)=>h(QChip,{key:"option-"+Oe,removable:je.editable.value===!0&&St.value(ue.opt)!==!0,dense:!0,textColor:e.color,tabindex:at.value,onRemove(){ue.removeAtIndex(Oe)}},()=>h("span",{class:"ellipsis",[ue.html===!0?"innerHTML":"textContent"]:wt.value(ue.opt)}))):[h("span",{class:"ellipsis",[lt.value===!0?"innerHTML":"textContent"]:Ye.value})]}function nt(){if(ke.value===!0)return o["no-option"]!==void 0?o["no-option"]({inputValue:u.value}):void 0;const ue=o.option!==void 0?o.option:He=>h(QItem,{key:He.index,...He.itemProps},()=>h(QItemSection,()=>h(QItemLabel,()=>h("span",{[He.html===!0?"innerHTML":"textContent"]:He.label}))));let Oe=Pe("div",Tt.value.map(ue));return o["before-options"]!==void 0&&(Oe=o["before-options"]().concat(Oe)),hMergeSlot(o["after-options"],Oe)}function re(ue,Oe){const He=Oe===!0?{...ft.value,...je.splitAttrs.attributes.value}:void 0,We={ref:Oe===!0?M:void 0,key:"i_t",class:Me.value,style:e.inputStyle,value:u.value!==void 0?u.value:"",type:"search",...He,id:Oe===!0?je.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":ue===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...k.value};return ue!==!0&&v===!0&&(Array.isArray(We.class)===!0?We.class=[...We.class,"no-pointer-events"]:We.class+=" no-pointer-events"),h("input",We)}function ne(ue){I!==null&&(clearTimeout(I),I=null),m!==null&&(clearTimeout(m),m=null),!(ue&&ue.target&&ue.target.qComposing===!0)&&(be(ue.target.value||""),j=!0,T=u.value,je.focused.value!==!0&&(v!==!0||f.value===!0)&&je.focus(),e.onFilter!==void 0&&(I=setTimeout(()=>{I=null,X(u.value)},e.inputDebounce)))}function be(ue,Oe){u.value!==ue&&(u.value=ue,Oe===!0||e.inputDebounce===0||e.inputDebounce==="0"?r("inputValue",ue):m=setTimeout(()=>{m=null,r("inputValue",ue)},e.inputDebounce))}function U(ue,Oe,He){j=He!==!0,e.useInput===!0&&(be(ue,!0),(Oe===!0||He!==!0)&&(T=ue),Oe!==!0&&X(ue))}function X(ue,Oe,He){if(e.onFilter===void 0||Oe!==!0&&je.focused.value!==!0)return;je.innerLoading.value===!0?r("filterAbort"):(je.innerLoading.value=!0,S.value=!0),ue!==""&&e.multiple!==!0&&P.value.length!==0&&j!==!0&&ue===wt.value(P.value[0])&&(ue="");const We=setTimeout(()=>{E.value===!0&&(E.value=!1)},10);g!==null&&clearTimeout(g),g=We,r("filter",ue,(ht,ct)=>{(Oe===!0||je.focused.value===!0)&&g===We&&(clearTimeout(g),typeof ht=="function"&&ht(),S.value=!1,nextTick(()=>{je.innerLoading.value=!1,je.editable.value===!0&&(Oe===!0?E.value===!0&&tt():E.value===!0?De(!0):E.value=!0),typeof ct=="function"&&nextTick(()=>{ct(l)}),typeof He=="function"&&nextTick(()=>{He(l)})}))},()=>{je.focused.value===!0&&g===We&&(clearTimeout(g),je.innerLoading.value=!1,S.value=!1),E.value===!0&&(E.value=!1)})}function C(){return h(QMenu,{ref:B,class:ye.value,style:e.popupContentStyle,modelValue:E.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&ke.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:Be.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:Dt.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...vt.value,onScrollPassive:Ae,onBeforeShow:ot,onBeforeHide:q,onShow:G},nt)}function q(ue){rt(ue),Ve()}function G(){Fe()}function ge(ue){var Oe;stop(ue),(Oe=M.value)==null||Oe.focus(),f.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function J(ue){stop(ue),nextTick(()=>{f.value=!1})}function he(){const ue=[h(QField,{class:`col-auto ${je.fieldClass.value}`,...Ce.value,for:je.targetUid.value,dark:Be.value,square:!0,loading:S.value,itemAligned:!1,filled:!0,stackLabel:u.value.length!==0,...je.splitAttrs.listeners.value,onFocus:ge,onBlur:J},{...o,rawControl:()=>je.getControl(!0),before:void 0,after:void 0})];return E.value===!0&&ue.push(h("div",{ref:H,class:ye.value+" scroll",style:e.popupContentStyle,...vt.value,onClick:prevent,onScrollPassive:Ae},nt())),h(QDialog,{ref:K,modelValue:O.value,position:e.useInput===!0?"top":void 0,transitionShow:D,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:ot,onBeforeHide:Te,onHide:qe,onShow:Ie},()=>h("div",{class:"q-select__dialog"+(Be.value===!0?" q-select__dialog--dark q-dark":"")+(f.value===!0?" q-select__dialog--focused":"")},ue))}function Te(ue){rt(ue),K.value!==null&&K.value.__updateRefocusTarget(je.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),je.focused.value=!1}function qe(ue){tt(),je.focused.value===!1&&r("blur",ue),le()}function Ie(){const ue=document.activeElement;(ue===null||ue.id!==je.targetUid.value)&&M.value!==null&&M.value!==ue&&M.value.focus(),Fe()}function Ve(){O.value!==!0&&(d.value=-1,E.value===!0&&(E.value=!1),je.focused.value===!1&&(g!==null&&(clearTimeout(g),g=null),je.innerLoading.value===!0&&(r("filterAbort"),je.innerLoading.value=!1,S.value=!1)))}function Ue(ue){je.editable.value===!0&&(v===!0?(je.onControlFocusin(ue),O.value=!0,nextTick(()=>{je.focus()})):je.focus(),e.onFilter!==void 0?X(u.value):(ke.value!==!0||o["no-option"]!==void 0)&&(E.value=!0))}function tt(){O.value=!1,Ve()}function le(){e.useInput===!0&&U(e.multiple!==!0&&e.fillInput===!0&&P.value.length!==0&&wt.value(P.value[0])||"",!0,!0)}function De(ue){let Oe=-1;if(ue===!0){if(P.value.length!==0){const He=pt.value(P.value[0]);Oe=e.options.findIndex(We=>isDeepEqual(pt.value(We),He))}oe(Oe)}V(Oe)}function Le(ue,Oe){E.value===!0&&je.innerLoading.value===!1&&(oe(-1,!0),nextTick(()=>{E.value===!0&&je.innerLoading.value===!1&&(ue>Oe?oe():De(!0))}))}function Xe(){O.value===!1&&B.value!==null&&B.value.updatePosition()}function ot(ue){ue!==void 0&&stop(ue),r("popupShow",ue),je.hasPopupOpen=!0,je.onControlFocusin(ue)}function rt(ue){ue!==void 0&&stop(ue),r("popupHide",ue),je.hasPopupOpen=!1,je.onControlFocusout(ue)}function bt(){v=b.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?o["no-option"]!==void 0||e.onFilter!==void 0||ke.value===!1:!0),D=b.platform.is.ios===!0&&v===!0&&e.useInput===!0?"fade":e.transitionShow}return onBeforeUpdate(bt),onUpdated(Xe),bt(),onBeforeUnmount(()=>{I!==null&&clearTimeout(I),m!==null&&clearTimeout(m)}),Object.assign(l,{showPopup:Ue,hidePopup:tt,removeAtIndex:a,add:ae,toggleOption:ie,getOptionIndex:()=>d.value,setOptionIndex:V,moveOptionSelection:N,filter:X,updateMenuPosition:Xe,updateInputValue:U,isOptionSelected:ee,getEmittingOptionValue:p,isOptionDisabled:(...ue)=>St.value.apply(null,ue)===!0,getOptionValue:(...ue)=>pt.value.apply(null,ue),getOptionLabel:(...ue)=>wt.value.apply(null,ue)}),Object.assign(je,{innerValue:P,fieldClass:computed(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:F,targetRef:M,hasValue:et,showPopup:Ue,floatingLabel:computed(()=>e.hideSelected!==!0&&et.value===!0||typeof u.value=="number"||u.value.length!==0||fieldValueIsFilled(e.displayValue)),getControlChild:()=>{if(je.editable.value!==!1&&(O.value===!0||ke.value!==!0||o["no-option"]!==void 0))return v===!0?he():C();je.hasPopupOpen===!0&&(je.hasPopupOpen=!1)},controlEvents:{onFocusin(ue){je.onControlFocusin(ue)},onFocusout(ue){je.onControlFocusout(ue,()=>{le(),Ve()})},onClick(ue){var Oe;if(prevent(ue),v!==!0&&E.value===!0){Ve(),(Oe=M.value)==null||Oe.focus();return}Ue(ue)}},getControl:ue=>{const Oe=Je(),He=ue===!0||O.value!==!0||v!==!0;if(e.useInput===!0)Oe.push(re(ue,He));else if(je.editable.value===!0){const ht=He===!0?ft.value:void 0;Oe.push(h("input",{ref:He===!0?M:void 0,key:"d_t",class:"q-select__focus-target",id:He===!0?je.targetUid.value:void 0,value:Ye.value,readonly:!0,"data-autofocus":ue===!0||e.autofocus===!0||void 0,...ht,onKeydown:Re,onKeyup:Se,onKeypress:xe})),He===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&Oe.push(h("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:ve}))}if(te.value!==void 0&&e.disable!==!0&&A.value.length!==0){const ht=A.value.map(ct=>h("option",{value:ct,selected:!0}));Oe.push(h("select",{class:"hidden",name:te.value,multiple:e.multiple},ht))}const We=e.useInput===!0||He!==!0?void 0:je.splitAttrs.attributes.value;return h("div",{class:"q-field__native row items-center",...We,...je.splitAttrs.listeners.value},Oe)},getInnerAppend:()=>e.loading!==!0&&S.value!==!0&&e.hideDropdownIcon!==!0?[h(QIcon,{class:"q-select__dropdown-icon"+(E.value===!0?" rotate-180":""),name:At.value})]:null}),useField(je)}}),alignMap={left:"start",center:"center",right:"end",between:"between",around:"around",evenly:"evenly",stretch:"stretch"},alignValues=Object.keys(alignMap),useAlignProps={align:{type:String,validator:e=>alignValues.includes(e)}};function useAlign(e){return computed(()=>{const o=e.align===void 0?e.vertical===!0?"stretch":"left":e.align;return`${e.vertical===!0?"items":"justify"}-${alignMap[o]}`})}const btnPadding={none:0,xs:4,sm:8,md:16,lg:24,xl:32},defaultSizes$1={xs:8,sm:10,md:14,lg:20,xl:24},formTypes=["button","submit","reset"],mediaTypeRE=/[^\s]\/[^\s]/,btnDesignOptions=["flat","outline","push","unelevated"];function getBtnDesign(e,o){return e.flat===!0?"flat":e.outline===!0?"outline":e.push===!0?"push":e.unelevated===!0?"unelevated":o}const nonRoundBtnProps={...useSizeProps,...useRouterLinkNonMatchingProps,type:{type:String,default:"button"},label:[Number,String],icon:String,iconRight:String,...btnDesignOptions.reduce((e,o)=>(e[o]=Boolean)&&e,{}),square:Boolean,rounded:Boolean,glossy:Boolean,size:String,fab:Boolean,fabMini:Boolean,padding:String,color:String,textColor:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,tabindex:[Number,String],ripple:{type:[Boolean,Object],default:!0},align:{...useAlignProps.align,default:"center"},stack:Boolean,stretch:Boolean,loading:{type:Boolean,default:null},disable:Boolean},useBtnProps={...nonRoundBtnProps,round:Boolean};function useBtn(e){const o=useSize(e,defaultSizes$1),r=useAlign(e),{hasRouterLink:l,hasLink:b,linkTag:E,linkAttrs:O,navigateOnClick:d}=useRouterLink({fallbackTag:"button"}),u=computed(()=>{const g=e.fab===!1&&e.fabMini===!1?o.value:{};return e.padding!==void 0?Object.assign({},g,{padding:e.padding.split(/\s+/).map(T=>T in btnPadding?btnPadding[T]+"px":T).join(" "),minWidth:"0",minHeight:"0"}):g}),f=computed(()=>e.rounded===!0||e.fab===!0||e.fabMini===!0),S=computed(()=>e.disable!==!0&&e.loading!==!0),I=computed(()=>S.value===!0?e.tabindex||0:-1),m=computed(()=>getBtnDesign(e,"standard")),s=computed(()=>{const g={tabindex:I.value};return b.value===!0?Object.assign(g,O.value):formTypes.includes(e.type)===!0&&(g.type=e.type),E.value==="a"?(e.disable===!0?g["aria-disabled"]="true":g.href===void 0&&(g.role="button"),l.value!==!0&&mediaTypeRE.test(e.type)===!0&&(g.type=e.type)):e.disable===!0&&(g.disabled="",g["aria-disabled"]="true"),e.loading===!0&&e.percentage!==void 0&&Object.assign(g,{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e.percentage}),g}),v=computed(()=>{let g;e.color!==void 0?e.flat===!0||e.outline===!0?g=`text-${e.textColor||e.color}`:g=`bg-${e.color} text-${e.textColor||"white"}`:e.textColor&&(g=`text-${e.textColor}`);const T=e.round===!0?"round":`rectangle${f.value===!0?" q-btn--rounded":e.square===!0?" q-btn--square":""}`;return`q-btn--${m.value} q-btn--${T}`+(g!==void 0?" "+g:"")+(S.value===!0?" q-btn--actionable q-focusable q-hoverable":e.disable===!0?" disabled":"")+(e.fab===!0?" q-btn--fab":e.fabMini===!0?" q-btn--fab-mini":"")+(e.noCaps===!0?" q-btn--no-uppercase":"")+(e.dense===!0?" q-btn--dense":"")+(e.stretch===!0?" no-border-radius self-stretch":"")+(e.glossy===!0?" glossy":"")+(e.square?" q-btn--square":"")}),j=computed(()=>r.value+(e.stack===!0?" column":" row")+(e.noWrap===!0?" no-wrap text-no-wrap":"")+(e.loading===!0?" q-btn__content--hidden":""));return{classes:v,style:u,innerClasses:j,attributes:s,hasLink:b,linkTag:E,navigateOnClick:d,isActionable:S}}const{passiveCapture}=listenOpts;let touchTarget=null,keyboardTarget=null,mouseTarget=null;const QBtn=createComponent({name:"QBtn",props:{...useBtnProps,percentage:Number,darkPercentage:Boolean,onTouchstart:[Function,Array]},emits:["click","keydown","mousedown","keyup"],setup(e,{slots:o,emit:r}){const{proxy:l}=getCurrentInstance(),{classes:b,style:E,innerClasses:O,attributes:d,hasLink:u,linkTag:f,navigateOnClick:S,isActionable:I}=useBtn(e),m=ref(null),s=ref(null);let v=null,j,g=null;const T=computed(()=>e.label!==void 0&&e.label!==null&&e.label!==""),D=computed(()=>e.disable===!0||e.ripple===!1?!1:{keyCodes:u.value===!0?[13,32]:[13],...e.ripple===!0?{}:e.ripple}),L=computed(()=>({center:e.round})),_=computed(()=>{const fe=Math.max(0,Math.min(100,e.percentage));return fe>0?{transition:"transform 0.6s",transform:`translateX(${fe-100}%)`}:{}}),F=computed(()=>{if(e.loading===!0)return{onMousedown:pe,onTouchstart:pe,onClick:pe,onKeydown:pe,onKeyup:pe};if(I.value===!0){const fe={onClick:B,onKeydown:K,onMousedown:te};if(l.$q.platform.has.touch===!0){const me=e.onTouchstart!==void 0?"":"Passive";fe[`onTouchstart${me}`]=H}return fe}return{onClick:stopAndPrevent}}),M=computed(()=>({ref:m,class:"q-btn q-btn-item non-selectable no-outline "+b.value,style:E.value,...d.value,...F.value}));function B(fe){if(m.value!==null){if(fe!==void 0){if(fe.defaultPrevented===!0)return;const me=document.activeElement;if(e.type==="submit"&&me!==document.body&&m.value.contains(me)===!1&&me.contains(m.value)===!1){fe.qAvoidFocus!==!0&&m.value.focus();const oe=()=>{var Pe;document.removeEventListener("keydown",stopAndPrevent,!0),document.removeEventListener("keyup",oe,passiveCapture),(Pe=m.value)==null||Pe.removeEventListener("blur",oe,passiveCapture)};document.addEventListener("keydown",stopAndPrevent,!0),document.addEventListener("keyup",oe,passiveCapture),m.value.addEventListener("blur",oe,passiveCapture)}}S(fe)}}function K(fe){m.value!==null&&(r("keydown",fe),isKeyCode(fe,[13,32])===!0&&keyboardTarget!==m.value&&(keyboardTarget!==null&&Q(),fe.defaultPrevented!==!0&&(fe.qAvoidFocus!==!0&&m.value.focus(),keyboardTarget=m.value,m.value.classList.add("q-btn--active"),document.addEventListener("keyup",se,!0),m.value.addEventListener("blur",se,passiveCapture)),stopAndPrevent(fe)))}function H(fe){m.value!==null&&(r("touchstart",fe),fe.defaultPrevented!==!0&&(touchTarget!==m.value&&(touchTarget!==null&&Q(),touchTarget=m.value,v=fe.target,v.addEventListener("touchcancel",se,passiveCapture),v.addEventListener("touchend",se,passiveCapture)),j=!0,g!==null&&clearTimeout(g),g=setTimeout(()=>{g=null,j=!1},200)))}function te(fe){m.value!==null&&(fe.qSkipRipple=j===!0,r("mousedown",fe),fe.defaultPrevented!==!0&&mouseTarget!==m.value&&(mouseTarget!==null&&Q(),mouseTarget=m.value,m.value.classList.add("q-btn--active"),document.addEventListener("mouseup",se,passiveCapture)))}function se(fe){if(m.value!==null&&!((fe==null?void 0:fe.type)==="blur"&&document.activeElement===m.value)){if((fe==null?void 0:fe.type)==="keyup"){if(keyboardTarget===m.value&&isKeyCode(fe,[13,32])===!0){const me=new MouseEvent("click",fe);me.qKeyEvent=!0,fe.defaultPrevented===!0&&prevent(me),fe.cancelBubble===!0&&stop(me),m.value.dispatchEvent(me),stopAndPrevent(fe),fe.qKeyEvent=!0}r("keyup",fe)}Q()}}function Q(fe){var oe,Pe;const me=s.value;fe!==!0&&(touchTarget===m.value||mouseTarget===m.value)&&me!==null&&me!==document.activeElement&&(me.setAttribute("tabindex",-1),me.focus()),touchTarget===m.value&&(v!==null&&(v.removeEventListener("touchcancel",se,passiveCapture),v.removeEventListener("touchend",se,passiveCapture)),touchTarget=v=null),mouseTarget===m.value&&(document.removeEventListener("mouseup",se,passiveCapture),mouseTarget=null),keyboardTarget===m.value&&(document.removeEventListener("keyup",se,!0),(oe=m.value)==null||oe.removeEventListener("blur",se,passiveCapture),keyboardTarget=null),(Pe=m.value)==null||Pe.classList.remove("q-btn--active")}function pe(fe){stopAndPrevent(fe),fe.qSkipRipple=!0}return onBeforeUnmount(()=>{Q(!0)}),Object.assign(l,{click:fe=>{I.value===!0&&B(fe)}}),()=>{let fe=[];e.icon!==void 0&&fe.push(h(QIcon,{name:e.icon,left:e.stack!==!0&&T.value===!0,role:"img"})),T.value===!0&&fe.push(h("span",{class:"block"},[e.label])),fe=hMergeSlot(o.default,fe),e.iconRight!==void 0&&e.round===!1&&fe.push(h(QIcon,{name:e.iconRight,right:e.stack!==!0&&T.value===!0,role:"img"}));const me=[h("span",{class:"q-focus-helper",ref:s})];return e.loading===!0&&e.percentage!==void 0&&me.push(h("span",{class:"q-btn__progress absolute-full overflow-hidden"+(e.darkPercentage===!0?" q-btn__progress--dark":"")},[h("span",{class:"q-btn__progress-indicator fit block",style:_.value})])),me.push(h("span",{class:"q-btn__content text-center col items-center q-anchor--skip "+O.value},fe)),e.loading!==null&&me.push(h(Transition,{name:"q-transition--fade"},()=>e.loading===!0?[h("span",{key:"loading",class:"absolute-full flex flex-center"},o.loading!==void 0?o.loading():[h(QSpinner)])]:null)),withDirectives(h(f.value,M.value,me),[[Ripple,D.value,void 0,L.value]])}}}),QCardSection=createComponent({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:o}){const r=computed(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>h(e.tag,{class:r.value},hSlot(o.default))}}),NAMED_MASKS={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},TOKENS={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}},KEYS=Object.keys(TOKENS);KEYS.forEach(e=>{TOKENS[e].regex=new RegExp(TOKENS[e].pattern)});const tokenRegexMask=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+KEYS.join("")+"])|(.)","g"),escRegex=/[.*+?^${}()|[\]\\]/g,MARKER="",useMaskProps={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function useMask(e,o,r,l){let b,E,O,d,u,f;const S=ref(null),I=ref(s());function m(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}watch(()=>e.type+e.autogrow,j),watch(()=>e.mask,H=>{if(H!==void 0)g(I.value,!0);else{const te=B(I.value);j(),e.modelValue!==te&&o("update:modelValue",te)}}),watch(()=>e.fillMask+e.reverseFillMask,()=>{S.value===!0&&g(I.value,!0)}),watch(()=>e.unmaskedValue,()=>{S.value===!0&&g(I.value)});function s(){if(j(),S.value===!0){const H=F(B(e.modelValue));return e.fillMask!==!1?K(H):H}return e.modelValue}function v(H){if(H<b.length)return b.slice(-H);let te="",se=b;const Q=se.indexOf(MARKER);if(Q!==-1){for(let pe=H-se.length;pe>0;pe--)te+=MARKER;se=se.slice(0,Q)+te+se.slice(Q)}return se}function j(){if(S.value=e.mask!==void 0&&e.mask.length!==0&&m(),S.value===!1){d=void 0,b="",E="";return}const H=NAMED_MASKS[e.mask]===void 0?e.mask:NAMED_MASKS[e.mask],te=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",se=te.replace(escRegex,"\\$&"),Q=[],pe=[],fe=[];let me=e.reverseFillMask===!0,oe="",Pe="";H.replace(tokenRegexMask,(je,P,Ce,Be,et)=>{if(Be!==void 0){const Me=TOKENS[Be];fe.push(Me),Pe=Me.negate,me===!0&&(pe.push("(?:"+Pe+"+)?("+Me.pattern+"+)?(?:"+Pe+"+)?("+Me.pattern+"+)?"),me=!1),pe.push("(?:"+Pe+"+)?("+Me.pattern+")?")}else if(Ce!==void 0)oe="\\"+(Ce==="\\"?"":Ce),fe.push(Ce),Q.push("([^"+oe+"]+)?"+oe+"?");else{const Me=P!==void 0?P:et;oe=Me==="\\"?"\\\\\\\\":Me.replace(escRegex,"\\\\$&"),fe.push(Me),Q.push("([^"+oe+"]+)?"+oe+"?")}});const Ae=new RegExp("^"+Q.join("")+"("+(oe===""?".":"[^"+oe+"]")+"+)?"+(oe===""?"":"["+oe+"]*")+"$"),Ne=pe.length-1,Fe=pe.map((je,P)=>P===0&&e.reverseFillMask===!0?new RegExp("^"+se+"*"+je):P===Ne?new RegExp("^"+je+"("+(Pe===""?".":Pe)+"+)?"+(e.reverseFillMask===!0?"$":se+"*")):new RegExp("^"+je));O=fe,d=je=>{const P=Ae.exec(e.reverseFillMask===!0?je:je.slice(0,fe.length+1));P!==null&&(je=P.slice(1).join(""));const Ce=[],Be=Fe.length;for(let et=0,Me=je;et<Be;et++){const ye=Fe[et].exec(Me);if(ye===null)break;Me=Me.slice(ye.shift().length),Ce.push(...ye)}return Ce.length!==0?Ce.join(""):je},b=fe.map(je=>typeof je=="string"?je:MARKER).join(""),E=b.split(MARKER).join(te)}function g(H,te,se){const Q=l.value,pe=Q.selectionEnd,fe=Q.value.length-pe,me=B(H);te===!0&&j();const oe=F(me),Pe=e.fillMask!==!1?K(oe):oe,Ae=I.value!==Pe;Q.value!==Pe&&(Q.value=Pe),Ae===!0&&(I.value=Pe),document.activeElement===Q&&nextTick(()=>{if(Pe===E){const Fe=e.reverseFillMask===!0?E.length:0;Q.setSelectionRange(Fe,Fe,"forward");return}if(se==="insertFromPaste"&&e.reverseFillMask!==!0){const Fe=Q.selectionEnd;let je=pe-1;for(let P=u;P<=je&&P<Fe;P++)b[P]!==MARKER&&je++;D.right(Q,je);return}if(["deleteContentBackward","deleteContentForward"].indexOf(se)!==-1){const Fe=e.reverseFillMask===!0?pe===0?Pe.length>oe.length?1:0:Math.max(0,Pe.length-(Pe===E?0:Math.min(oe.length,fe)+1))+1:pe;Q.setSelectionRange(Fe,Fe,"forward");return}if(e.reverseFillMask===!0)if(Ae===!0){const Fe=Math.max(0,Pe.length-(Pe===E?0:Math.min(oe.length,fe+1)));Fe===1&&pe===1?Q.setSelectionRange(Fe,Fe,"forward"):D.rightReverse(Q,Fe)}else{const Fe=Pe.length-fe;Q.setSelectionRange(Fe,Fe,"backward")}else if(Ae===!0){const Fe=Math.max(0,b.indexOf(MARKER),Math.min(oe.length,pe)-1);D.right(Q,Fe)}else{const Fe=pe-1;D.right(Q,Fe)}});const Ne=e.unmaskedValue===!0?B(Pe):Pe;String(e.modelValue)!==Ne&&(e.modelValue!==null||Ne!=="")&&r(Ne,!0)}function T(H,te,se){const Q=F(B(H.value));te=Math.max(0,b.indexOf(MARKER),Math.min(Q.length,te)),u=te,H.setSelectionRange(te,se,"forward")}const D={left(H,te){const se=b.slice(te-1).indexOf(MARKER)===-1;let Q=Math.max(0,te-1);for(;Q>=0;Q--)if(b[Q]===MARKER){te=Q,se===!0&&te++;break}if(Q<0&&b[te]!==void 0&&b[te]!==MARKER)return D.right(H,0);te>=0&&H.setSelectionRange(te,te,"backward")},right(H,te){const se=H.value.length;let Q=Math.min(se,te+1);for(;Q<=se;Q++)if(b[Q]===MARKER){te=Q;break}else b[Q-1]===MARKER&&(te=Q);if(Q>se&&b[te-1]!==void 0&&b[te-1]!==MARKER)return D.left(H,se);H.setSelectionRange(te,te,"forward")},leftReverse(H,te){const se=v(H.value.length);let Q=Math.max(0,te-1);for(;Q>=0;Q--)if(se[Q-1]===MARKER){te=Q;break}else if(se[Q]===MARKER&&(te=Q,Q===0))break;if(Q<0&&se[te]!==void 0&&se[te]!==MARKER)return D.rightReverse(H,0);te>=0&&H.setSelectionRange(te,te,"backward")},rightReverse(H,te){const se=H.value.length,Q=v(se),pe=Q.slice(0,te+1).indexOf(MARKER)===-1;let fe=Math.min(se,te+1);for(;fe<=se;fe++)if(Q[fe-1]===MARKER){te=fe,te>0&&pe===!0&&te--;break}if(fe>se&&Q[te-1]!==void 0&&Q[te-1]!==MARKER)return D.leftReverse(H,se);H.setSelectionRange(te,te,"forward")}};function L(H){o("click",H),f=void 0}function _(H){if(o("keydown",H),shouldIgnoreKey(H)===!0||H.altKey===!0)return;const te=l.value,se=te.selectionStart,Q=te.selectionEnd;if(H.shiftKey||(f=void 0),H.keyCode===37||H.keyCode===39){H.shiftKey&&f===void 0&&(f=te.selectionDirection==="forward"?se:Q);const pe=D[(H.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(H.preventDefault(),pe(te,f===se?Q:se),H.shiftKey){const fe=te.selectionStart;te.setSelectionRange(Math.min(f,fe),Math.max(f,fe),"forward")}}else H.keyCode===8&&e.reverseFillMask!==!0&&se===Q?(D.left(te,se),te.setSelectionRange(te.selectionStart,Q,"backward")):H.keyCode===46&&e.reverseFillMask===!0&&se===Q&&(D.rightReverse(te,Q),te.setSelectionRange(se,te.selectionEnd,"forward"))}function F(H){if(H==null||H==="")return"";if(e.reverseFillMask===!0)return M(H);const te=O;let se=0,Q="";for(let pe=0;pe<te.length;pe++){const fe=H[se],me=te[pe];if(typeof me=="string")Q+=me,fe===me&&se++;else if(fe!==void 0&&me.regex.test(fe))Q+=me.transform!==void 0?me.transform(fe):fe,se++;else return Q}return Q}function M(H){const te=O,se=b.indexOf(MARKER);let Q=H.length-1,pe="";for(let fe=te.length-1;fe>=0&&Q!==-1;fe--){const me=te[fe];let oe=H[Q];if(typeof me=="string")pe=me+pe,oe===me&&Q--;else if(oe!==void 0&&me.regex.test(oe))do pe=(me.transform!==void 0?me.transform(oe):oe)+pe,Q--,oe=H[Q];while(se===fe&&oe!==void 0&&me.regex.test(oe));else return pe}return pe}function B(H){return typeof H!="string"||d===void 0?typeof H=="number"?d(""+H):H:d(H)}function K(H){return E.length-H.length<=0?H:e.reverseFillMask===!0&&H.length!==0?E.slice(0,-H.length)+H:H+E.slice(H.length)}return{innerValue:I,hasMask:S,moveCursorForPaste:T,updateMaskValue:g,onMaskedKeydown:_,onMaskedClick:L}}function useFileFormDomProps(e,o){function r(){const l=e.modelValue;try{const b="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(l)===l&&("length"in l?Array.from(l):[l]).forEach(E=>{b.items.add(E)}),{files:b.files}}catch{return{files:void 0}}}return computed(()=>{if(e.type==="file")return r()})}const QInput=createComponent({name:"QInput",inheritAttrs:!1,props:{...useFieldProps,...useMaskProps,...useFormProps,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...useFieldEmits,"paste","change","keydown","click","animationend"],setup(e,{emit:o,attrs:r}){const{proxy:l}=getCurrentInstance(),{$q:b}=l,E={};let O=NaN,d,u,f=null,S;const I=ref(null),m=useFormInputNameAttr(e),{innerValue:s,hasMask:v,moveCursorForPaste:j,updateMaskValue:g,onMaskedKeydown:T,onMaskedClick:D}=useMask(e,o,oe,I),L=useFileFormDomProps(e),_=computed(()=>fieldValueIsFilled(s.value)),F=useKeyComposition(fe),M=useFieldState({changeEvent:!0}),B=computed(()=>e.type==="textarea"||e.autogrow===!0),K=computed(()=>B.value===!0||["text","search","url","tel","password"].includes(e.type)),H=computed(()=>{const P={...M.splitAttrs.listeners.value,onInput:fe,onPaste:pe,onChange:Ae,onBlur:Ne,onFocus:stop};return P.onCompositionstart=P.onCompositionupdate=P.onCompositionend=F,v.value===!0&&(P.onKeydown=T,P.onClick=D),e.autogrow===!0&&(P.onAnimationend=me),P}),te=computed(()=>{const P={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:m.value,...M.splitAttrs.attributes.value,id:M.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return B.value===!1&&(P.type=e.type),e.autogrow===!0&&(P.rows=1),P});watch(()=>e.type,()=>{I.value&&(I.value.value=e.modelValue)}),watch(()=>e.modelValue,P=>{if(v.value===!0){if(u===!0&&(u=!1,String(P)===O))return;g(P)}else s.value!==P&&(s.value=P,e.type==="number"&&E.hasOwnProperty("value")===!0&&(d===!0?d=!1:delete E.value));e.autogrow===!0&&nextTick(Pe)}),watch(()=>e.autogrow,P=>{P===!0?nextTick(Pe):I.value!==null&&r.rows>0&&(I.value.style.height="auto")}),watch(()=>e.dense,()=>{e.autogrow===!0&&nextTick(Pe)});function se(){addFocusFn(()=>{const P=document.activeElement;I.value!==null&&I.value!==P&&(P===null||P.id!==M.targetUid.value)&&I.value.focus({preventScroll:!0})})}function Q(){var P;(P=I.value)==null||P.select()}function pe(P){if(v.value===!0&&e.reverseFillMask!==!0){const Ce=P.target;j(Ce,Ce.selectionStart,Ce.selectionEnd)}o("paste",P)}function fe(P){if(!P||!P.target)return;if(e.type==="file"){o("update:modelValue",P.target.files);return}const Ce=P.target.value;if(P.target.qComposing===!0){E.value=Ce;return}if(v.value===!0)g(Ce,!1,P.inputType);else if(oe(Ce),K.value===!0&&P.target===document.activeElement){const{selectionStart:Be,selectionEnd:et}=P.target;Be!==void 0&&et!==void 0&&nextTick(()=>{P.target===document.activeElement&&Ce.indexOf(P.target.value)===0&&P.target.setSelectionRange(Be,et)})}e.autogrow===!0&&Pe()}function me(P){o("animationend",P),Pe()}function oe(P,Ce){S=()=>{f=null,e.type!=="number"&&E.hasOwnProperty("value")===!0&&delete E.value,e.modelValue!==P&&O!==P&&(O=P,Ce===!0&&(u=!0),o("update:modelValue",P),nextTick(()=>{O===P&&(O=NaN)})),S=void 0},e.type==="number"&&(d=!0,E.value=P),e.debounce!==void 0?(f!==null&&clearTimeout(f),E.value=P,f=setTimeout(S,e.debounce)):S()}function Pe(){requestAnimationFrame(()=>{const P=I.value;if(P!==null){const Ce=P.parentNode.style,{scrollTop:Be}=P,{overflowY:et,maxHeight:Me}=b.platform.is.firefox===!0?{}:window.getComputedStyle(P),ye=et!==void 0&&et!=="scroll";ye===!0&&(P.style.overflowY="hidden"),Ce.marginBottom=P.scrollHeight-1+"px",P.style.height="1px",P.style.height=P.scrollHeight+"px",ye===!0&&(P.style.overflowY=parseInt(Me,10)<P.scrollHeight?"auto":"hidden"),Ce.marginBottom="",P.scrollTop=Be}})}function Ae(P){F(P),f!==null&&(clearTimeout(f),f=null),S==null||S(),o("change",P.target.value)}function Ne(P){P!==void 0&&stop(P),f!==null&&(clearTimeout(f),f=null),S==null||S(),d=!1,u=!1,delete E.value,e.type!=="file"&&setTimeout(()=>{I.value!==null&&(I.value.value=s.value!==void 0?s.value:"")})}function Fe(){return E.hasOwnProperty("value")===!0?E.value:s.value!==void 0?s.value:""}onBeforeUnmount(()=>{Ne()}),onMounted(()=>{e.autogrow===!0&&Pe()}),Object.assign(M,{innerValue:s,fieldClass:computed(()=>`q-${B.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:computed(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:I,emitValue:oe,hasValue:_,floatingLabel:computed(()=>_.value===!0&&(e.type!=="number"||isNaN(s.value)===!1)||fieldValueIsFilled(e.displayValue)),getControl:()=>h(B.value===!0?"textarea":"input",{ref:I,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...te.value,...H.value,...e.type!=="file"?{value:Fe()}:L.value}),getShadowControl:()=>h("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(B.value===!0?"":" text-no-wrap")},[h("span",{class:"invisible"},Fe()),h("span",e.shadowText)])});const je=useField(M);return Object.assign(l,{focus:se,select:Q,getNativeElement:()=>I.value}),injectProp(l,"nativeEl",()=>I.value),je}}),QTh=createComponent({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:o,emit:r}){const l=getCurrentInstance(),{proxy:{$q:b}}=l,E=O=>{r("click",O)};return()=>{if(e.props===void 0)return h("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:E},hSlot(o.default));let O,d;const u=l.vnode.key;if(u){if(O=e.props.colsMap[u],O===void 0)return}else O=e.props.col;if(O.sortable===!0){const S=O.align==="right"?"unshift":"push";d=hUniqueSlot(o.default,[]),d[S](h(QIcon,{class:O.__iconClass,name:b.iconSet.table.arrowUp}))}else d=hSlot(o.default);const f={class:O.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:O.headerStyle,onClick:S=>{O.sortable===!0&&e.props.sort(O),E(S)}};return h("th",f,d)}}}),insetMap={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},margins={xs:2,sm:4,md:8,lg:16,xl:24},QSeparator=createComponent({name:"QSeparator",props:{...useDarkProps,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(e){const o=getCurrentInstance(),r=useDark(e,o.proxy.$q),l=computed(()=>e.vertical===!0?"vertical":"horizontal"),b=computed(()=>` q-separator--${l.value}`),E=computed(()=>e.inset!==!1?`${b.value}-${insetMap[e.inset]}`:""),O=computed(()=>`q-separator${b.value}${E.value}`+(e.color!==void 0?` bg-${e.color}`:"")+(r.value===!0?" q-separator--dark":"")),d=computed(()=>{const u={};if(e.size!==void 0&&(u[e.vertical===!0?"width":"height"]=e.size),e.spaced!==!1){const f=e.spaced===!0?`${margins.md}px`:e.spaced in margins?`${margins[e.spaced]}px`:e.spaced,S=e.vertical===!0?["Left","Right"]:["Top","Bottom"];u[`margin${S[0]}`]=u[`margin${S[1]}`]=f}return u});return()=>h("hr",{class:O.value,style:d.value,"aria-orientation":l.value})}}),roleAttrExceptions=["ul","ol"],QList=createComponent({name:"QList",props:{...useDarkProps,bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},setup(e,{slots:o}){const r=getCurrentInstance(),l=useDark(e,r.proxy.$q),b=computed(()=>roleAttrExceptions.includes(e.tag)?null:"list"),E=computed(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(l.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>h(e.tag,{class:E.value,role:b.value},hSlot(o.default))}}),separatorValues=["horizontal","vertical","cell","none"],QMarkupTable=createComponent({name:"QMarkupTable",props:{...useDarkProps,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>separatorValues.includes(e)}},setup(e,{slots:o}){const r=getCurrentInstance(),l=useDark(e,r.proxy.$q),b=computed(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(l.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>h("div",{class:b.value},[h("table",{class:"q-table"},hSlot(o.default))])}});function getTableMiddle(e,o){return h("div",e,[h("table",{class:"q-table"},o)])}const comps={list:QList,table:QMarkupTable},typeOptions=["list","table","__qtable"],QVirtualScroll=createComponent({name:"QVirtualScroll",props:{...useVirtualScrollProps,type:{type:String,default:"list",validator:e=>typeOptions.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:scrollTargetProp},setup(e,{slots:o,attrs:r}){let l;const b=ref(null),E=computed(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:O,localResetVirtualScroll:d,padVirtualScroll:u,onVirtualScrollEvt:f}=useVirtualScroll({virtualScrollLength:E,getVirtualScrollTarget:v,getVirtualScrollEl:s}),S=computed(()=>{if(E.value===0)return[];const D=(L,_)=>({index:O.value.from+_,item:L});return e.itemsFn===void 0?e.items.slice(O.value.from,O.value.to).map(D):e.itemsFn(O.value.from,O.value.to-O.value.from).map(D)}),I=computed(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),m=computed(()=>e.scrollTarget!==void 0?{}:{tabindex:0});watch(E,()=>{d()}),watch(()=>e.scrollTarget,()=>{g(),j()});function s(){return b.value.$el||b.value}function v(){return l}function j(){l=getScrollTarget(s(),e.scrollTarget),l.addEventListener("scroll",f,listenOpts.passive)}function g(){l!==void 0&&(l.removeEventListener("scroll",f,listenOpts.passive),l=void 0)}function T(){let D=u(e.type==="list"?"div":"tbody",S.value.map(o.default));return o.before!==void 0&&(D=o.before().concat(D)),hMergeSlot(o.after,D)}return onBeforeMount(()=>{d()}),onMounted(()=>{j()}),onActivated(()=>{j()}),onDeactivated(()=>{g()}),onBeforeUnmount(()=>{g()}),()=>{if(o.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?getTableMiddle({ref:b,class:"q-table__middle "+I.value},T()):h(comps[e.type],{...r,ref:b,class:[r.class,I.value],...m.value},T)}}}),defaultSizes={xs:2,sm:4,md:6,lg:10,xl:14};function width(e,o,r){return{transform:o===!0?`translateX(${r.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}const QLinearProgress=createComponent({name:"QLinearProgress",props:{...useDarkProps,...useSizeProps,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:o}){const{proxy:r}=getCurrentInstance(),l=useDark(e,r.$q),b=useSize(e,defaultSizes),E=computed(()=>e.indeterminate===!0||e.query===!0),O=computed(()=>e.reverse!==e.query),d=computed(()=>({...b.value!==null?b.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),u=computed(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),f=computed(()=>width(e.buffer!==void 0?e.buffer:1,O.value,r.$q)),S=computed(()=>`with${e.instantFeedback===!0?"out":""}-transition`),I=computed(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${S.value} q-linear-progress__track--${l.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),m=computed(()=>width(E.value===!0?1:e.value,O.value,r.$q)),s=computed(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${S.value} q-linear-progress__model--${E.value===!0?"in":""}determinate`),v=computed(()=>({width:`${e.value*100}%`})),j=computed(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${S.value}`);return()=>{const g=[h("div",{class:I.value,style:f.value}),h("div",{class:s.value,style:m.value})];return e.stripe===!0&&E.value===!1&&g.push(h("div",{class:j.value,style:v.value})),h("div",{class:u.value,style:d.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},hMergeSlot(o.default,g))}}});function useRefocusTarget(e,o){const r=ref(null),l=computed(()=>e.disable===!0?null:h("span",{ref:r,class:"no-outline",tabindex:-1}));function b(E){const O=o.value;(E==null?void 0:E.qAvoidFocus)!==!0&&((E==null?void 0:E.type.indexOf("key"))===0?document.activeElement!==O&&(O==null?void 0:O.contains(document.activeElement))===!0&&O.focus():r.value!==null&&(E===void 0||(O==null?void 0:O.contains(E.target))===!0)&&r.value.focus())}return{refocusTargetEl:l,refocusTarget:b}}const optionSizes={xs:30,sm:35,md:40,lg:50,xl:60},useCheckboxProps={...useDarkProps,...useSizeProps,...useFormProps,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},useCheckboxEmits=["update:modelValue"];function useCheckbox(e,o){const{props:r,slots:l,emit:b,proxy:E}=getCurrentInstance(),{$q:O}=E,d=useDark(r,O),u=ref(null),{refocusTargetEl:f,refocusTarget:S}=useRefocusTarget(r,u),I=useSize(r,optionSizes),m=computed(()=>r.val!==void 0&&Array.isArray(r.modelValue)),s=computed(()=>{const Q=toRaw(r.val);return m.value===!0?r.modelValue.findIndex(pe=>toRaw(pe)===Q):-1}),v=computed(()=>m.value===!0?s.value!==-1:toRaw(r.modelValue)===toRaw(r.trueValue)),j=computed(()=>m.value===!0?s.value===-1:toRaw(r.modelValue)===toRaw(r.falseValue)),g=computed(()=>v.value===!1&&j.value===!1),T=computed(()=>r.disable===!0?-1:r.tabindex||0),D=computed(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(r.disable===!0?" disabled":"")+(d.value===!0?` q-${e}--dark`:"")+(r.dense===!0?` q-${e}--dense`:"")+(r.leftLabel===!0?" reverse":"")),L=computed(()=>{const Q=v.value===!0?"truthy":j.value===!0?"falsy":"indet",pe=r.color!==void 0&&(r.keepColor===!0||j.value!==!0)?` text-${r.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${Q}${pe}`}),_=computed(()=>{const Q={type:"checkbox"};return r.name!==void 0&&Object.assign(Q,{".checked":v.value,"^checked":v.value===!0?"checked":void 0,name:r.name,value:m.value===!0?r.val:r.trueValue}),Q}),F=useFormInject(_),M=computed(()=>{const Q={tabindex:T.value,role:"checkbox","aria-label":r.label,"aria-checked":g.value===!0?"mixed":v.value===!0?"true":"false"};return r.disable===!0&&(Q["aria-disabled"]="true"),Q});function B(Q){Q!==void 0&&(stopAndPrevent(Q),S(Q)),r.disable!==!0&&b("update:modelValue",K(),Q)}function K(){if(m.value===!0){if(v.value===!0){const Q=r.modelValue.slice();return Q.splice(s.value,1),Q}return r.modelValue.concat([r.val])}if(v.value===!0){if(r.toggleOrder!=="ft"||r.toggleIndeterminate===!1)return r.falseValue}else if(j.value===!0){if(r.toggleOrder==="ft"||r.toggleIndeterminate===!1)return r.trueValue}else return r.toggleOrder!=="ft"?r.trueValue:r.falseValue;return r.indeterminateValue}function H(Q){(Q.keyCode===13||Q.keyCode===32)&&stopAndPrevent(Q)}function te(Q){(Q.keyCode===13||Q.keyCode===32)&&B(Q)}const se=o(v,g);return Object.assign(E,{toggle:B}),()=>{const Q=se();r.disable!==!0&&F(Q,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const pe=[h("div",{class:L.value,style:I.value,"aria-hidden":"true"},Q)];f.value!==null&&pe.push(f.value);const fe=r.label!==void 0?hMergeSlot(l.default,[r.label]):hSlot(l.default);return fe!==void 0&&pe.push(h("div",{class:`q-${e}__label q-anchor--skip`},fe)),h("div",{ref:u,class:D.value,...M.value,onClick:B,onKeydown:H,onKeyup:te},pe)}}const createBgNode=()=>h("div",{key:"svg",class:"q-checkbox__bg absolute"},[h("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[h("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),h("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),QCheckbox=createComponent({name:"QCheckbox",props:useCheckboxProps,emits:useCheckboxEmits,setup(e){const o=createBgNode();function r(l,b){const E=computed(()=>(l.value===!0?e.checkedIcon:b.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>E.value!==null?[h("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[h(QIcon,{class:"q-checkbox__icon",name:E.value})])]:[o]}return useCheckbox("checkbox",r)}});let counter=0;const useFullscreenProps={fullscreen:Boolean,noRouteFullscreenExit:Boolean},useFullscreenEmits=["update:fullscreen","fullscreen"];function useFullscreen(){const e=getCurrentInstance(),{props:o,emit:r,proxy:l}=e;let b,E,O;const d=ref(!1);vmHasRouter(e)===!0&&watch(()=>l.$route.fullPath,()=>{o.noRouteFullscreenExit!==!0&&S()}),watch(()=>o.fullscreen,I=>{d.value!==I&&u()}),watch(d,I=>{r("update:fullscreen",I),r("fullscreen",I)});function u(){d.value===!0?S():f()}function f(){d.value!==!0&&(d.value=!0,O=l.$el.parentNode,O.replaceChild(E,l.$el),document.body.appendChild(l.$el),counter++,counter===1&&document.body.classList.add("q-body--fullscreen-mixin"),b={handler:S},History.add(b))}function S(){d.value===!0&&(b!==void 0&&(History.remove(b),b=void 0),O.replaceChild(l.$el,E),d.value=!1,counter=Math.max(0,counter-1),counter===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),l.$el.scrollIntoView!==void 0&&setTimeout(()=>{l.$el.scrollIntoView()})))}return onBeforeMount(()=>{E=document.createElement("span")}),onMounted(()=>{o.fullscreen===!0&&f()}),onBeforeUnmount(S),Object.assign(l,{toggleFullscreen:u,setFullscreen:f,exitFullscreen:S}),{inFullscreen:d,toggleFullscreen:u}}function sortDate(e,o){return new Date(e)-new Date(o)}const useTableSortProps={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function useTableSort(e,o,r,l){const b=computed(()=>{const{sortBy:d}=o.value;return d&&r.value.find(u=>u.name===d)||null}),E=computed(()=>e.sortMethod!==void 0?e.sortMethod:(d,u,f)=>{const S=r.value.find(s=>s.name===u);if(S===void 0||S.field===void 0)return d;const I=f===!0?-1:1,m=typeof S.field=="function"?s=>S.field(s):s=>s[S.field];return d.sort((s,v)=>{let j=m(s),g=m(v);return S.rawSort!==void 0?S.rawSort(j,g,s,v)*I:j==null?-1*I:g==null?1*I:S.sort!==void 0?S.sort(j,g,s,v)*I:isNumber(j)===!0&&isNumber(g)===!0?(j-g)*I:isDate(j)===!0&&isDate(g)===!0?sortDate(j,g)*I:typeof j=="boolean"&&typeof g=="boolean"?(j-g)*I:([j,g]=[j,g].map(T=>(T+"").toLocaleString().toLowerCase()),j<g?-1*I:j===g?0:I)})});function O(d){let u=e.columnSortOrder;if(isObject(d)===!0)d.sortOrder&&(u=d.sortOrder),d=d.name;else{const I=r.value.find(m=>m.name===d);I!=null&&I.sortOrder&&(u=I.sortOrder)}let{sortBy:f,descending:S}=o.value;f!==d?(f=d,S=u==="da"):e.binaryStateSort===!0?S=!S:S===!0?u==="ad"?f=null:S=!1:u==="ad"?S=!0:f=null,l({sortBy:f,descending:S,page:1})}return{columnToSort:b,computedSortMethod:E,sort:O}}const useTableFilterProps={filter:[String,Object],filterMethod:Function};function useTableFilter(e,o){const r=computed(()=>e.filterMethod!==void 0?e.filterMethod:(l,b,E,O)=>{const d=b?b.toLowerCase():"";return l.filter(u=>E.some(f=>{const S=O(f,u)+"";return(S==="undefined"||S==="null"?"":S.toLowerCase()).indexOf(d)!==-1}))});return watch(()=>e.filter,()=>{nextTick(()=>{o({page:1},!0)})},{deep:!0}),{computedFilterMethod:r}}function samePagination(e,o){for(const r in o)if(o[r]!==e[r])return!1;return!0}function fixPagination(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const useTablePaginationProps={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function useTablePaginationState(e,o){const{props:r,emit:l}=e,b=ref(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:r.rowsPerPageOptions.length!==0?r.rowsPerPageOptions[0]:5},r.pagination)),E=computed(()=>{const S=r["onUpdate:pagination"]!==void 0?{...b.value,...r.pagination}:b.value;return fixPagination(S)}),O=computed(()=>E.value.rowsNumber!==void 0);function d(S){u({pagination:S,filter:r.filter})}function u(S={}){nextTick(()=>{l("request",{pagination:S.pagination||E.value,filter:S.filter||r.filter,getCellValue:o})})}function f(S,I){const m=fixPagination({...E.value,...S});if(samePagination(E.value,m)===!0){O.value===!0&&I===!0&&d(m);return}if(O.value===!0){d(m);return}r.pagination!==void 0&&r["onUpdate:pagination"]!==void 0?l("update:pagination",m):b.value=m}return{innerPagination:b,computedPagination:E,isServerSide:O,requestServerInteraction:u,setPagination:f}}function useTablePagination(e,o,r,l,b,E){const{props:O,emit:d,proxy:{$q:u}}=e,f=computed(()=>l.value===!0?r.value.rowsNumber||0:E.value),S=computed(()=>{const{page:_,rowsPerPage:F}=r.value;return(_-1)*F}),I=computed(()=>{const{page:_,rowsPerPage:F}=r.value;return _*F}),m=computed(()=>r.value.page===1),s=computed(()=>r.value.rowsPerPage===0?1:Math.max(1,Math.ceil(f.value/r.value.rowsPerPage))),v=computed(()=>I.value===0?!0:r.value.page>=s.value),j=computed(()=>(O.rowsPerPageOptions.includes(o.value.rowsPerPage)?O.rowsPerPageOptions:[o.value.rowsPerPage].concat(O.rowsPerPageOptions)).map(F=>({label:F===0?u.lang.table.allRows:""+F,value:F})));watch(s,(_,F)=>{if(_===F)return;const M=r.value.page;_&&!M?b({page:1}):_<M&&b({page:_})});function g(){b({page:1})}function T(){const{page:_}=r.value;_>1&&b({page:_-1})}function D(){const{page:_,rowsPerPage:F}=r.value;I.value>0&&_*F<f.value&&b({page:_+1})}function L(){b({page:s.value})}return O["onUpdate:pagination"]!==void 0&&d("update:pagination",{...r.value}),{firstRowIndex:S,lastRowIndex:I,isFirstPage:m,isLastPage:v,pagesNumber:s,computedRowsPerPageOptions:j,computedRowsNumber:f,firstPage:g,prevPage:T,nextPage:D,lastPage:L}}const useTableRowSelectionProps={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},useTableRowSelectionEmits=["update:selected","selection"];function useTableRowSelection(e,o,r,l){const b=computed(()=>{const v={};return e.selected.map(l.value).forEach(j=>{v[j]=!0}),v}),E=computed(()=>e.selection!=="none"),O=computed(()=>e.selection==="single"),d=computed(()=>e.selection==="multiple"),u=computed(()=>r.value.length!==0&&r.value.every(v=>b.value[l.value(v)]===!0)),f=computed(()=>u.value!==!0&&r.value.some(v=>b.value[l.value(v)]===!0)),S=computed(()=>e.selected.length);function I(v){return b.value[v]===!0}function m(){o("update:selected",[])}function s(v,j,g,T){o("selection",{rows:j,added:g,keys:v,evt:T});const D=O.value===!0?g===!0?j:[]:g===!0?e.selected.concat(j):e.selected.filter(L=>v.includes(l.value(L))===!1);o("update:selected",D)}return{hasSelectionMode:E,singleSelection:O,multipleSelection:d,allRowsSelected:u,someRowsSelected:f,rowsSelectedNumber:S,isRowSelected:I,clearSelection:m,updateSelection:s}}function getVal(e){return Array.isArray(e)?e.slice():[]}const useTableRowExpandProps={expanded:Array},useTableRowExpandEmits=["update:expanded"];function useTableRowExpand(e,o){const r=ref(getVal(e.expanded));watch(()=>e.expanded,O=>{r.value=getVal(O)});function l(O){return r.value.includes(O)}function b(O){e.expanded!==void 0?o("update:expanded",O):r.value=O}function E(O,d){const u=r.value.slice(),f=u.indexOf(O);d===!0?f===-1&&(u.push(O),b(u)):f!==-1&&(u.splice(f,1),b(u))}return{isRowExpanded:l,setExpanded:b,updateExpanded:E}}const useTableColumnSelectionProps={visibleColumns:Array};function useTableColumnSelection(e,o,r){const l=computed(()=>{if(e.columns!==void 0)return e.columns;const d=e.rows[0];return d!==void 0?Object.keys(d).map(u=>({name:u,label:u.toUpperCase(),field:u,align:isNumber(d[u])?"right":"left",sortable:!0})):[]}),b=computed(()=>{const{sortBy:d,descending:u}=o.value;return(e.visibleColumns!==void 0?l.value.filter(S=>S.required===!0||e.visibleColumns.includes(S.name)===!0):l.value).map(S=>{const I=S.align||"right",m=`text-${I}`;return{...S,align:I,__iconClass:`q-table__sort-icon q-table__sort-icon--${I}`,__thClass:m+(S.headerClasses!==void 0?" "+S.headerClasses:"")+(S.sortable===!0?" sortable":"")+(S.name===d?` sorted ${u===!0?"sort-desc":""}`:""),__tdStyle:S.style!==void 0?typeof S.style!="function"?()=>S.style:S.style:()=>null,__tdClass:S.classes!==void 0?typeof S.classes!="function"?()=>m+" "+S.classes:s=>m+" "+S.classes(s):()=>m}})}),E=computed(()=>{const d={};return b.value.forEach(u=>{d[u.name]=u}),d}),O=computed(()=>e.tableColspan!==void 0?e.tableColspan:b.value.length+(r.value===!0?1:0));return{colList:l,computedCols:b,computedColsMap:E,computedColspan:O}}const bottomClass="q-table__bottom row items-center",virtScrollPassthroughProps={};commonVirtScrollPropsList.forEach(e=>{virtScrollPassthroughProps[e]={}});const QTable=createComponent({name:"QTable",props:{rows:{type:Array,required:!0},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{},...virtScrollPassthroughProps,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],tableRowStyleFn:Function,tableRowClassFn:Function,cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],cardStyleFn:Function,cardClassFn:Function,hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...useDarkProps,...useFullscreenProps,...useTableColumnSelectionProps,...useTableFilterProps,...useTablePaginationProps,...useTableRowExpandProps,...useTableRowSelectionProps,...useTableSortProps},emits:["request","virtualScroll",...useFullscreenEmits,...useTableRowExpandEmits,...useTableRowSelectionEmits],setup(e,{slots:o,emit:r}){const l=getCurrentInstance(),{proxy:{$q:b}}=l,E=useDark(e,b),{inFullscreen:O,toggleFullscreen:d}=useFullscreen(),u=computed(()=>typeof e.rowKey=="function"?e.rowKey:ne=>ne[e.rowKey]),f=ref(null),S=ref(null),I=computed(()=>e.grid!==!0&&e.virtualScroll===!0),m=computed(()=>" q-table__card"+(E.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),s=computed(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":m.value)+(E.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(O.value===!0?" fullscreen scroll":"")),v=computed(()=>s.value+(e.loading===!0?" q-table--loading":""));watch(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+s.value,()=>{var ne;I.value===!0&&((ne=S.value)==null||ne.reset())});const{innerPagination:j,computedPagination:g,isServerSide:T,requestServerInteraction:D,setPagination:L}=useTablePaginationState(l,V),{computedFilterMethod:_}=useTableFilter(e,L),{isRowExpanded:F,setExpanded:M,updateExpanded:B}=useTableRowExpand(e,r),K=computed(()=>{let ne=e.rows;if(T.value===!0||ne.length===0)return ne;const{sortBy:be,descending:U}=g.value;return e.filter&&(ne=_.value(ne,e.filter,je.value,V)),Be.value!==null&&(ne=et.value(e.rows===ne?ne.slice():ne,be,U)),ne}),H=computed(()=>K.value.length),te=computed(()=>{let ne=K.value;if(T.value===!0)return ne;const{rowsPerPage:be}=g.value;return be!==0&&(ye.value===0&&e.rows!==ne?ne.length>ke.value&&(ne=ne.slice(0,ke.value)):ne=ne.slice(ye.value,ke.value)),ne}),{hasSelectionMode:se,singleSelection:Q,multipleSelection:pe,allRowsSelected:fe,someRowsSelected:me,rowsSelectedNumber:oe,isRowSelected:Pe,clearSelection:Ae,updateSelection:Ne}=useTableRowSelection(e,r,te,u),{colList:Fe,computedCols:je,computedColsMap:P,computedColspan:Ce}=useTableColumnSelection(e,g,se),{columnToSort:Be,computedSortMethod:et,sort:Me}=useTableSort(e,g,Fe,L),{firstRowIndex:ye,lastRowIndex:ke,isFirstPage:Ee,isLastPage:Ye,pagesNumber:Ge,computedRowsPerPageOptions:lt,computedRowsNumber:at,firstPage:ft,prevPage:vt,nextPage:jt,lastPage:Tt}=useTablePagination(l,j,g,T,L,H),At=computed(()=>te.value.length===0),Dt=computed(()=>{const ne={};return commonVirtScrollPropsList.forEach(be=>{ne[be]=e[be]}),ne.virtualScrollItemSize===void 0&&(ne.virtualScrollItemSize=e.dense===!0?28:48),ne});function Lt(){I.value===!0&&S.value.reset()}function pt(){if(e.grid===!0)return re();const ne=e.hideHeader!==!0?ce:null;if(I.value===!0){const U=o["top-row"],X=o["bottom-row"],C={default:q=>k(q.item,o.body,q.index)};if(U!==void 0){const q=h("tbody",U({cols:je.value}));C.before=ne===null?()=>q:()=>[ne()].concat(q)}else ne!==null&&(C.before=ne);return X!==void 0&&(C.after=()=>h("tbody",X({cols:je.value}))),h(QVirtualScroll,{ref:S,class:e.tableClass,style:e.tableStyle,...Dt.value,scrollTarget:e.virtualScrollTarget,items:te.value,type:"__qtable",tableColspan:Ce.value,onVirtualScroll:St},C)}const be=[p()];return ne!==null&&be.unshift(ne()),getTableMiddle({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},be)}function wt(ne,be){if(S.value!==null){S.value.scrollTo(ne,be);return}ne=parseInt(ne,10);const U=f.value.querySelector(`tbody tr:nth-of-type(${ne+1})`);if(U!==null){const X=f.value.querySelector(".q-table__middle.scroll"),C=U.offsetTop-e.virtualScrollStickySizeStart,q=C<X.scrollTop?"decrease":"increase";X.scrollTop=C,r("virtualScroll",{index:ne,from:0,to:j.value.rowsPerPage-1,direction:q})}}function St(ne){r("virtualScroll",ne)}function A(){return[h(QLinearProgress,{class:"q-table__linear-progress",color:e.color,dark:E.value,indeterminate:!0,trackColor:"transparent"})]}function k(ne,be,U){const X=u.value(ne),C=Pe(X);if(be!==void 0){const J={key:X,row:ne,pageIndex:U,__trClass:C?"selected":""};if(e.tableRowStyleFn!==void 0&&(J.__trStyle=e.tableRowStyleFn(ne)),e.tableRowClassFn!==void 0){const he=e.tableRowClassFn(ne);he&&(J.__trClass=`${he} ${J.__trClass}`)}return be(a(J))}const q=o["body-cell"],G=je.value.map(J=>{const he=o[`body-cell-${J.name}`],Te=he!==void 0?he:q;return Te!==void 0?Te(W({key:X,row:ne,pageIndex:U,col:J})):h("td",{class:J.__tdClass(ne),style:J.__tdStyle(ne)},V(J,ne))});if(se.value===!0){const J=o["body-selection"],he=J!==void 0?J(ae({key:X,row:ne,pageIndex:U})):[h(QCheckbox,{modelValue:C,color:e.color,dark:E.value,dense:e.dense,"onUpdate:modelValue":(Te,qe)=>{Ne([X],[ne],Te,qe)}})];G.unshift(h("td",{class:"q-table--col-auto-width"},he))}const ge={key:X,class:{selected:C}};if(e.onRowClick!==void 0&&(ge.class["cursor-pointer"]=!0,ge.onClick=J=>{r("rowClick",J,ne,U)}),e.onRowDblclick!==void 0&&(ge.class["cursor-pointer"]=!0,ge.onDblclick=J=>{r("rowDblclick",J,ne,U)}),e.onRowContextmenu!==void 0&&(ge.class["cursor-pointer"]=!0,ge.onContextmenu=J=>{r("rowContextmenu",J,ne,U)}),e.tableRowStyleFn!==void 0&&(ge.style=e.tableRowStyleFn(ne)),e.tableRowClassFn!==void 0){const J=e.tableRowClassFn(ne);J&&(ge.class[J]=!0)}return h("tr",ge,G)}function p(){const ne=o.body,be=o["top-row"],U=o["bottom-row"];let X=te.value.map((C,q)=>k(C,ne,q));return be!==void 0&&(X=be({cols:je.value}).concat(X)),U!==void 0&&(X=X.concat(U({cols:je.value}))),h("tbody",X)}function a(ne){return ie(ne),ne.cols=ne.cols.map(be=>injectProp({...be},"value",()=>V(be,ne.row))),ne}function W(ne){return ie(ne),injectProp(ne,"value",()=>V(ne.col,ne.row)),ne}function ae(ne){return ie(ne),ne}function ie(ne){Object.assign(ne,{cols:je.value,colsMap:P.value,sort:Me,rowIndex:ye.value+ne.pageIndex,color:e.color,dark:E.value,dense:e.dense}),se.value===!0&&injectProp(ne,"selected",()=>Pe(ne.key),(be,U)=>{Ne([ne.key],[ne.row],be,U)}),injectProp(ne,"expand",()=>F(ne.key),be=>{B(ne.key,be)})}function V(ne,be){const U=typeof ne.field=="function"?ne.field(be):be[ne.field];return ne.format!==void 0?ne.format(U,be):U}const N=computed(()=>({pagination:g.value,pagesNumber:Ge.value,isFirstPage:Ee.value,isLastPage:Ye.value,firstPage:ft,prevPage:vt,nextPage:jt,lastPage:Tt,inFullscreen:O.value,toggleFullscreen:d}));function Y(){const ne=o.top,be=o["top-left"],U=o["top-right"],X=o["top-selection"],C=se.value===!0&&X!==void 0&&oe.value>0,q="q-table__top relative-position row items-center";if(ne!==void 0)return h("div",{class:q},[ne(N.value)]);let G;if(C===!0?G=X(N.value).slice():(G=[],be!==void 0?G.push(h("div",{class:"q-table__control"},[be(N.value)])):e.title&&G.push(h("div",{class:"q-table__control"},[h("div",{class:["q-table__title",e.titleClass]},e.title)]))),U!==void 0&&(G.push(h("div",{class:"q-table__separator col"})),G.push(h("div",{class:"q-table__control"},[U(N.value)]))),G.length!==0)return h("div",{class:q},G)}const ee=computed(()=>me.value===!0?null:fe.value);function ce(){const ne=Se();return e.loading===!0&&o.loading===void 0&&ne.push(h("tr",{class:"q-table__progress"},[h("th",{class:"relative-position",colspan:Ce.value},A())])),h("thead",ne)}function Se(){const ne=o.header,be=o["header-cell"];if(ne!==void 0)return ne(ve({header:!0})).slice();const U=je.value.map(X=>{const C=o[`header-cell-${X.name}`],q=C!==void 0?C:be,G=ve({col:X});return q!==void 0?q(G):h(QTh,{key:X.name,props:G},()=>X.label)});if(Q.value===!0&&e.grid!==!0)U.unshift(h("th",{class:"q-table--col-auto-width"}," "));else if(pe.value===!0){const X=o["header-selection"],C=X!==void 0?X(ve({})):[h(QCheckbox,{color:e.color,modelValue:ee.value,dark:E.value,dense:e.dense,"onUpdate:modelValue":xe})];U.unshift(h("th",{class:"q-table--col-auto-width"},C))}return[h("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},U)]}function ve(ne){return Object.assign(ne,{cols:je.value,sort:Me,colsMap:P.value,color:e.color,dark:E.value,dense:e.dense}),pe.value===!0&&injectProp(ne,"selected",()=>ee.value,xe),ne}function xe(ne){me.value===!0&&(ne=!1),Ne(te.value.map(u.value),te.value,ne)}const Re=computed(()=>{const ne=[e.iconFirstPage||b.iconSet.table.firstPage,e.iconPrevPage||b.iconSet.table.prevPage,e.iconNextPage||b.iconSet.table.nextPage,e.iconLastPage||b.iconSet.table.lastPage];return b.lang.rtl===!0?ne.reverse():ne});function ze(){if(e.hideBottom===!0)return;if(At.value===!0){if(e.hideNoData===!0)return;const U=e.loading===!0?e.loadingLabel||b.lang.table.loading:e.filter?e.noResultsLabel||b.lang.table.noResults:e.noDataLabel||b.lang.table.noData,X=o["no-data"],C=X!==void 0?[X({message:U,icon:b.iconSet.table.warning,filter:e.filter})]:[h(QIcon,{class:"q-table__bottom-nodata-icon",name:b.iconSet.table.warning}),U];return h("div",{class:bottomClass+" q-table__bottom--nodata"},C)}const ne=o.bottom;if(ne!==void 0)return h("div",{class:bottomClass},[ne(N.value)]);const be=e.hideSelectedBanner!==!0&&se.value===!0&&oe.value>0?[h("div",{class:"q-table__control"},[h("div",[(e.selectedRowsLabel||b.lang.table.selectedRecords)(oe.value)])])]:[];if(e.hidePagination!==!0)return h("div",{class:bottomClass+" justify-end"},Je(be));if(be.length!==0)return h("div",{class:bottomClass},be)}function $e(ne){L({page:1,rowsPerPage:ne.value})}function Je(ne){let be;const{rowsPerPage:U}=g.value,X=e.paginationLabel||b.lang.table.pagination,C=o.pagination,q=e.rowsPerPageOptions.length>1;if(ne.push(h("div",{class:"q-table__separator col"})),q===!0&&ne.push(h("div",{class:"q-table__control"},[h("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||b.lang.table.recordsPerPage]),h(QSelect,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:U,options:lt.value,displayValue:U===0?b.lang.table.allRows:U,dark:E.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":$e})])),C!==void 0)be=C(N.value);else if(be=[h("span",U!==0?{class:"q-table__bottom-item"}:{},[U?X(ye.value+1,Math.min(ke.value,at.value),at.value):X(1,H.value,at.value)])],U!==0&&Ge.value>1){const G={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(G.size="sm"),Ge.value>2&&be.push(h(QBtn,{key:"pgFirst",...G,icon:Re.value[0],disable:Ee.value,ariaLabel:b.lang.pagination.first,onClick:ft})),be.push(h(QBtn,{key:"pgPrev",...G,icon:Re.value[1],disable:Ee.value,ariaLabel:b.lang.pagination.prev,onClick:vt}),h(QBtn,{key:"pgNext",...G,icon:Re.value[2],disable:Ye.value,ariaLabel:b.lang.pagination.next,onClick:jt})),Ge.value>2&&be.push(h(QBtn,{key:"pgLast",...G,icon:Re.value[3],disable:Ye.value,ariaLabel:b.lang.pagination.last,onClick:Tt}))}return ne.push(h("div",{class:"q-table__control"},be)),ne}function nt(){const ne=e.gridHeader===!0?[h("table",{class:"q-table"},[ce()])]:e.loading===!0&&o.loading===void 0?A():void 0;return h("div",{class:"q-table__middle"},ne)}function re(){const ne=o.item!==void 0?o.item:be=>{const U=be.cols.map(C=>h("div",{class:"q-table__grid-item-row"},[h("div",{class:"q-table__grid-item-title"},[C.label]),h("div",{class:"q-table__grid-item-value"},[C.value])]));if(se.value===!0){const C=o["body-selection"],q=C!==void 0?C(be):[h(QCheckbox,{modelValue:be.selected,color:e.color,dark:E.value,dense:e.dense,"onUpdate:modelValue":(G,ge)=>{Ne([be.key],[be.row],G,ge)}})];U.unshift(h("div",{class:"q-table__grid-item-row"},q),h(QSeparator,{dark:E.value}))}const X={class:["q-table__grid-item-card"+m.value,e.cardClass],style:e.cardStyle};if(e.cardStyleFn!==void 0&&(X.style=[X.style,e.cardStyleFn(be.row)]),e.cardClassFn!==void 0){const C=e.cardClassFn(be.row);C&&(X.class[0]+=` ${C}`)}return(e.onRowClick!==void 0||e.onRowDblclick!==void 0||e.onRowContextmenu!==void 0)&&(X.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(X.onClick=C=>{r("RowClick",C,be.row,be.pageIndex)}),e.onRowDblclick!==void 0&&(X.onDblclick=C=>{r("RowDblclick",C,be.row,be.pageIndex)}),e.onRowContextmenu!==void 0&&(X.onContextmenu=C=>{r("rowContextmenu",C,be.row,be.pageIndex)})),h("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(be.selected===!0?" q-table__grid-item--selected":"")},[h("div",X,U)])};return h("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},te.value.map((be,U)=>ne(a({key:u.value(be),row:be,pageIndex:U}))))}return Object.assign(l.proxy,{requestServerInteraction:D,setPagination:L,firstPage:ft,prevPage:vt,nextPage:jt,lastPage:Tt,isRowSelected:Pe,clearSelection:Ae,isRowExpanded:F,setExpanded:M,sort:Me,resetVirtualScroll:Lt,scrollTo:wt,getCellValue:V}),injectMultipleProps(l.proxy,{filteredSortedRows:()=>K.value,computedRows:()=>te.value,computedRowsNumber:()=>at.value}),()=>{const ne=[Y()],be={ref:f,class:v.value};return e.grid===!0?ne.push(nt()):Object.assign(be,{class:[be.class,e.cardClass],style:e.cardStyle}),ne.push(pt(),ze()),e.loading===!0&&o.loading!==void 0&&ne.push(o.loading()),h("div",be,ne)}}}),QCard=createComponent({name:"QCard",props:{...useDarkProps,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:o}){const{proxy:{$q:r}}=getCurrentInstance(),l=useDark(e,r),b=computed(()=>"q-card"+(l.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>h(e.tag,{class:b.value},hSlot(o.default))}}),QToolbarTitle=createComponent({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:o}){const r=computed(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>h("div",{class:r.value},hSlot(o.default))}}),QToolbar=createComponent({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:o}){const r=computed(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>h("div",{class:r.value,role:"toolbar"},hSlot(o.default))}}),QCardActions=createComponent({name:"QCardActions",props:{...useAlignProps,vertical:Boolean},setup(e,{slots:o}){const r=useAlign(e),l=computed(()=>`q-card__actions ${r.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>h("div",{class:l.value},hSlot(o.default))}});function getDepth(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const o=parseInt(e,10);return isNaN(o)?0:o}const ClosePopup=createDirective({name:"close-popup",beforeMount(e,{value:o}){const r={depth:getDepth(o),handler(l){r.depth!==0&&setTimeout(()=>{const b=getPortalProxy(e);b!==void 0&&closePortals(b,l,r.depth)})},handlerKey(l){isKeyCode(l,13)===!0&&r.handler(l)}};e.__qclosepopup=r,e.addEventListener("click",r.handler),e.addEventListener("keyup",r.handlerKey)},updated(e,{value:o,oldValue:r}){o!==r&&(e.__qclosepopup.depth=getDepth(o))},beforeUnmount(e){const o=e.__qclosepopup;e.removeEventListener("click",o.handler),e.removeEventListener("keyup",o.handlerKey),delete e.__qclosepopup}});function useQuasar(){return inject(quasarKey)}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$1={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(e,o){(function(r,l){e.exports=l()})(jsuites,function(){var r;return function(){var l={195:function(d){(function(u,f){d.exports=f()})(this,function(){return function(Be){function f(ye,ke){this.highOrder=ye,this.lowOrder=ke}var S=[new f(1779033703,4089235720),new f(3144134277,2227873595),new f(1013904242,4271175723),new f(2773480762,1595750129),new f(1359893119,2917565137),new f(2600822924,725511199),new f(528734635,4215389547),new f(1541459225,327033209)],I=[new f(1116352408,3609767458),new f(1899447441,602891725),new f(3049323471,3964484399),new f(3921009573,2173295548),new f(961987163,4081628472),new f(1508970993,3053834265),new f(2453635748,2937671579),new f(2870763221,3664609560),new f(3624381080,2734883394),new f(310598401,1164996542),new f(607225278,1323610764),new f(1426881987,3590304994),new f(1925078388,4068182383),new f(2162078206,991336113),new f(2614888103,633803317),new f(3248222580,3479774868),new f(3835390401,2666613458),new f(4022224774,944711139),new f(264347078,2341262773),new f(604807628,2007800933),new f(770255983,1495990901),new f(1249150122,1856431235),new f(1555081692,3175218132),new f(1996064986,2198950837),new f(2554220882,3999719339),new f(2821834349,766784016),new f(2952996808,2566594879),new f(3210313671,3203337956),new f(3336571891,1034457026),new f(3584528711,2466948901),new f(113926993,3758326383),new f(338241895,168717936),new f(666307205,1188179964),new f(773529912,1546045734),new f(1294757372,1522805485),new f(1396182291,2643833823),new f(1695183700,2343527390),new f(1986661051,1014477480),new f(2177026350,1206759142),new f(2456956037,344077627),new f(2730485921,1290863460),new f(2820302411,3158454273),new f(3259730800,3505952657),new f(3345764771,106217008),new f(3516065817,3606008344),new f(3600352804,1432725776),new f(4094571909,1467031594),new f(275423344,851169720),new f(430227734,3100823752),new f(506948616,1363258195),new f(659060556,3750685593),new f(883997877,3785050280),new f(958139571,3318307427),new f(1322822218,3812723403),new f(1537002063,2003034995),new f(1747873779,3602036899),new f(1955562222,1575990012),new f(2024104815,1125592928),new f(2227730452,2716904306),new f(2361852424,442776044),new f(2428436474,593698344),new f(2756734187,3733110249),new f(3204031479,2999351573),new f(3329325298,3815920427),new f(3391569614,3928383900),new f(3515267271,566280711),new f(3940187606,3454069534),new f(4118630271,4000239992),new f(116418474,1914138554),new f(174292421,2731055270),new f(289380356,3203993006),new f(460393269,320620315),new f(685471733,587496836),new f(852142971,1086792851),new f(1017036298,365543100),new f(1126000580,2618297676),new f(1288033470,3409855158),new f(1501505948,4234509866),new f(1607167915,987167468),new f(1816402316,1246189591)],m=new Array(64),s,v,j,g,T,D,L,_,F,M,B,K,H=8;function te(ye){return unescape(encodeURIComponent(ye))}function se(ye){for(var ke=[],Ee=(1<<H)-1,Ye=ye.length*H,Ge=0;Ge<Ye;Ge+=H)ke[Ge>>5]|=(ye.charCodeAt(Ge/H)&Ee)<<32-H-Ge%32;return ke}function Q(ye){for(var ke="0123456789abcdef",Ee="",Ye=ye.length*4,Ge,lt=0;lt<Ye;lt+=1)Ge=ye[lt>>2]>>(3-lt%4)*8,Ee+=ke.charAt(Ge>>4&15)+ke.charAt(Ge&15);return Ee}function pe(ye,ke){var Ee,Ye,Ge,lt;return Ee=(ye.lowOrder&65535)+(ke.lowOrder&65535),Ye=(ye.lowOrder>>>16)+(ke.lowOrder>>>16)+(Ee>>>16),Ge=(Ye&65535)<<16|Ee&65535,Ee=(ye.highOrder&65535)+(ke.highOrder&65535)+(Ye>>>16),Ye=(ye.highOrder>>>16)+(ke.highOrder>>>16)+(Ee>>>16),lt=(Ye&65535)<<16|Ee&65535,new f(lt,Ge)}function fe(ye,ke,Ee,Ye){var Ge,lt,at,ft;return Ge=(ye.lowOrder&65535)+(ke.lowOrder&65535)+(Ee.lowOrder&65535)+(Ye.lowOrder&65535),lt=(ye.lowOrder>>>16)+(ke.lowOrder>>>16)+(Ee.lowOrder>>>16)+(Ye.lowOrder>>>16)+(Ge>>>16),at=(lt&65535)<<16|Ge&65535,Ge=(ye.highOrder&65535)+(ke.highOrder&65535)+(Ee.highOrder&65535)+(Ye.highOrder&65535)+(lt>>>16),lt=(ye.highOrder>>>16)+(ke.highOrder>>>16)+(Ee.highOrder>>>16)+(Ye.highOrder>>>16)+(Ge>>>16),ft=(lt&65535)<<16|Ge&65535,new f(ft,at)}function me(ye,ke,Ee,Ye,Ge){var lt,at,ft,vt;return lt=(ye.lowOrder&65535)+(ke.lowOrder&65535)+(Ee.lowOrder&65535)+(Ye.lowOrder&65535)+(Ge.lowOrder&65535),at=(ye.lowOrder>>>16)+(ke.lowOrder>>>16)+(Ee.lowOrder>>>16)+(Ye.lowOrder>>>16)+(Ge.lowOrder>>>16)+(lt>>>16),ft=(at&65535)<<16|lt&65535,lt=(ye.highOrder&65535)+(ke.highOrder&65535)+(Ee.highOrder&65535)+(Ye.highOrder&65535)+(Ge.highOrder&65535)+(at>>>16),at=(ye.highOrder>>>16)+(ke.highOrder>>>16)+(Ee.highOrder>>>16)+(Ye.highOrder>>>16)+(Ge.highOrder>>>16)+(lt>>>16),vt=(at&65535)<<16|lt&65535,new f(vt,ft)}function oe(ye,ke,Ee){return new f(ye.highOrder&ke.highOrder^ye.highOrder&Ee.highOrder^ke.highOrder&Ee.highOrder,ye.lowOrder&ke.lowOrder^ye.lowOrder&Ee.lowOrder^ke.lowOrder&Ee.lowOrder)}function Pe(ye,ke,Ee){return new f(ye.highOrder&ke.highOrder^~ye.highOrder&Ee.highOrder,ye.lowOrder&ke.lowOrder^~ye.lowOrder&Ee.lowOrder)}function Ae(ye,ke){return ke<=32?new f(ye.highOrder>>>ke|ye.lowOrder<<32-ke,ye.lowOrder>>>ke|ye.highOrder<<32-ke):new f(ye.lowOrder>>>ke|ye.highOrder<<32-ke,ye.highOrder>>>ke|ye.lowOrder<<32-ke)}function Ne(ye){var ke=Ae(ye,28),Ee=Ae(ye,34),Ye=Ae(ye,39);return new f(ke.highOrder^Ee.highOrder^Ye.highOrder,ke.lowOrder^Ee.lowOrder^Ye.lowOrder)}function Fe(ye){var ke=Ae(ye,14),Ee=Ae(ye,18),Ye=Ae(ye,41);return new f(ke.highOrder^Ee.highOrder^Ye.highOrder,ke.lowOrder^Ee.lowOrder^Ye.lowOrder)}function je(ye){var ke=Ae(ye,1),Ee=Ae(ye,8),Ye=Ce(ye,7);return new f(ke.highOrder^Ee.highOrder^Ye.highOrder,ke.lowOrder^Ee.lowOrder^Ye.lowOrder)}function P(ye){var ke=Ae(ye,19),Ee=Ae(ye,61),Ye=Ce(ye,6);return new f(ke.highOrder^Ee.highOrder^Ye.highOrder,ke.lowOrder^Ee.lowOrder^Ye.lowOrder)}function Ce(ye,ke){return ke<=32?new f(ye.highOrder>>>ke,ye.lowOrder>>>ke|ye.highOrder<<32-ke):new f(0,ye.highOrder<<32-ke)}var Be=te(Be),et=Be.length*H;Be=se(Be),Be[et>>5]|=128<<24-et%32,Be[(et+128>>10<<5)+31]=et;for(var F=0;F<Be.length;F+=32){s=S[0],v=S[1],j=S[2],g=S[3],T=S[4],D=S[5],L=S[6],_=S[7];for(var M=0;M<80;M++)M<16?m[M]=new f(Be[M*2+F],Be[M*2+F+1]):m[M]=fe(P(m[M-2]),m[M-7],je(m[M-15]),m[M-16]),B=me(_,Fe(T),Pe(T,D,L),I[M],m[M]),K=pe(Ne(s),oe(s,v,j)),_=L,L=D,D=T,T=pe(g,B),g=j,j=v,v=s,s=pe(B,K);S[0]=pe(s,S[0]),S[1]=pe(v,S[1]),S[2]=pe(j,S[2]),S[3]=pe(g,S[3]),S[4]=pe(T,S[4]),S[5]=pe(D,S[5]),S[6]=pe(L,S[6]),S[7]=pe(_,S[7])}for(var Me=[],F=0;F<S.length;F++)Me.push(S[F].highOrder),Me.push(S[F].lowOrder);return Q(Me)}})}},b={};function E(d){var u=b[d];if(u!==void 0)return u.exports;var f=b[d]={exports:{}};return l[d].call(f.exports,f,f.exports,E),f.exports}(function(){E.n=function(d){var u=d&&d.__esModule?function(){return d.default}:function(){return d};return E.d(u,{a:u}),u}})(),function(){E.d=function(d,u){for(var f in u)E.o(u,f)&&!E.o(d,f)&&Object.defineProperty(d,f,{enumerable:!0,get:u[f]})}}(),function(){E.o=function(d,u){return Object.prototype.hasOwnProperty.call(d,u)}}();var O={};(function(){E.d(O,{default:function(){return St}});var d=function(A){document.dictionary||(document.dictionary={});var k=null,p=Object.keys(A);for(k=0;k<p.length;k++)document.dictionary[p[k]]=A[p[k]]},u=function(A){return typeof document<"u"&&document.dictionary&&document.dictionary[A]||A},f={setDictionary:d,translate:u},I=function(A,k){if(k===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(a){return a!==null}),setTimeout(function(){window.jSuitesStateControl.push(A)},0);else{var p=window.jSuitesStateControl.indexOf(A);p>=0&&window.jSuitesStateControl.splice(p,1)}},m={};m.two=function(A){return A=""+A,A.length==1&&(A="0"+A),A},m.focus=function(A){if(A.innerText.length){var k=document.createRange(),p=window.getSelection(),a=A.childNodes[A.childNodes.length-1];k.setStart(a,a.length),k.collapse(!0),p.removeAllRanges(),p.addRange(k),A.scrollLeft=A.scrollWidth}},m.isNumeric=function(A){return typeof A=="string"&&(A=A.trim()),!isNaN(A)&&A!==null&&A!==""},m.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(A){var k=Math.random()*16|0,p=A=="x"?k:k&3|8;return p.toString(16)})},m.getNode=function(){var A=document.getSelection().anchorNode;return A?A.nodeType==3?A.parentNode:A:null},m.hash=function(A){var k=0,p,a;if(A.length===0)return k;for(p=0;p<A.length;p++)a=A.charCodeAt(p),a>32&&(k=(k<<5)-k+a,k|=0);return k},m.randomColor=function(A){var k=-.25,p=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");p.length<6&&(p=p[0]+p[0]+p[1]+p[1]+p[2]+p[2]);var a=[],W,ae;for(ae=0;ae<3;ae++)W=parseInt(p.substr(ae*2,2),16),W=Math.round(Math.min(Math.max(0,W+W*k),255)).toString(16),a.push(("00"+W).substr(W.length));return A==!0?"#"+m.two(a[0].toString(16))+m.two(a[1].toString(16))+m.two(a[2].toString(16)):a},m.getWindowWidth=function(){var A=window,k=document,p=k.documentElement,a=k.getElementsByTagName("body")[0],W=A.innerWidth||p.clientWidth||a.clientWidth;return W},m.getWindowHeight=function(){var A=window,k=document,p=k.documentElement,a=k.getElementsByTagName("body")[0],W=A.innerHeight||p.clientHeight||a.clientHeight;return W},m.getPosition=function(A){if(A.changedTouches&&A.changedTouches[0])var k=A.changedTouches[0].pageX,p=A.changedTouches[0].pageY;else var k=window.Event?A.pageX:A.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),p=window.Event?A.pageY:A.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[k,p]},m.click=function(A){if(A.click)A.click();else{var k=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});A.dispatchEvent(k)}},m.findElement=function(A,k){var p=!1;function a(W){W&&!p&&(typeof k=="function"?p=k(W):typeof k=="string"&&W.classList&&W.classList.contains(k)&&(p=W)),W.parentNode&&!p&&a(W.parentNode)}return a(A),p};var s=m;function v(A,k,p){if(A=A.split("."),A.length){let a=this,W=null;for(;A.length>1;)if(W=A.shift(),a.hasOwnProperty(W))a=a[W];else{if(typeof k>"u")return;a[W]={},a=a[W]}if(W=A.shift(),typeof k<"u")return p===!0?delete a[W]:a[W]=k,!0;if(a)return a[W]}return!1}function j(A,k){var p={};p.options={};var a={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},W=null;for(var ae in a)k&&k.hasOwnProperty(ae)?p.options[ae]=k[ae]:p.options[ae]=a[ae];A.classList.add("jsorting"),A.addEventListener("dragstart",function(N){let Y=N.target;if(Y.nodeType===3)if(Y.parentNode.getAttribute("draggable")==="true")Y=Y.parentNode;else{N.preventDefault(),N.stopPropagation();return}if(Y.getAttribute("draggable")==="true"){let ee=Array.prototype.indexOf.call(Y.parentNode.children,Y);W={element:Y,o:ee,d:ee},Y.style.opacity="0.25",typeof p.options.ondragstart=="function"&&p.options.ondragstart(A,Y,N),N.dataTransfer.setDragImage(Y,0,0)}}),A.addEventListener("dragover",function(N){if(N.preventDefault(),W&&ie(N.target)&&N.target.getAttribute("draggable")=="true"&&W.element!=N.target){if(p.options.direction)var Y=N.target.clientWidth/2>N.offsetX;else var Y=N.target.clientHeight/2>N.offsetY;Y?N.target.parentNode.insertBefore(W.element,N.target):N.target.parentNode.insertBefore(W.element,N.target.nextSibling),W.d=Array.prototype.indexOf.call(N.target.parentNode.children,W.element)}}),A.addEventListener("dragleave",function(N){N.preventDefault()}),A.addEventListener("dragend",function(N){N.preventDefault(),W&&(typeof p.options.ondragend=="function"&&p.options.ondragend(A,W.element,N),W.o<W.d?N.target.parentNode.insertBefore(W.element,N.target.parentNode.children[W.o]):N.target.parentNode.insertBefore(W.element,N.target.parentNode.children[W.o].nextSibling),W.element.style.opacity="",W=null)}),A.addEventListener("drop",function(N){N.preventDefault(),W&&(W.o!==W.d&&typeof p.options.ondrop=="function"&&p.options.ondrop(A,W.o,W.d,W.element,N.target,N),W.element.style.opacity="",W=null)});for(var ie=function(N){var Y=!1;function ee(ce){ce.className&&ce.classList.contains("jsorting")&&(Y=!0),Y||ee(ce.parentNode)}return ee(N),Y},V=0;V<A.children.length;V++)A.children[V].hasAttribute("draggable")||A.children[V].setAttribute("draggable","true");return A.val=function(){for(var N=null,Y=[],ee=0;ee<A.children.length;ee++)(N=A.children[ee].getAttribute("data-id"))&&Y.push(N);return Y},A}function g(A,k){var p={};(!k.loadUp||typeof k.loadUp!="function")&&(k.loadUp=function(){return!1}),(!k.loadDown||typeof k.loadDown!="function")&&(k.loadDown=function(){return!1}),k.timer||(k.timer=100);var a=null,W=function(ae){if(a==null){var ie=!1,V=A.scrollTop;A.scrollTop+A.clientHeight*2>=A.scrollHeight?k.loadDown()&&(V==A.scrollTop&&(A.scrollTop=A.scrollTop-A.clientHeight),ie=!0):A.scrollTop<=A.clientHeight&&k.loadUp()&&(V==A.scrollTop&&(A.scrollTop=A.scrollTop+A.clientHeight),ie=!0),a=setTimeout(function(){a=null},k.timer),ie&&typeof k.onupdate=="function"&&k.onupdate()}};return A.onscroll=function(ae){W()},A.onwheel=function(ae){W()},p}function T(){var A=function(k,p){if(Array.isArray(k)){var a={instance:[],complete:p};if(k.length>0)for(var W=0;W<k.length;W++)k[W].multiple=a,a.instance.push(A(k[W]));return a}if(k.data||(k.data={}),k.type&&(k.method=k.type),k.method||(k.method="GET"),k.dataType||(k.dataType="json"),k.data){var ae=function(ce,Se){var ve=[];if(ce){var xe=Object.keys(ce);if(xe.length)for(var Re=0;Re<xe.length;Re++){if(Se)var ze=Se+"["+xe[Re]+"]";else var ze=xe[Re];if(ce[ze]instanceof FileList)ve[ze]=ce[xe[Re]];else if(ce[xe[Re]]===null||ce[xe[Re]]===void 0)ve[ze]="";else if(typeof ce[xe[Re]]=="object")for(var $e=ae(ce[xe[Re]],ze),Je=Object.keys($e),nt=0;nt<Je.length;nt++)ve[Je[nt]]=$e[Je[nt]];else ve[ze]=ce[xe[Re]]}}return ve},ie=ae(k.data),V=Object.keys(ie);if(k.method=="GET"){if(V.length){for(var N=[],W=0;W<V.length;W++)N.push(V[W]+"="+encodeURIComponent(ie[V[W]]));k.url.indexOf("?")<0&&(k.url+="?"),k.url+=N.join("&")}}else for(var N=new FormData,W=0;W<V.length;W++)if(ie[V[W]]instanceof FileList){if(ie[V[W]].length)for(var Y=0;Y<ie[V[W]].length;Y++)N.append(V[W],ie[V[W]][Y],ie[V[W]][Y].name)}else N.append(V[W],ie[V[W]])}var ee=new XMLHttpRequest;return ee.open(k.method,k.url,!0),k.requestedWith?ee.setRequestHeader("X-Requested-With",k.requestedWith):k.requestedWith!==!1&&ee.setRequestHeader("X-Requested-With","XMLHttpRequest"),k.contentType&&ee.setRequestHeader("Content-Type",k.contentType),k.method==="POST"?ee.setRequestHeader("Accept","application/json"):k.dataType==="blob"?ee.responseType="blob":k.contentType||(k.dataType==="json"?ee.setRequestHeader("Content-Type","text/json"):k.dataType==="html"&&ee.setRequestHeader("Content-Type","text/html")),k.cache!==!0&&(ee.setRequestHeader("pragma","no-cache"),ee.setRequestHeader("cache-control","no-cache")),k.withCredentials===!0&&(ee.withCredentials=!0),typeof k.beforeSend=="function"&&k.beforeSend(ee),typeof A.beforeSend=="function"&&A.beforeSend(ee),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(ee),ee.onerror=function(){k.error&&typeof k.error=="function"&&k.error({message:"Network error: Unable to reach the server.",status:0})},ee.ontimeout=function(){k.error&&typeof k.error=="function"&&k.error({message:"Request timed out after "+ee.timeout+"ms.",status:0})},ee.onload=function(){if(ee.status>=200&&ee.status<300)if(k.dataType==="json")try{var ce=JSON.parse(ee.responseText);k.success&&typeof k.success=="function"&&k.success(ce)}catch(ve){k.error&&typeof k.error=="function"&&k.error(ve,ce)}else{if(k.dataType==="blob")var ce=ee.response;else var ce=ee.responseText;k.success&&typeof k.success=="function"&&k.success(ce)}else k.error&&typeof k.error=="function"&&k.error(ee.responseText,ee.status);if(A.queue&&A.queue.length>0&&A.send(A.queue.shift()),A.requests&&A.requests.length){var Se=A.requests.indexOf(ee);if(A.requests.splice(Se,1),A.requests.length||k.complete&&typeof k.complete=="function"&&k.complete(ce),k.group&&A.oncomplete&&typeof A.oncomplete[k.group]=="function"&&(A.pending(k.group)||(A.oncomplete[k.group](),A.oncomplete[k.group]=null)),k.multiple&&k.multiple.instance){var Se=k.multiple.instance.indexOf(ee);k.multiple.instance.splice(Se,1),k.multiple.instance.length||k.multiple.complete&&typeof k.multiple.complete=="function"&&k.multiple.complete(ce)}}},ee.options=k,ee.data=N,k.queue===!0&&A.requests.length>0?A.queue.push(ee):A.send(ee),ee};return A.send=function(k){k.data?Array.isArray(k.data)?k.send(k.data.join("&")):k.send(k.data):k.send(),A.requests.push(k)},A.exists=function(k,p){var a=new XMLHttpRequest;a.open("HEAD",k,!1),a.send(),a.status&&p(a.status)},A.pending=function(k){var p=0,a=A.requests;if(a&&a.length)for(var W=0;W<a.length;W++)(!k||k==a[W].options.group)&&p++;return p},A.oncomplete={},A.requests=[],A.queue=[],A}var D=T();function L(){const A={loading:{}};return A.loading.show=function(k){A.loading.element||(A.loading.element=document.createElement("div"),A.loading.element.className="jloading"),document.body.appendChild(A.loading.element),k>0&&setTimeout(function(){A.loading.hide()},k*1e3)},A.loading.hide=function(){A.loading.element&&A.loading.element.parentNode&&document.body.removeChild(A.loading.element)},A.slideLeft=function(k,p,a){p==!0?(k.classList.add("jslide-left-in"),setTimeout(function(){k.classList.remove("jslide-left-in"),typeof a=="function"&&a()},400)):(k.classList.add("jslide-left-out"),setTimeout(function(){k.classList.remove("jslide-left-out"),typeof a=="function"&&a()},400))},A.slideRight=function(k,p,a){p===!0?(k.classList.add("jslide-right-in"),setTimeout(function(){k.classList.remove("jslide-right-in"),typeof a=="function"&&a()},400)):(k.classList.add("jslide-right-out"),setTimeout(function(){k.classList.remove("jslide-right-out"),typeof a=="function"&&a()},400))},A.slideTop=function(k,p,a){p===!0?(k.classList.add("jslide-top-in"),setTimeout(function(){k.classList.remove("jslide-top-in"),typeof a=="function"&&a()},400)):(k.classList.add("jslide-top-out"),setTimeout(function(){k.classList.remove("jslide-top-out"),typeof a=="function"&&a()},400))},A.slideBottom=function(k,p,a){p===!0?(k.classList.add("jslide-bottom-in"),setTimeout(function(){k.classList.remove("jslide-bottom-in"),typeof a=="function"&&a()},400)):(k.classList.add("jslide-bottom-out"),setTimeout(function(){k.classList.remove("jslide-bottom-out"),typeof a=="function"&&a()},100))},A.fadeIn=function(k,p){k.style.display="",k.classList.add("jfade-in"),setTimeout(function(){k.classList.remove("jfade-in"),typeof p=="function"&&p()},2e3)},A.fadeOut=function(k,p){k.classList.add("jfade-out"),setTimeout(function(){k.style.display="none",k.classList.remove("jfade-out"),typeof p=="function"&&p()},1e3)},A}var _=L();function F(){var A={};A.now=function(ie,V){var N=null,Y=null,ee=null,ce=null,Se=null,ve=null;return Array.isArray(ie)?(N=ie[0],Y=ie[1],ee=ie[2],ce=ie[3],Se=ie[4],ve=ie[5]):(ie||(ie=new Date),N=ie.getFullYear(),Y=ie.getMonth()+1,ee=ie.getDate(),ce=ie.getHours(),Se=ie.getMinutes(),ve=ie.getSeconds()),V==!0?s.two(N)+"-"+s.two(Y)+"-"+s.two(ee):s.two(N)+"-"+s.two(Y)+"-"+s.two(ee)+" "+s.two(ce)+":"+s.two(Se)+":"+s.two(ve)},A.toArray=function(ie){var N=ie.split(ie.indexOf("T")!==-1?"T":" "),V=N[1],N=N[0].split("-"),Y=parseInt(N[0]),ee=parseInt(N[1]),ce=parseInt(N[2]),Se=0,ve=0;return V&&(V=V.split(":"),Se=parseInt(V[0]),ve=parseInt(V[1])),[Y,ee,ce,Se,ve,0]};var k=Date.UTC(1900,0,0),p=Date.UTC(1900,1,29),a=864e5;A.dateToNum=function(ie){typeof ie=="string"&&(ie=new Date(ie+"  GMT+0"));var V=ie.getTime();return V>=p&&(V+=a),V-=k,V/a},A.numToDate=function(ie){var V=k+ie*a;V>=p&&(V-=a);const N=new Date(V);var Y=[N.getUTCFullYear(),N.getUTCMonth()+1,N.getUTCDate(),N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds()];return A.now(Y)};let W=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ae=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(A,"weekdays",{get:function(){return W.map(function(ie){return f.translate(ie)})}}),Object.defineProperty(A,"weekdaysShort",{get:function(){return W.map(function(ie){return f.translate(ie).substring(0,3)})}}),Object.defineProperty(A,"months",{get:function(){return ae.map(function(ie){return f.translate(ie)})}}),Object.defineProperty(A,"monthsShort",{get:function(){return ae.map(function(ie){return f.translate(ie).substring(0,3)})}}),A}var M=F();function B(){var A={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},k=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var C=0;this.date[4]&&(C=parseFloat(this.date[4]/60));var q=parseInt(this.date[3])+C;q/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?q=s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),q=s.two(this.date[0])+"-"+s.two(this.date[1])+"-"+s.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(q+=" "+s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5])));return q},p=function(){var C="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)C=parseInt(this.date[3]);else{let G=parseInt(this.date[3]);G<13&&this.values.indexOf("PM")!==-1?C=(G+12)%24:C=G%24}this.date[4]&&(C+=parseFloat(this.date[4]/60)),this.date[5]&&(C+=parseFloat(this.date[5]/3600)),C/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var q=M.now(this.date);C=M.dateToNum(q)}return isNaN(C)&&(C=""),C},a=function(C){return C===null||C===""||C===void 0},W=function(C){var q=(""+C)[0];return q=="="},ae=function(C){return C==="currency"||C==="percentage"||C==="scientific"||C==="numeric"},ie=function(C){if(C&&Number(C)==C)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var q=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=q[1]}else{C||(C=this.mask);var G=new RegExp("0{1}(.{1})0+","ig"),q=G.exec(C);if(q&&q[1]&&q[1].length==1)return this.options.decimal=q[1],q[1];var G=new RegExp("#{1}(.{1})#+","ig"),q=G.exec(C);q&&q[1]&&q[1].length==1?q[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},V=function(C,q){if(C=="")return"";q||(q=ie.call(this)),C=(""+C).split(q);var G=C[0].match(/[-]+/g);if(G&&G.length?G=!0:G=!1,C[0]=C[0].match(/[0-9]+/g),C[0]?(G&&C[0].unshift("-"),C[0]=C[0].join("")):G&&(C[0]="-"),C[0]||C[1])C[1]!==void 0&&(C[1]=C[1].match(/[0-9]+/g),C[1]?C[1]=C[1].join(""):C[1]="");else return"";return C},N=function(C,q){if(C==="")return"";var G=ie.call(this),ge=this.options;if(C=V.call(this,C),C==="")return"";var J=null;if(C[0]&&(ge.style==="percent"?J=parseFloat(C[0])/100:J=parseFloat(C[0]+".1")),(C[0]==="-"||C[0]==="-00")&&!C[1]&&q&&q.inputType=="deleteContentBackward")return"";var he=new Intl.NumberFormat(this.locale,ge).format(J);if(he=he.split(G),ge.style==="percent"&&he[0].indexOf("%")!==-1&&(he[0]=he[0].replace("%",""),he[2]="%"),typeof he[1]<"u"){var Te=he[1].replace(/[0-9]*/g,"");Te&&(he[2]=Te)}return C[1]!==void 0?he[1]=G+C[1]:he[1]="",he.join("")},Y=function(C,q){var G=Se.call(C);if(G){var ge=N.call(this,G,q),J=ge.length-G.length,he=ce.call(C)+J;Se.call(C,ge,he,!0)}},ee=function(C){var q=V.call(this,C);return q?(q[0]==="-"&&(q[0]="-0"),parseFloat(q.join("."))):null},ce=function(C,q){if(C===void 0)if(this.tagName=="DIV"){var G=0,ge=window.getSelection();if(ge&&ge.rangeCount!==0){var J=ge.getRangeAt(0),he=J.cloneRange();he.selectNodeContents(this),he.setEnd(J.endContainer,J.endOffset),G=he.toString().length}return G}else return this.selectionStart;else{var Te=Se.call(this);if(q){for(var he=null,qe=0;qe<Te.length;qe++)(Te[qe].match(/[\-0-9]/g)||Te[qe]==="."||Te[qe]===",")&&(he=qe);he===null&&(he=Te.indexOf(" ")),C>=he&&(C=he+1)}if(C>Te.length&&(C=Te.length),C)if(this.tagName=="DIV"){var ge=window.getSelection(),J=document.createRange();this.childNodes[0]&&(J.setStart(this.childNodes[0],C),ge.removeAllRanges(),ge.addRange(J))}else this.selectionStart=C,this.selectionEnd=C}},Se=function(C,q,G){if(this.tagName=="DIV")if(C===void 0){var C=this.innerText;return this.value&&this.value.length>C.length&&(C=this.value),C}else this.innerText!==C&&(this.innerText=C,q&&ce.call(this,q,G));else{if(C===void 0)return this.value;this.value!==C&&(this.value=C,q&&ce.call(this,q,G))}},ve=M.weekdays,xe=M.weekdaysShort,Re=M.months,ze=M.monthsShort,$e={YEAR:function(C,q){var G=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<=10&&this.values[this.index].length<q&&(this.values[this.index]+=C),this.values[this.index].length==q){if(q==2)var G=G.substr(0,2)+this.values[this.index];else if(q==3)var G=G.substr(0,1)+this.values[this.index];else if(q==4)var G=this.values[this.index];this.date[0]=G,this.index++}},YYYY:function(C){$e.YEAR.call(this,C,4)},YYY:function(C){$e.YEAR.call(this,C,3)},YY:function(C){$e.YEAR.call(this,C,2)},FIND:function(C,q){if(a(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=C;return}for(var G=0,ge=0,J=(this.values[this.index]+C).toLowerCase(),he=0;he<q.length;he++)q[he].toLowerCase().indexOf(J)==0&&(G=he,ge++);if(ge>1)this.values[this.index]+=C;else if(ge==1){var Te=q[G].length-this.values[this.index].length-1;return this.position+=Te,this.values[this.index]=q[G],this.index++,G}},MMM:function(C){var q=$e.FIND.call(this,C,ze);q!==void 0&&(this.date[1]=q+1)},MON:function(C){$e.MMM.call(this,C)},MMMM:function(C){var q=$e.FIND.call(this,C,Re);q!==void 0&&(this.date[1]=q+1)},MONTH:function(C){$e.MMMM.call(this,C)},MMMMM:function(C){a(this.values[this.index])&&(this.values[this.index]="");for(var q=(this.values[this.index]+C).toLowerCase(),G=0;G<Re.length;G++)if(Re[G][0].toLowerCase().indexOf(q)==0){this.values[this.index]=Re[G][0],this.date[1]=G+1,this.index++;break}},MM:function(C){a(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(this.date[1]=this.values[this.index]="0"+C,this.index++):parseInt(C)<2&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[1]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[1]=this.values[this.index]+=C,this.index++)},M:function(C){var q=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(a(this.values[this.index]))this.values[this.index]=C,C>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(C)<3)this.date[1]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[1]=this.values[this.index]+=C,this.index++;else var q=!0;else var q=!0;if(q==!0){var G=parseInt(this.values[this.index]);G>0&&G<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(C){var q=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(a(this.values[this.index]))this.values[this.index]=C,parseInt(C)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(C)<2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[2]=this.values[this.index]+=C,this.index++;else var q=!0;else var q=!0;if(q==!0){var G=parseInt(this.values[this.index]);G>0&&G<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(C){a(this.values[this.index])?parseInt(C)>3&&parseInt(C)<10?(this.date[2]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==3&&parseInt(C)<2?(this.date[2]=this.values[this.index]+=C,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(C)<10?(this.date[2]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[2]=this.values[this.index]+=C,this.index++)},DDD:function(C){$e.FIND.call(this,C,xe)},DY:function(C){$e.DDD.call(this,C)},DDDD:function(C){$e.FIND.call(this,C,ve)},DAY:function(C){$e.DDDD.call(this,C)},HH12:function(C,q){a(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(q&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<1&&parseInt(C)<10&&(this.date[3]=this.values[this.index]+=C,this.index++)},HH24:function(C,q){parseInt(C)>=0&&parseInt(C)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>2&&parseInt(C)<10?(q&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==2&&parseInt(C)<4?(!q&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<2&&parseInt(C)<10&&(!q&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++))},HH:function(C){$e.HH24.call(this,C,1)},H:function(C){$e.HH24.call(this,C,0)},"\\[H\\]":function(C){this.values[this.index]==null&&(this.values[this.index]=""),C.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=C:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(C,q){this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>5&&parseInt(C)<10?(this.date[q]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):parseInt(C)<10&&(this.date[q]=this.values[this.index]+=C,this.index++)},MI:function(C){$e.N60.call(this,C,4)},SS:function(C){$e.N60.call(this,C,5)},"AM/PM":function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?C.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":C.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<7&&(this.values[this.index]=C),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(C){var q=ie.call(this),G=!1;a(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(G=!0);var ge=V.call(this,this.values[this.index],q);ge&&(this.values[this.index]=ge.join(q)),parseInt(C)>=0&&parseInt(C)<10?(this.values[this.index]=="0"&&C>0?this.values[this.index]="":this.values[this.index]=="-0"&&C>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||C==q)&&(this.values[this.index]+=C)):q&&C==q?this.values[this.index].indexOf(q)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=C):C=="-"&&(G=!0),G===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(C){$e["0{1}(.{1}0+)?"].call(this,C)},"0{1}(.{1}0+)?%":function(C){$e["0{1}(.{1}0+)?"].call(this,C),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(C){$e["0{1}(.{1}0+)?"].call(this,C);var q=ie.call(this),G=this.tokens[this.index].substr(1,1),ge=this.values[this.index][0]==="-",J=V.call(this,this.values[this.index],q);if(J!==""){var he=J[0].match(/[0-9]/g);if(he){he=he.join("");for(var Te=[],qe=0,Ie=he.length-1;Ie>=0;Ie--)Te.push(he[Ie]),qe++,qe%3||Te.push(G);Te=Te.reverse(),J[0]=Te.join(""),J[0].substr(0,1)==G&&(J[0]=J[0].substr(1))}else J[0]="";this.values[this.index]=J.join(q),ge&&(this.values[this.index]="-"+this.values[this.index])}},0:function(C){C.match(/[0-9]/g)&&(this.values[this.index]=C,this.index++)},"[0-9a-zA-Z$]+":function(C){a(this.values[this.index])&&(this.values[this.index]="");var q=this.tokens[this.index],G=this.values[this.index],ge=G.length;q[ge]==C?(this.values[this.index]+=C,this.values[this.index]==q&&this.index++):(this.values[this.index]=q,this.index++,C.match(/[\-0-9]/g)&&this.position--)},A:function(C){C.match(/[a-zA-Z]/gi)&&(this.values[this.index]=C,this.index++)},".":function(C){$e["[0-9a-zA-Z$]+"].call(this,C)},"@":function(C){a(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=C}},Je=function(C){if(this.type=="general")var q=[].concat(A.general);else var q=[].concat(A.currency,A.datetime,A.percentage,A.scientific,A.numeric,A.text,A.general);var G=new RegExp(q.join("|"),"gi");return C.match(G)},nt=function(C){if(this.type)if(this.type=="text")var q=["text"];else if(this.type=="general")var q=["general"];else if(this.type=="datetime")var q=["numeric","datetime","general"];else var q=["currency","percentage","scientific","numeric","general"];else var q=Object.keys(A);for(var G=0;G<q.length;G++)for(var ge=q[G],J=0;J<A[ge].length;J++){var he=new RegExp(A[ge][J],"gi"),Te=C.match(he);if(Te)return{type:ge,method:A[ge][J]}}},re=function(C){for(var q=[],G=0;G<C.length;G++){var ge=nt.call(this,C[G]);ge?q.push(ge.method):q.push(null)}for(var G=0;G<q.length;G++)q[G]=="MM"&&(q[G-1]&&q[G-1].indexOf("H")>=0||q[G-2]&&q[G-2].indexOf("H")>=0||q[G+1]&&q[G+1].indexOf("S")>=0||q[G+2]&&q[G+2].indexOf("S")>=0)&&(q[G]="MI");return q},ne=function(C){var q=nt.call(this,C);if(q)var G=q.type;if(G){for(var ge=0,J=Je.call(this,C),he=0;he<J.length;he++)q=nt.call(this,J[he]),q&&ae(q.type)&&ge++;ge>1&&(G="general")}return G},be=function(){typeof $e[this.methods[this.index]]=="function"?($e[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},U=function(C){return(""+ +C).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(q,G,ge,J,he){return he<0?G+"0."+Array(1-he-ge.length).join(0)+ge+J:G+ge+J+Array(he-J.length+1).join(0)})},X=function(C,q,G){var ge=null,J={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof C=="object"){if(J.input=C.target,J.value=Se.call(C.target),J.caret=ce.call(C.target),(ge=C.target.getAttribute("data-mask"))&&(J.mask=ge),(ge=C.target.getAttribute("data-type"))&&(J.type=ge),C.target.mask?(C.target.mask.options&&(J.options=C.target.mask.options),C.target.mask.locale&&(J.locale=C.target.mask.locale)):(ge=C.target.getAttribute("data-locale"))&&(J.locale=ge,J.mask&&(J.options.style=J.mask)),C.target.attributes&&C.target.attributes.length)for(var he=0;he<C.target.attributes.length;he++){var Te=C.target.attributes[he].name,qe=C.target.attributes[he].value;Te.substr(0,4)=="data"&&(J.options[Te.substr(5)]=qe)}}else{if(typeof q=="string")J.mask=q;else for(var Te=Object.keys(q),he=0;he<Te.length;he++)J[Te[he]]=q[Te[he]];typeof C=="number"&&(ie.call(J,J.mask),C=(""+C).replace(".",J.options.decimal)),J.value=C,J.input&&(Se.call(J.input,C),s.focus(J.input),J.caret=ce.call(J.input))}if(!W(J.value)&&(J.mask||J.locale)){if(J.mask){if(J.mask=J.mask.replace(new RegExp(/\[h]/),"|h|"),J.mask=J.mask.replace(new RegExp(/\[.*?\]/),""),J.mask=J.mask.replace(new RegExp(/\|h\|/),"[h]"),J.mask.indexOf(";")!==-1){var ge=J.mask.split(";");J.mask=ge[0]}if(J.mask.indexOf("##")!==-1){var Ie=J.mask.split(";");Ie[0]&&(typeof C=="object"&&(Ie[0]=Ie[0].replace(new RegExp(/_\)/g),""),Ie[0]=Ie[0].replace(new RegExp(/_\(/g),"")),Ie[0]=Ie[0].replace("*","	"),Ie[0]=Ie[0].replace(new RegExp(/_-/g),""),Ie[0]=Ie[0].replace(new RegExp(/_/g),""),Ie[0]=Ie[0].replace(new RegExp(/"/g),""),Ie[0]=Ie[0].replace("##0.###","##0.000"),Ie[0]=Ie[0].replace("##0.##","##0.00"),Ie[0]=Ie[0].replace("##0.#","##0.0"),Ie[0]=Ie[0].replace("##0,###","##0,000"),Ie[0]=Ie[0].replace("##0,##","##0,00"),Ie[0]=Ie[0].replace("##0,#","##0,0")),J.mask=Ie[0]}if(J.mask.indexOf("\\")!==-1){var Ie=J.mask.split(";");Ie[0]=Ie[0].replace(new RegExp(/\\/g),""),J.mask=Ie[0]}J.type||(J.type=ne.call(J,J.mask)),J.tokens=Je.call(J,J.mask)}if(typeof C!="object"||!C.inputType||!C.inputType.indexOf("insert")||!C.inputType.indexOf("delete"))if(J.locale)if(J.input)Y.call(J,J.input,C);else var Ve=N.call(J,J.value);else{for(J.methods=re.call(J,J.tokens),J.event=C;J.position<J.value.length&&typeof J.tokens[J.index]<"u";)be.call(J);var Ve=J.values.join("");if(ae(J.type)&&Ve!==""){for(;typeof J.tokens[J.index]<"u";){var ge=nt.call(J,J.tokens[J.index]);ge&&ge.type=="general"&&(J.values[J.index]=J.tokens[J.index]),J.index++}var Ue=!0}else var Ue=!1;if(Ve=J.values.join(""),J.input){if(ge=Ve.length-J.value.length,ge>0)var tt=J.caret+ge;else var tt=J.caret;Se.call(J.input,Ve,tt,Ue)}}if(J.input){var le=null;if(ae(J.type)){let De=Se.call(J.input);J.number=ee.call(J,De),J.type=="percentage"&&(""+De).indexOf("%")!==-1?le=X.adjustPrecision(J.number/100):le=J.number}else J.type=="datetime"&&(le=k.call(J),J.date[0]&&J.date[1]&&J.date[2]&&J.input.setAttribute("data-completed",!0));le&&J.input.setAttribute("data-value",le)}if(Ve!==void 0)return G?J:Ve}};return X.adjustPrecision=function(C){if(typeof C=="number"&&!Number.isInteger(C)){const q=C.toString().split(".");if(q[1]&&q[1].length>10){let G=0;const ge=q[1][q[1].length-2];if(ge==0||ge==9){for(let J=q[1].length-2;J>0;J--)if(G>=0&&q[1][J]==ge){if(G++,G>6)break}else{G=0;break}if(G)return parseFloat(parseFloat(C).toFixed(q[1].length-1))}}}return C},X.getType=ne,X.prepare=function(C,q){return q||(q={}),Je.call(q,C)},X.apply=function(C){var q=Se.call(C.target);C.key.length==1&&(q+=C.key),Se.call(C.target,X(q,C.target.getAttribute("data-mask")))},X.run=function(C,q,G){return X(C,{mask:q,decimal:G})},X.extract=function(C,q,G){if(a(C)||typeof q!="object")return C;if(q=Object.assign({},q),q.options||(q.options={}),!q.mask&&q.format&&(q.mask=q.format),q.mask){if(q.mask.indexOf(";")!==-1){var ge=q.mask.split(";");q.mask=ge[0]}q.mask=q.mask.replace(new RegExp(/\[h]/),"|h|"),q.mask=q.mask.replace(new RegExp(/\[.*?\]/),""),q.mask=q.mask.replace(new RegExp(/\|h\|/),"[h]")}ie.call(q,q.mask);var J=null,he=null;if(q.type=="percent"||q.options.style=="percent"?J="percentage":q.mask&&(J=ne.call(q,q.mask)),J==="text"){var Te={};he=C}else if(J==="general"){var Te=X(C,q,!0);he=C}else if(J==="datetime"){C instanceof Date&&(C=X.getDateString(C,q.mask));var Te=X(C,q,!0);s.isNumeric(C)?he=C:he=p.call(Te)}else if(J==="scientific"){he=C,typeof C=="string"&&(he=Number(he));var Te=q}else{he=ee.call(q,C),J==="percentage"&&(""+C).indexOf("%")!==-1&&(he/=100);var Te=q}return Te.value=he,!Te.type&&J&&(Te.type=J),G?Te:he},X.render=function(C,q,G,ge){if(a(C)||typeof q!="object")return C;if(q=Object.assign({},q),q.options||(q.options={}),!q.mask&&q.format&&(q.mask=q.format),q.mask){if(q.mask.indexOf(";")!==-1){var J=q.mask.split(";");G||(J[0]=J[0].replace(new RegExp(/_\)/g),""),J[0]=J[0].replace(new RegExp(/_\(/g),"")),q.mask=J[0]}q.mask=q.mask.replace(new RegExp(/\[h]/),"|h|"),q.mask=q.mask.replace(new RegExp(/\[.*?\]/),""),q.mask=q.mask.replace(new RegExp(/\|h\|/),"[h]")}var he=null;q.type=="percent"||q.options.style=="percent"?he="percentage":q.mask?he=ne.call(q,q.mask):C instanceof Date&&(he="datetime");var Te=!1;if(he=="datetime"||q.type=="calendar"){var J=X.getDateString(C,q.mask);J&&(C=J),q.mask&&G&&(Te=!0)}else if(he==="text")typeof C=="number"&&(C=C.toString());else if(typeof C=="string"&&r.isNumeric(C)&&(C=Number(C)),he==="percentage"&&(C=X.adjustPrecision(C*100)),typeof C=="number"){var J=null;if(q.mask&&G){var qe=ie.call(q,q.mask);if(he==="scientific")if(q.mask.indexOf(qe)!==-1){let Le=q.mask.split("E");Le=Le[0].split(qe),Le=""+Le[1].match(/[0-9]+/g),Le=Le.length,J=C.toExponential(Le)}else J=C.toExponential(0);else{if(q.mask.indexOf(qe)!==-1){qe=q.mask.split(qe),qe=""+qe[1].match(/[0-9]+/g),qe=qe.length,J=C.toFixed(qe);let Le=C.toString().split("."),Xe=Le[1];Xe&&Xe.length>qe&&Xe[Xe.length-1]==="5"&&(J=parseFloat(Le[0]+"."+Xe+"1").toFixed(qe))}else J=C.toFixed(0);(""+J).indexOf("e")!==-1&&(J=U(J))}}else if(q.locale&&G){var qe=(""+C).split(".");if(q.options){typeof qe[1]>"u"&&(qe[1]="");var Ve=qe[1].length;if(q.options.minimumFractionDigits>Ve)for(var Ie=0;Ie<q.options.minimumFractionDigits-Ve;Ie++)qe[1]+="0"}qe[1].length?J=qe.join("."):J=qe[0];var Ve=qe[1].length;q.options&&q.options.maximumFractionDigits<Ve&&(J=parseFloat(J).toFixed(q.options.maximumFractionDigits))}else J=U(C);J!==null&&(C=J,ie.call(q,q.mask),q.options.decimal&&(C=C.replace(".",q.options.decimal)))}else q.mask&&G&&(Te=!0);if(Te){var Ue=q.mask.length-C.length;if(Ue>0)for(var Ie=0;Ie<Ue;Ie++)C+=" "}if(he==="scientific")if(!G)C=U(C);else return C;if(he==="numeric"&&ge===!1&&typeof C=="string")return C;if(C=X(C,q),G&&he==="numeric"){var tt=q.mask.match(new RegExp(/^[0]+$/gm));if(tt&&tt.length===1){var le=tt[0].length;if(le>3)for(C=""+C;C.length<le;)C="0"+C}}return C},X.set=function(C,q){if(q){C.setAttribute("data-mask",q);var G=new Event("input",{bubbles:!0,cancelable:!0});C.dispatchEvent(G)}},X.extractDateFromString=function(C,q){var G=X(C,{mask:q},!0);if(C>0&&Number(C)==C&&(G.values.join("")!==G.value||G.type=="numeric")){var ge=new Date(Math.round((C-25569)*86400*1e3));return ge.getFullYear()+"-"+s.two(ge.getMonth())+"-"+s.two(ge.getDate())+" 00:00:00"}var J=!1;return G.values&&G.values.length===G.tokens.length&&G.values[G.values.length-1].length>=G.tokens[G.tokens.length-1].length&&(J=!0),G.date[0]&&G.date[1]&&(G.date[2]||J)?(G.date[2]||(G.date[2]=1),G.date[0]+"-"+s.two(G.date[1])+"-"+s.two(G.date[2])+" "+s.two(G.date[3])+":"+s.two(G.date[4])+":"+s.two(G.date[5])):""},X.getDateString=function(C,q){if(!q)var q={};if(q&&typeof q=="object"){if(q.format)var G=q.format;else if(q.mask)var G=q.mask}else var G=q;if(G||(G="YYYY-MM-DD"),G.indexOf("[h]")>=0){var ge=0;if(C&&s.isNumeric(C)&&(ge=parseFloat(24*Number(C)),G.indexOf("mm")>=0)){var J=(""+ge).split(".");if(J[1]){var he=60*parseFloat("0."+J[1]);he=parseFloat(he.toFixed(2))}else var he=0;ge=parseInt(J[0])+":"+s.two(he)}return ge}C instanceof Date?C=M.now(C):C&&s.isNumeric(C)&&(C=M.numToDate(C));for(var Te=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],qe=new RegExp(Te.join("|"),"gi"),Ie=G.match(qe),Ve=0;Ve<Ie.length;Ve++)Ie[Ve].toUpperCase()=="MM"&&(Ie[Ve-1]&&Ie[Ve-1].toUpperCase().indexOf("H")>=0||Ie[Ve-2]&&Ie[Ve-2].toUpperCase().indexOf("H")>=0||Ie[Ve+1]&&Ie[Ve+1].toUpperCase().indexOf("S")>=0||Ie[Ve+2]&&Ie[Ve+2].toUpperCase().indexOf("S")>=0)&&(Ie[Ve]="mi");var Ue={tokens:Ie};if(C){var he=""+C,tt=he.indexOf("T")!==-1?"T":" ";he=he.split(tt);var J=0,le=0,De=0;he[1]&&(J=he[1].split(":"),le=J[1]?J[1]:0,De=J[2]?J[2]:0,J=J[0]?J[0]:0),he=he[0].split("-");let bt=new Date(he[0],he[1],0).getDate();if(he[0]&&he[1]&&he[2]&&he[0]>0&&he[1]>0&&he[1]<13&&he[2]>0&&he[2]<=bt){Ue.data=[he[0],he[1],he[2],J,le,De],Ue.value=[];for(var Le=new Date(Ue.data[0],Ue.data[1]-1,Ue.data[2],Ue.data[3],Ue.data[4],Ue.data[5]),Xe=function(ue){var Oe=this.tokens[ue],He=Oe.toUpperCase(),We=null;He==="YYYY"?We=this.data[0]:He==="YYY"?We=this.data[0].substring(1,4):He==="YY"?We=this.data[0].substring(2,4):He==="Y"?We=this.data[0].substring(3,4):Oe==="MON"?We=M.months[Le.getMonth()].substr(0,3).toUpperCase():Oe==="mon"?We=M.months[Le.getMonth()].substr(0,3).toLowerCase():Oe==="MONTH"?We=M.months[Le.getMonth()].toUpperCase():Oe==="month"?We=M.months[Le.getMonth()].toLowerCase():He==="MMMMM"?We=M.months[Le.getMonth()].substr(0,1):He==="MMMM"||Oe==="Month"?We=M.months[Le.getMonth()]:He==="MMM"||Oe=="Mon"?We=M.months[Le.getMonth()].substr(0,3):He==="MM"?We=s.two(this.data[1]):He==="M"?We=Le.getMonth()+1:Oe==="DAY"?We=M.weekdays[Le.getDay()].toUpperCase():Oe==="day"?We=M.weekdays[Le.getDay()].toLowerCase():He==="DDDD"||Oe=="Day"?We=M.weekdays[Le.getDay()]:He==="DDD"?We=M.weekdays[Le.getDay()].substr(0,3):He==="DD"?We=s.two(this.data[2]):He==="D"?We=parseInt(this.data[2]):He==="Q"?We=Math.floor((Le.getMonth()+3)/3):He==="HH24"||He==="HH"?(We=this.data[3],We>12&&this.tokens.indexOf("am/pm")!==-1&&(We-=12),We=s.two(We)):He==="HH12"?this.data[3]>12?We=s.two(this.data[3]-12):We=s.two(this.data[3]):He==="H"?(We=this.data[3],We>12&&this.tokens.indexOf("am/pm")!==-1&&(We-=12,We=s.two(We))):He==="MI"?We=s.two(this.data[4]):He==="SS"?We=s.two(this.data[5]):He==="MS"?We=Le.getMilliseconds():He==="AM/PM"?this.data[3]>=12?We="PM":We="AM":He==="WD"&&(We=M.weekdays[Le.getDay()]),We===null?this.value[ue]=this.tokens[ue]:this.value[ue]=We},Ve=0;Ve<Ue.tokens.length;Ve++)Xe.call(Ue,Ve);C=Ue.value.join("")}else C=""}return C},X}var K=B();function H(){var A=function(k,p){if(k.calendar)return k.calendar.setOptions(p,!0);var a={type:"calendar"};a.options={},a.date=null,a.setOptions=function(U,X){var C={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:M.monthsShort,monthsFull:M.months,weekdays:M.weekdays,textDone:f.translate("Done"),textReset:f.translate("Reset"),textUpdate:f.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var q in C)U&&U.hasOwnProperty(q)?a.options[q]=U[q]:(typeof a.options[q]>"u"||X===!0)&&(a.options[q]=C[q]);if(a.options.resetButton==!1?N.style.display="none":N.style.display="",a.options.readonly?k.setAttribute("readonly","readonly"):k.removeAttribute("readonly"),a.options.placeholder?k.setAttribute("placeholder",a.options.placeholder):k.removeAttribute("placeholder"),s.isNumeric(a.options.value)&&a.options.value>0&&(a.options.value=A.numToDate(a.options.value),a.options.dataType="numeric"),N.innerHTML=a.options.textReset,Y.innerHTML=a.options.textDone,nt.innerHTML=a.options.textUpdate,a.options.format&&k.setAttribute("data-mask",a.options.format.toLowerCase()),!a.options.value&&a.options.today)var G=A.now();else var G=a.options.value;return G&&(a.options.value=null,a.setValue(G)),a},a.open=function(U){if(!V.classList.contains("jcalendar-focus")&&!V.classList.contains("jcalendar-inline")){if(A.current=a,I(a,!0),a.getDays(),a.options.type=="year-month-picker"&&a.getMonths(),a.options.time&&(re.value=a.date[3],ne.value=a.date[4]),V.classList.add("jcalendar-focus"),s.getWindowWidth()<800||a.options.fullscreen)V.classList.add("jcalendar-fullsize"),_.slideBottom(ce,1);else{V.classList.remove("jcalendar-fullsize");var X=k.getBoundingClientRect(),C=ce.getBoundingClientRect();if(a.options.position)ee.style.position="fixed",window.innerHeight<X.bottom+C.height?ee.style.top=X.top-(C.height+2)+"px":ee.style.top=X.top+X.height+2+"px",ee.style.left=X.left+"px";else{if(window.innerHeight<X.bottom+C.height){var q=-1*(X.height+C.height+2);q+X.top<0&&(q=-1*(X.top+X.height)),ee.style.top=q+"px"}else ee.style.top="2px";if(window.innerWidth<X.left+C.width){var q=window.innerWidth-(X.left+C.width+20);ee.style.left=q+"px"}else ee.style.left="0px"}}typeof a.options.onopen=="function"&&a.options.onopen(k)}},a.close=function(U,X){if(a.options.autoSelect!==!0&&typeof X>"u"&&(X=!1),V.classList.contains("jcalendar-focus")){if(X!==!1){var C=V.querySelector(".jcalendar-selected");if(typeof X=="string")var q=X;else if(!C||C.classList.contains("jcalendar-disabled"))var q=a.options.value;else var q=a.getValue();a.setValue(q)}else{let G=a.options.value||"";a.options.value=null,a.setValue(G)}!U&&typeof a.options.onclose=="function"&&a.options.onclose(k),V.classList.remove("jcalendar-focus"),I(a,!1),A.current=null}return a.options.value},a.prev=function(){a.options.mode=="years"?(a.date[0]=a.date[0]-12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])-1,a.getMonths()):(a.date[1]<2?(a.date[0]=a.date[0]-1,a.date[1]=12):a.date[1]=a.date[1]-1,a.getDays())},a.next=function(){a.options.mode=="years"?(a.date[0]=parseInt(a.date[0])+12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])+1,a.getMonths()):(a.date[1]>11?(a.date[0]=parseInt(a.date[0])+1,a.date[1]=1):a.date[1]=parseInt(a.date[1])+1,a.getDays())},a.setToday=function(){var U=new Date().toISOString().substr(0,10);return a.setValue(U),U},a.setValue=function(U){U||(U=""+U);var X=U,C=a.options.value;if(C!=X){if(X){a.setLabel(X,a.options);var G=X.split(" ");G[1]||(G[1]="00:00:00");var q=G[1].split(":"),G=G[0].split("-"),ge=parseInt(G[0]),J=parseInt(G[1]),he=parseInt(G[2]),Te=parseInt(q[0]),qe=parseInt(q[1]);a.date=[ge,J,he,Te,qe,0];var U=a.setLabel(X,a.options),Ie=A.now(new Date(ge,J-1,he),!0);if(a.options.validRange){if(!a.options.validRange[0]||Ie>=a.options.validRange[0])var Ve=!0;else var Ve=!1;if(!a.options.validRange[1]||Ie<=a.options.validRange[1])var Ue=!0;else var Ue=!1;Ve&&Ue?(k.classList.remove("jcalendar_warning"),k.title=""):(k.classList.add("jcalendar_warning"),k.title=f.translate("Date outside the valid range"))}else k.classList.remove("jcalendar_warning"),k.title=""}else{a.date=null;var U="";k.classList.remove("jcalendar_warning"),k.title=""}a.options.value=X,typeof a.options.onchange=="function"&&a.options.onchange(k,X,C),k.value!=U&&(k.value=U,typeof k.oninput=="function"&&k.oninput({type:"input",target:k,value:k.value}))}a.date&&(a.getDays(),a.options.type=="year-month-picker"&&a.getMonths())},a.getValue=function(){return a.date?a.options.time?s.two(a.date[0])+"-"+s.two(a.date[1])+"-"+s.two(a.date[2])+" "+s.two(a.date[3])+":"+s.two(a.date[4])+":"+s.two(0):s.two(a.date[0])+"-"+s.two(a.date[1])+"-"+s.two(a.date[2])+" "+s.two(0)+":"+s.two(0)+":"+s.two(0):""},a.update=function(U,X){if(!U.classList.contains("jcalendar-disabled")){var C=V.querySelector(".jcalendar-selected");C&&C.classList.remove("jcalendar-selected"),U.classList.add("jcalendar-selected"),U.classList.contains("jcalendar-set-month")?(a.date[1]=X,a.date[2]=1):a.date[2]=U.innerText,a.options.time?(a.date[3]=re.value,a.date[4]=ne.value):a.close(null,!0)}ie()},a.reset=function(){a.setValue(""),a.date=null,a.close(!1,!1)},a.getDays=function(){a.options.mode="days";var Te=new Date,U=a.date&&s.isNumeric(a.date[0])?a.date[0]:parseInt(Te.getFullYear()),X=a.date&&s.isNumeric(a.date[1])?a.date[1]:parseInt(Te.getMonth())+1,C=a.date&&s.isNumeric(a.date[2])?a.date[2]:parseInt(Te.getDate()),q=a.date&&s.isNumeric(a.date[3])?a.date[3]:parseInt(Te.getHours()),G=a.date&&s.isNumeric(a.date[4])?a.date[4]:parseInt(Te.getMinutes());a.date=[U,X,C,q,G,0],Se.innerHTML=U,ve.innerHTML=a.options.months[X-1];var ge=Te.getMonth()==X-1&&Te.getFullYear()==U,J=Te.getDate(),Te=new Date(U,X,0,0,0),he=Te.getDate(),Te=new Date(U,X-1,0,0,0),qe=Te.getDay()+1,tt=a.options.startingDay||0;qe=qe-tt,Re.innerHTML="";var Ie=document.createElement("tr");Ie.setAttribute("align","center"),Re.appendChild(Ie);for(var Ve=0;Ve<7;Ve++){var Ue=document.createElement("td");Ue.classList.add("jcalendar-weekday"),Ue.innerHTML=a.options.weekdays[tt].substr(0,1),Ie.appendChild(Ue),tt++,tt>6&&(tt=0)}for(var tt=0,le=0,De=0;De<6;De++){var Ie=document.createElement("tr");Ie.setAttribute("align","center"),Ie.style.height="34px";for(var Ve=0;Ve<7;Ve++){var Ue=document.createElement("td");if(Ue.classList.add("jcalendar-set-day"),tt>=qe&&tt<qe+he){le++,Ue.innerHTML=le,le==C&&Ue.classList.add("jcalendar-selected"),ge&&J==le&&(Ue.style.fontWeight="bold");var Le=A.now(new Date(U,X-1,le),!0);if(a.options.validRange){if(!a.options.validRange[0]||Le>=a.options.validRange[0])var Xe=!0;else var Xe=!1;if(!a.options.validRange[1]||Le<=a.options.validRange[1])var ot=!0;else var ot=!1;Xe&&ot||Ue.classList.add("jcalendar-disabled")}}Ie.appendChild(Ue),tt++}Re.appendChild(Ie)}a.options.time?$e.style.display="":$e.style.display="none",ie()},a.getMonths=function(){a.options.mode="months";var U=a.options.months;a.options.value;var X=new Date,C=parseInt(X.getFullYear()),q=parseInt(X.getMonth())+1,G=a.date&&s.isNumeric(a.date[0])?a.date[0]:C,ge=a.date&&s.isNumeric(a.date[1])?a.date[1]:q;Se.innerHTML=a.date[0],ve.innerHTML=U[ge-1];var J=document.createElement("table");J.setAttribute("width","100%");for(var he=null,Te=0;Te<12;Te++){if(!(Te%4)){var he=document.createElement("tr");he.setAttribute("align","center"),J.appendChild(he)}var qe=document.createElement("td");if(qe.classList.add("jcalendar-set-month"),qe.setAttribute("data-value",Te+1),qe.innerText=U[Te],a.options.validRange){var Ie=G+"-"+s.two(Te+1);if(!a.options.validRange[0]||Ie>=a.options.validRange[0].substr(0,7))var Ve=!0;else var Ve=!1;if(!a.options.validRange[1]||Ie<=a.options.validRange[1].substr(0,7))var Ue=!0;else var Ue=!1;Ve&&Ue||qe.classList.add("jcalendar-disabled")}Te+1==ge&&qe.classList.add("jcalendar-selected"),C==G&&Te+1==q&&(qe.style.fontWeight="bold"),he.appendChild(qe)}Re.innerHTML='<tr><td colspan="7"></td></tr>',Re.children[0].children[0].appendChild(J),ie()},a.getYears=function(){a.options.mode="years";for(var U=new Date,X=U.getFullYear(),C=a.date&&s.isNumeric(a.date[0])?a.date[0]:parseInt(U.getFullYear()),q=[],G=0;G<25;G++)q[G]=parseInt(a.date[0])+(G-12);var ge=document.createElement("table");ge.setAttribute("width","100%");for(var G=0;G<25;G++){if(!(G%5)){var J=document.createElement("tr");J.setAttribute("align","center"),ge.appendChild(J)}var he=document.createElement("td");he.classList.add("jcalendar-set-year"),he.innerText=q[G],C==q[G]&&he.classList.add("jcalendar-selected"),X==q[G]&&(he.style.fontWeight="bold"),J.appendChild(he)}Re.innerHTML='<tr><td colspan="7"></td></tr>',Re.firstChild.firstChild.appendChild(ge),ie()},a.setLabel=function(U,X){return A.getDateString(U,X)},a.fromFormatted=function(U,X){return A.extractDateFromString(U,X)};var W=function(U){var X=s.findElement(U.target,"jcalendar-container");if(X){var C=U.target.className;if(C=="jcalendar-prev")a.prev();else if(C=="jcalendar-next")a.next();else if(C=="jcalendar-month")a.getMonths();else if(C=="jcalendar-year")a.getYears();else if(C=="jcalendar-set-year")a.date[0]=U.target.innerText,a.options.type=="year-month-picker"?a.getMonths():a.getDays();else if(U.target.classList.contains("jcalendar-set-month")){var q=parseInt(U.target.getAttribute("data-value"));a.options.type=="year-month-picker"?a.update(U.target,q):(a.date[1]=q,a.getDays())}else C=="jcalendar-confirm"||C=="jcalendar-update"||C=="jcalendar-close"?a.close(null,!0):C=="jcalendar-backdrop"?a.close(!1,!1):C=="jcalendar-reset"?a.reset():U.target.classList.contains("jcalendar-set-day")&&U.target.innerText&&a.update(U.target)}else a.close(!1,!1)},ae=function(U){if(U.target.value&&U.target.value.length>3){var X=A.extractDateFromString(U.target.value,a.options.format);X&&a.setValue(X)}},ie=function(){var U=V.querySelector(".jcalendar-selected");U&&U.classList.contains("jcalendar-disabled")?(nt.setAttribute("disabled","disabled"),re.setAttribute("disabled","disabled"),ne.setAttribute("disabled","disabled")):(nt.removeAttribute("disabled"),re.removeAttribute("disabled"),ne.removeAttribute("disabled")),typeof a.options.onupdate=="function"&&a.options.onupdate(k,a.getValue())},V=null,N=null,Y=null,ee=null,ce=null,Se=null,ve=null,xe=null,Re=null,ze=null,$e=null,Je=null,nt=null,re=null,ne=null,be=function(){k.tagName=="INPUT"&&k.value&&(p.value=k.value),N=document.createElement("div"),N.className="jcalendar-reset",Y=document.createElement("div"),Y.className="jcalendar-confirm",ze=document.createElement("div"),ze.className="jcalendar-controls",ze.style.borderBottom="1px solid #ddd",ze.appendChild(N),ze.appendChild(Y),ee=document.createElement("div"),ee.className="jcalendar-container",ce=document.createElement("div"),ce.className="jcalendar-content",ee.appendChild(ce),k.tagName=="DIV"?(V=k,V.classList.add("jcalendar-inline")):(ce.appendChild(ze),V=document.createElement("div"),V.className="jcalendar"),V.classList.add("jcalendar-container"),V.appendChild(ee);var U=document.createElement("div");U.className="jcalendar-table",ce.appendChild(U);var X=document.createElement("td");X.setAttribute("colspan","2"),X.className="jcalendar-prev",Se=document.createElement("span"),Se.className="jcalendar-year",ve=document.createElement("span"),ve.className="jcalendar-month";var C=document.createElement("td");C.className="jcalendar-header",C.setAttribute("colspan","3"),C.appendChild(ve),C.appendChild(Se);var q=document.createElement("td");q.setAttribute("colspan","2"),q.className="jcalendar-next";var G=document.createElement("thead"),ge=document.createElement("tr");ge.appendChild(X),ge.appendChild(C),ge.appendChild(q),G.appendChild(ge),xe=document.createElement("table"),Re=document.createElement("tbody"),xe.setAttribute("cellpadding","0"),xe.setAttribute("cellspacing","0"),xe.appendChild(G),xe.appendChild(Re),U.appendChild(xe),re=document.createElement("select"),re.className="jcalendar-select",re.onchange=function(){a.date[3]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(k,a.getValue())};for(var J=0;J<24;J++){var he=document.createElement("option");he.value=J,he.innerHTML=s.two(J),re.appendChild(he)}ne=document.createElement("select"),ne.className="jcalendar-select",ne.onchange=function(){a.date[4]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(k,a.getValue())};for(var J=0;J<60;J++){var he=document.createElement("option");he.value=J,he.innerHTML=s.two(J),ne.appendChild(he)}var Te=document.createElement("div");Te.className="jcalendar-controls",$e=document.createElement("div"),$e.className="jcalendar-time",$e.style.maxWidth="140px",$e.appendChild(re),$e.appendChild(ne),nt=document.createElement("button"),nt.setAttribute("type","button"),nt.className="jcalendar-update",Je=document.createElement("div"),Je.style.flexGrow="10",Je.appendChild(nt),Te.appendChild($e),k.tagName=="INPUT"&&Te.appendChild(Je),ce.appendChild(Te);var qe=document.createElement("div");qe.className="jcalendar-backdrop",V.appendChild(qe),k.addEventListener("keyup",ae),V.addEventListener("swipeleft",function(Ie){_.slideLeft(xe,0,function(){a.next(),_.slideRight(xe,1)}),Ie.preventDefault(),Ie.stopPropagation()}),V.addEventListener("swiperight",function(Ie){_.slideRight(xe,0,function(){a.prev(),_.slideLeft(xe,1)}),Ie.preventDefault(),Ie.stopPropagation()}),"ontouchend"in document.documentElement?(V.addEventListener("touchend",W),k.addEventListener("touchend",a.open)):(V.addEventListener("mouseup",W),k.addEventListener("mouseup",a.open)),A.hasEvents||(A.hasEvents=!0,document.addEventListener("keydown",A.keydown)),a.setOptions(p),k.tagName=="INPUT"?(k.parentNode.insertBefore(V,k.nextSibling),k.setAttribute("autocomplete","off"),k.classList.add("jcalendar-input"),k.value=a.setLabel(a.getValue(),a.options)):(a.getDays(),a.options.time&&(re.value=a.date[3],ne.value=a.date[4])),a.options.opened==!0&&a.open(),a.options.controls==!1&&ee.classList.add("jcalendar-hide-controls"),k.change=a.setValue,k.val=function(Ie){if(Ie===void 0)return a.getValue();a.setValue(Ie)},k.calendar=V.calendar=a};return be(),a};return A.keydown=function(k){var p=null;(p=A.current)&&(k.which==13?p.close(!1,!0):k.which==27&&p.close(!1,!1))},A.prettify=function(k,p){if(!p)var p={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};k.indexOf("GMT")===-1&&k.indexOf("Z")===-1&&(k+=" GMT");var a=new Date,W=new Date(k),ae=parseInt((a-W)/1e3/60);if(String.prototype.format=function(V){return this.replace("{0}",V)},ae==0)var ie=p.justNow;else if(ae<90)var ie=p.xMinutesAgo.format(ae);else if(ae<1440)var ie=p.xHoursAgo.format(Math.round(ae/60));else if(ae<20160)var ie=p.xDaysAgo.format(Math.round(ae/1440));else if(ae<43200)var ie=p.xWeeksAgo.format(Math.round(ae/10080));else if(ae<1036800)var ie=p.xMonthsAgo.format(Math.round(ae/43200));else var ie=p.xYearsAgo.format(Math.round(ae/525600));return ie},A.prettifyAll=function(){for(var k=document.querySelectorAll(".prettydate"),p=0;p<k.length;p++)k[p].getAttribute("data-date")?k[p].innerHTML=A.prettify(k[p].getAttribute("data-date")):k[p].innerHTML&&(k[p].setAttribute("title",k[p].innerHTML),k[p].setAttribute("data-date",k[p].innerHTML),k[p].innerHTML=A.prettify(k[p].innerHTML))},A.now=M.now,A.toArray=M.toArray,A.dateToNum=M.dateToNum,A.numToDate=M.numToDate,A.weekdays=M.weekdays,A.months=M.months,A.weekdaysShort=M.weekdaysShort,A.monthsShort=M.monthsShort,A.extractDateFromString=K.extractDateFromString,A.getDateString=K.getDateString,A}var te=H();function se(){var A={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},k=function(p){return A[p]?A[p]:A.material};return k.get=function(p){return A[p]?A[p]:A},k.set=function(p,a){A[p]=a},k}var Q=se();function pe(A,k){var p={};p.options={};var a={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var W in a)k&&k.hasOwnProperty(W)?p.options[W]=k[W]:p.options[W]=a[W];A.classList.add("jtabs");var ae=null,ie=null,V=null;const N=function(ve){p.options.animation&&setTimeout(function(){let xe=p.headers.children[ve].getBoundingClientRect();p.options.palette==="modern"?(V.style.width=xe.width-4+"px",V.style.left=p.headers.children[ve].offsetLeft+2+"px"):(V.style.width=xe.width+"px",V.style.left=p.headers.children[ve].offsetLeft+"px"),p.options.position==="bottom"?V.style.top="0px":V.style.bottom="0px"},50)};var Y=function(ve){typeof p.headers.scrollTo=="function"?p.headers.scrollTo({left:ve,behavior:"smooth"}):p.headers.scrollLeft=ve,ve<=1?ae.classList.add("disabled"):ae.classList.remove("disabled"),ve>=p.headers.scrollWidth-p.headers.offsetWidth?ie.classList.add("disabled"):ie.classList.remove("disabled"),p.headers.scrollWidth<=p.headers.offsetWidth?(ae.style.display="none",ie.style.display="none"):(ae.style.display="",ie.style.display="")};if(p.setBorder=N,p.open=function(ve){if(Array.from(p.content.children),!!p.content.children[ve]){for(var xe=null,Re=0;Re<p.headers.children.length;Re++)p.headers.children[Re].classList.contains("jtabs-selected")&&(xe=Re),p.headers.children[Re].classList.remove("jtabs-selected"),p.headers.children[Re].removeAttribute("aria-selected"),p.content.children[Re]&&p.content.children[Re].classList.remove("jtabs-selected");if(p.headers.children[ve].classList.add("jtabs-selected"),p.headers.children[ve].setAttribute("aria-selected","true"),p.content.children[ve]&&p.content.children[ve].classList.add("jtabs-selected"),xe!=ve&&typeof p.options.onchange=="function"&&p.content.children[ve]&&p.options.onchange(A,p,ve,p.headers.children[ve],p.content.children[ve]),p.options.hideHeaders==!0&&p.headers.children.length<3&&p.options.allowCreate==!1)p.headers.parentNode.style.display="none";else{p.headers.parentNode.style.display="";var ze=p.headers.children[ve].offsetLeft,$e=ze+p.headers.children[ve].offsetWidth,Je=p.headers.scrollLeft,nt=Je+p.headers.offsetWidth;Je<=ze&&nt>=$e||Y(ze-1),N(ve)}}},p.selectIndex=function(ve){var xe=Array.prototype.indexOf.call(p.headers.children,ve);return xe>=0&&p.open(xe),xe},p.rename=function(ve,xe){xe||(xe=prompt("New title",p.headers.children[ve].innerText)),p.headers.children[ve].innerText=xe,N(p.getActive())},p.create=function(ve,xe){if(typeof p.options.onbeforecreate=="function"){var Re=p.options.onbeforecreate(A,ve);if(Re===!1)return!1;ve=Re}var ze=p.appendElement(ve);return typeof p.options.oncreate=="function"&&p.options.oncreate(A,ze),N(p.getActive()),ze},p.remove=function(ve){return p.deleteElement(ve)},p.nextNumber=function(){for(var ve=0,xe=0;xe<p.headers.children.length;xe++){var Re=p.headers.children[xe].innerText.match(/[0-9].*/);Re>ve&&(ve=parseInt(Re))}return ve?ve++:ve=1,ve},p.deleteElement=function(ve){let xe=p.getActive();if(p.headers.children[ve])p.headers.removeChild(p.headers.children[ve]),p.content.removeChild(p.content.children[ve]);else return!1;if(xe===ve)p.open(0);else{let Re=p.getActive()||0;N(Re)}typeof p.options.ondelete=="function"&&p.options.ondelete(A,ve)},p.appendElement=function(ve,xe,Re,ze){if(!ve)var ve=prompt("Title?","");if(ve){let nt=s.guid(),re=s.guid();var $e=document.createElement("div");$e.setAttribute("id",re),$e.setAttribute("role","tabpanel"),$e.setAttribute("aria-labelledby",nt);var Je=document.createElement("div");if(Je.setAttribute("id",nt),Je.setAttribute("role","tab"),Je.setAttribute("aria-controls",re),Je.innerHTML=ve,Je.content=$e,typeof ze>"u")p.content.appendChild($e),p.headers.insertBefore(Je,p.headers.lastChild);else{let ne=p.content.children[ze];ne?p.content.insertBefore($e,ne):p.content.appendChild($e),ne=p.headers.children[ze]||p.headers.lastChild,p.headers.insertBefore(Je,ne)}return p.options.allowChangePosition&&Je.setAttribute("draggable","true"),Re!==!1&&p.selectIndex(Je),typeof xe=="function"&&xe($e,Je),$e}},p.getActive=function(){for(var ve=0;ve<p.headers.children.length;ve++)if(p.headers.children[ve].classList.contains("jtabs-selected"))return ve;return!1},p.updateContent=function(ve,xe){if(typeof xe!="string")var Re=xe;else{var Re=document.createElement("div");Re.innerHTML=xe}p.content.children[ve].classList.contains("jtabs-selected")&&xe.classList.add("jtabs-selected"),p.content.replaceChild(xe,p.content.children[ve]),N()},p.updatePosition=function(ve,xe,Re,ze){if(ve>xe?p.content.insertBefore(p.content.children[ve],p.content.children[xe]):p.content.insertBefore(p.content.children[ve],p.content.children[xe].nextSibling),ze!==!1)p.open(xe);else{const $e=p.getActive();xe<$e&&p.setBorder($e)}!Re&&typeof p.options.onchangeposition=="function"&&p.options.onchangeposition(p.headers,ve,xe)},p.move=function(ve,xe,Re,ze){ve>xe?p.headers.insertBefore(p.headers.children[ve],p.headers.children[xe]):p.headers.insertBefore(p.headers.children[ve],p.headers.children[xe].nextSibling),p.updatePosition(ve,xe,Re,ze)},p.setBorder=N,p.init=function(){A.innerHTML="",p.headers=document.createElement("div"),p.content=document.createElement("div"),p.headers.classList.add("jtabs-headers"),p.headers.setAttribute("role","tablist"),p.content.classList.add("jtabs-content"),p.content.setAttribute("role","region"),p.content.setAttribute("aria-label","Tab Panels"),p.options.palette?A.classList.add("jtabs-modern"):A.classList.remove("jtabs-modern"),p.options.padding&&(p.content.style.padding=parseInt(p.options.padding)+"px");var ve=document.createElement("div");ve.className="jtabs-headers-container",ve.appendChild(p.headers),p.options.maxWidth&&(ve.style.maxWidth=parseInt(p.options.maxWidth)+"px");var xe=document.createElement("div");if(xe.className="jtabs-controls",xe.setAttribute("draggable","false"),ve.appendChild(xe),p.options.position=="bottom"?(A.appendChild(p.content),A.appendChild(ve)):(A.appendChild(ve),A.appendChild(p.content)),p.options.allowCreate==!0){var Re=document.createElement("div");Re.className="jtabs-add",Re.onclick=function(){p.create()},xe.appendChild(Re)}ae=document.createElement("div"),ae.className="jtabs-prev",ae.onclick=function(){Y(p.headers.scrollLeft-p.headers.offsetWidth)},xe.appendChild(ae),ie=document.createElement("div"),ie.className="jtabs-next",ie.onclick=function(){Y(p.headers.scrollLeft+p.headers.offsetWidth)},xe.appendChild(ie);for(var ze=0;ze<p.options.data.length;ze++){if(p.options.data[ze].titleElement)var $e=p.options.data[ze].titleElement;else var $e=document.createElement("div");if(p.options.data[ze].icon){var Je=document.createElement("div"),nt=document.createElement("i");nt.classList.add("material-icons"),nt.innerHTML=p.options.data[ze].icon,Je.appendChild(nt),$e.appendChild(Je)}if(p.options.data[ze].title){var re=document.createTextNode(p.options.data[ze].title);$e.appendChild(re)}if(p.options.data[ze].width&&($e.style.width=p.options.data[ze].width),p.options.data[ze].contentElement)var ne=p.options.data[ze].contentElement;else{var ne=document.createElement("div");ne.innerHTML=p.options.data[ze].content}p.headers.appendChild($e),p.content.appendChild(ne)}V=document.createElement("div"),V.className="jtabs-border",p.headers.appendChild(V),p.options.animation&&A.classList.add("jtabs-animation"),p.headers.addEventListener("click",function(be){if(be.target.parentNode.classList.contains("jtabs-headers"))var U=be.target;else if(be.target.tagName=="I")var U=be.target.parentNode.parentNode;else var U=be.target.parentNode;var X=p.selectIndex(U);typeof p.options.onclick=="function"&&p.options.onclick(A,p,X,p.headers.children[X],p.content.children[X])}),p.headers.addEventListener("contextmenu",function(be){p.selectIndex(be.target)}),p.headers.children.length&&p.open(0),Y(0),p.options.allowChangePosition==!0&&j(p.headers,{direction:1,ondrop:function(be,U,X){p.updatePosition(U,X)}}),typeof p.options.onload=="function"&&p.options.onload(A,p)},A.children[0]&&A.children[0].children.length)for(var ee=0;ee<A.children[0].children.length;ee++){var ce=p.options.data&&p.options.data[ee]?p.options.data[ee]:{};A.children[1]&&A.children[1].children[ee]?(ce.titleElement=A.children[0].children[ee],ce.contentElement=A.children[1].children[ee]):ce.contentElement=A.children[0].children[ee],p.options.data[ee]=ce}var Se=!1;if(p.options.data)for(var ee=0;ee<p.options.data.length;ee++)p.options.data[ee].url&&(D({url:p.options.data[ee].url,type:"GET",dataType:"text/html",index:ee,success:function(xe){p.options.data[this.index].content=xe},complete:function(){p.init()}}),Se=!0);return Se||p.init(),A.tabs=p,p}function fe(A,k){if(A.color)return A.color.setOptions(k,!0);var p={type:"color"};p.options={};var a=null,W=null,ae=null,ie=null,V=null,N=null,Y=null;p.setOptions=function(C,q){var G={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};C||(C={}),C&&!C.palette&&(C.palette=Q());for(var ge in G)C&&C.hasOwnProperty(ge)?p.options[ge]=C[ge]:(typeof p.options[ge]>"u"||q===!0)&&(p.options[ge]=G[ge]);return ie&&(ie.innerHTML=p.options.resetLabel),V&&(V.innerHTML=p.options.doneLabel),p.options.palette&&Y&&Y.updateContent(0,xe()),typeof p.options.value=="string"&&(A.value=p.options.value,A.tagName==="INPUT"&&(A.style.color=A.value,A.style.backgroundColor=A.value)),p.options.placeholder?A.setAttribute("placeholder",p.options.placeholder):A.getAttribute("placeholder")&&A.removeAttribute("placeholder"),p},p.select=function(C){var q=a.querySelector(".jcolor-selected");q&&q.classList.remove("jcolor-selected"),p.values[C]&&p.values[C].classList.add("jcolor-selected"),p.options.value=C},p.open=function(){if(!a.classList.contains("jcolor-focus")){I(p,!0),a.classList.add("jcolor-focus"),p.options.value&&p.select(p.options.value),ae.style.marginTop="",ae.style.marginLeft="";var C=ae.getBoundingClientRect(),q=s.getWindowWidth(),G=s.getWindowHeight();if(q<800||p.options.fullscreen==!0?(ae.classList.add("jcolor-fullscreen"),_.slideBottom(ae,1),W.style.display="block"):(ae.classList.contains("jcolor-fullscreen")&&(ae.classList.remove("jcolor-fullscreen"),W.style.display=""),p.options.position?ae.style.position="fixed":ae.style.position="",C.left+C.width>q&&(ae.style.marginLeft=-1*(C.left+C.width-(q-20))+"px"),C.top+C.height>G&&(ae.style.marginTop=-1*(C.top+C.height-(G-20))+"px")),typeof p.options.onopen=="function"&&p.options.onopen(A,p),Y.setBorder(Y.getActive()),p.options.value){var ge=ve(p.options.value);ne.forEach(function(J,he){J.value=ge[he],J.dispatchEvent(new Event("input"))})}}},p.close=function(C){return a.classList.contains("jcolor-focus")&&(a.classList.remove("jcolor-focus"),W.style.display="",!C&&typeof p.options.onclose=="function"&&p.options.onclose(A,p),I(p,!1)),p.options.value},p.setValue=function(C){C||(C=""),C!=p.options.value&&(p.options.value=C,re=C,p.select(C),typeof p.options.onchange=="function"&&p.options.onchange(A,C,p),A.value!=p.options.value&&(A.value=p.options.value,A.tagName==="INPUT"&&(A.style.color=A.value,A.style.backgroundColor=A.value),typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),p.options.closeOnChange==!0&&p.close())},p.getValue=function(){return p.options.value};var ee=function(C){var q=C.toString(16);return q.length===1?"0"+q:q},ce=function(C,q,G){return"#"+ee(C)+ee(q)+ee(G)},Se=function(C){return parseInt("0x"+C)},ve=function(C){return[Se(C.substr(1,2)),Se(C.substr(3,2)),Se(C.substr(5,2))]},xe=function(){var C=document.createElement("div");C.className="jcolor-grid",p.values=[];var q=document.createElement("table");q.setAttribute("cellpadding","7"),q.setAttribute("cellspacing","0");for(var G=0;G<p.options.palette.length;G++){for(var ge=document.createElement("tr"),J=0;J<p.options.palette[G].length;J++){var he=document.createElement("td"),Te=p.options.palette[G][J];Te.length<7&&Te.substr(0,1)!=="#"&&(Te="#"+Te),he.style.backgroundColor=Te,he.setAttribute("data-value",Te),he.innerHTML="",ge.appendChild(he),p.options.value==Te&&he.classList.add("jcolor-selected"),p.values[Te]=he}q.appendChild(ge)}return C.appendChild(q),C},Re=document.createElement("canvas");Re.width=200,Re.height=160;var ze=Re.getContext("2d"),$e=function(){var C=N.firstChild.getBoundingClientRect();Re.width=C.width-14,Je()},Je=function(){var C=ze.createLinearGradient(0,0,Re.width,0);C.addColorStop(0,"rgb(255,0,0)"),C.addColorStop(.15,"rgb(255,0,255)"),C.addColorStop(.33,"rgb(0,0,255)"),C.addColorStop(.49,"rgb(0,255,255)"),C.addColorStop(.67,"rgb(0,255,0)"),C.addColorStop(.84,"rgb(255,255,0)"),C.addColorStop(1,"rgb(255,0,0)"),ze.fillStyle=C,ze.fillRect(0,0,Re.width,Re.height),C=ze.createLinearGradient(0,0,0,Re.height),C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.5,"rgba(255,255,255,0)"),C.addColorStop(.5,"rgba(0,0,0,0)"),C.addColorStop(1,"rgba(0,0,0,1)"),ze.fillStyle=C,ze.fillRect(0,0,Re.width,Re.height)},nt=function(){var C=document.createElement("div");C.className="jcolor-hsl";var q=document.createElement("div");q.className="jcolor-point";var G=document.createElement("div");G.appendChild(Re),G.appendChild(q),C.appendChild(G);var ge=function(J,he,Te){if(J===1){var qe=C.getBoundingClientRect(),Ie=he-qe.left,Ve=Te-qe.top;Ie<0&&(Ie=0),Ve<0&&(Ve=0),Ie>qe.width&&(Ie=qe.width),Ve>qe.height&&(Ve=qe.height),q.style.left=Ie+"px",q.style.top=Ve+"px";var Ue=ze.getImageData(Ie,Ve,1,1).data;re=ce(Ue[0],Ue[1],Ue[2])}};return C.addEventListener("mousedown",function(J){ge(J.buttons,J.clientX,J.clientY)}),C.addEventListener("mousemove",function(J){ge(J.buttons,J.clientX,J.clientY)}),C.addEventListener("touchmove",function(J){ge(1,J.changedTouches[0].clientX,J.changedTouches[0].clientY)}),C},re="",ne=[],be=function(){if(re!=="")for(var C=0;C<ne.length;C++){var q=ve(re);q[C]=0;var G="linear-gradient(90deg, rgb(";G+=q.join(", "),G+="), rgb(",q[C]=255,G+=q.join(", "),G+="))",ne[C].style.backgroundImage=G}},U=function(){var C=document.createElement("div");C.className="jcolor-sliders";var q=document.createElement("div"),G=function(Te){var qe=document.createElement("div");qe.className="jcolor-sliders-input-container";var Ie=document.createElement("label");Ie.innerText=Te;var Ve=document.createElement("div");Ve.className="jcolor-sliders-input-subcontainer";var Ue=document.createElement("input");Ue.type="range",Ue.min=0,Ue.max=255,Ue.value=0,Ue.setAttribute("aria-label","Color value"),Ue.setAttribute("aria-valuemin","0"),Ue.setAttribute("aria-valuemax","255"),Ue.setAttribute("aria-valuenow","0"),qe.appendChild(Ie),Ve.appendChild(Ue);var tt=document.createElement("div");return tt.innerText=Ue.value,Ue.addEventListener("input",function(){tt.innerText=Ue.value}),Ve.appendChild(tt),qe.appendChild(Ve),q.appendChild(qe),Ue};ne=[G("Red"),G("Green"),G("Blue")],C.appendChild(q);var ge=document.createElement("div");ge.className="jcolor-sliders-final-color";var J=document.createElement("div");J.style.visibility="hidden",J.innerText="a",ge.appendChild(J);var he=function(){var Te=ce(parseInt(ne[0].value),parseInt(ne[1].value),parseInt(ne[2].value));J.innerText=Te,J.style.color=Te,J.style.removeProperty("visibility"),re=Te};return ne.forEach(function(Te){Te.addEventListener("input",function(){he(),be()})}),C.appendChild(ge),C},X=function(){p.setOptions(k),A.tagName=="INPUT"&&(A.classList.add("jcolor-input"),A.readOnly=!0),a=document.createElement("div"),a.className="jcolor",W=document.createElement("div"),W.className="jcolor-backdrop",a.appendChild(W),ae=document.createElement("div"),ae.className="jcolor-content";var C=document.createElement("div");C.className="jcolor-controls",ae.appendChild(C),ie=document.createElement("div"),ie.className="jcolor-reset",ie.innerHTML=p.options.resetLabel,C.appendChild(ie),V=document.createElement("div"),V.className="jcolor-close",V.innerHTML=p.options.doneLabel,C.appendChild(V),N=document.createElement("div"),ae.appendChild(N),Y=pe(N,{animation:!0,data:[{title:"Grid",contentElement:xe()},{title:"Spectrum",contentElement:nt()},{title:"Sliders",contentElement:U()}],onchange:function(q,G,ge){if(ge===1)$e();else{var J=re!==""?re:p.getValue();if(ge===2&&J){var he=ve(J);ne.forEach(function(Te,qe){Te.value=he[qe],Te.dispatchEvent(new Event("input"))})}}},palette:"modern"}),a.appendChild(ae),A.tagName=="INPUT"?A.parentNode.insertBefore(a,A.nextSibling):A.appendChild(a),a.addEventListener("click",function(q){if(q.target.tagName=="TD"){var G=q.target.getAttribute("data-value");G&&p.setValue(G)}else q.target.classList.contains("jcolor-reset")?(p.setValue(""),p.close()):q.target.classList.contains("jcolor-close")?(Y.getActive()>0&&p.setValue(re),p.close()):q.target.classList.contains("jcolor-backdrop")?p.close():p.open()}),A.addEventListener("mouseup",function(q){p.open()}),window.addEventListener("resize",function(){a.classList.contains("jcolor-focus")&&Y.getActive()==1&&$e()}),p.options.opened==!0&&p.open(),A.change=p.setValue,A.val=function(q){if(q===void 0)return p.getValue();p.setValue(q)},A.color=p,a.color=p};return p.toHex=function(C){var q=function(G){return("0"+parseInt(G).toString(16)).slice(-2)};if(C)return/^#[0-9A-F]{6}$/i.test(C)?C:(C=C.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),C&&C.length?"#"+q(C[1])+q(C[2])+q(C[3]):"")},X(),p}function me(){var A=function(k,p){var a={type:"contextmenu"};a.options={};var W={items:null,onclick:null};for(var ae in W)p&&p.hasOwnProperty(ae)?a.options[ae]=p[ae]:a.options[ae]=W[ae];k.classList.add("jcontextmenu"),a.open=function(N,Y){if(Y&&(a.options.items=Y,a.create(Y)),A.current&&A.current.close(),I(a,!0),k.classList.add("jcontextmenu-focus"),A.current=a,a.options.items&&a.options.items.length>0||k.children.length){if(N.target)if(N.changedTouches&&N.changedTouches[0])ee=N.changedTouches[0].clientX,ce=N.changedTouches[0].clientY;else var ee=N.clientX,ce=N.clientY;else var ee=N.x,ce=N.y;var Se=k.getBoundingClientRect();if(window.innerHeight<ce+Se.height){var ve=ce-Se.height;ve<0&&(ve=0),k.style.top=ve+"px"}else k.style.top=ce+"px";window.innerWidth<ee+Se.width?ee-Se.width>0?k.style.left=ee-Se.width+"px":k.style.left="10px":k.style.left=ee+"px"}},a.isOpened=function(){return!!k.classList.contains("jcontextmenu-focus")},a.close=function(){k.classList.contains("jcontextmenu-focus")&&k.classList.remove("jcontextmenu-focus"),I(a,!1)},a.create=function(N){k.innerHTML="";var Y=ie();k.appendChild(Y);for(var ee=0;ee<N.length;ee++){var ce=V(N[ee]);k.appendChild(ce)}};function ie(){var N=document.createElement("div");N.classList.add("header"),N.addEventListener("click",function(ce){ce.preventDefault(),ce.stopPropagation()});var Y=document.createElement("a");Y.classList.add("title"),Y.innerHTML=f.translate("Menu"),N.appendChild(Y);var ee=document.createElement("a");return ee.classList.add("close"),ee.innerHTML=f.translate("close"),ee.addEventListener("click",function(ce){a.close()}),N.appendChild(ee),N}function V(N){if(N.type&&(N.type=="line"||N.type=="divisor"))var Y=document.createElement("hr");else{var Y=document.createElement("div"),ee=document.createElement("a");if(ee.innerHTML=N.title,N.tooltip&&Y.setAttribute("title",N.tooltip),N.icon&&Y.setAttribute("data-icon",N.icon),N.id&&(Y.id=N.id),N.disabled?Y.className="jcontextmenu-disabled":N.onclick&&(Y.method=N.onclick,Y.addEventListener("mousedown",function(Je){Je.preventDefault()}),Y.addEventListener("mouseup",function(Je){this.method(this,Je)})),Y.appendChild(ee),N.submenu){var ce=document.createElement("span");ce.innerHTML="&#9658;",Y.appendChild(ce),Y.classList.add("jcontexthassubmenu");var Se=document.createElement("div");Se.classList.add("jcontextmenu"),Se.setAttribute("tabindex","900");for(var ve=N.submenu,xe=0;xe<ve.length;xe++){var Re=V(ve[xe]);Se.appendChild(Re)}Y.appendChild(Se)}else if(N.shortcut){var ze=document.createElement("span");ze.innerHTML=N.shortcut,Y.appendChild(ze)}}return Y}return typeof a.options.onclick=="function"&&k.addEventListener("click",function(N){a.options.onclick(a,N)}),a.options.items&&a.create(a.options.items),window.addEventListener("mousewheel",function(){a.close()}),k.contextmenu=a,a};return A}var oe=me();function Pe(){var A=function(k,p){if(k.dropdown)return k.dropdown.setOptions(p,!0);var a={type:"dropdown"};a.options={};var W=function(U,X){U&&U.length&&(a.options.sortResults!==!1&&(typeof a.options.sortResults=="function"?U.sort(a.options.sortResults):U.sort(ae)),a.setData(U)),typeof a.options.onload=="function"&&a.options.onload(k,a,U,X),X&&V(X),X==null&&(a.options.value=""),k.value=a.options.value,a.options.opened==!0&&a.open()},ae=function(U,X){var C,q;return typeof U=="string"?C=U:U.text?C=U.text:U.name&&(C=U.name),typeof X=="string"?q=X:X.text?q=X.text:X.name&&(q=X.name),typeof C=="string"||typeof q=="string"?(typeof C!="string"&&(C=""+C),typeof q!="string"&&(q=""+q),C.localeCompare(q)):C-q},ie=function(){a.value={};for(var U=0;U<a.items.length;U++)a.items[U].selected==!0&&(a.items[U].element&&a.items[U].element.classList.remove("jdropdown-selected"),a.items[U].selected=null);a.options.value="",k.value=""},V=function(U){if(ie(),U!==null)if(!U)typeof a.value[""]<"u"&&(a.value[""]="");else{Array.isArray(U)||(U=(""+U).split(";"));for(var X=0;X<U.length;X++)a.value[U[X]]=""}for(var X=0;X<a.items.length;X++)typeof a.value[N(X)]<"u"&&(a.items[X].element&&a.items[X].element.classList.add("jdropdown-selected"),a.items[X].selected=!0,a.value[N(X)]=Y(X));a.options.value=Object.keys(a.value).join(";"),a.header.value=a.getText()},N=function(U,X){if(a.options.format)var C="id";else var C="value";return a.items[U]?a.items[U].data[C]:""},Y=function(U,X){if(a.options.format)var C="name";else var C="text";return a.items[U]?a.items[U].data[C]:""},ee=function(){return Object.keys(a.value)},ce=function(){for(var U=[],X=Object.keys(a.value),C=0;C<X.length;C++)U.push(a.value[X[C]]);return U};a.setOptions=function(U,X){U||(U={});var C={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var q in C)U&&U.hasOwnProperty(q)?a.options[q]=U[q]:(typeof a.options[q]>"u"||X===!0)&&(a.options[q]=C[q]);return(a.options.remoteSearch==!0||a.options.type==="searchbar")&&(a.options.autocomplete=!0),a.options.newOptions==!0?a.header.classList.add("jdropdown-add"):a.header.classList.remove("jdropdown-add"),a.options.autocomplete==!0?a.header.removeAttribute("readonly"):a.header.setAttribute("readonly","readonly"),a.options.placeholder?a.header.setAttribute("placeholder",a.options.placeholder):a.header.removeAttribute("placeholder"),k.classList.remove("jdropdown-searchbar"),k.classList.remove("jdropdown-picker"),k.classList.remove("jdropdown-list"),a.options.type=="searchbar"?k.classList.add("jdropdown-searchbar"):a.options.type=="list"?k.classList.add("jdropdown-list"):a.options.type=="picker"?k.classList.add("jdropdown-picker"):s.getWindowWidth()<800?a.options.autocomplete?(k.classList.add("jdropdown-searchbar"),a.options.type="searchbar"):(k.classList.add("jdropdown-picker"),a.options.type="picker"):(a.options.width?(k.style.width=a.options.width,k.style.minWidth=a.options.width):(k.style.removeProperty("width"),k.style.removeProperty("min-width")),k.classList.add("jdropdown-default"),a.options.type="default"),a.options.type=="searchbar"?Se.appendChild(Re):ve.insertBefore(Re,ve.firstChild),a.options.url&&!U.data?D({url:a.options.url,method:"GET",dataType:"json",success:function(G){G&&W(G,a.options.value)}}):W(a.options.data,a.options.value),a};var Se=null,ve=null,xe=null,Re=null,ze=null,$e=null,Je=null,nt=function(){if(p||(p={}),k.tagName=="SELECT"){var U=A.extractFromDom(k,p);k=U.el,p=U.options}!p.placeholder&&k.getAttribute("placeholder")&&(p.placeholder=k.getAttribute("placeholder")),a.value={},a.items=[],a.groups=[],a.search="",a.results=null,k.classList.add("jdropdown"),Se=document.createElement("div"),Se.className="jdropdown-container-header",a.header=document.createElement("input"),a.header.className="jdropdown-header jss_object",a.header.type="text",a.header.setAttribute("autocomplete","off"),a.header.onfocus=function(){typeof a.options.onfocus=="function"&&a.options.onfocus(k)},a.header.onblur=function(){typeof a.options.onblur=="function"&&a.options.onblur(k)},a.header.onkeyup=function(X){a.options.autocomplete==!0&&!Je?(a.search!=a.header.value.trim()&&(Je=setTimeout(function(){a.find(a.header.value.trim()),Je=null},400)),k.classList.contains("jdropdown-focus")||a.open()):a.options.autocomplete||a.next(X.key)},A.hasEvents||(A.hasEvents=!0,document.addEventListener("keydown",A.keydown)),ve=document.createElement("div"),ve.className="jdropdown-container",xe=document.createElement("div"),xe.className="jdropdown-content",Re=document.createElement("div"),Re.className="jdropdown-close",Re.textContent="Done",ze=document.createElement("div"),ze.className="jdropdown-reset",ze.textContent="x",ze.onclick=function(){a.reset(),a.close()},$e=document.createElement("div"),$e.className="jdropdown-backdrop",Se.appendChild(a.header),ve.appendChild(xe),k.appendChild(Se),k.appendChild(ve),k.appendChild($e),a.setOptions(p),"ontouchsend"in document.documentElement?k.addEventListener("touchsend",A.mouseup):k.addEventListener("mouseup",A.mouseup),a.options.lazyLoading==!0&&g(xe,{loadUp:a.loadUp,loadDown:a.loadDown}),xe.onwheel=function(X){X.stopPropagation()},k.change=a.setValue,k.val=function(X){if(X===void 0)return a.getValue(!!a.options.multiple);a.setValue(X)},k.dropdown=a};a.getUrl=function(){return a.options.url},a.setUrl=function(U,X){a.options.url=U,D({url:a.options.url,method:"GET",dataType:"json",success:function(C){a.setData(C),typeof X=="function"&&X(a)}})},a.setId=function(U,X){if(a.options.format)var C="id";else var C="value";typeof U=="object"?U[C]=X:a.items[U].data[C]=X};const re=function(U,X){if(!U){let G=a.options.autocomplete==!0?a.header.value:"";if(U=prompt(f.translate("Add A New Option"),G),!U)return!1}if(X||(X=s.guid()),a.options.format)var C={id:X,name:U};else var C={value:X,text:U};if(typeof a.options.onbeforeinsert=="function"){let G=a.options.onbeforeinsert(a,C);if(G===!1)return!1;G&&(C=G)}a.options.data.push(C);var q=a.createItem(C);return xe.appendChild(q.element),typeof a.options.oninsert=="function"&&a.options.oninsert(a,C,q),xe.style.display=="none"&&(xe.style.display=""),a.results&&a.results.push(q),C};a.add=function(U,X){return typeof a.options.prompt=="function"?a.options.prompt.call(a,re):re(U,X)},a.createItem=function(U,X,C){a.options.format?(!U.id&&U.value!==void 0&&(U.id=U.value),!U.name&&U.text!==void 0&&(U.name=U.text)):(!U.value&&U.id!==void 0&&(U.value=U.id),!U.text&&U.name!==void 0&&(U.text=U.name));var q={};if(q.element=document.createElement("div"),q.element.className="jdropdown-item",q.element.indexValue=a.items.length,q.data=U,X&&(q.group=X),U.id&&q.element.setAttribute("id",U.id),U.disabled==!0&&q.element.setAttribute("data-disabled",!0),U.tooltip&&q.element.setAttribute("title",U.tooltip),U.image){var G=document.createElement("img");G.className="jdropdown-image",G.src=U.image,U.title||G.classList.add("jdropdown-image-small"),q.element.appendChild(G)}else if(U.icon){var ge=document.createElement("span");ge.className="jdropdown-icon material-icons",ge.innerText=U.icon,U.title||ge.classList.add("jdropdown-icon-small"),U.color&&(ge.style.color=U.color),q.element.appendChild(ge)}else if(U.color){var J=document.createElement("div");J.className="jdropdown-color",J.style.backgroundColor=U.color,q.element.appendChild(J)}if(a.options.format)var he=U.name;else var he=U.text;var Te=document.createElement("div");if(Te.className="jdropdown-description",Te.textContent=he||"&nbsp;",U.title){var qe=document.createElement("div");qe.className="jdropdown-title",qe.innerText=U.title,Te.appendChild(qe)}if(a.options.format)var Ie=U.id;else var Ie=U.value;return a.value[Ie]&&(q.element.classList.add("jdropdown-selected"),q.selected=!0),a.items.push(q),q.element.appendChild(Te),q},a.appendData=function(U){if(U.length){for(var X=[],C=[],q=0;q<U.length;q++)U[q].group?(C[U[q].group]||(C[U[q].group]=[]),C[U[q].group].push(q)):X.push(q);var G=0,ge=Object.keys(C);if(ge.length>0)for(var q=0;q<ge.length;q++){var J=document.createElement("div");J.className="jdropdown-group";var he=document.createElement("div");he.className="jdropdown-group-name",he.textContent=ge[q];var Te=document.createElement("i");Te.className="jdropdown-group-arrow jdropdown-group-arrow-down",he.appendChild(Te);var qe=document.createElement("div");qe.className="jdropdown-group-items";for(var Ie=0;Ie<C[ge[q]].length;Ie++){var Ve=a.createItem(U[C[ge[q]][Ie]],J,ge[q]);(a.options.lazyLoading==!1||G<200)&&(qe.appendChild(Ve.element),G++)}J.appendChild(he),J.appendChild(qe),a.groups.push(J),qe.children.length>0&&xe.appendChild(J)}if(X.length)for(var q=0;q<X.length;q++){var Ve=a.createItem(U[X[q]]);(a.options.lazyLoading==!1||G<200)&&(xe.appendChild(Ve.element),G++)}}},a.setData=function(U){if(ie(),xe.textContent="",a.header.value="",a.items=[],U&&U.length){for(var X=0;X<U.length;X++)typeof U[X]!="object"&&(a.options.format?U[X]={id:U[X],name:U[X]}:U[X]={value:U[X],text:U[X]});a.appendData(U),a.options.data=U}else a.options.data=[];a.close()},a.getData=function(){return a.options.data},a.getPosition=function(U){for(var X=0;X<a.items.length;X++)if(N(X)==U)return X;return!1},a.getText=function(U){var X=ce();return U?X:X.join("; ")},a.getValue=function(U){var X=ee();return U?X:X.join(";")};var ne=function(U){k.value!=a.options.value&&(k.value=a.options.value,typeof k.oninput=="function"&&k.oninput({type:"input",target:k,value:k.value})),typeof a.options.onchange=="function"&&a.options.onchange(k,a,U,a.options.value)};a.setValue=function(U){var X=a.getValue();Array.isArray(U)&&(U=U.join(";")),X!==U&&(V(U),ne(X))},a.resetSelected=function(){a.setValue(null)},a.selectIndex=function(C,X){var C=parseInt(C);if(a.items&&a.items[C]&&(X===!0||a.items[C].data.disabled!==!0))if(a.setCursor(C,!1),!a.options.multiple)a.items[C].selected?a.options.allowEmpty!==!1&&a.setValue(null):a.setValue(N(C)),a.close();else{var q=a.options.value;a.items[C].selected?(a.items[C].element.classList.remove("jdropdown-selected"),a.items[C].selected=!1,delete a.value[N(C)]):(a.items[C].element.classList.add("jdropdown-selected"),a.items[C].selected=!0,a.value[N(C)]=Y(C)),a.options.value=Object.keys(a.value).join(";"),a.options.autocomplete==!1&&(a.header.value=ce().join("; ")),ne(q)}},a.selectItem=function(U){a.selectIndex(U.indexValue)};var be=function(U,X){for(var C=0;C<X.length;C++)if(a.options.format){if(X[C].id==U)return!0}else if(X[C].value==U)return!0;return!1};return a.find=function(U){if(a.search==U.trim())return!1;if(a.search=U,a.setCursor(),a.groups.length)for(var X=0;X<a.groups.length;X++)a.groups[X].lastChild.textContent="";if(xe.textContent="",a.options.remoteSearch==!0){a.results=null;var C=a.options.url;let qe={url:C,method:"GET",data:{q:U},dataType:"json",success:function(Ie){a.items=[];var Ve=Object.keys(a.value);if(Ve.length)for(var Ue=0;Ue<Ve.length;Ue++)be(Ve[Ue],Ie)||(a.options.format?Ie.unshift({id:Ve[Ue],name:a.value[Ve[Ue]]}):Ie.unshift({value:Ve[Ue],text:a.value[Ve[Ue]]}));a.appendData(Ie),Ie.length?xe.style.display="":xe.style.display="none",typeof a.options.onsearch=="function"&&a.options.onsearch(a,Ie)}};if(typeof a.options.onbeforesearch=="function"){let Ie=a.options.onbeforesearch(a,qe);if(Ie===!1)return;typeof Ie=="object"&&(qe=Ie)}D(qe)}else{U=new RegExp(U,"gi");for(var q=[],X=0;X<a.items.length;X++){var G=Y(X),ge=a.items[X].data.title||"",J=a.items[X].data.group||"",he=a.items[X].data.synonym||"";he&&(he=he.join(" ")),(U==null||a.items[X].selected==!0||G.toString().match(U)||ge.match(U)||J.match(U)||he.match(U))&&q.push(a.items[X])}if(!q.length)xe.style.display="none",a.results=null;else{xe.style.display="",a.results=q;var Te=q.length||0;a.options.lazyLoading==!0&&Te>200&&(Te=200);for(var X=0;X<Te;X++)a.results[X].group?(a.results[X].group.parentNode||xe.appendChild(a.results[X].group),a.results[X].group.lastChild.appendChild(a.results[X].element)):xe.appendChild(a.results[X].element)}}a.options.autofocus==!0&&a.first()},a.open=function(){if(!k.classList.contains("jdropdown-focus")){A.current=a,I(a,!0),k.classList.add("jdropdown-focus"),s.getWindowWidth()<800&&(a.options.type==null||a.options.type=="picker")&&_.slideBottom(ve,1),a.options.autocomplete==!0&&(a.header.value=a.search,a.header.focus());var U=ee();if(U[0]){var X=a.getPosition(U[0]);X!==!1&&a.setCursor(X)}if(!a.options.type||a.options.type=="default"){var C=k.getBoundingClientRect(),q=ve.getBoundingClientRect();a.options.position?(ve.style.position="fixed",window.innerHeight<C.bottom+q.height?(ve.style.top="",ve.style.bottom=window.innerHeight-C.top+1+"px"):(ve.style.top=C.bottom+"px",ve.style.bottom=""),ve.style.left=C.left+"px"):window.innerHeight<C.bottom+q.height?(ve.style.top="",ve.style.bottom=C.height+1+"px"):(ve.style.top="",ve.style.bottom=""),ve.style.minWidth=C.width+"px",a.options.maxWidth&&(ve.style.maxWidth=a.options.maxWidth),!a.items.length&&a.options.autocomplete==!0?xe.style.display="none":xe.style.display=""}}typeof a.options.onopen=="function"&&a.options.onopen(k)},a.close=function(U){return k.classList.contains("jdropdown-focus")&&(a.header.value=a.getText(),a.setCursor(),!U&&typeof a.options.onclose=="function"&&a.options.onclose(k),a.header.blur&&a.header.blur(),k.classList.remove("jdropdown-focus"),I(a,!1),A.current=null),a.getValue()},a.setCursor=function(U,X){if(a.currentIndex!=null&&a.items&&a.items[a.currentIndex]&&a.items[a.currentIndex].element.classList.remove("jdropdown-cursor"),U==null)a.currentIndex=null;else if(U=parseInt(U),a.items[U].element.parentNode&&(a.items[U].element.classList.add("jdropdown-cursor"),a.currentIndex=U,X!==!1&&a.items[a.currentIndex].element)){xe.scrollTop;var C=a.items[a.currentIndex].element;xe.scrollTop=C.offsetTop-C.scrollTop+C.clientTop-95}},a.resetCursor=a.setCursor,a.updateCursor=a.setCursor,a.reset=function(){a.setCursor(),a.setValue(null)},a.first=function(){a.options.lazyLoading===!0&&a.loadFirst();var U=xe.querySelectorAll(".jdropdown-item");if(U.length){var X=U[0].indexValue;a.setCursor(X)}},a.last=function(){a.options.lazyLoading===!0&&a.loadLast();var U=xe.querySelectorAll(".jdropdown-item");if(U.length){var X=U[U.length-1].indexValue;a.setCursor(X)}},a.next=function(U){var X=null;if(U){if(U.length==1){var C=a.currentIndex||-1;U=U.toLowerCase();var q=null,G=null,ge=xe.querySelectorAll(".jdropdown-item");if(ge.length){for(var J=0;J<ge.length;J++)if(ge[J].indexValue>C&&(q=a.items[ge[J].indexValue])&&(G=q.element.innerText[0])&&(G=G.toLowerCase(),U==G)){X=ge[J].indexValue;break}a.setCursor(X)}}}else if(a.currentIndex==null||a.currentIndex==null)a.first();else{var he=a.items[a.currentIndex].element,Te=he.nextElementSibling;Te?(Te.classList.contains("jdropdown-group")&&(Te=Te.lastChild.firstChild),X=Te.indexValue):he.parentNode.classList.contains("jdropdown-group-items")&&((Te=he.parentNode.parentNode.nextElementSibling)&&(Te.classList.contains("jdropdown-group")?Te=Te.lastChild.firstChild:Te.classList.contains("jdropdown-item")?X=Te.indexValue:Te=null),Te&&(X=Te.indexValue)),X!==null&&a.setCursor(X)}},a.prev=function(){var U=null;if(a.currentIndex===null)a.first();else{var X=a.items[a.currentIndex].element,C=X.previousElementSibling;C?(C.classList.contains("jdropdown-group")&&(C=C.lastChild.lastChild),U=C.indexValue):X.parentNode.classList.contains("jdropdown-group-items")&&((C=X.parentNode.parentNode.previousElementSibling)&&(C.classList.contains("jdropdown-group")?C=C.lastChild.lastChild:C.classList.contains("jdropdown-item")?U=C.indexValue:C=null),C&&(U=C.indexValue))}U!==null&&a.setCursor(U)},a.loadFirst=function(){if(a.results)var U=a.results;else var U=a.items;var X=U.length||0;a.options.lazyLoading==!0&&X>200&&(X=200),xe.textContent="";for(var C=0;C<X;C++)U[C].group?(U[C].group.parentNode||xe.appendChild(U[C].group),U[C].group.lastChild.appendChild(U[C].element)):xe.appendChild(U[C].element);xe.scrollTop=0},a.loadLast=function(){if(a.results)var U=a.results;else var U=a.items;var X=U.length;if(X>200){X=X-200,xe.textContent="";for(var C=X;C<U.length;C++)U[C].group?(U[C].group.parentNode||xe.appendChild(U[C].group),U[C].group.lastChild.appendChild(U[C].element)):xe.appendChild(U[C].element);xe.scrollTop=xe.scrollHeight}},a.loadUp=function(){var U=!1;if(a.results)var X=a.results;else var X=a.items;var C=xe.querySelectorAll(".jdropdown-item"),q=C[0].indexValue;q=a.items[q];var G=X.indexOf(q)-1;if(G>0){for(var ge=0;G>0&&X[G]&&ge<200;)X[G].group?(X[G].group.parentNode||xe.insertBefore(X[G].group,xe.firstChild),X[G].group.lastChild.insertBefore(X[G].element,X[G].group.lastChild.firstChild)):xe.insertBefore(X[G].element,xe.firstChild),G--,ge++;U=!0}return U},a.loadDown=function(){var U=!1;if(a.results)var X=a.results;else var X=a.items;var C=xe.querySelectorAll(".jdropdown-item"),q=C[C.length-1].indexValue;q=a.items[q];var G=X.indexOf(q)+1;if(G<X.length){for(var ge=0;G<X.length&&X[G]&&ge<200;)X[G].group?(X[G].group.parentNode||xe.appendChild(X[G].group),X[G].group.lastChild.appendChild(X[G].element)):xe.appendChild(X[G].element),G++,ge++;U=!0}return U},nt(),a};return A.keydown=function(k){var p=null;if(p=A.current){if(k.which==13||k.which==9)p.header.value&&p.currentIndex==null&&p.options.newOptions?p.add():(p.currentIndex==null&&p.options.autocomplete==!0&&p.header.value!=""&&p.find(p.header.value),p.selectIndex(p.currentIndex));else if(k.which==38)p.currentIndex==null?p.first():p.currentIndex>0&&p.prev(),k.preventDefault();else if(k.which==40)p.currentIndex==null?p.first():p.currentIndex+1<p.items.length&&p.next(),k.preventDefault();else if(k.which==36)p.first(),k.target.classList.contains("jdropdown-header")||k.preventDefault();else if(k.which==35)p.last(),k.target.classList.contains("jdropdown-header")||k.preventDefault();else if(k.which==27)p.close();else if(k.which==33){if(p.currentIndex==null)p.first();else if(p.currentIndex>0)for(var a=0;a<7;a++)p.prev();k.preventDefault()}else if(k.which==34){if(p.currentIndex==null)p.first();else if(p.currentIndex+1<p.items.length)for(var a=0;a<7;a++)p.next();k.preventDefault()}}},A.mouseup=function(k){var p=s.findElement(k.target,"jdropdown");if(p){var a=p.dropdown;if(k.target.classList.contains("jdropdown-header"))if(p.classList.contains("jdropdown-focus")&&p.classList.contains("jdropdown-default")){var W=p.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0]){var ae=k.changedTouches[0].clientX;k.changedTouches[0].clientY}else{var ae=k.clientX;k.clientY}W.width-(ae-W.left)<30?k.target.classList.contains("jdropdown-add")?a.add():a.close():a.options.autocomplete==!1&&a.close()}else a.open();else if(k.target.classList.contains("jdropdown-group-name")){var ie=k.target.nextSibling.children;if(k.target.nextSibling.style.display!="none")for(var V=0;V<ie.length;V++)ie[V].style.display!="none"&&a.selectItem(ie[V])}else k.target.classList.contains("jdropdown-group-arrow")?k.target.classList.contains("jdropdown-group-arrow-down")?(k.target.classList.remove("jdropdown-group-arrow-down"),k.target.classList.add("jdropdown-group-arrow-up"),k.target.parentNode.nextSibling.style.display="none"):(k.target.classList.remove("jdropdown-group-arrow-up"),k.target.classList.add("jdropdown-group-arrow-down"),k.target.parentNode.nextSibling.style.display=""):k.target.classList.contains("jdropdown-item")?a.selectItem(k.target):k.target.classList.contains("jdropdown-image")||k.target.classList.contains("jdropdown-description")?a.selectItem(k.target.parentNode):k.target.classList.contains("jdropdown-title")?a.selectItem(k.target.parentNode.parentNode):(k.target.classList.contains("jdropdown-close")||k.target.classList.contains("jdropdown-backdrop"))&&a.close()}},A.extractFromDom=function(k,p){var a=k;if(p||(p={}),k.getAttribute("multiple")&&(!p||p.multiple==null)&&(p.multiple=!0),k.getAttribute("placeholder")&&(!p||p.placeholder==null)&&(p.placeholder=k.getAttribute("placeholder")),k.getAttribute("data-autocomplete")&&(!p||p.autocomplete==null)&&(p.autocomplete=!0),(!p||p.width==null)&&(p.width=k.offsetWidth),k.value&&(!p||p.value==null)&&(p.value=k.value),!p||p.data==null){p.data=[];for(var W=0;W<k.children.length;W++)if(k.children[W].tagName=="OPTGROUP")for(var ae=0;ae<k.children[W].children.length;ae++)p.data.push({value:k.children[W].children[ae].value,text:k.children[W].children[ae].textContent,group:k.children[W].getAttribute("label")});else p.data.push({value:k.children[W].value,text:k.children[W].textContent})}(!p||p.onchange==null)&&(p.onchange=function(V,N,Y,ee){p.multiple==!0?obj.items[N].classList.contains("jdropdown-selected")?a.options[N].setAttribute("selected","selected"):a.options[N].removeAttribute("selected"):a.value=ee});var ie=document.createElement("div");return k.parentNode.insertBefore(ie,k),k.style.display="none",k=ie,{el:k,options:p}},A}var Ae=Pe();function Ne(A,k){if(A.picker)return A.picker.setOptions(k,!0);var p={type:"picker"};p.options={};var a=null,W=null,ae=function(N){return N instanceof Element||N instanceof HTMLDocument},ie=function(){W.innerHTML="";for(var N=Object.keys(p.options.data),Y=0;Y<N.length;Y++){var ee=document.createElement("div");ee.classList.add("jpicker-item"),ee.setAttribute("role","option"),ee.k=N[Y],ee.v=p.options.data[N[Y]];var ce=p.getLabel(N[Y],ee);ae(ce)?ee.appendChild(ce):ee.innerHTML=ce,W.appendChild(ee)}};p.setOptions=function(N,Y){var ee={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};N&&N.options&&(N.data=N.options);for(var ce in ee)N&&N.hasOwnProperty(ce)?p.options[ce]=N[ce]:(typeof p.options[ce]>"u"||Y===!0)&&(p.options[ce]=ee[ce]);return p.options.header===!1?a.style.display="none":a.style.display="",p.options.width?a.style.width=parseInt(p.options.width)+"px":a.style.width="",p.options.height?(W.style.maxHeight=p.options.height+"px",W.style.overflow="scroll"):W.style.overflow="",p.options.columns>0&&(p.options.grid?(W.classList.add("jpicker-grid"),W.style.gridTemplateColumns="repeat("+p.options.grid+", 1fr)"):(W.classList.add("jpicker-columns"),W.style.width=p.options.width?p.options.width:36*p.options.columns+"px")),isNaN(parseInt(p.options.value))&&(p.options.value=0),ie(),p.setValue(p.options.value),p},p.getValue=function(){return p.options.value},p.setValue=function(N,Y){if(p.setLabel(N),p.options.value=String(N),A.value!=p.options.value&&(A.value=p.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),W.children[N]&&W.children[N].getAttribute("type")!=="generic"&&p.close(),Y&&typeof p.options.onchange=="function"){var ee=p.options.data[N];p.options.onchange(A,p,ee,ee,N,Y)}},p.getLabel=function(N,Y){var ee=p.options.data[N]||null;return typeof p.options.render=="function"&&(ee=p.options.render(ee,Y)),ee},p.setLabel=function(N){var Y;p.options.content?Y='<i class="material-icons">'+p.options.content+"</i>":Y=p.getLabel(N,null),ae(Y)?(a.innerHTML="",a.appendChild(Y)):a.innerHTML=Y},p.open=function(){if(!A.classList.contains("jpicker-focus")){I(p,!0),A.classList.add("jpicker-focus"),A.focus();var N=0,Y=0;W.style.marginLeft="";var ee=a.getBoundingClientRect(),ce=W.getBoundingClientRect();window.innerHeight<ee.bottom+ce.height||p.options.bottom?N=-1*(ce.height+4):N=ee.height+4,p.options.right===!0&&(Y=-1*ce.width+ee.width),ce.left+Y<0&&(Y=Y+ce.left+10),ce.left+ce.width>window.innerWidth&&(Y=-1*(10+ce.left+ce.width-window.innerWidth)),W.style.marginTop=parseInt(N)+"px",W.style.marginLeft=parseInt(Y)+"px",typeof p.options.onopen=="function"&&p.options.onopen(A,p)}},p.close=function(){A.classList.contains("jpicker-focus")&&(A.classList.remove("jpicker-focus"),I(p,!1),typeof p.options.onclose=="function"&&p.options.onclose(A,p))};var V=function(){let N=s.guid();A.classList.add("jpicker"),A.setAttribute("role","combobox"),A.setAttribute("aria-haspopup","listbox"),A.setAttribute("aria-expanded","false"),A.setAttribute("aria-controls",N),A.setAttribute("tabindex","0"),A.onmousedown=function(Y){A.classList.contains("jpicker-focus")||p.open()},a=document.createElement("div"),a.classList.add("jpicker-header"),W=document.createElement("div"),W.setAttribute("id",N),W.setAttribute("role","listbox"),W.classList.add("jpicker-content"),W.onclick=function(Y){var ee=s.findElement(Y.target,"jpicker-item");ee&&ee.parentNode===W&&p.setValue(ee.k,Y)},A.appendChild(a),A.appendChild(W),A.value=k.value||0,p.setOptions(k),typeof p.options.onload=="function"&&p.options.onload(A,p),A.change=p.setValue,A.val=function(Y){if(Y===void 0)return p.getValue();p.setValue(Y)},A.picker=p};return V(),p}function Fe(A,k){var p={type:"toolbar"};p.options={};var a={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var W in a)k&&k.hasOwnProperty(W)?p.options[W]=k[W]:p.options[W]=a[W];!A&&k.app&&k.app.el&&(A=document.createElement("div"),k.app.el.appendChild(A));var ae=document.createElement("div");ae.classList.add("jtoolbar-item"),ae.classList.add("jtoolbar-arrow");var ie=document.createElement("div");ie.classList.add("jtoolbar-floating"),ae.appendChild(ie),p.selectItem=function(N){for(var Y=V.children,ee=0;ee<Y.length;ee++)N!=Y[ee]&&Y[ee].classList.remove("jtoolbar-selected");N.classList.add("jtoolbar-selected")},p.hide=function(){_.slideBottom(A,0,function(){A.style.display="none"})},p.show=function(){A.style.display="",_.slideBottom(A,1)},p.get=function(){return A},p.setBadge=function(N,Y){V.children[N].children[1].firstChild.innerHTML=Y},p.destroy=function(){toolbar.remove(),A.innerHTML=""},p.update=function(N,Y){for(var ee=0;ee<V.children.length;ee++){var ce=V.children[ee];typeof ce.updateState=="function"&&ce.updateState(A,p,ce,N,Y)}for(var ee=0;ee<ie.children.length;ee++){var ce=ie.children[ee];typeof ce.updateState=="function"&&ce.updateState(A,p,ce,N,Y)}},p.create=function(N){V.innerHTML="";for(var Y=0;Y<N.length;Y++){var ee=document.createElement("div");if(ee.classList.add("jtoolbar-item"),N[Y].width&&(ee.style.width=parseInt(N[Y].width)+"px"),N[Y].k&&(ee.k=N[Y].k),N[Y].tooltip&&(ee.setAttribute("title",N[Y].tooltip),ee.setAttribute("aria-label",N[Y].tooltip)),N[Y].id&&ee.setAttribute("id",N[Y].id),N[Y].updateState&&(ee.updateState=N[Y].updateState),N[Y].active&&ee.classList.add("jtoolbar-active"),N[Y].disabled&&ee.classList.add("jtoolbar-disabled"),N[Y].type=="select"||N[Y].type=="dropdown")Ne(ee,N[Y]);else if(N[Y].type=="divisor")ee.classList.add("jtoolbar-divisor");else if(N[Y].type=="label")ee.classList.add("jtoolbar-label"),ee.innerHTML=N[Y].content;else{var ce=document.createElement("i");if(typeof N[Y].class>"u")ce.classList.add("material-icons");else for(var Se=N[Y].class.split(" "),ve=0;ve<Se.length;ve++)ce.classList.add(Se[ve]);if(ce.innerHTML=N[Y].content?N[Y].content:"",ee.setAttribute("role","button"),ee.appendChild(ce),p.options.badge==!0){var xe=document.createElement("div");xe.classList.add("jbadge");var Re=document.createElement("div");Re.innerHTML=N[Y].badge?N[Y].badge:"",xe.appendChild(Re),ee.appendChild(xe)}if(N[Y].title)if(p.options.title==!0){var ze=document.createElement("span");ze.innerHTML=N[Y].title,ee.appendChild(ze)}else ee.setAttribute("title",N[Y].title);p.options.app&&N[Y].route&&(ee.route=N[Y].route,ee.onclick=function(){p.options.app.pages(this.route)},p.options.app.pages(N[Y].route,{toolbarItem:ee,closed:!0})),typeof N[Y].render=="function"&&N[Y].render(ee,N[Y])}N[Y].onclick&&(ee.onclick=N[Y].onclick.bind(N[Y],A,p,ee)),V.appendChild(ee)}setTimeout(function(){p.refresh()},0)},p.open=function(){ae.classList.add("jtoolbar-arrow-selected"),A.getBoundingClientRect();var N=ie.getBoundingClientRect();N.bottom>window.innerHeight||p.options.bottom?ie.style.bottom="0":ie.style.removeProperty("bottom"),ie.style.right="0",ae.children[0].focus(),I(p,!0)},p.close=function(){ae.classList.remove("jtoolbar-arrow-selected"),I(p,!1)},p.refresh=function(){if(p.options.responsive==!0){var N=A.parentNode.getBoundingClientRect();p.options.maxWidth||(p.options.maxWidth=N.width);var Y=parseInt(p.options.maxWidth);for(ae.parentNode&&ae.parentNode.removeChild(ae);ie.firstChild;)V.appendChild(ie.firstChild);if(Y<V.offsetWidth)for(Y-=50;V.lastChild&&Y<V.offsetWidth;)ie.insertBefore(V.lastChild,ie.firstChild);ie.children.length>0&&V.appendChild(ae)}},p.setReadonly=function(N){N=N?"add":"remove",A.classList[N]("jtoolbar-disabled")},A.onclick=function(N){var Y=s.findElement(N.target,"jtoolbar-item");Y&&p.selectItem(Y),N.target.classList.contains("jtoolbar-arrow")&&p.open()},window.addEventListener("resize",function(){p.refresh()}),A.classList.add("jtoolbar"),A.innerHTML="",p.options.container==!0&&A.classList.add("jtoolbar-container");var V=document.createElement("div");return A.appendChild(V),p.options.app&&A.classList.add("jtoolbar-mobile"),p.create(p.options.items),A.toolbar=p,p}function je(){var A=function(k,p){var a={type:"editor"};a.options={};var W={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var ae in W)p&&p.hasOwnProperty(ae)?a.options[ae]=p[ae]:a.options[ae]=W[ae];var ie=null,V=null,N=[];a.el=k,typeof a.options.onclick=="function"&&(k.onclick=function(le){a.options.onclick(k,a,le)}),k.classList.add("jeditor-container");var Y=document.createElement("div");Y.className="jsnippet",Y.setAttribute("contenteditable",!1);var ee=document.createElement("div");if(ee.className="jeditor-toolbar",a.editor=document.createElement("div"),a.editor.setAttribute("contenteditable",!0),a.editor.setAttribute("spellcheck",!1),a.editor.classList.add("jeditor"),a.options.placeholder&&a.editor.setAttribute("data-placeholder",a.options.placeholder),(a.options.maxHeight||a.options.height)&&(a.editor.style.overflowY="auto",a.options.maxHeight&&(a.editor.style.maxHeight=a.options.maxHeight),a.options.height&&(a.editor.style.height=a.options.height)),a.options.url)D({url:a.options.url,dataType:"html",success:function(le){a.editor.innerHTML=le,A.setCursor(a.editor,a.options.focus=="initial")}});else if(a.options.value)a.editor.innerHTML=a.options.value;else for(var ce=0;ce<k.children.length;ce++)a.editor.appendChild(k.children[ce]);k.innerHTML="";var Se=function(le){typeof a.options.onchange=="function"&&a.options.onchange(k,a,le),a.options.value=a.getData(),k.value!=a.options.value&&(k.value=a.options.value,typeof k.oninput=="function"&&k.oninput({type:"input",target:k,value:k.value}))},ve=function(le){var De=document.createElement("div");De.innerHTML=le;var Le=De.querySelectorAll("img");if(Le.length)for(var Xe=0;Xe<Le.length;Xe++)a.addImage(Le[Xe].src)},xe=function(){var le=null;if(le=Y.children[0]){le.classList.contains("jslider-grid")||le.classList.add("jslider-grid");var De=le.children.length;le.setAttribute("data-number",De>4?4:De),De>4?le.setAttribute("data-total",De-4):le.removeAttribute("data-total")}},Re=function(le){Y.innerHTML||a.appendSnippet({}),Y.children[0].appendChild(le),xe()};a.appendSnippet=function(le){Y.innerHTML="";for(var De=["image","title","description","host","url"],Le=0;Le<De.length;Le++){var Xe=document.createElement("div");if(Xe.className="jsnippet-"+De[Le],Xe.setAttribute("data-k",De[Le]),Y.appendChild(Xe),le[De[Le]])if(De[Le]=="image"){Array.isArray(le.image)||(le.image=[le.image]);for(var ot=0;ot<le.image.length;ot++){var rt=document.createElement("img");rt.src=le.image[ot],Xe.appendChild(rt)}}else Xe.innerHTML=le[De[Le]]}a.editor.appendChild(document.createElement("br")),a.editor.appendChild(Y)},a.setData=function(le){typeof le=="object"?a.editor.innerHTML=le.content:a.editor.innerHTML=le,a.options.focus&&A.setCursor(a.editor,!0),N=[]},a.getFiles=function(){for(var le=a.editor.querySelectorAll(".jfile"),De=[],Le=0;Le<le.length;Le++)N[le[Le].src]&&De.push(N[le[Le].src]);return De},a.getText=function(){return a.editor.innerText},a.getData=function(le){if(le){var De={content:""};if(Y.innerHTML){De.snippet={};for(var Le=0;Le<Y.children.length;Le++){var Xe=Y.children[Le].getAttribute("data-k");if(Xe)if(Xe=="image"){De.snippet.image||(De.snippet.image=[]);for(var ot=0;ot<Y.children[Le].children.length;ot++)De.snippet.image.push(Y.children[Le].children[ot].getAttribute("src"))}else De.snippet[Xe]=Y.children[Le].innerHTML}}var rt=Object.keys(N);if(rt.length){De.files=[];for(var Le=0;Le<rt.length;Le++)De.files.push(N[rt[Le]])}var bt=document.createElement("div");bt.innerHTML=a.editor.innerHTML;var ue=bt.querySelector(".jsnippet");ue&&ue.remove();var Oe=bt.innerHTML;Oe=Oe.replace(/<br>/g,`
`),Oe=Oe.replace(/<\/div>/g,`</div>
`),Oe=Oe.replace(/<(?:.|\n)*?>/gm,""),De.content=Oe.trim(),Ve("getData",De)}else var De=a.editor.innerHTML;return De},a.reset=function(){a.editor.innerHTML="",Y.innerHTML="",N=[]},a.addPdf=function(le){if(le.result.substr(0,4)!="data")console.error("Invalid source");else{var De=document.createElement("canvas");De.width=60,De.height=60;var Le=new Image,Xe=De.getContext("2d");Xe.drawImage(Le,0,0,De.width,De.height),De.toBlob(function(ot){var rt=document.createElement("img");rt.src=window.URL.createObjectURL(ot),rt.title=le.name,rt.className="jfile pdf",N[rt.src]={file:rt.src,extension:"pdf",content:le.result},document.execCommand("insertHtml",!1,rt.outerHTML)})}},a.addImage=function(le,De){if(a.options.acceptImages)if(le||(le=""),le.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(le.substr(0,4)=="data"){var Le=le.split(";");Le=Le[0].split("/"),Le=Le[1]}else{var Le=le.substr(le.lastIndexOf(".")+1);le=a.options.remoteParser+le}var Xe=new Image;Xe.onload=function(){var rt=document.createElement("canvas");rt.width=Xe.width,rt.height=Xe.height;var bt=rt.getContext("2d");bt.drawImage(Xe,0,0,rt.width,rt.height),rt.toBlob(function(ue){var Oe=document.createElement("img");Oe.src=window.URL.createObjectURL(ue),Oe.classList.add("jfile"),Oe.setAttribute("tabindex","900"),Oe.setAttribute("width",Xe.width),Oe.setAttribute("height",Xe.height),N[Oe.src]={file:Oe.src,extension:Le,content:rt.toDataURL()},a.options.dropAsSnippet||De?(Re(Oe),N[Oe.src].snippet=!0):document.execCommand("insertHtml",!1,Oe.outerHTML),Se()})},Xe.src=le}},a.addFile=function(le){for(var De=[],Le=0;Le<le.length;Le++)if(le[Le].size>a.options.maxFileSize)alert("The file is too big");else{var Xe=le[Le].type.split("/");Xe[0]=="image"?Xe=1:Xe[1]=="pdf"?Xe=2:Xe=0,Xe?(De[Le]=new FileReader,De[Le].index=Le,De[Le].type=Xe,De[Le].name=le[Le].name,De[Le].date=le[Le].lastModified,De[Le].size=le[Le].size,De[Le].addEventListener("load",function(ot){ot.target.type==2?a.options.acceptFiles==!0&&a.addPdf(ot.target):a.addImage(ot.target.result)},!1),De[Le].readAsDataURL(le[Le])):alert("The extension is not allowed")}},a.destroy=function(){a.editor.removeEventListener("mouseup",Te),a.editor.removeEventListener("mousedown",qe),a.editor.removeEventListener("mousemove",Ie),a.editor.removeEventListener("keyup",J),a.editor.removeEventListener("keydown",he),a.editor.removeEventListener("dragstart",U),a.editor.removeEventListener("dragenter",X),a.editor.removeEventListener("dragover",C),a.editor.removeEventListener("drop",q),a.editor.removeEventListener("paste",be),a.editor.removeEventListener("blur",G),a.editor.removeEventListener("focus",ge),k.editor=null,k.classList.remove("jeditor-container"),ee.remove(),Y.remove(),a.editor.remove()},a.upload=function(){s.click(a.file)};const ze=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],$e=["width","height","align","border","src","tabindex"],Je=["color","font-weight","font-size","background","background-color","margin"],nt=function(le){if(le.tagName&&ze.indexOf(le.tagName.toLowerCase())===-1&&le.innerText&&(le.innerHTML=le.innerText),le.attributes&&le.attributes.length){let De=null,Le=le.getAttribute("style");if(Le){De=[];let ot=Le.split(";");for(let rt=0;rt<ot.length;rt++){let bt=ot[rt].trim().split(":");if(Je.indexOf(bt[0].trim())>=0){let ue=bt.shift();bt=bt.join(":"),De.push(ue+":"+bt)}}}le.tagName.toUpperCase()==="IMG"&&(!a.options.acceptImages||!le.src?le.parentNode.removeChild(le):(le.setAttribute("tabindex","900"),a.addImage(le.src)));let Xe=[];for(let ot=0;ot<le.attributes.length;ot++)Xe.push(le.attributes[ot].name);Xe.length&&Xe.forEach(function(ot){$e.indexOf(ot)===-1?le.removeAttribute(ot):le.attributes&&le.attributes[ce]&&le.attributes[ce].value.indexOf("<")!==-1&&le.attributes[ce].value.replace("<","&#60;")}),le.style="",De&&De.length&&le.setAttribute("style",De.join(";"))}if(le.children.length)for(let De=le.children.length;De>0;De--)nt(le.children[De-1])};var re=function(le){var De=window.getSelection(),Le=document.createRange();Le.selectNode(le),De.addRange(Le)},ne=function(le){le&&(le=le.replace(new RegExp("<!--(.*?)-->","gsi"),""));var De=new DOMParser,Le=De.parseFromString(le,"text/html");nt(Le);var Xe=document.createElement("div");return Xe.innerHTML=Le.firstChild.innerHTML,Xe},be=function(le){if(a.options.filterPaste==!0){if(le.clipboardData||le.originalEvent.clipboardData)var De=(le.originalEvent||le).clipboardData.getData("text/html"),Le=(le.originalEvent||le).clipboardData.getData("text/plain"),Xe=(le.originalEvent||le).clipboardData.files;else if(window.clipboardData)var De=window.clipboardData.getData("Html"),Le=window.clipboardData.getData("Text"),Xe=window.clipboardData.files;if(Xe.length)a.addFile(Xe);else if(!De)De=Le.split(`\r
`),le.target.innerText?(De=De.map(function(rt){return"<div>"+rt+"</div>"}),document.execCommand("insertText",!1,De.join(""))):De.map(function(rt){var bt=document.createElement("div");bt.innerText=rt,a.editor.appendChild(bt)});else{var ot=ne(De);document.execCommand("insertHtml",!1,ot.innerHTML)}le.preventDefault()}},U=function(le){V&&V.e&&le.preventDefault()},X=function(le){V||a.options.dropZone==!1||(k.classList.add("jeditor-dragging"),le.preventDefault())},C=function(le){V||a.options.dropZone==!1||(ie&&clearTimeout(ie),ie=setTimeout(function(){k.classList.remove("jeditor-dragging")},100),le.preventDefault())},q=function(le){if(!(V||a.options.dropZone==!1)){var De=null;document.caretRangeFromPoint?De=document.caretRangeFromPoint(le.clientX,le.clientY):le.rangeParent&&(De=document.createRange(),De.setStart(le.rangeParent,le.rangeOffset));var Le=window.getSelection();Le.removeAllRanges(),Le.addRange(De),Le.anchorNode.parentNode.focus();var Xe=(le.originalEvent||le).dataTransfer.getData("text/html"),ot=(le.originalEvent||le).dataTransfer.getData("text/plain"),rt=(le.originalEvent||le).dataTransfer.files;rt.length?a.addFile(rt):ot&&ve(Xe),k.classList.remove("jeditor-dragging"),le.preventDefault()}},G=function(le){Ve("onevent",le),Se(le),typeof a.options.onblur=="function"&&a.options.onblur(k,a,le)},ge=function(le){typeof a.options.onfocus=="function"&&a.options.onfocus(k,a,le)},J=function(le){a.editor.innerHTML||(a.editor.innerHTML="<div><br></div>"),typeof a.options.onkeyup=="function"&&a.options.onkeyup(k,a,le)},he=function(le){if(Ve("onevent",le),le.key=="Delete"&&le.target.tagName=="IMG"){var De=le.target.parentNode;re(le.target),De.classList.contains("jsnippet-image")&&xe()}typeof a.options.onkeydown=="function"&&a.options.onkeydown(k,a,le)},Te=function(le){if(V&&V.e&&(V.e.classList.remove("resizing"),V.e.changed==!0)){var De=V.e.cloneNode();De.width=parseInt(V.e.style.width)||V.e.getAttribute("width"),De.height=parseInt(V.e.style.height)||V.e.getAttribute("height"),V.e.style.width="",V.e.style.height="",re(V.e),document.execCommand("insertHtml",!1,De.outerHTML)}V=!1},qe=function(le){var De=function(rt){var bt=rt.getBoundingClientRect();bt.width-(le.clientX-bt.left)<40&&le.clientY-bt.top<40&&(rt.innerHTML="",rt.remove())};if(le.target.tagName=="IMG")if(le.target.style.cursor){var Le=le.target.getBoundingClientRect();V={e:le.target,x:le.clientX,y:le.clientY,w:Le.width,h:Le.height,d:le.target.style.cursor},le.target.getAttribute("width")||le.target.setAttribute("width",Le.width),le.target.getAttribute("height")||le.target.setAttribute("height",Le.height);var Xe=window.getSelection();if(Xe.rangeCount)for(var ot=0;ot<Xe.rangeCount;ot++)Xe.removeRange(Xe.getRangeAt(ot));le.target.classList.add("resizing")}else V=!0;else le.target.classList.contains("jsnippet")?De(le.target):le.target.parentNode.classList.contains("jsnippet")&&De(le.target.parentNode),V=!0},Ie=function(le){if(le.target.tagName=="IMG"&&!le.target.parentNode.classList.contains("jsnippet-image")&&a.options.allowImageResize==!0&&le.target.getAttribute("tabindex")){var De=le.target.getBoundingClientRect();le.clientY-De.top<5?De.width-(le.clientX-De.left)<5?le.target.style.cursor="ne-resize":le.clientX-De.left<5?le.target.style.cursor="nw-resize":le.target.style.cursor="n-resize":De.height-(le.clientY-De.top)<5?De.width-(le.clientX-De.left)<5?le.target.style.cursor="se-resize":le.clientX-De.left<5?le.target.style.cursor="sw-resize":le.target.style.cursor="s-resize":De.width-(le.clientX-De.left)<5?le.target.style.cursor="e-resize":le.clientX-De.left<5?le.target.style.cursor="w-resize":le.target.style.cursor=""}if(le.which==1&&V&&V.d){if(V.d=="e-resize"||V.d=="ne-resize"||V.d=="se-resize")if(V.e.style.width=V.w+(le.clientX-V.x),le.shiftKey){var Le=(le.clientX-V.x)*(V.h/V.w);V.e.style.height=V.h+Le}else var Le=null;Le||(V.d=="s-resize"||V.d=="se-resize"||V.d=="sw-resize")&&(le.shiftKey||(V.e.style.height=V.h+(le.clientY-V.y))),V.e.changed=!0}},Ve=function(le,De){if(a.options.extensions){var Le=Object.keys(a.options.extensions);if(Le.length)for(var Xe=0;Xe<Le.length;Xe++)a.options.extensions[Le[Xe]]&&typeof a.options.extensions[Le[Xe]][le]=="function"&&a.options.extensions[Le[Xe]][le].call(a,De)}},Ue=function(){if(a.options.extensions){var le=Object.keys(a.options.extensions);if(le.length)for(var De=0;De<le.length;De++)a.options.extensions[le[De]]&&typeof a.options.extensions[le[De]]=="function"&&(a.options.extensions[le[De]]=a.options.extensions[le[De]](k,a))}};if(document.addEventListener("mouseup",Te),document.addEventListener("mousemove",Ie),a.editor.addEventListener("mousedown",qe),a.editor.addEventListener("keyup",J),a.editor.addEventListener("keydown",he),a.editor.addEventListener("dragstart",U),a.editor.addEventListener("dragenter",X),a.editor.addEventListener("dragover",C),a.editor.addEventListener("drop",q),a.editor.addEventListener("paste",be),a.editor.addEventListener("focus",ge),a.editor.addEventListener("blur",G),k.appendChild(a.editor),a.options.snippet&&a.appendSnippet(a.options.snippet),a.options.toolbar){if(Array.isArray(a.options.toolbar))var tt={container:!0,responsive:!0,items:a.options.toolbar};else if(a.options.toolbar===!0)var tt={container:!0,responsive:!0,items:[]};else var tt=a.options.toolbar;tt.items&&tt.items.length||(tt.items=A.getDefaultToolbar(a)),a.options.toolbarOnTop?(k.classList.add("toolbar-on-top"),k.insertBefore(ee,k.firstChild)):(a.editor.style.padding="15px",k.appendChild(ee)),Fe(ee,tt),ee.addEventListener("click",function(){a.editor.focus()})}return a.file=document.createElement("input"),a.file.style.display="none",a.file.type="file",a.file.setAttribute("accept","image/*"),a.file.onchange=function(){a.addFile(this.files)},k.appendChild(a.file),a.options.focus&&A.setCursor(a.editor,a.options.focus=="initial"),k.change=a.setData,k.val=function(le){if(le===void 0){var De=k.getAttribute("data-html")!=="true";return a.getData(De)}else a.setData(le)},Ue(),k.editor=a,typeof a.options.onload=="function"&&a.options.onload(k,a,a.editor),a};return A.setCursor=function(k,p){k.focus(),document.execCommand("selectAll");var a=window.getSelection(),W=a.getRangeAt(0);if(p==!0)var ae=W.startContainer,ie=0;else var ae=W.endContainer,ie=ae.length;W.setStart(ae,ie),W.setEnd(ae,ie),a.removeAllRanges(),a.addRange(W)},A.getDefaultToolbar=function(k){var p=function(W,ae,ie){ie.color||(fe(ie,{onchange:function(V,N){ie.k==="color"?document.execCommand("foreColor",!1,N):document.execCommand("backColor",!1,N)}}),ie.color.open())},a=[];return a.push({content:"undo",onclick:function(){document.execCommand("undo")}}),a.push({content:"redo",onclick:function(){document.execCommand("redo")}}),a.push({type:"divisor"}),k.options.toolbarOnTop&&(a.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(W){return'<span style="font-family:'+W+'">'+W+"</span>"},onchange:function(W,ae,ie,V,N){document.execCommand("fontName",!1,V)}}),a.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(W){return'<span style="font-size:'+W+'">'+W+"</span>"},onchange:function(W,ae,ie,V,N){document.execCommand("fontSize",!1,parseInt(N)+1)}}),a.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(W){return'<i class="material-icons">'+W+"</i>"},onchange:function(W,ae,ie,V,N){var Y=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(Y[N])}}),a.push({type:"divisor"}),a.push({content:"format_color_text",k:"color",onclick:p}),a.push({content:"format_color_fill",k:"background-color",onclick:p})),a.push({content:"format_bold",onclick:function(W,ae,ie){document.execCommand("bold"),document.queryCommandState("bold")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({content:"format_italic",onclick:function(W,ae,ie){document.execCommand("italic"),document.queryCommandState("italic")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({content:"format_underline",onclick:function(W,ae,ie){document.execCommand("underline"),document.queryCommandState("underline")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({type:"divisor"}),a.push({content:"format_list_bulleted",onclick:function(W,ae,ie){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({content:"format_list_numbered",onclick:function(W,ae,ie){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({content:"format_indent_increase",onclick:function(W,ae,ie){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ie.classList.add("selected"):ie.classList.remove("selected")}}),a.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),k.options.toolbarOnTop&&(a.push({type:"divisor"}),a.push({content:"photo",onclick:function(){k.upload()}}),a.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(W,ae){ae&&(ae.onmouseover=this.onmouseover,W=W.split("x"),ae.setAttribute("data-x",W[0]),ae.setAttribute("data-y",W[1]));var ie=document.createElement("div");return ae.style.margin="1px",ae.style.border="1px solid #ddd",ie},onmouseover:function(W){for(var ae=parseInt(W.target.getAttribute("data-x")),ie=parseInt(W.target.getAttribute("data-y")),V=0;V<W.target.parentNode.children.length;V++){var N=W.target.parentNode.children[V],Y=parseInt(N.getAttribute("data-x")),ee=parseInt(N.getAttribute("data-y"));Y<=ae&&ee<=ie?(N.style.backgroundColor="#cae1fc",N.style.borderColor="#2977ff"):(N.style.backgroundColor="",N.style.borderColor="#ddd")}},onchange:function(W,ae,ie){ie=ie.split("x");for(var V=document.createElement("table"),N=document.createElement("tbody"),Y=0;Y<=ie[1];Y++){for(var ee=document.createElement("tr"),ce=0;ce<=ie[0];ce++){var Se=document.createElement("td");Se.innerHTML="",ee.appendChild(Se)}N.appendChild(ee)}V.appendChild(N),V.setAttribute("width","100%"),V.setAttribute("cellpadding","6"),V.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,V.outerHTML)}})),a},A}var P=je();function Ce(){var A=function(k,p){var a={};a.options={};var W={type:"big",title:"Untitled",width:510,height:472};for(var ae in W)p&&p.hasOwnProperty(ae)?a.options[ae]=p[ae]:a.options[ae]=W[ae];var ie=function(){for(var Y=document.createElement("div");k.children[0];)Y.appendChild(k.children[0]);for(a.content=document.createElement("div"),a.content.className="jfloating_content",a.content.innerHTML=k.innerHTML;Y.children[0];)a.content.appendChild(Y.children[0]);a.container=document.createElement("div"),a.container.className="jfloating",a.container.appendChild(a.content),a.options.title?a.container.setAttribute("title",a.options.title):a.container.classList.add("no-title"),a.options.width&&(a.container.style.width=parseInt(a.options.width)+"px"),a.options.height&&(a.container.style.height=parseInt(a.options.height)+"px"),k.innerHTML="",k.appendChild(a.container)},V=function(){a.container&&a.container.addEventListener("click",function(Y){var ee=Y.target.getBoundingClientRect();if(Y.target.classList.contains("jfloating")){if(Y.changedTouches&&Y.changedTouches[0])var ce=Y.changedTouches[0].clientX,Se=Y.changedTouches[0].clientY;else var ce=Y.clientX,Se=Y.clientY;ee.width-(ce-ee.left)<50&&Se-ee.top<50?setTimeout(function(){a.close()},100):a.setState()}})},N=function(){a.container.classList.add("jfloating-"+a.options.type)};return a.state={isMinized:!1},a.setState=function(){a.state.isMinized?a.container.classList.remove("jfloating-minimized"):a.container.classList.add("jfloating-minimized"),a.state.isMinized=!a.state.isMinized},a.close=function(){Components.elements.splice(A.elements.indexOf(a.container),1),a.updatePosition(),k.remove()},a.updatePosition=function(){for(var Y=0;Y<A.elements.length;Y++){var ee=A.elements[Y],ce=A.elements[Y-1];ee.style.right=Y*(ce?ce.offsetWidth:ee.offsetWidth)*1.01+"px"}},a.init=function(){ie(),V(),N(),A.elements.push(a.container),a.updatePosition(),k.floating=a},a.init(),a};return A.elements=[],A}var Be=Ce();function et(){const A=function(V){return!isNaN(V)&&V!==null&&(typeof V!="string"||V.trim()!=="")},k={between:function(V,N){return V>=N[0]&&V<=N[1]},"not between":function(V,N){return V<N[0]||V>N[1]},"<":function(V,N){return V<N[0]},"<=":function(V,N){return V<=N[0]},">":function(V,N){return V>N[0]},">=":function(V,N){return V>=N[0]},"=":function(V,N){return V==N[0]},"!=":function(V,N){return V!=N[0]}},p={"valid date":function(){return!0},"=":function(V,N){return V===N[0]},"!=":function(V,N){return V!==N[0]},"<":function(V,N){return V<N[0]},"<=":function(V,N){return V<=N[0]},">":function(V,N){return V>N[0]},">=":function(V,N){return V>=N[0]},between:function(V,N){return V>=N[0]&&V<=N[1]},"not between":function(V,N){return V<N[0]||V>N[1]}},a={contains:function(V,N){return V.includes(N[0])},"not contains":function(V,N){return!V.includes(N[0])},"begins with":function(V,N){return V.startsWith(N[0])},"ends with":function(V,N){return V.endsWith(N[0])},"=":function(V,N){return V===N[0]},"!=":function(V,N){return V!==N[0]},"valid email":function(V){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return N.test(V)},"valid url":function(V){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return N.test(V)}},W=function(V,N){return typeof W[N.type]=="function"?N.allowBlank&&(typeof V>"u"||V===""||V===null)?!0:W[N.type].call(this,V,N):null};W.url=function(V){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!N.test(V)},W.email=function(V){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(V&&N.test(V))},W.required=function(V){return!!(V&&V.trim())},W.empty=function(V){return typeof V>"u"||V===null||typeof V=="string"&&!V.toString().trim()},W["not exist"]=W.empty,W.notEmpty=function(V){return!W.empty(V)},W.exist=W.notEmpty,W.number=function(V,N){if(!A(V))return!1;if(!N||!N.criteria)return!0;if(!k[N.criteria])return!1;let Y=N.value.map(function(ee){return parseFloat(ee)});return k[N.criteria](V,Y)},W.login=function(V){let N=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(V&&N.test(V))},W.list=function(V,N){let Y=typeof V;if(Y!=="string"&&Y!=="number")return!1;let ee;return typeof N.value[0]=="string"?N.source?ee=N.source:ee=N.value[0].split(","):ee=N.value[0],Array.isArray(ee)?ee.findIndex(function(Se){return Se==V})>-1:!1};const ae=function(){let V=new Date;return V.setHours(0,0,0,0),V},ie={"one year ago":function(){let V=ae();return V.setFullYear(V.getFullYear()-1),V},"one month ago":function(){let V=ae();return V.setMonth(V.getMonth()-1),V},"one week ago":function(){let V=ae();return V.setDate(V.getDate()-7),V},yesterday:function(){let V=ae();return V.setDate(V.getDate()-1),V},today:ae,tomorrow:function(){let V=ae();return V.setDate(V.getDate()+1),V}};return W.date=function(V,N){if(A(V)&&V>0&&V<1e6&&(V=M.numToDate(V)),new Date(V)=="Invalid Date")return!1;if(!N||!N.criteria)return!0;if(!p[N.criteria])return!1;let Y=N.value.map(function(ee){return typeof ee=="string"&&ie[ee]?ie[ee]().getTime():new Date(ee).getTime()});return p[N.criteria](new Date(V).getTime(),Y)},W.text=function(V,N){if(typeof V>"u"||V===null)V="";else if(typeof V!="string")return!1;return!N||!N.criteria?!0:a[N.criteria]?a[N.criteria](V,N.value):!1},W.textLength=function(V,N){let Y;return typeof V=="string"?Y=V.length:typeof V<"u"&&V!==null&&typeof V.toString=="function"?Y=V.toString().length:Y=0,W.number(Y,N)},W}var Me=et();function ye(){var A=function(k,p){var a={};a.options={};var W={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(N,Y){alert(Y)}};for(var ae in W)p&&p.hasOwnProperty(ae)?a.options[ae]=p[ae]:a.options[ae]=W[ae];a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=k.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=Me.email),a.options.validations.length||(a.options.validations.length=Me.length),a.options.validations.required||(a.options.validations.required=Me.required),a.setUrl=function(N){a.options.url=N},a.load=function(){D({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(N){if(typeof a.options.onbeforeload=="function"){var Y=a.options.onbeforeload(k,N);Y&&(N=Y)}A.setElements(k,N),typeof a.options.onload=="function"&&a.options.onload(k,N)}})},a.save=function(){var N=a.validate();if(N)a.options.onerror(k,N);else{var Y=A.getElements(k,!0);if(typeof a.options.onbeforesave=="function"){var Y=a.options.onbeforesave(k,Y);if(Y===!1)return}D({url:a.options.url,method:"POST",dataType:"json",data:Y,success:function(ee){typeof a.options.onsave=="function"&&a.options.onsave(k,Y,ee)}})}},a.remove=function(){if(typeof a.options.onbeforeremove=="function"){var N=a.options.onbeforeremove(k,a);if(N===!1)return!1}D({url:a.options.url,method:"DELETE",dataType:"json",success:function(Y){typeof a.options.onremove=="function"&&a.options.onremove(k,a,Y),a.reset()}})};var ie=function(N){N.classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0);var Y=N.getAttribute("data-error")||"There is an error in the form";return N.setAttribute("title",Y),Y},V=function(N){var Y=!1;N.classList.remove("error"),N.removeAttribute("title");for(var ee=k.querySelectorAll("input, select, textarea, div[name]"),ce=0;ce<ee.length;ce++)ee[ce].getAttribute("data-validation")&&ee[ce].classList.contains("error")&&(Y=!0);a.options.submitButton&&(Y?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))};return a.validateElement=function(N){var Y=!1,ee=A.getValue(N),ce=N.getAttribute("data-validation");return typeof a.options.validations[ce]=="function"&&!a.options.validations[ce](ee,N)?Y=ie(N):N.classList.contains("error")&&V(N),Y},a.reset=function(){for(var N=k.querySelectorAll("input, select, textarea, div[name]"),Y=0;Y<N.length;Y++)N[Y].getAttribute("name")&&(N[Y].type=="checkbox"||N[Y].type=="radio"?N[Y].checked=!1:typeof N[Y].val=="function"?N[Y].val(""):N[Y].value="")},a.validate=function(){for(var N=[],Y=k.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Y.length;ee++)if(Y[ee].getAttribute("data-validation")){var ce=a.validateElement(Y[ee]);ce&&N.push(ce)}return N.length>0?N.join("<br>"):!1},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(A.getElements(k))},a.getHash=function(N){var Y=0,ee,ce;if(N.length===0)return Y;for(ee=0;ee<N.length;ee++)ce=N.charCodeAt(ee),Y=(Y<<5)-Y+ce,Y|=0;return Y},a.isChanged=function(){var N=a.setHash();return a.options.currentHash!=N},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(N){a.options.ignore=!!N},setTimeout(function(){a.options.currentHash=a.setHash()},1e3),k.addEventListener("keyup",function(N){N.target.getAttribute("data-validation")&&a.validateElement(N.target)}),A.hasEvents||(window.addEventListener("beforeunload",function(N){if(a.isChanged()&&a.options.ignore==!1){var Y=a.options.message?a.options.message:"o/";return Y?(typeof N>"u"&&(N=window.event),N&&(N.returnValue=Y),Y):void 0}}),A.hasEvents=!0),k.form=a,a};return A.getValue=function(k){var p=null;if(k.type=="checkbox")k.checked==!0&&(p=k.value||!0);else if(k.type=="radio")k.checked==!0&&(p=k.value);else if(k.type=="file")p=k.files;else if(k.tagName=="select"&&k.multiple==!0){p=[];for(var a=k.querySelectorAll("options[selected]"),W=0;W<a.length;W++)p.push(a[W].value)}else typeof k.val=="function"?p=k.val():p=k.value||"";return p},A.getElements=function(k,p){for(var a={},W=null,ae=k.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<ae.length;ie++)(W=ae[ie].getAttribute("name"))&&(a[W]=A.getValue(ae[ie])||"");return p==!0?a:JSON.stringify(a)},A.setElements=function(k,p){for(var a=null,W=null,ae=k.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<ae.length;ie++){var V=ae[ie].getAttribute("type");if(a=ae[ie].getAttribute("name")){if(a=a.replace(new RegExp(/\[(.*?)\]/ig),".$1"),W=null,a.match(/\./)){var N=v.call(p,a)||"";typeof N<"u"&&(W=N)}else typeof p[a]<"u"&&(W=p[a]);W!==null&&(V=="checkbox"||V=="radio"?ae[ie].checked=!!W:V=="file"||(typeof ae[ie].val=="function"?ae[ie].val(W):ae[ie].value=W))}}},A}var ke=ye();function Ee(){var A=function(){var p=null,a=function(V){if(V.which==27)for(var N=document.querySelectorAll(".jmodal"),Y=0;Y<N.length;Y++)N[Y].parentNode.modal.close()},W=function(V){let N=V.composedPath();var Y=s.findElement(N[0],"jmodal");if(Y){var ee=Y.getBoundingClientRect();if(V.changedTouches&&V.changedTouches[0])var ce=V.changedTouches[0].clientX,Se=V.changedTouches[0].clientY;else var ce=V.clientX,Se=V.clientY;ee.width-(ce-ee.left)<50&&Se-ee.top<50&&Y.parentNode.modal.close()}p&&(p.element.style.cursor="auto",p=null)},ae=function(V){let N=V.composedPath();var Y=s.findElement(N[0],"jmodal");if(Y){var ee=Y.getBoundingClientRect();if(V.changedTouches&&V.changedTouches[0])var ce=V.changedTouches[0].clientX,Se=V.changedTouches[0].clientY;else var ce=V.clientX,Se=V.clientY;ee.width-(ce-ee.left)<50&&Se-ee.top<50||Se-ee.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),p={left:ee.left,top:ee.top,x:V.clientX,y:V.clientY,width:ee.width,height:ee.height,element:Y})}},ie=function(V){if(p){if(V=V||window.event,V.buttons)var N=V.buttons;else if(V.button)var N=V.button;else var N=V.which;N?(p.element.style.top=p.top+(V.clientY-p.y)+p.height/2+"px",p.element.style.left=p.left+(V.clientX-p.x)+p.width/2+"px",p.element.style.cursor="move"):p.element.style.cursor="auto"}};document.addEventListener("keydown",a),document.addEventListener("mouseup",W),document.addEventListener("mousedown",ae),document.addEventListener("mousemove",ie)},k=function(p,a){var W={};W.options={};var ae={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ie in ae)a&&a.hasOwnProperty(ie)?W.options[ie]=a[ie]:W.options[ie]=ae[ie];!W.options.title&&p.getAttribute("title")&&(W.options.title=p.getAttribute("title"));for(var V=document.createElement("div");p.children[0];)V.appendChild(p.children[0]);for(W.title=document.createElement("div"),W.title.className="jmodal_title",W.options.icon&&W.title.setAttribute("data-icon",W.options.icon),W.content=document.createElement("div"),W.content.className="jmodal_content",W.content.innerHTML=p.innerHTML;V.children[0];)W.content.appendChild(V.children[0]);if(W.container=document.createElement("div"),W.container.className="jmodal",W.container.appendChild(W.title),W.container.appendChild(W.content),W.options.padding&&(W.content.style.padding=W.options.padding),W.options.width&&(W.container.style.width=W.options.width),W.options.height&&(W.container.style.height=W.options.height),W.options.title){var N=document.createElement("h4");N.innerText=W.options.title,W.title.appendChild(N)}if(p.innerHTML="",p.style.display="none",p.appendChild(W.container),W.options.backdrop){var Y=document.createElement("div");Y.className="jmodal_backdrop",Y.onclick=function(){W.close()},p.appendChild(Y)}return W.open=function(){p.style.display="block";var ee=W.container.getBoundingClientRect();s.getWindowWidth()<ee.width?(W.container.style.top="",W.container.style.left="",W.container.classList.add("jmodal_fullscreen"),_.slideBottom(W.container,1)):W.options.backdrop&&(Y.style.display="block"),typeof W.options.onopen=="function"&&W.options.onopen(p,W)},W.resetPosition=function(){W.container.style.top="",W.container.style.left=""},W.isOpen=function(){return p.style.display!="none"},W.close=function(){W.isOpen()&&(p.style.display="none",W.options.backdrop&&(Y.style.display=""),W.container.classList.remove("jmodal_fullscreen"),typeof W.options.onclose=="function"&&W.options.onclose(p,W))},W.options.url?D({url:W.options.url,method:"GET",dataType:"text/html",success:function(ee){W.content.innerHTML=ee,W.options.closed||W.open(),typeof W.options.onload=="function"&&W.options.onload(W)}}):(W.options.closed||W.open(),typeof W.options.onload=="function"&&W.options.onload(W)),p.modal=W,A(),A=function(){},W};return k}var Ye=Ee();function Ge(){var A=function(k){var p={};p.options={};var a={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var W in a)k&&k.hasOwnProperty(W)?p.options[W]=k[W]:p.options[W]=a[W];var ae=document.createElement("div");ae.className="jnotification",p.options.error&&ae.classList.add("jnotification-error");var ie=document.createElement("div");ie.className="jnotification-container",ae.appendChild(ie);var V=document.createElement("div");V.className="jnotification-header",ie.appendChild(V);var N=document.createElement("div");if(N.className="jnotification-image",V.appendChild(N),p.options.icon){var Y=document.createElement("img");Y.src=p.options.icon,N.appendChild(Y)}var ee=document.createElement("div");if(ee.className="jnotification-name",ee.innerHTML=p.options.name,V.appendChild(ee),p.options.closeable==!0){var ce=document.createElement("div");ce.className="jnotification-close",ce.onclick=function(){p.hide()},V.appendChild(ce)}var Se=document.createElement("div");Se.className="jnotification-date",V.appendChild(Se);var ve=document.createElement("div");if(ve.className="jnotification-content",ie.appendChild(ve),p.options.title){var xe=document.createElement("div");xe.className="jnotification-title",xe.innerHTML=p.options.title,ve.appendChild(xe)}var Re=document.createElement("div");if(Re.className="jnotification-message",Re.innerHTML=p.options.message,ve.appendChild(Re),p.show=function(){document.body.appendChild(ae),s.getWindowWidth()>800?_.fadeIn(ae):_.slideTop(ae,1)},p.hide=function(){s.getWindowWidth()>800?_.fadeOut(ae,function(){ae.parentNode&&(ae.parentNode.removeChild(ae),ze&&clearTimeout(ze))}):_.slideTop(ae,0,function(){ae.parentNode&&(ae.parentNode.removeChild(ae),ze&&clearTimeout(ze))})},p.show(),p.options.autoHide==!0)var ze=setTimeout(function(){p.hide()},p.options.timeout);return s.getWindowWidth()<800&&ae.addEventListener("swipeup",function($e){p.hide(),$e.preventDefault(),$e.stopPropagation()}),p};return A.isVisible=function(){var k=document.querySelector(".jnotification");return!!(k&&k.parentNode)},A}var lt=Ge();function at(A,k){var p={};p.options={};var a={value:0,onchange:null,width:null};for(var W in a)k&&k.hasOwnProperty(W)?p.options[W]=k[W]:p.options[W]=a[W];A.classList.add("jprogressbar"),A.setAttribute("tabindex",1),A.setAttribute("data-value",p.options.value);var ae=document.createElement("div");ae.style.width=p.options.value+"%",ae.style.color="#fff",A.appendChild(ae),p.options.width&&(A.style.width=p.options.width),p.setValue=function(V){V=parseInt(V),p.options.value=V,ae.style.width=V+"%",A.setAttribute("data-value",V+"%"),V<6?A.style.color="#000":A.style.color="#fff",p.options.value=V,typeof p.options.onchange=="function"&&p.options.onchange(A,V),A.value!=p.options.value&&(A.value=p.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},p.getValue=function(){return p.options.value};var ie=function(V){if(V.which){var N=A.getBoundingClientRect();if(V.changedTouches&&V.changedTouches[0]){var Y=V.changedTouches[0].clientX;V.changedTouches[0].clientY}else{var Y=V.clientX;V.clientY}p.setValue(Math.round((Y-N.left)/N.width*100))}};return"touchstart"in document.documentElement?(A.addEventListener("touchstart",ie),A.addEventListener("touchend",ie)):(A.addEventListener("mousedown",ie),A.addEventListener("mousemove",ie)),A.change=p.setValue,A.val=function(V){if(V===void 0)return p.getValue();p.setValue(V)},A.progressbar=p,p}function ft(A,k){if(A.rating)return A.rating.setOptions(k,!0);var p={};p.options={},p.setOptions=function(W,ae){var ie={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var V in ie)W&&W.hasOwnProperty(V)?p.options[V]=W[V]:(typeof p.options[V]>"u"||ae===!0)&&(p.options[V]=ie[V]);A.innerHTML="";for(var N=0;N<p.options.number;N++){var Y=document.createElement("div");Y.setAttribute("data-index",N+1),Y.setAttribute("title",p.options.tooltip[N]),A.appendChild(Y)}if(p.options.value)for(var N=0;N<p.options.number;N++)N<p.options.value&&A.children[N].classList.add("jrating-selected");return p},p.setValue=function(W){for(var ae=0;ae<p.options.number;ae++)ae<W?A.children[ae].classList.add("jrating-selected"):(A.children[ae].classList.remove("jrating-over"),A.children[ae].classList.remove("jrating-selected"));p.options.value=W,typeof p.options.onchange=="function"&&p.options.onchange(A,W),A.value!=p.options.value&&(A.value=p.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},p.getValue=function(){return p.options.value};var a=function(){p.setOptions(k),A.classList.add("jrating"),A.addEventListener("click",function(W){var ae=W.target.getAttribute("data-index");ae!=null&&(ae==p.options.value?p.setValue(0):p.setValue(ae))}),A.addEventListener("mouseover",function(W){for(var ae=W.target.getAttribute("data-index"),ie=0;ie<p.options.number;ie++)ie<ae?A.children[ie].classList.add("jrating-over"):A.children[ie].classList.remove("jrating-over")}),A.addEventListener("mouseout",function(W){for(var ae=0;ae<p.options.number;ae++)A.children[ae].classList.remove("jrating-over")}),A.change=p.setValue,A.val=function(W){if(W===void 0)return p.getValue();p.setValue(W)},A.rating=p};return a(),p}function vt(A,k){if(A.search)return A.search;var p=null,a=function(Y){if(Y.target.classList.contains("jsearch_item"))var ee=Y.target;else var ee=Y.target.parentNode;V.selectIndex(ee),Y.preventDefault()},W=function(Y){if(typeof V.options.onsearch=="function"){var ee=V.options.onsearch(V,Y);ee&&(Y=ee)}if(N.innerHTML="",!Y.length)A.style.display="";else{A.style.display="block";for(var ce=Y.length<11?Y.length:10,Se=0;Se<ce;Se++){if(typeof Y[Se]=="string")var ve=Y[Se],xe=Y[Se];else{var ve=Y[Se].text;!ve&&Y[Se].name&&(ve=Y[Se].name);var xe=Y[Se].value;!xe&&Y[Se].id&&(xe=Y[Se].id)}var Re=document.createElement("div");Re.setAttribute("data-value",xe),Re.setAttribute("data-text",ve),Re.className="jsearch_item",Y[Se].id&&Re.setAttribute("id",Y[Se].id),V.options.forceSelect&&Se==0&&Re.classList.add("selected");var ze=document.createElement("img");Y[Se].image?ze.src=Y[Se].image:ze.style.display="none",Re.appendChild(ze);var $e=document.createElement("div");$e.innerHTML=ve,Re.appendChild($e),N.appendChild(Re)}}},ae=function(Y){if(Y!=V.terms)if(V.terms=Y,V.options.forceSelect?p=0:p=null,Array.isArray(V.options.data)){var ee=function(Se){if(typeof Se=="string"){if((""+Se).toLowerCase().search(Y.toLowerCase())>=0)return!0}else for(var ve in Se){var xe=Se[ve];if((""+xe).toLowerCase().search(Y.toLowerCase())>=0)return!0}return!1},ce=V.options.data.filter(function(Se){return ee(Se)});W(ce)}else D({url:V.options.data+Y,method:"GET",dataType:"json",success:function(Se){W(Se)}})},ie=null,V=function(Y){ie&&clearTimeout(ie),ie=setTimeout(function(){ae(Y)},500)};k.forceSelect===null&&(k.forceSelect=!0),V.options={data:k.data||null,input:k.input||null,searchByNode:k.searchByNode||null,onselect:k.onselect||null,forceSelect:k.forceSelect,onsearch:k.onsearch||null,onbeforesearch:k.onbeforesearch||null},V.selectIndex=function(Y){var ee=Y.getAttribute("id"),ce=Y.getAttribute("data-text"),Se=Y.getAttribute("data-value"),ve=Y.children[0].src||"";typeof V.options.onselect=="function"&&V.options.onselect(V,ce,Se,ee,ve),V.close()},V.open=function(){A.style.display="block"},V.close=function(){ie&&clearTimeout(ie),V.terms="",N.innerHTML="",A.style.display=""},V.isOpened=function(){return!!A.style.display},V.keydown=function(Y){V.isOpened()&&(Y.key=="Enter"?p!==null&&N.children[p]?(V.selectIndex(N.children[p]),Y.preventDefault()):V.close():Y.key==="ArrowUp"?(p!==null&&N.children[0]&&(N.children[p].classList.remove("selected"),!V.options.forceSelect&&p===0?p=null:(p=Math.max(0,p-1),N.children[p].classList.add("selected"))),Y.preventDefault()):Y.key==="ArrowDown"&&(p==null?p=-1:N.children[p].classList.remove("selected"),p<9&&N.children[p+1]&&p++,N.children[p].classList.add("selected"),Y.preventDefault()))},V.keyup=function(Y){if(!V.options.searchByNode&&V.options.input)if(V.options.input.tagName==="DIV")var ee=V.options.input.innerText;else var ee=V.options.input.value;else{var ce=s.getNode();if(ce)var ee=ce.innerText}if(typeof V.options.onbeforesearch=="function"){var Se=V.options.onbeforesearch(V,ee);if(Se)ee=Se;else if(Se===!1)return}V(ee)},V.blur=function(Y){V.close()},V.options.input&&(V.options.input.addEventListener("keyup",V.keyup),V.options.input.addEventListener("keydown",V.keydown),V.options.input.addEventListener("blur",V.blur));var N=document.createElement("div");return N.classList.add("jsearch_container"),N.onmousedown=a,A.appendChild(N),A.classList.add("jsearch"),A.search=V,V}function jt(A,k){var p={};if(p.options={},p.currentImage=null,k&&(p.options=k),A.setAttribute("tabindex","900"),p.options.items=[],!A.classList.contains("jslider")){if(A.classList.add("jslider"),A.classList.add("unselectable"),p.options.height&&(A.style.minHeight=parseInt(p.options.height)+"px"),p.options.width&&(A.style.width=parseInt(p.options.width)+"px"),p.options.grid){A.classList.add("jslider-grid");var a=A.children.length;a>4&&A.setAttribute("data-total",a-4),A.setAttribute("data-number",a>4?4:a)}var W=document.createElement("div");if(W.classList.add("jslider-counter"),A.children.length>0)for(var ae=0;ae<A.children.length;ae++){p.options.items.push(A.children[ae]);var ie=document.createElement("div");ie.onclick=function(){var ce=Array.prototype.slice.call(W.children).indexOf(this);p.show(p.currentImage=p.options.items[ce])},W.appendChild(ie)}var V=document.createElement("div");V.className="jslider-caption";var N=document.createElement("div"),Y=document.createElement("div");Y.className="jslider-close",Y.innerHTML="",Y.onclick=function(){p.close()},N.appendChild(V),N.appendChild(Y)}p.updateCounter=function(ce){for(var Se=0;Se<W.children.length;Se++)if(W.children[Se].classList.contains("jslider-counter-focus")){W.children[Se].classList.remove("jslider-counter-focus");break}W.children[ce].classList.add("jslider-counter-focus")},p.show=function(ce){if(!ce)var ce=A.children[0];A.classList.add("jslider-focus"),A.classList.remove("jslider-grid"),A.appendChild(N),A.appendChild(W);var Se=p.options.items.indexOf(ce);p.updateCounter(Se);for(var ve=0;ve<A.children.length;ve++)A.children[ve].style.display="";ce.style.display="block",ce.previousElementSibling?A.classList.add("jslider-left"):A.classList.remove("jslider-left"),ce.nextElementSibling&&ce.nextElementSibling.tagName=="IMG"?A.classList.add("jslider-right"):A.classList.remove("jslider-right"),p.currentImage=ce,p.currentImage.offsetHeight>p.currentImage.offsetWidth&&p.currentImage.classList.add("jslider-vertical"),N.children[0].innerText=p.currentImage.getAttribute("title")},p.open=function(){p.show(),typeof p.options.onopen=="function"&&p.options.onopen(A)},p.close=function(){A.classList.remove("jslider-focus"),A.classList.remove("jslider-left"),A.classList.remove("jslider-right"),p.options.grid&&A.classList.add("jslider-grid");for(var ce=0;ce<A.children.length;ce++)A.children[ce].style.display="";W.remove(),N.remove(),p.currentImage=null,typeof p.options.onclose=="function"&&p.options.onclose(A)},p.reset=function(){A.innerHTML=""},p.next=function(){var ce=p.currentImage.nextElementSibling;ce&&ce.tagName==="IMG"&&p.show(p.currentImage.nextElementSibling)},p.prev=function(){p.currentImage.previousElementSibling&&p.show(p.currentImage.previousElementSibling)};var ee=function(ce){if(ce.target.tagName=="IMG")p.show(ce.target);else if(!ce.target.classList.contains("jslider-close")&&!(ce.target.parentNode.classList.contains("jslider-counter")||ce.target.classList.contains("jslider-counter"))){var Se=ce.offsetX||ce.changedTouches[0].clientX;ce.target.clientWidth-Se<40?p.next():Se<40&&p.prev()}};return"ontouchend"in document.documentElement?A.addEventListener("touchend",ee):A.addEventListener("mouseup",ee),A.addEventListener("swipeleft",function(ce){p.next(),ce.preventDefault(),ce.stopPropagation()}),A.addEventListener("swiperight",function(ce){p.prev(),ce.preventDefault(),ce.stopPropagation()}),A.addEventListener("keydown",function(ce){ce.which==27&&p.close()}),A.slider=p,p}function Tt(A,k){if(A.tags)return A.tags.setOptions(k,!0);var p={type:"tags"};p.options={};var a=function(){return!!(p.options.limit&&A.children.length>=p.options.limit)},W=null,ae=null;p.setOptions=function(re,ne){var be={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var U in be)re&&re.hasOwnProperty(U)?p.options[U]=re[U]:(typeof p.options[U]>"u"||ne===!0)&&(p.options[U]=be[U]);return p.options.placeholder?A.setAttribute("data-placeholder",p.options.placeholder):A.removeAttribute("data-placeholder"),A.placeholder=p.options.placeholder,p.setValue(p.options.value),Y(),p.options.search?ae||(ae=document.createElement("div"),A.parentNode.insertBefore(ae,A.nextSibling),W=vt(ae,{data:p.options.search,onselect:function(X,C,q){p.selectIndex(C,q)}})):ae&&(W=null,ae.remove(),ae=null),p},p.add=function(re,ne){if(typeof p.options.onbeforechange=="function"){var be=p.options.onbeforechange(A,p,p.options.value,re);if(be===!1)return!1;be!=null&&(re=be)}if(W&&W.close(),a())typeof p.options.onlimit=="function"?p.options.onlimit(p,p.options.limit):alert(f.translate("You reach the limit number of entries")+" "+p.options.limit);else{var U=s.getNode();if(U&&U.parentNode&&U.parentNode.classList.contains("jtags")&&U.nextSibling&&!(U.nextSibling.innerText&&U.nextSibling.innerText.trim()))X=U.nextSibling;else{if(A.lastChild&&(A.lastChild.innerText.trim()||A.removeChild(A.lastChild)),!re||typeof re=="string")var X=V(re,re,U);else for(var C=0;C<=re.length;C++)if(!a()){if(!re[C]||typeof re[C]=="string")var q=re[C]||"",G=null;else var q=re[C].text,G=re[C].value;var X=V(q,G)}N()}ne&&ie(X)}},p.setLimit=function(re){for(p.options.limit=re,A.children.length-re;A.children.length>re;)A.removeChild(A.lastChild)},p.remove=function(re){re.parentNode.removeChild(re),A.children.length?N():p.add("",!0),typeof p.options.onremoveitem=="function"&&p.options.onremoveitem(A,p,re)},p.getData=function(){for(var re=[],ne=0;ne<A.children.length;ne++){var be=A.children[ne].innerText.replace(`
`,""),U=A.children[ne].getAttribute("data-value");U||(U=be),(be||U)&&re.push({text:be,value:U})}return re},p.getValue=function(re){var ne=null;if(re!=null)ne=A.children[re].getAttribute("data-value"),ne||(ne=A.children[re].innerText.replace(`
`,""));else{for(var be=[],U=0;U<A.children.length;U++)ne=A.children[U].innerText.replace(`
`,""),ne&&be.push(p.getValue(U));ne=be.join(",")}return ne},p.setValue=function(re){if(!re)p.reset();else if(A.value!=re)if(Array.isArray(re))p.add(re);else{var ne=(""+re).trim(),be=ce(ne);A.innerHTML="",p.add(be)}},p.reset=function(){A.classList.add("jtags-empty"),A.innerHTML="<div></div>",N()},p.isValid=function(){for(var re=0,ne=0;ne<A.children.length;ne++)A.children[ne].classList.contains("jtags_error")&&re++;return re==0},p.selectIndex=function(re,ne){var be=s.getNode();be&&(be.innerText=re,ne&&be.setAttribute("data-value",ne),be.classList.remove("jtags_error"),a()||p.add("",!0))},p.search=function(re){re.innerText},p.destroy=function(){A.removeEventListener("mouseup",ze),A.removeEventListener("keydown",ve),A.removeEventListener("keyup",xe),A.removeEventListener("paste",Re),A.removeEventListener("focus",$e),A.removeEventListener("blur",Je),A.parentNode.removeChild(A)};var ie=function(re){if(A.children.length){var ne=document.createRange(),be=window.getSelection();if(!re)var re=A.childNodes[A.childNodes.length-1];ne.setStart(re,re.length),ne.collapse(!0),be.removeAllRanges(),be.addRange(ne),A.scrollLeft=A.scrollWidth}},V=function(re,ne,be){var U=document.createElement("div");return U.textContent=re||"",ne&&U.setAttribute("data-value",ne),be&&be.parentNode.classList.contains("jtags")?A.insertBefore(U,be.nextSibling):A.appendChild(U),U},N=function(){var re=p.getValue();re!=p.options.value&&(p.options.value=re,typeof p.options.onchange=="function"&&p.options.onchange(A,p,p.options.value),A.value!=p.options.value&&(A.value=p.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))),Y()},Y=function(){for(var re=0;re<A.children.length;re++)A.children[re].tagName==="DIV"&&(p.getValue(re)?(A.children[re].classList.add("jtags_label"),typeof p.options.validation=="function"&&p.getValue(re)?p.options.validation(A.children[re],A.children[re].innerText,A.children[re].getAttribute("data-value"))?A.children[re].classList.remove("jtags_error"):A.children[re].classList.add("jtags_error"):A.children[re].classList.remove("jtags_error")):A.children[re].classList.remove("jtags_label"));ee()},ee=function(){A.innerText.trim()?A.classList.remove("jtags-empty"):(!A.children.length||A.children[0].tagName==="BR")&&(A.innerHTML="",ie(V()))},ce=function(re){var ne=[],be="";if(re=re.trim(),re){for(var U=0;U<re.length;U++)re[U]==","||re[U]==";"||re[U]==`
`?be&&(ne.push(be.trim()),be=""):be+=re[U];be&&ne.push(be)}return ne},Se=0,ve=function(re){if(Se=window.getSelection().anchorOffset,ee(),re.key==="Tab"||re.key===";"||re.key===","){var ne=window.getSelection().anchorOffset;ne>1&&(a()?typeof p.options.onlimit=="function"&&p.options.onlimit(p,p.options.limit):p.add("",!0)),re.preventDefault()}else if(re.key=="Enter"){if(!W||!W.isOpened()){var ne=window.getSelection().anchorOffset;ne>1&&(a()||p.add("",!0)),re.preventDefault()}}else re.key=="Backspace"&&A.children.length==1&&window.getSelection().anchorOffset<1&&re.preventDefault();W&&W.keydown(re),ee()},xe=function(re){if(re.which==39){var ne=window.getSelection().anchorOffset;ne>1&&ne==Se&&p.add("",!0)}else re.which==13||re.which==38||re.which==40?re.preventDefault():W&&W.keyup(re);Y()},Re=function(re){if(re.clipboardData||re.originalEvent.clipboardData)var ne=(re.originalEvent||re).clipboardData.getData("text/plain");else if(window.clipboardData)var ne=window.clipboardData.getData("Text");var be=ce(ne);if(typeof p.options.onbeforepaste=="function"){var U=p.options.onbeforepaste(A,p,be);if(U===!1)return re.preventDefault(),!1;U&&(be=U)}be.length>1?(p.add(be,!0),re.preventDefault()):be[0]&&(document.execCommand("insertText",!1,be[0]),re.preventDefault())},ze=function(re){if(re.target.parentNode&&re.target.parentNode.classList.contains("jtags")&&(re.target.classList.contains("jtags_label")||re.target.classList.contains("jtags_error"))){var ne=re.target.getBoundingClientRect();ne.width-(re.clientX-ne.left)<16&&p.remove(re.target)}re.target==A&&ie()},$e=function(){A.classList.contains("jtags-focus")||((!A.children.length||p.getValue(A.children.length-1))&&(a()||V("")),typeof p.options.onfocus=="function"&&p.options.onfocus(A,p,p.getValue()),A.classList.add("jtags-focus"))},Je=function(){if(A.classList.contains("jtags-focus")){W&&W.close();for(var re=0;re<A.children.length-1;re++)p.getValue(re)||A.removeChild(A.children[re]);N(),A.classList.remove("jtags-focus"),typeof p.options.onblur=="function"&&p.options.onblur(A,p,p.getValue())}},nt=function(){"touchend"in document.documentElement?A.addEventListener("touchend",ze):A.addEventListener("mouseup",ze),A.addEventListener("keydown",ve),A.addEventListener("keyup",xe),A.addEventListener("paste",Re),A.addEventListener("focus",$e),A.addEventListener("blur",Je),A.setAttribute("contenteditable",!0),A.classList.add("jtags"),p.setOptions(k),typeof p.options.onload=="function"&&p.options.onload(A,p),A.change=p.setValue,A.val=function(re){if(re===void 0)return p.getValue();p.setValue(re)},A.tags=p};return nt(),p}function At(A,k){var p={};p.options={};var a={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var W in a)k&&k.hasOwnProperty(W)?p.options[W]=k[W]:p.options[W]=a[W];p.options.multiple==!0&&A.setAttribute("data-multiple",!0),A.content=[],A.classList.add("jupload"),p.options.input==!0&&A.classList.add("input"),p.add=function(N){if(p.options.multiple==!1&&(A.content=[],A.innerText=""),p.options.type=="image"){var Y=document.createElement("img");Y.setAttribute("src",N.file),Y.setAttribute("tabindex",-1),A.getAttribute("name")||(Y.className="jfile",Y.content=N),A.appendChild(Y)}else{if(N.name)var ee=N.name;else var ee=N.file;var ce=document.createElement("div");ce.innerText=ee||p.options.type,ce.classList.add("jupload-item"),ce.setAttribute("tabindex",-1),A.appendChild(ce)}N.content&&(N.file=s.guid()),A.content.push(N),typeof p.options.onchange=="function"&&p.options.onchange(A,N)},p.addFromFile=function(N){var Y=N.type.split("/");if(Y[0]==p.options.type){var ee=new FileReader;ee.addEventListener("load",function(ce){var Se={file:ce.srcElement.result,extension:N.name.substr(N.name.lastIndexOf(".")+1),name:N.name,size:N.size,lastmodified:N.lastModified,content:ce.srcElement.result};p.add(Se)}),ee.readAsDataURL(N)}else alert(f.translate("This extension is not allowed"))},p.addFromUrl=function(N){if(N.substr(0,4)!="data"&&!p.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(N.substr(0,4)=="data"){var Y=N.split(";");Y=Y[0].split("/");var ee=Y[0].replace("data:","");if(ee==p.options.type){var ce={file:N,name:"",extension:Y[1],content:N};p.add(ce)}else alert(p.options.text.extensionNotAllowed)}else{var Y=N.substr(N.lastIndexOf(".")+1);N=p.options.remoteParser+N,D({url:N,type:"GET",dataType:"blob",success:function(ve){}})}};var ae=p.options.type+"/"+p.options.extension,ie=document.createElement("input");ie.type="file",ie.setAttribute("accept",ae),ie.onchange=function(){for(var N=0;N<this.files.length;N++)p.addFromFile(this.files[N])},p.options.multiple==!0&&ie.setAttribute("multiple",!0);var V=null;return A.addEventListener("click",function(N){V=null,!A.children.length||N.target===A?s.click(ie):N.target.parentNode==A&&(V=N.target)}),A.addEventListener("dblclick",function(N){s.click(ie)}),A.addEventListener("dragenter",function(N){A.style.border="1px dashed #000"}),A.addEventListener("dragleave",function(N){A.style.border="1px solid #eee"}),A.addEventListener("dragstop",function(N){A.style.border="1px solid #eee"}),A.addEventListener("dragover",function(N){N.preventDefault()}),A.addEventListener("keydown",function(N){if(V&&N.which==46){var Y=Array.prototype.indexOf.call(A.children,V);Y>=0&&(A.content.splice(Y,1),V.remove(),V=null)}}),A.addEventListener("drop",function(N){N.preventDefault(),N.stopPropagation();var Y=(N.originalEvent||N).dataTransfer.getData("text/html"),ee=(N.originalEvent||N).dataTransfer.files;if(ee.length)for(var ce=0;ce<N.dataTransfer.files.length;ce++)p.addFromFile(N.dataTransfer.files[ce]);else if(Y){p.options.multiple==!1&&(A.innerText="");var Se=document.createElement("div");Se.innerHTML=Y;var ve=Se.querySelectorAll("img");if(ve.length)for(var ce=0;ce<ve.length;ce++)p.addFromUrl(ve[ce].src)}return A.style.border="1px solid #eee",!1}),A.val=function(N){if(N===void 0)return A.content&&A.content.length?A.content:null;if(A.innerText="",A.content=[],N)if(Array.isArray(N))for(var Y=0;Y<N.length;Y++)typeof N[Y]=="string"?p.add({file:N[Y]}):p.add(N[Y]);else typeof N=="string"&&p.add({file:N})},A.upload=A.image=p,p}var Dt=E(195),Lt=E.n(Dt),pt={...f,...s,version:"5.9.2",setExtensions:function(A){if(typeof A=="object")for(var k=Object.keys(A),p=0;p<k.length;p++)pt[k[p]]=A[k[p]]},tracking:I,path:v,sorting:j,lazyLoading:g,ajax:D,animation:_,calendar:te,color:fe,contextmenu:oe,dropdown:Ae,editor:P,floating:Be,form:ke,mask:K,modal:Ye,notification:lt,palette:Q,picker:Ne,progressbar:at,rating:ft,search:vt,slider:jt,tabs:pe,tags:Tt,toolbar:Fe,upload:At,validations:Me};pt.image=At,pt.image.create=function(A){var k=document.createElement("img");return k.setAttribute("src",A.file),k.className="jfile",k.setAttribute("tabindex",-1),k.content=A,k},pt.tracker=ke,pt.loading=_.loading,pt.sha512=Lt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const A=function(re,ne){return re[ne.type]&&re[ne.type]==ne||re.component&&re.component==ne?!0:re.parentNode?A(re.parentNode,ne):!1},k=function(re){let ne=window.jSuitesStateControl;if(ne&&ne.length>0)for(let be=0;be<ne.length;be++)ne[be]&&!A(re,ne[be])&&ne[be].close()};let p=15,a=!1,W={x:null,y:null},ae=document.createElement("div");ae.classList.add("jtooltip");const ie=function(re){return re&&(re.shadowRoot||re.tagName&&re.tagName.includes("-"))},V=function(re){let ne,be,U=re.path||re.composedPath&&re.composedPath();return U?(be=U[0],be&&ie(be)&&!be.shadowRoot&&re.toElement&&(be=re.toElement)):(re.target&&ie(re.target)?ne=re.target.shadowRoot:ne=document,be=ne.elementFromPoint(x,y)),be},N=function(re){if(re.changedTouches&&re.changedTouches[0])var ne=re.changedTouches[0].clientX,be=re.changedTouches[0].clientY;else var ne=re.clientX,be=re.clientY;let U=V(re),X=U&&U.tagName==="DIV"&&U.getAttribute("contentEditable"),C=pt.findElement(U,"jpanel");if(C&&!C.classList.contains("readonly")&&!X){let q=C.getBoundingClientRect(),G=0;C.style.rotate&&(G=parseFloat(C.style.rotate));let ge="move";U.getAttribute("data-action")?ge=U.getAttribute("data-action"):C.style.cursor?ge="resize":C.style.cursor="move",a={action:ge,a:G,e:C,x:ne,y:be,l:q.left,t:q.top,b:q.bottom,r:q.right,w:q.width,h:q.height,d:C.style.cursor,actioned:!1},C.style.width||(C.style.width=q.width+"px"),C.style.height||(C.style.height=q.height+"px")}else a=!1;k(U),xe(re)},Y=function(re,ne,be,U,X,C){const q=be-re,G=U-ne,ge=X-re,J=C-ne;let he=Math.atan2(G,q),qe=Math.atan2(J,ge)-he;return qe=qe*(180/Math.PI),qe<0&&(qe+=360),qe},ee=function(re){a&&a.e&&(typeof a.e.refresh=="function"&&W.actioned&&a.e.refresh(),a.e.style.cursor=""),W={x:null,y:null},a=!1},ce=function(re){if(a){let C=re.clientX||re.pageX,q=re.clientY||re.pageY;if(W.x==null&&W.y==null&&(W.x=C,W.y=q),a.action==="move"){var ne=C-W.x,be=q-W.y,U=a.e.offsetTop+be,X=a.e.offsetLeft+ne;a.e.style.top=U+"px",a.e.style.left=X+"px",typeof a.e.refresh=="function"&&(W.actioned=!0,a.e.refresh("position",U,X))}else if(a.action==="rotate"){let G=a.l+a.w/2,ge=a.t+a.h/2,J=Y(G,ge,a.x,a.y,C,q);J=J+a.a%360,J=Math.round(J/2)*2,a.e.style.rotate=`${J}deg`,typeof a.e.refresh=="function"&&(W.actioned=!0,a.e.refresh("rotate",J))}else if(a.action==="resize"){let G=null,ge=null,J=null,he=null;a.d=="e-resize"||a.d=="ne-resize"||a.d=="se-resize"?(J=a.e.offsetWidth+(C-W.x),re.shiftKey&&(he=a.e.offsetHeight+(C-W.x)*(a.e.offsetHeight/a.e.offsetWidth))):(a.d==="w-resize"||a.d=="nw-resize"||a.d=="sw-resize")&&(ge=a.e.offsetLeft+(C-W.x),J=a.e.offsetLeft+a.e.offsetWidth-ge,re.shiftKey&&(he=a.e.offsetHeight-(C-W.x)*(a.e.offsetHeight/a.e.offsetWidth))),a.d=="s-resize"||a.d=="se-resize"||a.d=="sw-resize"?he||(he=a.e.offsetHeight+(q-W.y)):(a.d==="n-resize"||a.d=="ne-resize"||a.d=="nw-resize")&&(G=a.e.offsetTop+(q-W.y),he=a.e.offsetTop+a.e.offsetHeight-G),G&&(a.e.style.top=G+"px"),ge&&(a.e.style.left=ge+"px"),J&&(a.e.style.width=J+"px"),he&&(a.e.style.height=he+"px"),typeof a.e.refresh=="function"&&(W.actioned=!0,a.e.refresh("dimensions",J,he))}W.x=C,W.y=q}else{let C=V(re),q=pt.findElement(C,"jpanel");if(q){if(q.classList.contains("jpanel-controls")){let ge=C.getAttribute("data-position");ge?q.style.cursor=ge:q.style.cursor=""}else if(q.getAttribute("tabindex")){let ge=q.getBoundingClientRect();re.clientY-ge.top<p?ge.width-(re.clientX-ge.left)<p?q.style.cursor="ne-resize":re.clientX-ge.left<p?q.style.cursor="nw-resize":q.style.cursor="n-resize":ge.height-(re.clientY-ge.top)<p?ge.width-(re.clientX-ge.left)<p?q.style.cursor="se-resize":re.clientX-ge.left<p?q.style.cursor="sw-resize":q.style.cursor="s-resize":ge.width-(re.clientX-ge.left)<p?q.style.cursor="e-resize":re.clientX-ge.left<p?q.style.cursor="w-resize":q.style.cursor=""}}}};let Se=["n","ne","e","se","s","sw","w","nw","rotate"];Se.forEach(function(re,ne){Se[ne]=document.createElement("div"),Se[ne].classList.add("jpanel-action"),re==="rotate"?Se[ne].setAttribute("data-action","rotate"):(Se[ne].setAttribute("data-action","resize"),Se[ne].setAttribute("data-position",re+"-resize"))});let ve;const xe=function(re){let ne=V(re),be=pt.findElement(ne,"jpanel");be&&!be.classList.contains("readonly")&&be.classList.contains("jpanel-controls")?(be.append(...Se),be.classList.contains("jpanel-rotate")||Se[Se.length-1].remove(),ve=be):Re()},Re=function(re){ve&&(Se.forEach(function(ne){ne.remove()}),ve=null)},ze=function(re){var be=V(re).getAttribute("data-tooltip");if(be){if(ae.innerText=be,re.changedTouches&&re.changedTouches[0])var U=re.changedTouches[0].clientX,X=re.changedTouches[0].clientY;else var U=re.clientX,X=re.clientY;ae.style.top=X+"px",ae.style.left=U+"px",document.body.appendChild(ae)}else ae.innerText&&(ae.innerText="",document.body.removeChild(ae))},$e=function(re){var ne=document.activeElement;if(ne&&typeof ne.contextmenu=="function")ne.contextmenu(re),re.preventDefault(),re.stopImmediatePropagation();else if(ne=pt.findElement(re.target,function(U){return U.tagName&&U.getAttribute("aria-contextmenu-id")}),ne){var be=document.querySelector("#"+ne);be?(be.contextmenu.open(re),re.preventDefault(),re.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+ne)}},Je=function(re){let ne=document.activeElement;ne&&re.key==="Delete"&&typeof ne.delete=="function"&&(ne.delete(),re.preventDefault(),re.stopImmediatePropagation());let be=window.jSuitesStateControl;be&&be.length>0&&(ne=be[be.length-1],ne&&re.key==="Escape"&&typeof ne.isOpened=="function"&&typeof ne.close=="function"&&ne.isOpened()&&(ne.close(),re.preventDefault(),re.stopImmediatePropagation()))},nt=function(re){(re.target.getAttribute("data-mask")||re.target.mask)&&pt.mask(re)};document.addEventListener("focusin",xe),document.addEventListener("mouseup",ee),document.addEventListener("mousedown",N),document.addEventListener("mousemove",ce),document.addEventListener("mouseover",ze),document.addEventListener("keydown",Je),document.addEventListener("contextmenu",$e),document.addEventListener("input",nt)}();var St=pt})(),r=O.default}(),r})}(jsuites$1)),jsuites$1.exports}var dist=dist$1.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(e,o){module.exports=o()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(e){var o;e.exports=(function(){var r={765:function(O,d){var u;u=function(f){f.version="1.0.2";var S=Math;function I(me,oe){for(var Pe=0,Ae=0;Pe<me.length;++Pe)Ae=oe*Ae+me[Pe];return Ae}function m(me,oe,Pe,Ae,Ne){if(oe===0)return Pe;if(oe===1)return Ae;for(var Fe=2/me,je=Ae,P=1;P<oe;++P)je=Ae*P*Fe+Ne*Pe,Pe=Ae,Ae=je;return je}function s(me,oe,Pe,Ae,Ne){return function(Fe,je){if(Ae){if(Fe===0)return Ae==1?-1/0:1/0;if(Fe<0)return NaN}return je===0?me(Fe):je===1?oe(Fe):je<0?NaN:m(Fe,je|=0,me(Fe),oe(Fe),Ne)}}var v,j,g,T,D,L,_,F,M,B,K,H,te,se=function(){var me=.636619772,oe=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Pe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ae=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ne=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Fe(Me){var ye=0,ke=0,Ee=0,Ye=Me*Me;if(Me<8)ye=(ke=I(oe,Ye))/(Ee=I(Pe,Ye));else{var Ge=Me-.785398164;ke=I(Ae,Ye=64/Ye),Ee=I(Ne,Ye),ye=S.sqrt(me/Me)*(S.cos(Ge)*ke-S.sin(Ge)*Ee*8/Me)}return ye}var je=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),P=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ce=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Be=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function et(Me){var ye=0,ke=0,Ee=0,Ye=Me*Me,Ge=S.abs(Me)-2.356194491;return Math.abs(Me)<8?ye=(ke=Me*I(je,Ye))/(Ee=I(P,Ye)):(ke=I(Ce,Ye=64/Ye),Ee=I(Be,Ye),ye=S.sqrt(me/S.abs(Me))*(S.cos(Ge)*ke-S.sin(Ge)*Ee*8/S.abs(Me)),Me<0&&(ye=-ye)),ye}return function Me(ye,ke){if(ke=Math.round(ke),!isFinite(ye))return isNaN(ye)?ye:0;if(ke<0)return(ke%2?-1:1)*Me(ye,-ke);if(ye<0)return(ke%2?-1:1)*Me(-ye,ke);if(ke===0)return Fe(ye);if(ke===1)return et(ye);if(ye===0)return 0;var Ee=0;if(ye>ke)Ee=m(ye,ke,Fe(ye),et(ye),-1);else{for(var Ye=!1,Ge=0,lt=0,at=1,ft=0,vt=2/ye,jt=2*S.floor((ke+S.floor(S.sqrt(40*ke)))/2);jt>0;jt--)ft=jt*vt*at-Ge,Ge=at,at=ft,S.abs(at)>1e10&&(at*=1e-10,Ge*=1e-10,Ee*=1e-10,lt*=1e-10),Ye&&(lt+=at),Ye=!Ye,jt==ke&&(Ee=Ge);Ee/=lt=2*lt-at}return Ee}}(),Q=(v=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),g=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),T=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),D=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),L=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),F=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),s(function(me){var oe=0,Pe=0,Ae=0,Ne=me*me,Fe=me-.785398164;return me<8?oe=(Pe=I(j,Ne))/(Ae=I(g,Ne))+v*se(me,0)*S.log(me):(Pe=I(T,Ne=64/Ne),Ae=I(D,Ne),oe=S.sqrt(v/me)*(S.sin(Fe)*Pe+S.cos(Fe)*Ae*8/me)),oe},function(me){var oe=0,Pe=0,Ae=0,Ne=me*me,Fe=me-2.356194491;return me<8?oe=(Pe=me*I(L,Ne))/(Ae=I(_,Ne))+v*(se(me,1)*S.log(me)-1/me):(Pe=I(F,Ne=64/Ne),Ae=I(M,Ne),oe=S.sqrt(v/me)*(S.sin(Fe)*Pe+S.cos(Fe)*Ae*8/me)),oe},0,1,-1)),pe=(B=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),K=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),H=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),te=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function me(oe,Pe){if((Pe=Math.round(Pe))===0)return function(Be){return Be<=3.75?I(B,Be*Be/14.0625):S.exp(S.abs(Be))/S.sqrt(S.abs(Be))*I(K,3.75/S.abs(Be))}(oe);if(Pe===1)return function(Be){return Be<3.75?Be*I(H,Be*Be/14.0625):(Be<0?-1:1)*S.exp(S.abs(Be))/S.sqrt(S.abs(Be))*I(te,3.75/S.abs(Be))}(oe);if(Pe<0)return NaN;if(S.abs(oe)===0)return 0;if(oe==1/0)return 1/0;var Ae,Ne=0,Fe=2/S.abs(oe),je=0,P=1,Ce=0;for(Ae=2*S.round((Pe+S.round(S.sqrt(40*Pe)))/2);Ae>0;Ae--)Ce=Ae*Fe*P+je,je=P,P=Ce,S.abs(P)>1e10&&(P*=1e-10,je*=1e-10,Ne*=1e-10),Ae==Pe&&(Ne=je);return Ne*=me(oe,0)/P,oe<0&&Pe%2?-Ne:Ne}),fe=function(){var me=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),oe=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Pe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ae=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return s(function(Ne){return Ne<=2?-S.log(Ne/2)*pe(Ne,0)+I(me,Ne*Ne/4):S.exp(-Ne)/S.sqrt(Ne)*I(oe,2/Ne)},function(Ne){return Ne<=2?S.log(Ne/2)*pe(Ne,1)+1/Ne*I(Pe,Ne*Ne/4):S.exp(-Ne)/S.sqrt(Ne)*I(Ae,2/Ne)},0,2,1)}();f.besselj=se,f.bessely=Q,f.besseli=pe,f.besselk=fe},u(typeof DO_NOT_EXPORT_BESSEL>"u"?d:{})},162:function(O){var d;O.exports=(d=function(u,f){var S=Array.prototype.concat,I=Array.prototype.slice,m=Object.prototype.toString;function s(M,B){var K=M>B?M:B;return u.pow(10,17-~~(u.log(K>0?K:-K)*u.LOG10E))}var v=Array.isArray||function(M){return m.call(M)==="[object Array]"};function j(M){return m.call(M)==="[object Function]"}function g(M){return typeof M=="number"&&M-M==0}function T(){return new T._init(arguments)}function D(){return 0}function L(){return 1}function _(M,B){return M===B?1:0}T.fn=T.prototype,T._init=function(M){if(v(M[0]))if(v(M[0][0])){j(M[1])&&(M[0]=T.map(M[0],M[1]));for(var B=0;B<M[0].length;B++)this[B]=M[0][B];this.length=M[0].length}else this[0]=j(M[1])?T.map(M[0],M[1]):M[0],this.length=1;else if(g(M[0]))this[0]=T.seq.apply(null,M),this.length=1;else{if(M[0]instanceof T)return T(M[0].toArray());this[0]=[],this.length=1}return this},T._init.prototype=T.prototype,T._init.constructor=T,T.utils={calcRdx:s,isArray:v,isFunction:j,isNumber:g,toVector:function(M){return S.apply([],M)}},T._random_fn=u.random,T.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");T._random_fn=M},T.extend=function(M){var B,K;if(arguments.length===1){for(K in M)T[K]=M[K];return this}for(B=1;B<arguments.length;B++)for(K in arguments[B])M[K]=arguments[B][K];return M},T.rows=function(M){return M.length||1},T.cols=function(M){return M[0].length||1},T.dimensions=function(M){return{rows:T.rows(M),cols:T.cols(M)}},T.row=function(M,B){return v(B)?B.map(function(K){return T.row(M,K)}):M[B]},T.rowa=function(M,B){return T.row(M,B)},T.col=function(M,B){if(v(B)){var K=T.arange(M.length).map(function(){return new Array(B.length)});return B.forEach(function(se,Q){T.arange(M.length).forEach(function(pe){K[pe][Q]=M[pe][se]})}),K}for(var H=new Array(M.length),te=0;te<M.length;te++)H[te]=[M[te][B]];return H},T.cola=function(M,B){return T.col(M,B).map(function(K){return K[0]})},T.diag=function(M){for(var B=T.rows(M),K=new Array(B),H=0;H<B;H++)K[H]=[M[H][H]];return K},T.antidiag=function(M){for(var B=T.rows(M)-1,K=new Array(B),H=0;B>=0;B--,H++)K[H]=[M[H][B]];return K},T.transpose=function(M){var B,K,H,te,se,Q=[];for(v(M[0])||(M=[M]),K=M.length,H=M[0].length,se=0;se<H;se++){for(B=new Array(K),te=0;te<K;te++)B[te]=M[te][se];Q.push(B)}return Q.length===1?Q[0]:Q},T.map=function(M,B,K){var H,te,se,Q,pe;for(v(M[0])||(M=[M]),te=M.length,se=M[0].length,Q=K?M:new Array(te),H=0;H<te;H++)for(Q[H]||(Q[H]=new Array(se)),pe=0;pe<se;pe++)Q[H][pe]=B(M[H][pe],H,pe);return Q.length===1?Q[0]:Q},T.cumreduce=function(M,B,K){var H,te,se,Q,pe;for(v(M[0])||(M=[M]),te=M.length,se=M[0].length,Q=K?M:new Array(te),H=0;H<te;H++)for(Q[H]||(Q[H]=new Array(se)),se>0&&(Q[H][0]=M[H][0]),pe=1;pe<se;pe++)Q[H][pe]=B(Q[H][pe-1],M[H][pe]);return Q.length===1?Q[0]:Q},T.alter=function(M,B){return T.map(M,B,!0)},T.create=function(M,B,K){var H,te,se=new Array(M);for(j(B)&&(K=B,B=M),H=0;H<M;H++)for(se[H]=new Array(B),te=0;te<B;te++)se[H][te]=K(H,te);return se},T.zeros=function(M,B){return g(B)||(B=M),T.create(M,B,D)},T.ones=function(M,B){return g(B)||(B=M),T.create(M,B,L)},T.rand=function(M,B){return g(B)||(B=M),T.create(M,B,T._random_fn)},T.identity=function(M,B){return g(B)||(B=M),T.create(M,B,_)},T.symmetric=function(M){var B,K,H=M.length;if(M.length!==M[0].length)return!1;for(B=0;B<H;B++)for(K=0;K<H;K++)if(M[K][B]!==M[B][K])return!1;return!0},T.clear=function(M){return T.alter(M,D)},T.seq=function(M,B,K,H){j(H)||(H=!1);var te,se=[],Q=s(M,B),pe=(B*Q-M*Q)/((K-1)*Q),fe=M;for(te=0;fe<=B&&te<K;fe=(M*Q+pe*Q*++te)/Q)se.push(H?H(fe,te):fe);return se},T.arange=function(M,B,K){var H,te=[];if(K=K||1,B===f&&(B=M,M=0),M===B||K===0)return[];if(M<B&&K<0)return[];if(M>B&&K>0)return[];if(K>0)for(H=M;H<B;H+=K)te.push(H);else for(H=M;H>B;H+=K)te.push(H);return te},T.slice=function(){function M(B,K,H,te){var se,Q=[],pe=B.length;if(K===f&&H===f&&te===f)return T.copy(B);if(te=te||1,(K=(K=K||0)>=0?K:pe+K)===(H=(H=H||B.length)>=0?H:pe+H)||te===0)return[];if(K<H&&te<0)return[];if(K>H&&te>0)return[];if(te>0)for(se=K;se<H;se+=te)Q.push(B[se]);else for(se=K;se>H;se+=te)Q.push(B[se]);return Q}return function(B,K){var H,te;return g((K=K||{}).row)?g(K.col)?B[K.row][K.col]:M(T.rowa(B,K.row),(H=K.col||{}).start,H.end,H.step):g(K.col)?M(T.cola(B,K.col),(te=K.row||{}).start,te.end,te.step):(te=K.row||{},H=K.col||{},M(B,te.start,te.end,te.step).map(function(se){return M(se,H.start,H.end,H.step)}))}}(),T.sliceAssign=function(M,B,K){var H,te;if(g(B.row)){if(g(B.col))return M[B.row][B.col]=K;B.col=B.col||{},B.col.start=B.col.start||0,B.col.end=B.col.end||M[0].length,B.col.step=B.col.step||1,H=T.arange(B.col.start,u.min(M.length,B.col.end),B.col.step);var se=B.row;return H.forEach(function(pe,fe){M[se][pe]=K[fe]}),M}if(g(B.col)){B.row=B.row||{},B.row.start=B.row.start||0,B.row.end=B.row.end||M.length,B.row.step=B.row.step||1,te=T.arange(B.row.start,u.min(M[0].length,B.row.end),B.row.step);var Q=B.col;return te.forEach(function(pe,fe){M[pe][Q]=K[fe]}),M}return K[0].length===f&&(K=[K]),B.row.start=B.row.start||0,B.row.end=B.row.end||M.length,B.row.step=B.row.step||1,B.col.start=B.col.start||0,B.col.end=B.col.end||M[0].length,B.col.step=B.col.step||1,te=T.arange(B.row.start,u.min(M.length,B.row.end),B.row.step),H=T.arange(B.col.start,u.min(M[0].length,B.col.end),B.col.step),te.forEach(function(pe,fe){H.forEach(function(me,oe){M[pe][me]=K[fe][oe]})}),M},T.diagonal=function(M){var B=T.zeros(M.length,M.length);return M.forEach(function(K,H){B[H][H]=K}),B},T.copy=function(M){return M.map(function(B){return g(B)?B:B.map(function(K){return K})})};var F=T.prototype;return F.length=0,F.push=Array.prototype.push,F.sort=Array.prototype.sort,F.splice=Array.prototype.splice,F.slice=Array.prototype.slice,F.toArray=function(){return this.length>1?I.call(this):I.call(this)[0]},F.map=function(M,B){return T(T.map(this,M,B))},F.cumreduce=function(M,B){return T(T.cumreduce(this,M,B))},F.alter=function(M){return T.alter(this,M),this},function(M){for(var B=0;B<M.length;B++)(function(K){F[K]=function(H){var te,se=this;return H?(setTimeout(function(){H.call(se,F[K].call(se))}),this):(te=T[K](this),v(te)?T(te):te)}})(M[B])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var B=0;B<M.length;B++)(function(K){F[K]=function(H,te){var se=this;return te?(setTimeout(function(){te.call(se,F[K].call(se,H))}),this):T(T[K](this,H))}})(M[B])}("row col".split(" ")),function(M){for(var B=0;B<M.length;B++)(function(K){F[K]=function(){return T(T[K].apply(null,arguments))}})(M[B])}("create zeros ones rand identity".split(" ")),T}(Math),function(u,f){var S=u.utils.isFunction;function I(v,j){return v-j}function m(v,j,g){return f.max(j,f.min(v,g))}u.sum=function(v){for(var j=0,g=v.length;--g>=0;)j+=v[g];return j},u.sumsqrd=function(v){for(var j=0,g=v.length;--g>=0;)j+=v[g]*v[g];return j},u.sumsqerr=function(v){for(var j,g=u.mean(v),T=0,D=v.length;--D>=0;)T+=(j=v[D]-g)*j;return T},u.sumrow=function(v){for(var j=0,g=v.length;--g>=0;)j+=v[g];return j},u.product=function(v){for(var j=1,g=v.length;--g>=0;)j*=v[g];return j},u.min=function(v){for(var j=v[0],g=0;++g<v.length;)v[g]<j&&(j=v[g]);return j},u.max=function(v){for(var j=v[0],g=0;++g<v.length;)v[g]>j&&(j=v[g]);return j},u.unique=function(v){for(var j={},g=[],T=0;T<v.length;T++)j[v[T]]||(j[v[T]]=!0,g.push(v[T]));return g},u.mean=function(v){return u.sum(v)/v.length},u.meansqerr=function(v){return u.sumsqerr(v)/v.length},u.geomean=function(v){var j=v.map(f.log),g=u.mean(j);return f.exp(g)},u.median=function(v){var j=v.length,g=v.slice().sort(I);return 1&j?g[j/2|0]:(g[j/2-1]+g[j/2])/2},u.cumsum=function(v){return u.cumreduce(v,function(j,g){return j+g})},u.cumprod=function(v){return u.cumreduce(v,function(j,g){return j*g})},u.diff=function(v){var j,g=[],T=v.length;for(j=1;j<T;j++)g.push(v[j]-v[j-1]);return g},u.rank=function(v){var j,g=[],T={};for(j=0;j<v.length;j++)T[F=v[j]]?T[F]++:(T[F]=1,g.push(F));var D=g.sort(I),L={},_=1;for(j=0;j<D.length;j++){var F,M=T[F=D[j]],B=(_+(_+M-1))/2;L[F]=B,_+=M}return v.map(function(K){return L[K]})},u.mode=function(v){var j,g=v.length,T=v.slice().sort(I),D=1,L=0,_=0,F=[];for(j=0;j<g;j++)T[j]===T[j+1]?D++:(D>L?(F=[T[j]],L=D,_=0):D===L&&(F.push(T[j]),_++),D=1);return _===0?F[0]:F},u.range=function(v){return u.max(v)-u.min(v)},u.variance=function(v,j){return u.sumsqerr(v)/(v.length-(j?1:0))},u.pooledvariance=function(v){return v.reduce(function(j,g){return j+u.sumsqerr(g)},0)/(v.reduce(function(j,g){return j+g.length},0)-v.length)},u.deviation=function(v){for(var j=u.mean(v),g=v.length,T=new Array(g),D=0;D<g;D++)T[D]=v[D]-j;return T},u.stdev=function(v,j){return f.sqrt(u.variance(v,j))},u.pooledstdev=function(v){return f.sqrt(u.pooledvariance(v))},u.meandev=function(v){for(var j=u.mean(v),g=[],T=v.length-1;T>=0;T--)g.push(f.abs(v[T]-j));return u.mean(g)},u.meddev=function(v){for(var j=u.median(v),g=[],T=v.length-1;T>=0;T--)g.push(f.abs(v[T]-j));return u.median(g)},u.coeffvar=function(v){return u.stdev(v)/u.mean(v)},u.quartiles=function(v){var j=v.length,g=v.slice().sort(I);return[g[f.round(j/4)-1],g[f.round(j/2)-1],g[f.round(3*j/4)-1]]},u.quantiles=function(v,j,g,T){var D,L,_,F,M,B=v.slice().sort(I),K=[j.length],H=v.length;for(g===void 0&&(g=.375),T===void 0&&(T=.375),D=0;D<j.length;D++)_=H*(L=j[D])+(g+L*(1-g-T)),F=f.floor(m(_,1,H-1)),M=m(_-F,0,1),K[D]=(1-M)*B[F-1]+M*B[F];return K},u.percentile=function(v,j,g){var T=v.slice().sort(I),D=j*(T.length+(g?1:-1))+(g?0:1),L=parseInt(D),_=D-L;return L+1<T.length?T[L-1]+_*(T[L]-T[L-1]):T[L-1]},u.percentileOfScore=function(v,j,g){var T,D,L=0,_=v.length,F=!1;for(g==="strict"&&(F=!0),D=0;D<_;D++)T=v[D],(F&&T<j||!F&&T<=j)&&L++;return L/_},u.histogram=function(v,j){j=j||4;var g,T=u.min(v),D=(u.max(v)-T)/j,L=v.length,_=[];for(g=0;g<j;g++)_[g]=0;for(g=0;g<L;g++)_[f.min(f.floor((v[g]-T)/D),j-1)]+=1;return _},u.covariance=function(v,j){var g,T=u.mean(v),D=u.mean(j),L=v.length,_=new Array(L);for(g=0;g<L;g++)_[g]=(v[g]-T)*(j[g]-D);return u.sum(_)/(L-1)},u.corrcoeff=function(v,j){return u.covariance(v,j)/u.stdev(v,1)/u.stdev(j,1)},u.spearmancoeff=function(v,j){return v=u.rank(v),j=u.rank(j),u.corrcoeff(v,j)},u.stanMoment=function(v,j){for(var g=u.mean(v),T=u.stdev(v),D=v.length,L=0,_=0;_<D;_++)L+=f.pow((v[_]-g)/T,j);return L/v.length},u.skewness=function(v){return u.stanMoment(v,3)},u.kurtosis=function(v){return u.stanMoment(v,4)-3};var s=u.prototype;(function(v){for(var j=0;j<v.length;j++)(function(g){s[g]=function(T,D){var L=[],_=0,F=this;if(S(T)&&(D=T,T=!1),D)return setTimeout(function(){D.call(F,s[g].call(F,T))}),this;if(this.length>1){for(F=T===!0?this:this.transpose();_<F.length;_++)L[_]=u[g](F[_]);return L}return u[g](this[0],T)}})(v[j])})("cumsum cumprod".split(" ")),function(v){for(var j=0;j<v.length;j++)(function(g){s[g]=function(T,D){var L=[],_=0,F=this;if(S(T)&&(D=T,T=!1),D)return setTimeout(function(){D.call(F,s[g].call(F,T))}),this;if(this.length>1){for(g!=="sumrow"&&(F=T===!0?this:this.transpose());_<F.length;_++)L[_]=u[g](F[_]);return T===!0?u[g](u.utils.toVector(L)):L}return u[g](this[0],T)}})(v[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(v){for(var j=0;j<v.length;j++)(function(g){s[g]=function(){var T,D=[],L=0,_=this,F=Array.prototype.slice.call(arguments);if(S(F[F.length-1])){T=F[F.length-1];var M=F.slice(0,F.length-1);return setTimeout(function(){T.call(_,s[g].apply(_,M))}),this}T=void 0;var B=function(K){return u[g].apply(_,[K].concat(F))};if(this.length>1){for(_=_.transpose();L<_.length;L++)D[L]=B(_[L]);return D}return B(this[0])}})(v[j])}("quantiles percentileOfScore".split(" "))}(d,Math),function(u,f){u.gammaln=function(S){var I,m,s,v=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],g=1.000000000190015;for(s=(m=I=S)+5.5,s-=(I+.5)*f.log(s);v<6;v++)g+=j[v]/++m;return f.log(2.5066282746310007*g/I)-s},u.loggam=function(S){var I,m,s,v,j,g,T,D=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(I=S,T=0,S==1||S==2)return 0;for(S<=7&&(I=S+(T=f.floor(7-S))),m=1/(I*I),s=2*f.PI,j=D[9],g=8;g>=0;g--)j*=m,j+=D[g];if(v=j/I+.5*f.log(s)+(I-.5)*f.log(I)-I,S<=7)for(g=1;g<=T;g++)v-=f.log(I-1),I-=1;return v},u.gammafn=function(S){var I,m,s,v,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],g=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],T=!1,D=0,L=0,_=0,F=S;if(S>171.6243769536076)return 1/0;if(F<=0){if(!(v=F%1+36e-17))return 1/0;T=(1&F?-1:1)*f.PI/f.sin(f.PI*v),F=1-F}for(s=F,m=F<1?F++:(F-=D=(0|F)-1)-1,I=0;I<8;++I)_=(_+j[I])*m,L=L*m+g[I];if(v=_/L+1,s<F)v/=s;else if(s>F)for(I=0;I<D;++I)v*=F,F++;return T&&(v=T/v),v},u.gammap=function(S,I){return u.lowRegGamma(S,I)*u.gammafn(S)},u.lowRegGamma=function(S,I){var m,s=u.gammaln(S),v=S,j=1/S,g=j,T=I+1-S,D=1/1e-30,L=1/T,_=L,F=1,M=-~(8.5*f.log(S>=1?S:1/S)+.4*S+17);if(I<0||S<=0)return NaN;if(I<S+1){for(;F<=M;F++)j+=g*=I/++v;return j*f.exp(-I+S*f.log(I)-s)}for(;F<=M;F++)_*=(L=1/(L=(m=-F*(F-S))*L+(T+=2)))*(D=T+m/D);return 1-_*f.exp(-I+S*f.log(I)-s)},u.factorialln=function(S){return S<0?NaN:u.gammaln(S+1)},u.factorial=function(S){return S<0?NaN:u.gammafn(S+1)},u.combination=function(S,I){return S>170||I>170?f.exp(u.combinationln(S,I)):u.factorial(S)/u.factorial(I)/u.factorial(S-I)},u.combinationln=function(S,I){return u.factorialln(S)-u.factorialln(I)-u.factorialln(S-I)},u.permutation=function(S,I){return u.factorial(S)/u.factorial(S-I)},u.betafn=function(S,I){if(!(S<=0||I<=0))return S+I>170?f.exp(u.betaln(S,I)):u.gammafn(S)*u.gammafn(I)/u.gammafn(S+I)},u.betaln=function(S,I){return u.gammaln(S)+u.gammaln(I)-u.gammaln(S+I)},u.betacf=function(S,I,m){var s,v,j,g,T=1e-30,D=1,L=I+m,_=I+1,F=I-1,M=1,B=1-L*S/_;for(f.abs(B)<T&&(B=T),g=B=1/B;D<=100&&(B=1+(v=D*(m-D)*S/((F+(s=2*D))*(I+s)))*B,f.abs(B)<T&&(B=T),M=1+v/M,f.abs(M)<T&&(M=T),g*=(B=1/B)*M,B=1+(v=-(I+D)*(L+D)*S/((I+s)*(_+s)))*B,f.abs(B)<T&&(B=T),M=1+v/M,f.abs(M)<T&&(M=T),g*=j=(B=1/B)*M,!(f.abs(j-1)<3e-7));D++);return g},u.gammapinv=function(S,I){var m,s,v,j,g,T,D=0,L=I-1,_=u.gammaln(I);if(S>=1)return f.max(100,I+100*f.sqrt(I));if(S<=0)return 0;for(I>1?(g=f.log(L),T=f.exp(L*(g-1)-_),j=S<.5?S:1-S,m=(2.30753+.27061*(s=f.sqrt(-2*f.log(j))))/(1+s*(.99229+.04481*s))-s,S<.5&&(m=-m),m=f.max(.001,I*f.pow(1-1/(9*I)-m/(3*f.sqrt(I)),3))):m=S<(s=1-I*(.253+.12*I))?f.pow(S/s,1/I):1-f.log(1-(S-s)/(1-s));D<12;D++){if(m<=0)return 0;if((m-=s=(v=(u.lowRegGamma(I,m)-S)/(s=I>1?T*f.exp(-(m-L)+L*(f.log(m)-g)):f.exp(-m+L*f.log(m)-_)))/(1-.5*f.min(1,v*((I-1)/m-1))))<=0&&(m=.5*(m+s)),f.abs(s)<1e-8*m)break}return m},u.erf=function(S){var I,m,s,v,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],g=j.length-1,T=!1,D=0,L=0;for(S<0&&(S=-S,T=!0),m=4*(I=2/(2+S))-2;g>0;g--)s=D,D=m*D-L+j[g],L=s;return v=I*f.exp(-S*S+.5*(j[0]+m*D)-L),T?v-1:1-v},u.erfc=function(S){return 1-u.erf(S)},u.erfcinv=function(S){var I,m,s,v,j=0;if(S>=2)return-100;if(S<=0)return 100;for(v=S<1?S:2-S,I=-.70711*((2.30753+.27061*(s=f.sqrt(-2*f.log(v/2))))/(1+s*(.99229+.04481*s))-s);j<2;j++)I+=(m=u.erfc(I)-v)/(1.1283791670955126*f.exp(-I*I)-I*m);return S<1?I:-I},u.ibetainv=function(S,I,m){var s,v,j,g,T,D,L,_,F,M,B=I-1,K=m-1,H=0;if(S<=0)return 0;if(S>=1)return 1;for(I>=1&&m>=1?(j=S<.5?S:1-S,D=(2.30753+.27061*(g=f.sqrt(-2*f.log(j))))/(1+g*(.99229+.04481*g))-g,S<.5&&(D=-D),L=(D*D-3)/6,_=2/(1/(2*I-1)+1/(2*m-1)),F=D*f.sqrt(L+_)/_-(1/(2*m-1)-1/(2*I-1))*(L+.8333333333333334-2/(3*_)),D=I/(I+m*f.exp(2*F))):(s=f.log(I/(I+m)),v=f.log(m/(I+m)),D=S<(g=f.exp(I*s)/I)/(F=g+(T=f.exp(m*v)/m))?f.pow(I*F*S,1/I):1-f.pow(m*F*(1-S),1/m)),M=-u.gammaln(I)-u.gammaln(m)+u.gammaln(I+m);H<10;H++){if(D===0||D===1)return D;if((D-=g=(T=(u.ibeta(D,I,m)-S)/(g=f.exp(B*f.log(D)+K*f.log(1-D)+M)))/(1-.5*f.min(1,T*(B/D-K/(1-D)))))<=0&&(D=.5*(D+g)),D>=1&&(D=.5*(D+g+1)),f.abs(g)<1e-8*D&&H>0)break}return D},u.ibeta=function(S,I,m){var s=S===0||S===1?0:f.exp(u.gammaln(I+m)-u.gammaln(I)-u.gammaln(m)+I*f.log(S)+m*f.log(1-S));return!(S<0||S>1)&&(S<(I+1)/(I+m+2)?s*u.betacf(S,I,m)/I:1-s*u.betacf(1-S,m,I)/m)},u.randn=function(S,I){var m,s,v,j,g;if(I||(I=S),S)return u.create(S,I,function(){return u.randn()});do m=u._random_fn(),s=1.7156*(u._random_fn()-.5),g=(v=m-.449871)*v+(j=f.abs(s)+.386595)*(.196*j-.25472*v);while(g>.27597&&(g>.27846||s*s>-4*f.log(m)*m*m));return s/m},u.randg=function(S,I,m){var s,v,j,g,T,D,L=S;if(m||(m=I),S||(S=1),I)return(D=u.zeros(I,m)).alter(function(){return u.randg(S)}),D;S<1&&(S+=1),s=S-.3333333333333333,v=1/f.sqrt(9*s);do{do g=1+v*(T=u.randn());while(g<=0);g*=g*g,j=u._random_fn()}while(j>1-.331*f.pow(T,4)&&f.log(j)>.5*T*T+s*(1-g+f.log(g)));if(S==L)return s*g;do j=u._random_fn();while(j===0);return f.pow(j,1/L)*s*g},function(S){for(var I=0;I<S.length;I++)(function(m){u.fn[m]=function(){return u(u.map(this,function(s){return u[m](s)}))}})(S[I])}("gammaln gammafn factorial factorialln".split(" ")),function(S){for(var I=0;I<S.length;I++)(function(m){u.fn[m]=function(){return u(u[m].apply(null,arguments))}})(S[I])}("randn".split(" "))}(d,Math),function(u,f){function S(m,s,v,j){for(var g,T=0,D=1,L=1,_=1,F=0,M=0;f.abs((L-M)/L)>j;)M=L,D=_+(g=-(s+F)*(s+v+F)*m/(s+2*F)/(s+2*F+1))*D,L=(T=L+g*T)+(g=(F+=1)*(v-F)*m/(s+2*F-1)/(s+2*F))*L,T/=_=D+g*_,D/=_,L/=_,_=1;return L/s}function I(m,s,v){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],g=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],T=.5*m;if(T>=8)return 1;var D,L=2*u.normal.cdf(T,0,1,1,0)-1;L=L>=f.exp(-50/v)?f.pow(L,v):0;for(var _=T,F=(8-T)/(D=m>3?2:3),M=_+F,B=0,K=v-1,H=1;H<=D;H++){for(var te=0,se=.5*(M+_),Q=.5*(M-_),pe=1;pe<=12;pe++){var fe,me=se+Q*(6<pe?j[(fe=12-pe+1)-1]:-j[(fe=pe)-1]),oe=me*me;if(oe>60)break;var Pe=2*u.normal.cdf(me,0,1,1,0)*.5-2*u.normal.cdf(me,m,1,1,0)*.5;Pe>=f.exp(-30/K)&&(te+=Pe=g[fe-1]*f.exp(-.5*oe)*f.pow(Pe,K))}B+=te*=2*Q*v/f.sqrt(2*f.PI),_=M,M+=F}return(L+=B)<=f.exp(-30/s)?0:(L=f.pow(L,s))>=1?1:L}(function(m){for(var s=0;s<m.length;s++)(function(v){u[v]=function j(g,T,D){return this instanceof j?(this._a=g,this._b=T,this._c=D,this):new j(g,T,D)},u.fn[v]=function(j,g,T){var D=u[v](j,g,T);return D.data=this,D},u[v].prototype.sample=function(j){var g=this._a,T=this._b,D=this._c;return j?u.alter(j,function(){return u[v].sample(g,T,D)}):u[v].sample(g,T,D)},function(j){for(var g=0;g<j.length;g++)(function(T){u[v].prototype[T]=function(D){var L=this._a,_=this._b,F=this._c;return D||D===0||(D=this.data),typeof D!="number"?u.fn.map.call(D,function(M){return u[v][T](M,L,_,F)}):u[v][T](D,L,_,F)}})(j[g])}("pdf cdf inv".split(" ")),function(j){for(var g=0;g<j.length;g++)(function(T){u[v].prototype[T]=function(){return u[v][T](this._a,this._b,this._c)}})(j[g])}("mean median mode variance".split(" "))})(m[s])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(m,s,v){return m>1||m<0?0:s==1&&v==1?1:s<512&&v<512?f.pow(m,s-1)*f.pow(1-m,v-1)/u.betafn(s,v):f.exp((s-1)*f.log(m)+(v-1)*f.log(1-m)-u.betaln(s,v))},cdf:function(m,s,v){return m>1||m<0?1*(m>1):u.ibeta(m,s,v)},inv:function(m,s,v){return u.ibetainv(m,s,v)},mean:function(m,s){return m/(m+s)},median:function(m,s){return u.ibetainv(.5,m,s)},mode:function(m,s){return(m-1)/(m+s-2)},sample:function(m,s){var v=u.randg(m);return v/(v+u.randg(s))},variance:function(m,s){return m*s/(f.pow(m+s,2)*(m+s+1))}}),u.extend(u.centralF,{pdf:function(m,s,v){var j;return m<0?0:s<=2?m===0&&s<2?1/0:m===0&&s===2?1:1/u.betafn(s/2,v/2)*f.pow(s/v,s/2)*f.pow(m,s/2-1)*f.pow(1+s/v*m,-(s+v)/2):(j=s*m/(v+m*s),s*(v/(v+m*s))/2*u.binomial.pdf((s-2)/2,(s+v-2)/2,j))},cdf:function(m,s,v){return m<0?0:u.ibeta(s*m/(s*m+v),s/2,v/2)},inv:function(m,s,v){return v/(s*(1/u.ibetainv(m,s/2,v/2)-1))},mean:function(m,s){return s>2?s/(s-2):void 0},mode:function(m,s){return m>2?s*(m-2)/(m*(s+2)):void 0},sample:function(m,s){return 2*u.randg(m/2)/m/(2*u.randg(s/2)/s)},variance:function(m,s){if(!(s<=4))return 2*s*s*(m+s-2)/(m*(s-2)*(s-2)*(s-4))}}),u.extend(u.cauchy,{pdf:function(m,s,v){return v<0?0:v/(f.pow(m-s,2)+f.pow(v,2))/f.PI},cdf:function(m,s,v){return f.atan((m-s)/v)/f.PI+.5},inv:function(m,s,v){return s+v*f.tan(f.PI*(m-.5))},median:function(m){return m},mode:function(m){return m},sample:function(m,s){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*s+m}}),u.extend(u.chisquare,{pdf:function(m,s){return m<0?0:m===0&&s===2?.5:f.exp((s/2-1)*f.log(m)-m/2-s/2*f.log(2)-u.gammaln(s/2))},cdf:function(m,s){return m<0?0:u.lowRegGamma(s/2,m/2)},inv:function(m,s){return 2*u.gammapinv(m,.5*s)},mean:function(m){return m},median:function(m){return m*f.pow(1-2/(9*m),3)},mode:function(m){return m-2>0?m-2:0},sample:function(m){return 2*u.randg(m/2)},variance:function(m){return 2*m}}),u.extend(u.exponential,{pdf:function(m,s){return m<0?0:s*f.exp(-s*m)},cdf:function(m,s){return m<0?0:1-f.exp(-s*m)},inv:function(m,s){return-f.log(1-m)/s},mean:function(m){return 1/m},median:function(m){return 1/m*f.log(2)},mode:function(){return 0},sample:function(m){return-1/m*f.log(u._random_fn())},variance:function(m){return f.pow(m,-2)}}),u.extend(u.gamma,{pdf:function(m,s,v){return m<0?0:m===0&&s===1?1/v:f.exp((s-1)*f.log(m)-m/v-u.gammaln(s)-s*f.log(v))},cdf:function(m,s,v){return m<0?0:u.lowRegGamma(s,m/v)},inv:function(m,s,v){return u.gammapinv(m,s)*v},mean:function(m,s){return m*s},mode:function(m,s){if(m>1)return(m-1)*s},sample:function(m,s){return u.randg(m)*s},variance:function(m,s){return m*s*s}}),u.extend(u.invgamma,{pdf:function(m,s,v){return m<=0?0:f.exp(-(s+1)*f.log(m)-v/m-u.gammaln(s)+s*f.log(v))},cdf:function(m,s,v){return m<=0?0:1-u.lowRegGamma(s,v/m)},inv:function(m,s,v){return v/u.gammapinv(1-m,s)},mean:function(m,s){return m>1?s/(m-1):void 0},mode:function(m,s){return s/(m+1)},sample:function(m,s){return s/u.randg(m)},variance:function(m,s){if(!(m<=2))return s*s/((m-1)*(m-1)*(m-2))}}),u.extend(u.kumaraswamy,{pdf:function(m,s,v){return m===0&&s===1?v:m===1&&v===1?s:f.exp(f.log(s)+f.log(v)+(s-1)*f.log(m)+(v-1)*f.log(1-f.pow(m,s)))},cdf:function(m,s,v){return m<0?0:m>1?1:1-f.pow(1-f.pow(m,s),v)},inv:function(m,s,v){return f.pow(1-f.pow(1-m,1/v),1/s)},mean:function(m,s){return s*u.gammafn(1+1/m)*u.gammafn(s)/u.gammafn(1+1/m+s)},median:function(m,s){return f.pow(1-f.pow(2,-1/s),1/m)},mode:function(m,s){if(m>=1&&s>=1&&m!==1&&s!==1)return f.pow((m-1)/(m*s-1),1/m)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(m,s,v){return m<=0?0:f.exp(-f.log(m)-.5*f.log(2*f.PI)-f.log(v)-f.pow(f.log(m)-s,2)/(2*v*v))},cdf:function(m,s,v){return m<0?0:.5+.5*u.erf((f.log(m)-s)/f.sqrt(2*v*v))},inv:function(m,s,v){return f.exp(-1.4142135623730951*v*u.erfcinv(2*m)+s)},mean:function(m,s){return f.exp(m+s*s/2)},median:function(m){return f.exp(m)},mode:function(m,s){return f.exp(m-s*s)},sample:function(m,s){return f.exp(u.randn()*s+m)},variance:function(m,s){return(f.exp(s*s)-1)*f.exp(2*m+s*s)}}),u.extend(u.noncentralt,{pdf:function(m,s,v){return f.abs(v)<1e-14?u.studentt.pdf(m,s):f.abs(m)<1e-14?f.exp(u.gammaln((s+1)/2)-v*v/2-.5*f.log(f.PI*s)-u.gammaln(s/2)):s/m*(u.noncentralt.cdf(m*f.sqrt(1+2/s),s+2,v)-u.noncentralt.cdf(m,s,v))},cdf:function(m,s,v){var j=1e-14;if(f.abs(v)<j)return u.studentt.cdf(m,s);var g=!1;m<0&&(g=!0,v=-v);for(var T=u.normal.cdf(-v,0,1),D=j+1,L=D,_=m*m/(m*m+s),F=0,M=f.exp(-v*v/2),B=f.exp(-v*v/2-.5*f.log(2)-u.gammaln(1.5))*v;F<200||L>j||D>j;)L=D,F>0&&(M*=v*v/(2*F),B*=v*v/(2*(F+.5))),T+=.5*(D=M*u.beta.cdf(_,F+.5,s/2)+B*u.beta.cdf(_,F+1,s/2)),F++;return g?1-T:T}}),u.extend(u.normal,{pdf:function(m,s,v){return f.exp(-.5*f.log(2*f.PI)-f.log(v)-f.pow(m-s,2)/(2*v*v))},cdf:function(m,s,v){return .5*(1+u.erf((m-s)/f.sqrt(2*v*v)))},inv:function(m,s,v){return-1.4142135623730951*v*u.erfcinv(2*m)+s},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},sample:function(m,s){return u.randn()*s+m},variance:function(m,s){return s*s}}),u.extend(u.pareto,{pdf:function(m,s,v){return m<s?0:v*f.pow(s,v)/f.pow(m,v+1)},cdf:function(m,s,v){return m<s?0:1-f.pow(s/m,v)},inv:function(m,s,v){return s/f.pow(1-m,1/v)},mean:function(m,s){if(!(s<=1))return s*f.pow(m,s)/(s-1)},median:function(m,s){return m*(s*f.SQRT2)},mode:function(m){return m},variance:function(m,s){if(!(s<=2))return m*m*s/(f.pow(s-1,2)*(s-2))}}),u.extend(u.studentt,{pdf:function(m,s){return s=s>1e100?1e100:s,1/(f.sqrt(s)*u.betafn(.5,s/2))*f.pow(1+m*m/s,-(s+1)/2)},cdf:function(m,s){var v=s/2;return u.ibeta((m+f.sqrt(m*m+s))/(2*f.sqrt(m*m+s)),v,v)},inv:function(m,s){var v=u.ibetainv(2*f.min(m,1-m),.5*s,.5);return v=f.sqrt(s*(1-v)/v),m>.5?v:-v},mean:function(m){return m>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(m){return u.randn()*f.sqrt(m/(2*u.randg(m/2)))},variance:function(m){return m>2?m/(m-2):m>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(m,s,v){return m<0||s<0||v<0?0:v/s*f.pow(m/s,v-1)*f.exp(-f.pow(m/s,v))},cdf:function(m,s,v){return m<0?0:1-f.exp(-f.pow(m/s,v))},inv:function(m,s,v){return s*f.pow(-f.log(1-m),1/v)},mean:function(m,s){return m*u.gammafn(1+1/s)},median:function(m,s){return m*f.pow(f.log(2),1/s)},mode:function(m,s){return s<=1?0:m*f.pow((s-1)/s,1/s)},sample:function(m,s){return m*f.pow(-f.log(u._random_fn()),1/s)},variance:function(m,s){return m*m*u.gammafn(1+2/s)-f.pow(u.weibull.mean(m,s),2)}}),u.extend(u.uniform,{pdf:function(m,s,v){return m<s||m>v?0:1/(v-s)},cdf:function(m,s,v){return m<s?0:m<v?(m-s)/(v-s):1},inv:function(m,s,v){return s+m*(v-s)},mean:function(m,s){return .5*(m+s)},median:function(m,s){return u.mean(m,s)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,s){return m/2+s/2+(s/2-m/2)*(2*u._random_fn()-1)},variance:function(m,s){return f.pow(s-m,2)/12}}),u.extend(u.binomial,{pdf:function(m,s,v){return v===0||v===1?s*v===m?1:0:u.combination(s,m)*f.pow(v,m)*f.pow(1-v,s-m)},cdf:function(m,s,v){var j,g=1e-10;if(m<0)return 0;if(m>=s)return 1;if(v<0||v>1||s<=0)return NaN;var T=v,D=(m=f.floor(m))+1,L=s-m,_=D+L,F=f.exp(u.gammaln(_)-u.gammaln(L)-u.gammaln(D)+D*f.log(T)+L*f.log(1-T));return j=T<(D+1)/(_+2)?F*S(T,D,L,g):1-F*S(1-T,L,D,g),f.round(1/g*(1-j))/(1/g)}}),u.extend(u.negbin,{pdf:function(m,s,v){return m===m>>>0&&(m<0?0:u.combination(m+s-1,s-1)*f.pow(1-v,m)*f.pow(v,s))},cdf:function(m,s,v){var j=0,g=0;if(m<0)return 0;for(;g<=m;g++)j+=u.negbin.pdf(g,s,v);return j}}),u.extend(u.hypgeom,{pdf:function(m,s,v,j){if(m!=m|0)return!1;if(m<0||m<v-(s-j)||m>j||m>v)return 0;if(2*v>s)return 2*j>s?u.hypgeom.pdf(s-v-j+m,s,s-v,s-j):u.hypgeom.pdf(j-m,s,s-v,j);if(2*j>s)return u.hypgeom.pdf(v-m,s,v,s-j);if(v<j)return u.hypgeom.pdf(m,s,j,v);for(var g=1,T=0,D=0;D<m;D++){for(;g>1&&T<j;)g*=1-v/(s-T),T++;g*=(j-D)*(v-D)/((D+1)*(s-v-j+D+1))}for(;T<j;T++)g*=1-v/(s-T);return f.min(1,f.max(0,g))},cdf:function(m,s,v,j){if(m<0||m<v-(s-j))return 0;if(m>=j||m>=v)return 1;if(2*v>s)return 2*j>s?u.hypgeom.cdf(s-v-j+m,s,s-v,s-j):1-u.hypgeom.cdf(j-m-1,s,s-v,j);if(2*j>s)return 1-u.hypgeom.cdf(v-m-1,s,v,s-j);if(v<j)return u.hypgeom.cdf(m,s,j,v);for(var g=1,T=1,D=0,L=0;L<m;L++){for(;g>1&&D<j;){var _=1-v/(s-D);T*=_,g*=_,D++}g+=T*=(j-L)*(v-L)/((L+1)*(s-v-j+L+1))}for(;D<j;D++)g*=1-v/(s-D);return f.min(1,f.max(0,g))}}),u.extend(u.poisson,{pdf:function(m,s){return s<0||m%1!=0||m<0?0:f.pow(s,m)*f.exp(-s)/u.factorial(m)},cdf:function(m,s){var v=[],j=0;if(m<0)return 0;for(;j<=m;j++)v.push(u.poisson.pdf(j,s));return u.sum(v)},mean:function(m){return m},variance:function(m){return m},sampleSmall:function(m){var s=1,v=0,j=f.exp(-m);do v++,s*=u._random_fn();while(s>j);return v-1},sampleLarge:function(m){var s,v,j,g,T,D,L,_,F,M,B=m;for(g=f.sqrt(B),T=f.log(B),D=.02483*(L=.931+2.53*g)-.059,_=1.1239+1.1328/(L-3.4),F=.9277-3.6224/(L-2);;)if(v=f.random()-.5,j=f.random(),M=.5-f.abs(v),s=f.floor((2*D/M+L)*v+B+.43),M>=.07&&j<=F||!(s<0||M<.013&&j>M)&&f.log(j)+f.log(_)-f.log(D/(M*M)+L)<=s*T-B-u.loggam(s+1))return s},sample:function(m){return m<10?this.sampleSmall(m):this.sampleLarge(m)}}),u.extend(u.triangular,{pdf:function(m,s,v,j){return v<=s||j<s||j>v?NaN:m<s||m>v?0:m<j?2*(m-s)/((v-s)*(j-s)):m===j?2/(v-s):2*(v-m)/((v-s)*(v-j))},cdf:function(m,s,v,j){return v<=s||j<s||j>v?NaN:m<=s?0:m>=v?1:m<=j?f.pow(m-s,2)/((v-s)*(j-s)):1-f.pow(v-m,2)/((v-s)*(v-j))},inv:function(m,s,v,j){return v<=s||j<s||j>v?NaN:m<=(j-s)/(v-s)?s+(v-s)*f.sqrt(m*((j-s)/(v-s))):s+(v-s)*(1-f.sqrt((1-m)*(1-(j-s)/(v-s))))},mean:function(m,s,v){return(m+s+v)/3},median:function(m,s,v){return v<=(m+s)/2?s-f.sqrt((s-m)*(s-v))/f.sqrt(2):v>(m+s)/2?m+f.sqrt((s-m)*(v-m))/f.sqrt(2):void 0},mode:function(m,s,v){return v},sample:function(m,s,v){var j=u._random_fn();return j<(v-m)/(s-m)?m+f.sqrt(j*(s-m)*(v-m)):s-f.sqrt((1-j)*(s-m)*(s-v))},variance:function(m,s,v){return(m*m+s*s+v*v-m*s-m*v-s*v)/18}}),u.extend(u.arcsine,{pdf:function(m,s,v){return v<=s?NaN:m<=s||m>=v?0:2/f.PI*f.pow(f.pow(v-s,2)-f.pow(2*m-s-v,2),-.5)},cdf:function(m,s,v){return m<s?0:m<v?2/f.PI*f.asin(f.sqrt((m-s)/(v-s))):1},inv:function(m,s,v){return s+(.5-.5*f.cos(f.PI*m))*(v-s)},mean:function(m,s){return s<=m?NaN:(m+s)/2},median:function(m,s){return s<=m?NaN:(m+s)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,s){return(m+s)/2+(s-m)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(m,s){return s<=m?NaN:f.pow(s-m,2)/8}}),u.extend(u.laplace,{pdf:function(m,s,v){return v<=0?0:f.exp(-f.abs(m-s)/v)/(2*v)},cdf:function(m,s,v){return v<=0?0:m<s?.5*f.exp((m-s)/v):1-.5*f.exp(-(m-s)/v)},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},variance:function(m,s){return 2*s*s},sample:function(m,s){var v,j=u._random_fn()-.5;return m-s*((v=j)/f.abs(v))*f.log(1-2*f.abs(j))}}),u.extend(u.tukey,{cdf:function(m,s,v){var j=s,g=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],T=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(m<=0)return 0;if(v<2||j<2)return NaN;if(!Number.isFinite(m))return 1;if(v>25e3)return I(m,1,j);var D,L=.5*v,_=L*f.log(v)-v*f.log(2)-u.gammaln(L),F=L-1,M=.25*v;D=v<=100?1:v<=800?.5:v<=5e3?.25:.125,_+=f.log(D);for(var B=0,K=1;K<=50;K++){for(var H=0,te=(2*K-1)*D,se=1;se<=16;se++){var Q,pe;8<se?(Q=se-8-1,pe=_+F*f.log(te+g[Q]*D)-(g[Q]*D+te)*M):(Q=se-1,pe=_+F*f.log(te-g[Q]*D)+(g[Q]*D-te)*M),pe>=-30&&(H+=I(8<se?m*f.sqrt(.5*(g[Q]*D+te)):m*f.sqrt(.5*(-g[Q]*D+te)),1,j)*T[Q]*f.exp(pe))}if(K*D>=1&&H<=1e-14)break;B+=H}if(H>1e-14)throw new Error("tukey.cdf failed to converge");return B>1&&(B=1),B},inv:function(m,s,v){if(v<2||s<2)return NaN;if(m<0||m>1)return NaN;if(m===0)return 0;if(m===1)return 1/0;var j,g=function(F,M,B){var K=.5-.5*F,H=f.sqrt(f.log(1/(K*K))),te=H+((((-453642210148e-16*H-.204231210125)*H-.342242088547)*H-1)*H+.322232421088)/((((.0038560700634*H+.10353775285)*H+.531103462366)*H+.588581570495)*H+.099348462606);B<120&&(te+=(te*te*te+te)/B/4);var se=.8832-.2368*te;return B<120&&(se+=-1.214/B+1.208*te/B),te*(se*f.log(M-1)+1.4142)}(m,s,v),T=u.tukey.cdf(g,s,v)-m;j=T>0?f.max(0,g-1):g+1;for(var D,L=u.tukey.cdf(j,s,v)-m,_=1;_<50;_++)if(D=j-L*(j-g)/(L-T),T=L,g=j,D<0&&(D=0,L=-m),L=u.tukey.cdf(D,s,v)-m,j=D,f.abs(j-g)<1e-4)return D;throw new Error("tukey.inv failed to converge")}})}(d,Math),function(u,f){var S,I,m=Array.prototype.push,s=u.utils.isArray;function v(j){return s(j)||j instanceof u}u.extend({add:function(j,g){return v(g)?(v(g[0])||(g=[g]),u.map(j,function(T,D,L){return T+g[D][L]})):u.map(j,function(T){return T+g})},subtract:function(j,g){return v(g)?(v(g[0])||(g=[g]),u.map(j,function(T,D,L){return T-g[D][L]||0})):u.map(j,function(T){return T-g})},divide:function(j,g){return v(g)?(v(g[0])||(g=[g]),u.multiply(j,u.inv(g))):u.map(j,function(T){return T/g})},multiply:function(j,g){var T,D,L,_,F,M,B,K;if(j.length===void 0&&g.length===void 0)return j*g;if(F=j.length,M=j[0].length,B=u.zeros(F,L=v(g)?g[0].length:M),K=0,v(g)){for(;K<L;K++)for(T=0;T<F;T++){for(_=0,D=0;D<M;D++)_+=j[T][D]*g[D][K];B[T][K]=_}return F===1&&K===1?B[0][0]:B}return u.map(j,function(H){return H*g})},outer:function(j,g){return u.multiply(j.map(function(T){return[T]}),[g])},dot:function(j,g){v(j[0])||(j=[j]),v(g[0])||(g=[g]);for(var T,D,L=j[0].length===1&&j.length!==1?u.transpose(j):j,_=g[0].length===1&&g.length!==1?u.transpose(g):g,F=[],M=0,B=L.length,K=L[0].length;M<B;M++){for(F[M]=[],T=0,D=0;D<K;D++)T+=L[M][D]*_[M][D];F[M]=T}return F.length===1?F[0]:F},pow:function(j,g){return u.map(j,function(T){return f.pow(T,g)})},exp:function(j){return u.map(j,function(g){return f.exp(g)})},log:function(j){return u.map(j,function(g){return f.log(g)})},abs:function(j){return u.map(j,function(g){return f.abs(g)})},norm:function(j,g){var T=0,D=0;for(isNaN(g)&&(g=2),v(j[0])&&(j=j[0]);D<j.length;D++)T+=f.pow(f.abs(j[D]),g);return f.pow(T,1/g)},angle:function(j,g){return f.acos(u.dot(j,g)/(u.norm(j)*u.norm(g)))},aug:function(j,g){var T,D=[];for(T=0;T<j.length;T++)D.push(j[T].slice());for(T=0;T<D.length;T++)m.apply(D[T],g[T]);return D},inv:function(j){for(var g,T=j.length,D=j[0].length,L=u.identity(T,D),_=u.gauss_jordan(j,L),F=[],M=0;M<T;M++)for(F[M]=[],g=D;g<_[0].length;g++)F[M][g-D]=_[M][g];return F},det:function j(g){if(g.length===2)return g[0][0]*g[1][1]-g[0][1]*g[1][0];for(var T=0,D=0;D<g.length;D++){for(var L=[],_=1;_<g.length;_++){L[_-1]=[];for(var F=0;F<g.length;F++)F<D?L[_-1][F]=g[_][F]:F>D&&(L[_-1][F-1]=g[_][F])}var M=D%2?-1:1;T+=j(L)*g[0][D]*M}return T},gauss_elimination:function(j,g){var T,D,L,_,F=0,M=0,B=j.length,K=j[0].length,H=1,te=0,se=[];for(T=(j=u.aug(j,g))[0].length,F=0;F<B;F++){for(D=j[F][F],M=F,_=F+1;_<K;_++)D<f.abs(j[_][F])&&(D=j[_][F],M=_);if(M!=F)for(_=0;_<T;_++)L=j[F][_],j[F][_]=j[M][_],j[M][_]=L;for(M=F+1;M<B;M++)for(H=j[M][F]/j[F][F],_=F;_<T;_++)j[M][_]=j[M][_]-H*j[F][_]}for(F=B-1;F>=0;F--){for(te=0,M=F+1;M<=B-1;M++)te+=se[M]*j[F][M];se[F]=(j[F][T-1]-te)/j[F][F]}return se},gauss_jordan:function(j,g){var T,D,L,_=u.aug(j,g),F=_.length,M=_[0].length,B=0;for(D=0;D<F;D++){var K=D;for(L=D+1;L<F;L++)f.abs(_[L][D])>f.abs(_[K][D])&&(K=L);var H=_[D];for(_[D]=_[K],_[K]=H,L=D+1;L<F;L++)for(B=_[L][D]/_[D][D],T=D;T<M;T++)_[L][T]-=_[D][T]*B}for(D=F-1;D>=0;D--){for(B=_[D][D],L=0;L<D;L++)for(T=M-1;T>D-1;T--)_[L][T]-=_[D][T]*_[L][D]/B;for(_[D][D]/=B,T=F;T<M;T++)_[D][T]/=B}return _},triaUpSolve:function(j,g){var T,D=j[0].length,L=u.zeros(1,D)[0],_=!1;return g[0].length!=null&&(g=g.map(function(F){return F[0]}),_=!0),u.arange(D-1,-1,-1).forEach(function(F){T=u.arange(F+1,D).map(function(M){return L[M]*j[F][M]}),L[F]=(g[F]-u.sum(T))/j[F][F]}),_?L.map(function(F){return[F]}):L},triaLowSolve:function(j,g){var T,D=j[0].length,L=u.zeros(1,D)[0],_=!1;return g[0].length!=null&&(g=g.map(function(F){return F[0]}),_=!0),u.arange(D).forEach(function(F){T=u.arange(F).map(function(M){return j[F][M]*L[M]}),L[F]=(g[F]-u.sum(T))/j[F][F]}),_?L.map(function(F){return[F]}):L},lu:function(j){var g,T=j.length,D=u.identity(T),L=u.zeros(j.length,j[0].length);return u.arange(T).forEach(function(_){L[0][_]=j[0][_]}),u.arange(1,T).forEach(function(_){u.arange(_).forEach(function(F){g=u.arange(F).map(function(M){return D[_][M]*L[M][F]}),D[_][F]=(j[_][F]-u.sum(g))/L[F][F]}),u.arange(_,T).forEach(function(F){g=u.arange(_).map(function(M){return D[_][M]*L[M][F]}),L[_][F]=j[g.length][F]-u.sum(g)})}),[D,L]},cholesky:function(j){var g,T=j.length,D=u.zeros(j.length,j[0].length);return u.arange(T).forEach(function(L){g=u.arange(L).map(function(_){return f.pow(D[L][_],2)}),D[L][L]=f.sqrt(j[L][L]-u.sum(g)),u.arange(L+1,T).forEach(function(_){g=u.arange(L).map(function(F){return D[L][F]*D[_][F]}),D[_][L]=(j[L][_]-u.sum(g))/D[L][L]})}),D},gauss_jacobi:function(j,g,T,D){for(var L,_,F,M,B=0,K=0,H=j.length,te=[],se=[],Q=[];B<H;B++)for(te[B]=[],se[B]=[],Q[B]=[],K=0;K<H;K++)B>K?(te[B][K]=j[B][K],se[B][K]=Q[B][K]=0):B<K?(se[B][K]=j[B][K],te[B][K]=Q[B][K]=0):(Q[B][K]=j[B][K],te[B][K]=se[B][K]=0);for(F=u.multiply(u.multiply(u.inv(Q),u.add(te,se)),-1),_=u.multiply(u.inv(Q),g),L=T,M=u.add(u.multiply(F,T),_),B=2;f.abs(u.norm(u.subtract(M,L)))>D;)L=M,M=u.add(u.multiply(F,L),_),B++;return M},gauss_seidel:function(j,g,T,D){for(var L,_,F,M,B,K=0,H=j.length,te=[],se=[],Q=[];K<H;K++)for(te[K]=[],se[K]=[],Q[K]=[],L=0;L<H;L++)K>L?(te[K][L]=j[K][L],se[K][L]=Q[K][L]=0):K<L?(se[K][L]=j[K][L],te[K][L]=Q[K][L]=0):(Q[K][L]=j[K][L],te[K][L]=se[K][L]=0);for(M=u.multiply(u.multiply(u.inv(u.add(Q,te)),se),-1),F=u.multiply(u.inv(u.add(Q,te)),g),_=T,B=u.add(u.multiply(M,T),F),K=2;f.abs(u.norm(u.subtract(B,_)))>D;)_=B,B=u.add(u.multiply(M,_),F),K+=1;return B},SOR:function(j,g,T,D,L){for(var _,F,M,B,K,H=0,te=j.length,se=[],Q=[],pe=[];H<te;H++)for(se[H]=[],Q[H]=[],pe[H]=[],_=0;_<te;_++)H>_?(se[H][_]=j[H][_],Q[H][_]=pe[H][_]=0):H<_?(Q[H][_]=j[H][_],se[H][_]=pe[H][_]=0):(pe[H][_]=j[H][_],se[H][_]=Q[H][_]=0);for(B=u.multiply(u.inv(u.add(pe,u.multiply(se,L))),u.subtract(u.multiply(pe,1-L),u.multiply(Q,L))),M=u.multiply(u.multiply(u.inv(u.add(pe,u.multiply(se,L))),g),L),F=T,K=u.add(u.multiply(B,T),M),H=2;f.abs(u.norm(u.subtract(K,F)))>D;)F=K,K=u.add(u.multiply(B,F),M),H++;return K},householder:function(j){for(var g,T,D,L,_=j.length,F=j[0].length,M=0,B=[],K=[];M<_-1;M++){for(g=0,L=M+1;L<F;L++)g+=j[L][M]*j[L][M];for(g=(j[M+1][M]>0?-1:1)*f.sqrt(g),T=f.sqrt((g*g-j[M+1][M]*g)/2),(B=u.zeros(_,1))[M+1][0]=(j[M+1][M]-g)/(2*T),D=M+2;D<_;D++)B[D][0]=j[D][M]/(2*T);K=u.subtract(u.identity(_,F),u.multiply(u.multiply(B,u.transpose(B)),2)),j=u.multiply(K,u.multiply(j,K))}return j},QR:(S=u.sum,I=u.arange,function(j){var g,T,D,L=j.length,_=j[0].length,F=u.zeros(_,_);for(j=u.copy(j),T=0;T<_;T++){for(F[T][T]=f.sqrt(S(I(L).map(function(M){return j[M][T]*j[M][T]}))),g=0;g<L;g++)j[g][T]=j[g][T]/F[T][T];for(D=T+1;D<_;D++)for(F[T][D]=S(I(L).map(function(M){return j[M][T]*j[M][D]})),g=0;g<L;g++)j[g][D]=j[g][D]-j[g][T]*F[T][D]}return[j,F]}),lstsq:function(j,g){var T=!1;g[0].length===void 0&&(g=g.map(function(te){return[te]}),T=!0);var D=u.QR(j),L=D[0],_=D[1],F=j[0].length,M=u.slice(L,{col:{end:F}}),B=function(te){var se=(te=u.copy(te)).length,Q=u.identity(se);return u.arange(se-1,-1,-1).forEach(function(pe){u.sliceAssign(Q,{row:pe},u.divide(u.slice(Q,{row:pe}),te[pe][pe])),u.sliceAssign(te,{row:pe},u.divide(u.slice(te,{row:pe}),te[pe][pe])),u.arange(pe).forEach(function(fe){var me=u.multiply(te[fe][pe],-1),oe=u.slice(te,{row:fe}),Pe=u.multiply(u.slice(te,{row:pe}),me);u.sliceAssign(te,{row:fe},u.add(oe,Pe));var Ae=u.slice(Q,{row:fe}),Ne=u.multiply(u.slice(Q,{row:pe}),me);u.sliceAssign(Q,{row:fe},u.add(Ae,Ne))})}),Q}(u.slice(_,{row:{end:F}})),K=u.transpose(M);K[0].length===void 0&&(K=[K]);var H=u.multiply(u.multiply(B,K),g);return H.length===void 0&&(H=[[H]]),T?H.map(function(te){return te[0]}):H},jacobi:function(j){for(var g,T,D,L,_,F,M,B=1,K=j.length,H=u.identity(K,K),te=[];B===1;){for(_=j[0][1],D=0,L=1,g=0;g<K;g++)for(T=0;T<K;T++)g!=T&&_<f.abs(j[g][T])&&(_=f.abs(j[g][T]),D=g,L=T);for(F=j[D][D]===j[L][L]?j[D][L]>0?f.PI/4:-f.PI/4:f.atan(2*j[D][L]/(j[D][D]-j[L][L]))/2,(M=u.identity(K,K))[D][D]=f.cos(F),M[D][L]=-f.sin(F),M[L][D]=f.sin(F),M[L][L]=f.cos(F),H=u.multiply(H,M),j=u.multiply(u.multiply(u.inv(M),j),M),B=0,g=1;g<K;g++)for(T=1;T<K;T++)g!=T&&f.abs(j[g][T])>.001&&(B=1)}for(g=0;g<K;g++)te.push(j[g][g]);return[H,te]},rungekutta:function(j,g,T,D,L,_){var F,M,B;if(_===2)for(;D<=T;)L+=((F=g*j(D,L))+(M=g*j(D+g,L+F)))/2,D+=g;if(_===4)for(;D<=T;)L+=((F=g*j(D,L))+2*(M=g*j(D+g/2,L+F/2))+2*(B=g*j(D+g/2,L+M/2))+g*j(D+g,L+B))/6,D+=g;return L},romberg:function(j,g,T,D){for(var L,_,F,M,B,K=0,H=(T-g)/2,te=[],se=[],Q=[];K<D/2;){for(B=j(g),F=g,M=0;F<=T;F+=H,M++)te[M]=F;for(L=te.length,F=1;F<L-1;F++)B+=(F%2!=0?4:2)*j(te[F]);B=H/3*(B+j(T)),Q[K]=B,H/=2,K++}for(_=Q.length,L=1;_!==1;){for(F=0;F<_-1;F++)se[F]=(f.pow(4,L)*Q[F+1]-Q[F])/(f.pow(4,L)-1);_=se.length,Q=se,se=[],L++}return Q},richardson:function(j,g,T,D){function L(pe,fe){for(var me,oe=0,Pe=pe.length;oe<Pe;oe++)pe[oe]===fe&&(me=oe);return me}for(var _,F,M,B,K,H=f.abs(T-j[L(j,T)+1]),te=0,se=[],Q=[];D>=H;)_=L(j,T+D),F=L(j,T),se[te]=(g[_]-2*g[F]+g[2*F-_])/(D*D),D/=2,te++;for(B=se.length,M=1;B!=1;){for(K=0;K<B-1;K++)Q[K]=(f.pow(4,M)*se[K+1]-se[K])/(f.pow(4,M)-1);B=Q.length,se=Q,Q=[],M++}return se},simpson:function(j,g,T,D){for(var L,_=(T-g)/D,F=j(g),M=[],B=g,K=0,H=1;B<=T;B+=_,K++)M[K]=B;for(L=M.length;H<L-1;H++)F+=(H%2!=0?4:2)*j(M[H]);return _/3*(F+j(T))},hermite:function(j,g,T,D){for(var L,_=j.length,F=0,M=0,B=[],K=[],H=[],te=[];M<_;M++){for(B[M]=1,L=0;L<_;L++)M!=L&&(B[M]*=(D-j[L])/(j[M]-j[L]));for(K[M]=0,L=0;L<_;L++)M!=L&&(K[M]+=1/(j[M]-j[L]));H[M]=(1-2*(D-j[M])*K[M])*(B[M]*B[M]),te[M]=(D-j[M])*(B[M]*B[M]),F+=H[M]*g[M]+te[M]*T[M]}return F},lagrange:function(j,g,T){for(var D,L,_=0,F=0,M=j.length;F<M;F++){for(L=g[F],D=0;D<M;D++)F!=D&&(L*=(T-j[D])/(j[F]-j[D]));_+=L}return _},cubic_spline:function(j,g,T){for(var D,L,_=j.length,F=0,M=[],B=[],K=[],H=[],te=[],se=[];F<_-1;F++)H[F]=j[F+1]-j[F];for(K[0]=0,F=1;F<_-1;F++)K[F]=3/H[F]*(g[F+1]-g[F])-3/H[F-1]*(g[F]-g[F-1]);for(F=1;F<_-1;F++)M[F]=[],B[F]=[],M[F][F-1]=H[F-1],M[F][F]=2*(H[F-1]+H[F]),M[F][F+1]=H[F],B[F][0]=K[F];for(L=u.multiply(u.inv(M),B),D=0;D<_-1;D++)te[D]=(g[D+1]-g[D])/H[D]-H[D]*(L[D+1][0]+2*L[D][0])/3,se[D]=(L[D+1][0]-L[D][0])/(3*H[D]);for(D=0;D<_&&!(j[D]>T);D++);return g[D-=1]+(T-j[D])*te[D]+u.sq(T-j[D])*L[D]+(T-j[D])*u.sq(T-j[D])*se[D]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var g,T,D,L,_,F=j.length,M=j[0].length,B=0,K=[],H=[],te=[],se=[],Q=[],pe=[],fe=[];for(B=0;B<F;B++)K[B]=u.sum(j[B])/M;for(B=0;B<M;B++)for(Q[B]=[],g=0;g<F;g++)Q[B][g]=j[g][B]-K[g];for(Q=u.transpose(Q),B=0;B<F;B++)for(pe[B]=[],g=0;g<F;g++)pe[B][g]=u.dot([Q[B]],[Q[g]])/(M-1);for(_=(D=u.jacobi(pe))[0],H=D[1],fe=u.transpose(_),B=0;B<H.length;B++)for(g=B;g<H.length;g++)H[B]<H[g]&&(T=H[B],H[B]=H[g],H[g]=T,te=fe[B],fe[B]=fe[g],fe[g]=te);for(L=u.transpose(Q),B=0;B<F;B++)for(se[B]=[],g=0;g<L.length;g++)se[B][g]=u.dot([fe[B]],[L[g]]);return[j,H,fe,se]}}),function(j){for(var g=0;g<j.length;g++)(function(T){u.fn[T]=function(D,L){var _=this;return L?(setTimeout(function(){L.call(_,u.fn[T].call(_,D))},15),this):typeof u[T](this,D)=="number"?u[T](this,D):u(u[T](this,D))}})(j[g])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(d,Math),function(u,f){var S=[].slice,I=u.utils.isNumber,m=u.utils.isArray;function s(v,j,g,T){if(v>1||g>1||v<=0||g<=0)throw new Error("Proportions should be greater than 0 and less than 1");var D=(v*j+g*T)/(j+T);return(v-g)/f.sqrt(D*(1-D)*(1/j+1/T))}u.extend({zscore:function(){var v=S.call(arguments);return I(v[1])?(v[0]-v[1])/v[2]:(v[0]-u.mean(v[1]))/u.stdev(v[1],v[2])},ztest:function(){var v,j=S.call(arguments);return m(j[1])?(v=u.zscore(j[0],j[1],j[3]),j[2]===1?u.normal.cdf(-f.abs(v),0,1):2*u.normal.cdf(-f.abs(v),0,1)):j.length>2?(v=u.zscore(j[0],j[1],j[2]),j[3]===1?u.normal.cdf(-f.abs(v),0,1):2*u.normal.cdf(-f.abs(v),0,1)):(v=j[0],j[1]===1?u.normal.cdf(-f.abs(v),0,1):2*u.normal.cdf(-f.abs(v),0,1))}}),u.extend(u.fn,{zscore:function(v,j){return(v-this.mean())/this.stdev(j)},ztest:function(v,j,g){var T=f.abs(this.zscore(v,g));return j===1?u.normal.cdf(-T,0,1):2*u.normal.cdf(-T,0,1)}}),u.extend({tscore:function(){var v=S.call(arguments);return v.length===4?(v[0]-v[1])/(v[2]/f.sqrt(v[3])):(v[0]-u.mean(v[1]))/(u.stdev(v[1],!0)/f.sqrt(v[1].length))},ttest:function(){var v,j=S.call(arguments);return j.length===5?(v=f.abs(u.tscore(j[0],j[1],j[2],j[3])),j[4]===1?u.studentt.cdf(-v,j[3]-1):2*u.studentt.cdf(-v,j[3]-1)):I(j[1])?(v=f.abs(j[0]),j[2]==1?u.studentt.cdf(-v,j[1]-1):2*u.studentt.cdf(-v,j[1]-1)):(v=f.abs(u.tscore(j[0],j[1])),j[2]==1?u.studentt.cdf(-v,j[1].length-1):2*u.studentt.cdf(-v,j[1].length-1))}}),u.extend(u.fn,{tscore:function(v){return(v-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(v,j){return j===1?1-u.studentt.cdf(f.abs(this.tscore(v)),this.cols()-1):2*u.studentt.cdf(-f.abs(this.tscore(v)),this.cols()-1)}}),u.extend({anovafscore:function(){var v,j,g,T,D,L,_,F,M=S.call(arguments);if(M.length===1){for(D=new Array(M[0].length),_=0;_<M[0].length;_++)D[_]=M[0][_];M=D}for(j=new Array,_=0;_<M.length;_++)j=j.concat(M[_]);for(g=u.mean(j),v=0,_=0;_<M.length;_++)v+=M[_].length*f.pow(u.mean(M[_])-g,2);for(v/=M.length-1,L=0,_=0;_<M.length;_++)for(T=u.mean(M[_]),F=0;F<M[_].length;F++)L+=f.pow(M[_][F]-T,2);return v/(L/(j.length-M.length))},anovaftest:function(){var v,j,g,T,D=S.call(arguments);if(I(D[0]))return 1-u.centralF.cdf(D[0],D[1],D[2]);var L=u.anovafscore(D);for(v=D.length-1,g=0,T=0;T<D.length;T++)g+=D[T].length;return j=g-v-1,1-u.centralF.cdf(L,v,j)},ftest:function(v,j,g){return 1-u.centralF.cdf(v,j,g)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var v,j=0;for(v=0;v<this.length;v++)j+=this[v].length;return u.ftest(this.anovafscore(),this.length-1,j-this.length)}}),u.extend({qscore:function(){var v,j,g,T,D,L=S.call(arguments);return I(L[0])?(v=L[0],j=L[1],g=L[2],T=L[3],D=L[4]):(v=u.mean(L[0]),j=u.mean(L[1]),g=L[0].length,T=L[1].length,D=L[2]),f.abs(v-j)/(D*f.sqrt((1/g+1/T)/2))},qtest:function(){var v,j=S.call(arguments);j.length===3?(v=j[0],j=j.slice(1)):j.length===7?(v=u.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(v=u.qscore(j[0],j[1],j[2]),j=j.slice(3));var g=j[0],T=j[1];return 1-u.tukey.cdf(v,T,g-T)},tukeyhsd:function(v){for(var j=u.pooledstdev(v),g=v.map(function(M){return u.mean(M)}),T=v.reduce(function(M,B){return M+B.length},0),D=[],L=0;L<v.length;++L)for(var _=L+1;_<v.length;++_){var F=u.qtest(g[L],g[_],v[L].length,v[_].length,j,T,v.length);D.push([[L,_],F])}return D}}),u.extend({normalci:function(){var v,j=S.call(arguments),g=new Array(2);return v=j.length===4?f.abs(u.normal.inv(j[1]/2,0,1)*j[2]/f.sqrt(j[3])):f.abs(u.normal.inv(j[1]/2,0,1)*u.stdev(j[2])/f.sqrt(j[2].length)),g[0]=j[0]-v,g[1]=j[0]+v,g},tci:function(){var v,j=S.call(arguments),g=new Array(2);return v=j.length===4?f.abs(u.studentt.inv(j[1]/2,j[3]-1)*j[2]/f.sqrt(j[3])):f.abs(u.studentt.inv(j[1]/2,j[2].length-1)*u.stdev(j[2],!0)/f.sqrt(j[2].length)),g[0]=j[0]-v,g[1]=j[0]+v,g},significant:function(v,j){return v<j}}),u.extend(u.fn,{normalci:function(v,j){return u.normalci(v,j,this.toArray())},tci:function(v,j){return u.tci(v,j,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(v,j,g,T){var D=s(v,j,g,T);return u.ztest(D,1)},twoSidedDifferenceOfProportions:function(v,j,g,T){var D=s(v,j,g,T);return u.ztest(D,2)}})}(d,Math),d.models=function(){function u(f,S){var I=f.length,m=S[0].length-1,s=I-m-1,v=d.lstsq(S,f),j=d.multiply(S,v.map(function(F){return[F]})).map(function(F){return F[0]}),g=d.subtract(f,j),T=d.mean(f),D=d.sum(j.map(function(F){return Math.pow(F-T,2)})),L=d.sum(f.map(function(F,M){return Math.pow(F-j[M],2)})),_=D+L;return{exog:S,endog:f,nobs:I,df_model:m,df_resid:s,coef:v,predict:j,resid:g,ybar:T,SST:_,SSE:D,SSR:L,R2:D/_}}return{ols:function(f,S){var I=u(f,S),m=function(j){var g,T,D=(g=j.exog,T=g[0].length,d.arange(T).map(function(H){var te=d.arange(T).filter(function(se){return se!==H});return u(d.col(g,H).map(function(se){return se[0]}),d.col(g,te))})),L=Math.sqrt(j.SSR/j.df_resid),_=D.map(function(H){var te=H.SST,se=H.R2;return L/Math.sqrt(te*(1-se))}),F=j.coef.map(function(H,te){return(H-0)/_[te]}),M=F.map(function(H){var te=d.studentt.cdf(H,j.df_resid);return 2*(te>.5?1-te:te)}),B=d.studentt.inv(.975,j.df_resid),K=j.coef.map(function(H,te){var se=B*_[te];return[H-se,H+se]});return{se:_,t:F,p:M,sigmaHat:L,interval95:K}}(I),s=function(j){var g,T,D,L=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:L,pvalue:1-(g=L,T=j.df_model,D=j.df_resid,d.beta.cdf(g/(D/T+g),T/2,D/2))}}(I),v=1-(1-I.R2)*((I.nobs-1)/I.df_resid);return I.t=m,I.f=s,I.adjust_R2=v,I}}}(),d.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),f=0;f<arguments.length;f++)u[f]=[1].concat(arguments[f]);return d(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),f=0;f<arguments[0].length;f++)u[f]=[1].concat(arguments[0][f]);return d(u)},buildjxmatrix:function(u){for(var f=new Array(u.length),S=0;S<u.length;S++)f[S]=u[S];return d.builddxmatrix(f)},buildymatrix:function(u){return d(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,f){var S,I,m,s,v;if(u.cols()==f.rows()){if(f.rows()>1){for(s=[],S=0;S<u.rows();S++)for(s[S]=[],I=0;I<f.cols();I++){for(v=0,m=0;m<u.cols();m++)v+=u.toArray()[S][m]*f.toArray()[m][I];s[S][I]=v}return d(s)}for(s=[],S=0;S<u.rows();S++)for(s[S]=[],I=0;I<f.cols();I++){for(v=0,m=0;m<u.cols();m++)v+=u.toArray()[S][m]*f.toArray()[I];s[S][I]=v}return d(s)}},regress:function(u,f){var S=d.xtranspxinv(u),I=u.transpose(),m=d.matrixmult(d(S),I);return d.matrixmult(m,f)},regresst:function(u,f,S){var I=d.regress(u,f),m={anova:{}},s=d.jMatYBar(u,I);m.yBar=s;var v=f.mean();m.anova.residuals=d.residuals(f,s),m.anova.ssr=d.ssr(s,v),m.anova.msr=m.anova.ssr/(u[0].length-1),m.anova.sse=d.sse(f,s),m.anova.mse=m.anova.sse/(f.length-(u[0].length-1)-1),m.anova.sst=d.sst(f,v),m.anova.mst=m.anova.sst/(f.length-1),m.anova.r2=1-m.anova.sse/m.anova.sst,m.anova.r2<0&&(m.anova.r2=0),m.anova.fratio=m.anova.msr/m.anova.mse,m.anova.pvalue=d.anovaftest(m.anova.fratio,u[0].length-1,f.length-(u[0].length-1)-1),m.anova.rmse=Math.sqrt(m.anova.mse),m.anova.r2adj=1-m.anova.mse/m.anova.mst,m.anova.r2adj<0&&(m.anova.r2adj=0),m.stats=new Array(u[0].length);for(var j,g,T,D=d.xtranspxinv(u),L=0;L<I.length;L++)j=Math.sqrt(m.anova.mse*Math.abs(D[L][L])),g=Math.abs(I[L]/j),T=d.ttest(g,f.length-u[0].length-1,S),m.stats[L]=[I[L],j,g,T];return m.regress=I,m},xtranspx:function(u){return d.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var f=d.matrixmult(u.transpose(),u);return d.inv(f)},jMatYBar:function(u,f){var S=d.matrixmult(u,f);return new d(S)},residuals:function(u,f){return d.matrixsubtract(u,f)},ssr:function(u,f){for(var S=0,I=0;I<u.length;I++)S+=Math.pow(u[I]-f,2);return S},sse:function(u,f){for(var S=0,I=0;I<u.length;I++)S+=Math.pow(u[I]-f[I],2);return S},sst:function(u,f){for(var S=0,I=0;I<u.length;I++)S+=Math.pow(u[I]-f,2);return S},matrixsubtract:function(u,f){for(var S=new Array(u.length),I=0;I<u.length;I++){S[I]=new Array(u[I].length);for(var m=0;m<u[I].length;m++)S[I][m]=u[I][m]-f[I][m]}return d(S)}}),d.jStat=d,d)},960:function(O,d,u){const f=u(592);O.exports=function(S){function I(L,_){const F=_.split(".");let M=L;for(const B of F){if(M==null)return;M=M[B]}return M}for(let L=0;L<Object.keys(f).length;L++){let _,F=Object.keys(f)[L],M=[];if(typeof f[F]=="object"){M=Object.keys(f[F]),_=Object.values(f[F]);for(let B=0;B<_.length;B++)if(typeof _[B]=="object"){let K=M[B];f[F][K]&&(M=[...M,...Object.keys(f[F][K]).map(H=>K+"."+H)],M.splice(M.indexOf(K),1))}}if(M.length<1)S[F]=f[F];else for(let B=0;B<M.length;B++)typeof I(f[F],M[B])=="function"&&(S[F]=I(f[F],M[B]))}let m=function(L){return typeof L=="number"&&(L=parseInt(L)),L},s=null,v=null,j=null;S.TABLE=function(){return j},S.COLUMN=S.COL=function(){return j.tracking&&j.tracking.push(D.getColumnNameFromCoords(m(s),m(v))),m(s)+1},S.ROW=function(){return j.tracking&&j.tracking.push(D.getColumnNameFromCoords(m(s),m(v))),m(v)+1},S.CELL=function(){return D.getColumnNameFromCoords(s,v)},S.VALUE=function(L,_,F){return j.getValueFromCoords(m(L)-1,m(_)-1,F)},S.THISROWCELL=function(L){return j.getValueFromCoords(m(L)-1,m(v))};const g=function(L,_){for(let F=0;F<L.length;F++){let M=D.getTokensFromRange(L[F]);_=_.replace(L[F],"["+M.join(",")+"]")}return _},T=function(L){return typeof L=="string"&&(L=L.trim()),!isNaN(L)&&L!==null&&L!==""},D=function(L,_,F,M,B){j=B,s=F,v=M;let K="",H={};if(_)if(_.size){let Q,pe=null;_.forEach(function(fe,me){Q=me.replace(/!/g,"."),Q.indexOf(".")!==-1&&(Q=Q.split("."),H[Q[0]]=!0)}),Q=Object.keys(H);for(let fe=0;fe<Q.length;fe++)K+="var "+Q[fe]+" = {};";_.forEach(function(fe,me){Q=me.replace(/!/g,"."),fe===null||T(fe)||(pe=fe.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),pe&&pe.length&&(fe=updateRanges(pe,fe))),Q.indexOf(".")>0?K+=Q+" = "+_.get(me)+`;
`:K+="var "+Q+" = "+fe+`;
`})}else{let Q=Object.keys(_);if(Q.length){let pe,fe={};for(let me=0;me<Q.length;me++)if(pe=Q[me].replace(/\!/g,"."),pe.indexOf(".")>0){let oe=oe.split(".");fe[oe[0]]={}}pe=Object.keys(fe);for(let me=0;me<pe.length;me++)K+="var "+pe[me]+" = {};";for(let me=0;me<Q.length;me++){if(pe=Q[me].replace(/!/g,"."),_[Q[me]]!==null&&!T(_[Q[me]])){let oe=_[Q[me]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);oe&&oe.length&&(_[Q[me]]=g(oe,_[Q[me]]))}pe.indexOf(".")>0?K+=pe+" = "+_[Q[me]]+`;
`:K+="var "+pe+" = "+_[Q[me]]+`;
`}}}let te=(L=function(Q,pe){let fe="",me=0,oe=["=","!",">","<"];for(let Pe=0;Pe<Q.length;Pe++)Q[Pe]==='"'&&(me=me===0?1:0),me===1?fe+=Q[Pe]:(fe+=Q[Pe].toUpperCase(),Pe>0&&Q[Pe]==="="&&oe.indexOf(Q[Pe-1])===-1&&oe.indexOf(Q[Pe+1])===-1&&(fe+="="));return fe=fe.replace(/\^/g,"**"),fe=fe.replace(/<>/g,"!="),fe=fe.replace(/&/g,"+"),fe=fe.replace(/\$/g,""),fe}(L=(L=L.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);te&&te.length&&(L=g(te,L));let se=new Function(K+"; return "+L)();return se===null&&(se=0),se};return D.getColumnNameFromCoords=function(L,_){return M="",(F=parseInt(L))>701?(M+=String.fromCharCode(64+parseInt(F/676)),M+=String.fromCharCode(64+parseInt(F%676/26))):F>25&&(M+=String.fromCharCode(64+parseInt(F/26))),M+String.fromCharCode(65+F%26)+(parseInt(_)+1);var F,M},D.getCoordsFromColumnName=function(L){var _=/^[a-zA-Z]+/.exec(L);if(_){for(var F=0,M=0;M<_[0].length;M++)F+=parseInt(_[0].charCodeAt(M)-64)*Math.pow(26,_[0].length-1-M);--F<0&&(F=0);var B=parseInt(/[0-9]+$/.exec(L))||null;return B>0&&B--,[F,B]}},D.getRangeFromTokens=function(L){L=L.filter(function(B){return B!="#REF!"});for(var _="",F="",M=0;M<L.length;M++)L[M].indexOf(".")>=0?_=".":L[M].indexOf("!")>=0&&(_="!"),_&&(F=L[M].split(_),L[M]=F[1],F=F[0]+_);return L.sort(function(B,K){var H=Helpers.getCoordsFromColumnName(B),te=Helpers.getCoordsFromColumnName(K);return H[1]>te[1]?1:H[1]<te[1]?-1:H[0]>te[0]?1:H[0]<te[0]?-1:0}),L.length?F+(L[0]+":")+L[L.length-1]:"#REF!"},D.getTokensFromRange=function(L){if(L.indexOf(".")>0){var _=L.split(".");L=_[1],_=_[0]+"."}else L.indexOf("!")>0?(_=L.split("!"),L=_[1],_=_[0]+"!"):_="";L=L.split(":");var F=D.getCoordsFromColumnName(L[0]),M=D.getCoordsFromColumnName(L[1]);if(F[0]<=M[0])var B=F[0],K=M[0];else B=M[0],K=F[0];if(F[1]===null&&M[1]==null)for(var H=null,te=null,se=Object.keys(vars),Q=0;Q<se.length;Q++){var pe=D.getCoordsFromColumnName(se[Q]);pe[0]===F[0]&&(H===null||pe[1]<H)&&(H=pe[1]),pe[0]===M[0]&&(te===null||pe[1]>te)&&(te=pe[1])}else F[1]<=M[1]?(H=F[1],te=M[1]):(H=M[1],te=F[1]);for(var fe=[],me=H;me<=te;me++){var oe=[];for(Q=B;Q<=K;Q++)oe.push(_+D.getColumnNameFromCoords(Q,me));fe.push(oe)}return fe},D.setFormula=function(L){let _=Object.keys(L);for(let F=0;F<_.length;F++)typeof L[_[F]]=="function"&&(S[_[F]]=L[_[F]])},D.basic=!0,D}(typeof window>"u"?u.g:window)},592:function(O,d,u){var f=u(162),S=u(765);const I=new Error("#NULL!"),m=new Error("#DIV/0!"),s=new Error("#VALUE!"),v=new Error("#REF!"),j=new Error("#NAME?"),g=new Error("#NUM!"),T=new Error("#N/A"),D=new Error("#ERROR!"),L=new Error("#GETTING_DATA");var _=Object.freeze({__proto__:null,data:L,div0:m,error:D,na:T,name:j,nil:I,num:g,ref:v,value:s});function F(t){const n=[];return M(t,c=>{n.push(c)}),n}function M(t,n){let c=-1;const w=t.length;for(;++c<w&&n(t[c],c,t)!==!1;);return t}function B(t){let n,c=t.length;for(;c--;)if(n=t[c],typeof n!="number")if(n!==!0)if(n!==!1){if(typeof n=="string"){const w=P(n);t[c]=w instanceof Error?0:w}}else t[c]=0;else t[c]=1;return t}function K(t,n){if(!t)return s;t.every(R=>Array.isArray(R))&&t.length!==0||(t=[[...t]]),t.map((R,z)=>{R.map((Z,de)=>{Z||(t[z][de]=0)})});const c=t.reduce((R,z,Z)=>z.length>t[R].length?Z:R,0),w=t[c].length;return t.map(R=>[...R,...Array(w-R.length).fill(0)])}function H(){let t;if(arguments.length===1){const c=arguments[0];t=(n=c)!=null&&typeof n.length=="number"&&typeof n!="string"?F.apply(null,arguments):[c]}else t=Array.from(arguments);for(var n;!se(t);)t=te(t);return t}function te(t){return t&&t.reduce?t.reduce((n,c)=>{const w=Array.isArray(n),R=Array.isArray(c);return w&&R?n.concat(c):w?(n.push(c),n):R?[n].concat(c):[n,c]}):[t]}function se(t){if(!t)return!1;for(let n=0;n<t.length;++n)if(Array.isArray(t[n]))return!1;return!0}function Q(t,n){return n=n||1,t&&typeof t.slice=="function"?t.slice(n):t}function pe(t){return t?t[0].map((n,c)=>t.map(w=>w[c])):s}function fe(t,n){let c=null;return M(t,(w,R)=>{if(w[0]===n)return c=R,!1}),c??s}function me(){for(let t=0;t<arguments.length;t++)if(arguments[t]instanceof Error)return arguments[t]}function oe(){let t=arguments.length;for(;t--;)if(arguments[t]instanceof Error)return!0;return!1}function Pe(t){return Math.round(t*1e14)/1e14}function Ae(){return H.apply(null,arguments).filter(t=>typeof t=="number")}function Ne(t){if(typeof t=="boolean"||t instanceof Error)return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){const n=t.toUpperCase();if(n==="TRUE")return!0;if(n==="FALSE")return!1}return t instanceof Date&&!isNaN(t)||s}function Fe(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);const n=parseFloat(t);return n<0||n>=2958466?g:function(c){c<60&&(c+=1);const w=Math.floor(c-25569),R=new Date(86400*w*1e3),z=c-Math.floor(c)+1e-7;let Z=Math.floor(86400*z);const de=Z%60;Z-=de;const we=Math.floor(Z/3600),_e=Math.floor(Z/60)%60;let Ke=R.getUTCDate(),Ze=R.getUTCMonth();return c>=60&&c<61&&(Ke=29,Ze=1),new Date(R.getUTCFullYear(),Ze,Ke,we,_e,de)}(n)}return typeof t!="string"||(t=/(\d{4})-(\d\d?)-(\d\d?)$/.test(t)?new Date(t+"T00:00:00.000"):new Date(t),isNaN(t))?s:t}function je(t){let n,c=t.length;for(;c--;){if(n=Fe(t[c]),n===s)return n;t[c]=n}return t}function P(t){return t instanceof Error?t:t==null?0:(typeof t=="boolean"&&(t=+t),isNaN(t)||t===""?s:parseFloat(t))}function Ce(t){let n,c;if(!t||(n=t.length)===0)return s;for(;n--;){if(t[n]instanceof Error)return t[n];if(c=P(t[n]),c instanceof Error)return c;t[n]=c}return t}function Be(t){return t instanceof Error?t:t==null?"":t.toString()}function et(){let t=arguments.length;for(;t--;)if(typeof arguments[t]=="string")return!0;return!1}function Me(t){return t!=null}const ye="=",ke=[">",">=","<","<=","=","<>"],Ee="operator",Ye="literal",Ge=[Ee,Ye],lt=Ee,at=Ye;function ft(t,n){if(Ge.indexOf(n)===-1)throw new Error("Unsupported token type: "+n);return{value:t,type:n}}function vt(t){return function(n){let c="";const w=[];for(let R=0;R<n.length;R++){const z=n[R];R===0&&ke.indexOf(z)>=0?w.push(ft(z,lt)):c+=z}return c.length>0&&w.push(ft(function(R){return typeof R!="string"||/^\d+(\.\d+)?$/.test(R)&&(R=R.indexOf(".")===-1?parseInt(R,10):parseFloat(R)),R}(c),at)),w.length>0&&w[0].type!==lt&&w.unshift(ft(ye,lt)),w}(function(n){const c=n.length,w=[];let R=0,z="",Z="";for(;R<c;){const de=n.charAt(R);switch(de){case">":case"<":case"=":Z+=de,z.length>0&&(w.push(z),z="");break;default:Z.length>0&&(w.push(Z),Z=""),z+=de}R++}return z.length>0&&w.push(z),Z.length>0&&w.push(Z),w}(t))}const jt=function(t){const n=[];let c;for(let w=0;w<t.length;w++){const R=t[w];switch(R.type){case lt:c=R.value;break;case at:n.push(R.value)}}return function(w,R){let z=!1;switch(R){case">":z=w[0]>w[1];break;case">=":z=w[0]>=w[1];break;case"<":z=w[0]<w[1];break;case"<=":z=w[0]<=w[1];break;case"=":z=w[0]==w[1];break;case"<>":z=w[0]!=w[1]}return z}(n,c)},Tt={};function At(t){return[s,v,m,g,j,I].indexOf(t)>=0||typeof t=="number"&&(isNaN(t)||!isFinite(t))}function Dt(t){return At(t)||t===T}function Lt(t){return t===!0||t===!1}function pt(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function wt(t){return typeof t=="string"}function St(){const t=[];for(let n=0;n<arguments.length;++n){let c=!1;const w=arguments[n];for(let R=0;R<t.length&&(c=t[R]===w,!c);++R);c||t.push(w)}return t}function A(t,n,c,w){if(!n||!c)return T;w=!(w===0||w===!1);let R=T;const z=typeof t=="number";let Z=!1;for(let de=0;de<n.length;de++){const we=n[de];if(we[0]===t){R=c<we.length+1?we[c-1]:v;break}!Z&&(z&&w&&we[0]<=t||w&&typeof we[0]=="string"&&we[0].localeCompare(t)<0)&&(R=c<we.length+1?we[c-1]:v),z&&we[0]>t&&(Z=!0)}return R}function k(){const t=H(arguments).filter(Me);if(t.length===0)return m;const n=me.apply(void 0,t);if(n)return n;const c=Ae(t),w=c.length;let R,z=0,Z=0;for(let de=0;de<w;de++)z+=c[de],Z+=1;return R=z/Z,isNaN(R)&&(R=g),R}function p(){const t=H(arguments).filter(Me);if(t.length===0)return m;const n=me.apply(void 0,t);if(n)return n;const c=t,w=c.length;let R,z=0,Z=0;for(let de=0;de<w;de++){const we=c[de];typeof we=="number"&&(z+=we),we===!0&&z++,we!==null&&Z++}return R=z/Z,isNaN(R)&&(R=g),R}Tt.TYPE=t=>{switch(t){case I:return 1;case m:return 2;case s:return 3;case v:return 4;case j:return 5;case g:return 6;case T:return 7;case L:return 8}return T};const a={DIST:function(t,n,c,w,R,z){return arguments.length<4?s:(R=R===void 0?0:R,z=z===void 0?1:z,oe(t=P(t),n=P(n),c=P(c),R=P(R),z=P(z))?s:(t=(t-R)/(z-R),w?f.beta.cdf(t,n,c):f.beta.pdf(t,n,c)))},INV:(t,n,c,w,R)=>(w=w===void 0?0:w,R=R===void 0?1:R,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R))?s:f.beta.inv(t,n,c)*(R-w)+w)},W={DIST:(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c),w=P(w))?s:w?f.binomial.cdf(t,n,c):f.binomial.pdf(t,n,c)};W.DIST.RANGE=(t,n,c,w)=>{if(w=w===void 0?c:w,oe(t=P(t),n=P(n),c=P(c),w=P(w)))return s;let R=0;for(let z=c;z<=w;z++)R+=rt(t,z)*Math.pow(n,z)*Math.pow(1-n,t-z);return R},W.INV=(t,n,c)=>{if(oe(t=P(t),n=P(n),c=P(c)))return s;let w=0;for(;w<=t;){if(f.binomial.cdf(w,t,n)>=c)return w;w++}};const ae={DIST:(t,n,c)=>oe(t=P(t),n=P(n))?s:c?f.chisquare.cdf(t,n):f.chisquare.pdf(t,n)};ae.DIST.RT=(t,n)=>!t|!n?T:t<1||n>Math.pow(10,10)?g:typeof t!="number"||typeof n!="number"?s:1-f.chisquare.cdf(t,n),ae.INV=(t,n)=>oe(t=P(t),n=P(n))?s:f.chisquare.inv(t,n),ae.INV.RT=(t,n)=>!t|!n?T:t<0||t>1||n<1||n>Math.pow(10,10)?g:typeof t!="number"||typeof n!="number"?s:f.chisquare.inv(1-t,n),ae.TEST=function(t,n){if(arguments.length!==2)return T;if(!(t instanceof Array&&n instanceof Array)||t.length!==n.length||t[0]&&n[0]&&t[0].length!==n[0].length)return s;const c=t.length;let w,R,z;for(R=0;R<c;R++)t[R]instanceof Array||(w=t[R],t[R]=[],t[R].push(w)),n[R]instanceof Array||(w=n[R],n[R]=[],n[R].push(w));const Z=t[0].length,de=Z===1?c-1:(c-1)*(Z-1);let we=0;const _e=Math.PI;for(R=0;R<c;R++)for(z=0;z<Z;z++)we+=Math.pow(t[R][z]-n[R][z],2)/n[R][z];return Math.round(1e6*function(Ke,Ze){let Qe=Math.exp(-.5*Ke);Ze%2==1&&(Qe*=Math.sqrt(2*Ke/_e));let it=Ze;for(;it>=2;)Qe=Qe*Ke/it,it-=2;let st=Qe,dt=Ze;for(;st>1e-10*Qe;)dt+=2,st=st*Ke/dt,Qe+=st;return 1-Qe}(we,de))/1e6};const ie={};function V(){return Ae(H(arguments)).length}function N(){const t=H(arguments);return t.length-Y(t)}function Y(){const t=H(arguments);let n,c=0;for(let w=0;w<t.length;w++)n=t[w],n!=null&&n!==""||c++;return c}ie.NORM=(t,n,c)=>oe(t=P(t),n=P(n),c=P(c))?s:f.normalci(1,t,n,c)[1]-1,ie.T=(t,n,c)=>oe(t=P(t),n=P(n),c=P(c))?s:f.tci(1,t,n,c)[1]-1;const ee={P:(t,n)=>{if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=f.mean(t),w=f.mean(n);let R=0;const z=t.length;for(let Z=0;Z<z;Z++)R+=(t[Z]-c)*(n[Z]-w);return R/z},S:(t,n)=>oe(t=Ce(H(t)),n=Ce(H(n)))?s:f.covariance(t,n)},ce={DIST:(t,n,c)=>oe(t=P(t),n=P(n))?s:c?f.exponential.cdf(t,n):f.exponential.pdf(t,n)},Se={};function ve(t,n,c){if(oe(t=P(t),n=Ce(H(n)),c=Ce(H(c))))return s;const w=f.mean(c),R=f.mean(n),z=c.length;let Z=0,de=0;for(let _e=0;_e<z;_e++)Z+=(c[_e]-w)*(n[_e]-R),de+=Math.pow(c[_e]-w,2);const we=Z/de;return R-we*w+we*t}function xe(t){return(t=P(t))instanceof Error?t:t===0||parseInt(t,10)===t&&t<0?g:f.gammafn(t)}function Re(t){return(t=P(t))instanceof Error?t:f.gammaln(t)}Se.DIST=(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c))?s:w?f.centralF.cdf(t,n,c):f.centralF.pdf(t,n,c),Se.DIST.RT=function(t,n,c){return arguments.length!==3?T:t<0||n<1||c<1?g:typeof t!="number"||typeof n!="number"||typeof c!="number"?s:1-f.centralF.cdf(t,n,c)},Se.INV=(t,n,c)=>oe(t=P(t),n=P(n),c=P(c))?s:t<=0||t>1?g:f.centralF.inv(t,n,c),Se.INV.RT=function(t,n,c){return arguments.length!==3?T:t<0||t>1||n<1||n>Math.pow(10,10)||c<1||c>Math.pow(10,10)?g:typeof t!="number"||typeof n!="number"||typeof c!="number"?s:f.centralF.inv(1-t,n,c)},Se.TEST=(t,n)=>{if(!t||!n||!(t instanceof Array&&n instanceof Array))return T;if(t.length<2||n.length<2)return m;const c=(z,Z)=>{let de=0;for(let we=0;we<z.length;we++)de+=Math.pow(z[we]-Z,2);return de},w=ut(t)/t.length,R=ut(n)/n.length;return c(t,w)/(t.length-1)/(c(n,R)/(n.length-1))},xe.DIST=function(t,n,c,w){return arguments.length!==4?T:t<0||n<=0||c<=0||typeof t!="number"||typeof n!="number"||typeof c!="number"?s:w?f.gamma.cdf(t,n,c,!0):f.gamma.pdf(t,n,c,!1)},xe.INV=function(t,n,c){return arguments.length!==3?T:t<0||t>1||n<=0||c<=0?g:typeof t!="number"||typeof n!="number"||typeof c!="number"?s:f.gamma.inv(t,n,c)},Re.PRECISE=function(t){return arguments.length!==1?T:t<=0?g:typeof t!="number"?s:f.gammaln(t)};const ze={};function $e(t,n){return oe(t=Ce(H(t)),n=P(n))?t:n<0||t.length<n?s:t.sort((c,w)=>w-c)[n-1]}function Je(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=f.mean(t),w=f.mean(n),R=n.length;let z=0,Z=0;for(let we=0;we<R;we++)z+=(n[we]-w)*(t[we]-c),Z+=Math.pow(n[we]-w,2);const de=z/Z;return[de,c-de*w]}ze.DIST=(t,n,c,w,R)=>{if(oe(t=P(t),n=P(n),c=P(c),w=P(w)))return s;function z(Z,de,we,_e){return rt(we,Z)*rt(_e-we,de-Z)/rt(_e,de)}return R?function(Z,de,we,_e){let Ke=0;for(let Ze=0;Ze<=Z;Ze++)Ke+=z(Ze,de,we,_e);return Ke}(t,n,c,w):z(t,n,c,w)};const nt={};function re(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;const c=Ae(t);return c.length===0?0:Math.max.apply(Math,c)}function ne(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;const c=B(t);let w=f.median(c);return isNaN(w)&&(w=g),w}function be(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;const c=Ae(t);return c.length===0?0:Math.min.apply(Math,c)}nt.DIST=(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c))?s:w?f.lognormal.cdf(t,n,c):f.lognormal.pdf(t,n,c),nt.INV=(t,n,c)=>oe(t=P(t),n=P(n),c=P(c))?s:f.lognormal.inv(t,n,c);const U={MULT:function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=t.length,c={};let w,R=[],z=0;for(let Z=0;Z<n;Z++)w=t[Z],c[w]=c[w]?c[w]+1:1,c[w]>z&&(z=c[w],R=[]),c[w]===z&&(R[R.length]=w);return R},SNGL:function(){const t=Ce(H(arguments));return t instanceof Error?t:U.MULT(t).sort((n,c)=>n-c)[0]}},X={DIST:(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c))?s:w?f.negbin.cdf(t,n,c):f.negbin.pdf(t,n,c)},C={};function q(t,n){if(oe(n=Ce(H(n)),t=Ce(H(t))))return s;const c=f.mean(t),w=f.mean(n),R=t.length;let z=0,Z=0,de=0;for(let we=0;we<R;we++)z+=(t[we]-c)*(n[we]-w),Z+=Math.pow(t[we]-c,2),de+=Math.pow(n[we]-w,2);return z/Math.sqrt(Z*de)}C.DIST=(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c))?s:c<=0?g:w?f.normal.cdf(t,n,c):f.normal.pdf(t,n,c),C.INV=(t,n,c)=>oe(t=P(t),n=P(n),c=P(c))?s:f.normal.inv(t,n,c),C.S={},C.S.DIST=(t,n)=>(t=P(t))instanceof Error?s:n?f.normal.cdf(t,0,1):f.normal.pdf(t,0,1),C.S.INV=t=>(t=P(t))instanceof Error?s:f.normal.inv(t,0,1);const G={EXC:(t,n)=>{if(oe(t=Ce(H(t)),n=P(n)))return s;const c=(t=t.sort((z,Z)=>z-Z)).length;if(n<1/(c+1)||n>1-1/(c+1))return g;const w=n*(c+1)-1,R=Math.floor(w);return Pe(w===R?t[w]:t[R]+(w-R)*(t[R+1]-t[R]))},INC:(t,n)=>{if(oe(t=Ce(H(t)),n=P(n)))return s;const c=n*((t=t.sort((R,z)=>R-z)).length-1),w=Math.floor(c);return Pe(c===w?t[c]:t[w]+(c-w)*(t[w+1]-t[w]))}},ge={EXC:(t,n,c)=>{if(c=c===void 0?3:c,oe(t=Ce(H(t)),n=P(n),c=P(c)))return s;t=t.sort((Ke,Ze)=>Ke-Ze);const w=St.apply(null,t),R=t.length,z=w.length,Z=Math.pow(10,c);let de=0,we=!1,_e=0;for(;!we&&_e<z;)n===w[_e]?(de=(t.indexOf(w[_e])+1)/(R+1),we=!0):n>=w[_e]&&(n<w[_e+1]||_e===z-1)&&(de=(t.indexOf(w[_e])+1+(n-w[_e])/(w[_e+1]-w[_e]))/(R+1),we=!0),_e++;return Math.floor(de*Z)/Z},INC:(t,n,c)=>{if(c=c===void 0?3:c,oe(t=Ce(H(t)),n=P(n),c=P(c)))return s;t=t.sort((Ke,Ze)=>Ke-Ze);const w=St.apply(null,t),R=t.length,z=w.length,Z=Math.pow(10,c);let de=0,we=!1,_e=0;for(;!we&&_e<z;)n===w[_e]?(de=t.indexOf(w[_e])/(R-1),we=!0):n>=w[_e]&&(n<w[_e+1]||_e===z-1)&&(de=(t.indexOf(w[_e])+(n-w[_e])/(w[_e+1]-w[_e]))/(R-1),we=!0),_e++;return Math.floor(de*Z)/Z}},J={DIST:(t,n,c)=>oe(t=P(t),n=P(n))?s:c?f.poisson.cdf(t,n):f.poisson.pdf(t,n)},he={EXC:(t,n)=>{if(oe(t=Ce(H(t)),n=P(n)))return s;switch(n){case 1:return G.EXC(t,.25);case 2:return G.EXC(t,.5);case 3:return G.EXC(t,.75);default:return g}},INC:(t,n)=>{if(oe(t=Ce(H(t)),n=P(n)))return s;switch(n){case 1:return G.INC(t,.25);case 2:return G.INC(t,.5);case 3:return G.INC(t,.75);default:return g}}},Te={};function qe(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=f.mean(t),c=t.length;let w=0;for(let R=0;R<c;R++)w+=Math.pow(t[R]-n,3);return c*w/((c-1)*(c-2)*Math.pow(f.stdev(t,!0),3))}function Ie(t,n){return oe(t=Ce(H(t)),n=P(n))?t:t.sort((c,w)=>c-w)[n-1]}Te.AVG=(t,n,c)=>{if(oe(t=P(t),n=Ce(H(n))))return s;const w=(c=c||!1)?(Z,de)=>Z-de:(Z,de)=>de-Z,R=(n=(n=H(n)).sort(w)).length;let z=0;for(let Z=0;Z<R;Z++)n[Z]===t&&z++;return z>1?(2*n.indexOf(t)+z+1)/2:n.indexOf(t)+1},Te.EQ=(t,n,c)=>{if(oe(t=P(t),n=Ce(H(n))))return s;const w=(c=c||!1)?(R,z)=>R-z:(R,z)=>z-R;return(n=n.sort(w)).indexOf(t)+1},qe.P=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=f.mean(t),c=t.length;let w=0,R=0;for(let z=0;z<c;z++)R+=Math.pow(t[z]-n,3),w+=Math.pow(t[z]-n,2);return R/=c,w/=c,R/Math.pow(w,1.5)};const Ve={P:function(){const t=tt.P.apply(this,arguments);let n=Math.sqrt(t);return isNaN(n)&&(n=g),n},S:function(){const t=tt.S.apply(this,arguments);return Math.sqrt(t)}},Ue={DIST:(t,n,c)=>c!==1&&c!==2?g:c===1?Ue.DIST.RT(t,n):Ue.DIST["2T"](t,n)};Ue.DIST["2T"]=function(t,n){return arguments.length!==2?T:t<0||n<1?g:typeof t!="number"||typeof n!="number"?s:2*(1-f.studentt.cdf(t,n))},Ue.DIST.RT=function(t,n){return arguments.length!==2?T:t<0||n<1?g:typeof t!="number"||typeof n!="number"?s:1-f.studentt.cdf(t,n)},Ue.INV=(t,n)=>oe(t=P(t),n=P(n))?s:f.studentt.inv(t,n),Ue.INV["2T"]=(t,n)=>(t=P(t),n=P(n),t<=0||t>1||n<1?g:oe(t,n)?s:Math.abs(f.studentt.inv(t/2,n))),Ue.TEST=(t,n)=>{if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=f.mean(t),w=f.mean(n);let R,z=0,Z=0;for(R=0;R<t.length;R++)z+=Math.pow(t[R]-c,2);for(R=0;R<n.length;R++)Z+=Math.pow(n[R]-w,2);z/=t.length-1,Z/=n.length-1;const de=Math.abs(c-w)/Math.sqrt(z/t.length+Z/n.length);return Ue.DIST["2T"](de,t.length+n.length-2)};const tt={};function le(){const t=H(arguments),n=t.length;let c=0,w=0;const R=p(t);for(let z=0;z<n;z++){const Z=t[z];c+=Math.pow(typeof Z=="number"?Z-R:Z===!0?1-R:0-R,2),Z!==null&&w++}return c/(w-1)}function De(){const t=H(arguments),n=t.length;let c=0,w=0;const R=p(t);let z;for(let Z=0;Z<n;Z++){const de=t[Z];c+=Math.pow(typeof de=="number"?de-R:de===!0?1-R:0-R,2),de!==null&&w++}return z=c/w,isNaN(z)&&(z=g),z}tt.P=function(){const t=Ae(H(arguments)),n=t.length;let c=0;const w=k(t);let R;for(let z=0;z<n;z++)c+=Math.pow(t[z]-w,2);return R=c/n,isNaN(R)&&(R=g),R},tt.S=function(){const t=Ae(H(arguments)),n=t.length;let c=0;const w=k(t);for(let R=0;R<n;R++)c+=Math.pow(t[R]-w,2);return c/(n-1)};const Le={DIST:(t,n,c,w)=>oe(t=P(t),n=P(n),c=P(c))?s:w?1-Math.exp(-Math.pow(t/c,n)):Math.pow(t,n-1)*Math.exp(-Math.pow(t/c,n))*n/Math.pow(c,n)},Xe={};function ot(t,n,c){const w=me(t=P(t),n=P(n),c=P(c));if(w)return w;if(n===0)return 0;n=Math.abs(n);const R=-Math.floor(Math.log(n)/Math.log(10));return t>=0?ct(Math.ceil(t/n)*n,R):c===0?-ct(Math.floor(Math.abs(t)/n)*n,R):-ct(Math.ceil(Math.abs(t)/n)*n,R)}function rt(t,n){return me(t=P(t),n=P(n))||(t<n?g:ue(t)/(ue(n)*ue(t-n)))}Xe.TEST=(t,n,c)=>{if(oe(t=Ce(H(t)),n=P(n)))return s;c=c||Ve.S(t);const w=t.length;return 1-C.S.DIST((k(t)-n)/(c/Math.sqrt(w)),!0)},ot.MATH=ot,ot.PRECISE=ot;const bt=[];function ue(t){if((t=P(t))instanceof Error)return t;const n=Math.floor(t);return n===0||n===1?1:(bt[n]>0||(bt[n]=ue(n-1)*n),bt[n])}function Oe(t,n){const c=me(t=P(t),n=P(n));if(c)return c;if(n===0)return 0;if(!(t>=0&&n>0||t<=0&&n<0))return g;n=Math.abs(n);const w=-Math.floor(Math.log(n)/Math.log(10));return t>=0?ct(Math.floor(t/n)*n,w):-ct(Math.ceil(Math.abs(t)/n),w)}Oe.MATH=(t,n,c)=>{if(n instanceof Error)return n;n=n===void 0?0:n;const w=me(t=P(t),n=P(n),c=P(c));if(w)return w;if(n===0)return 0;n=n?Math.abs(n):1;const R=-Math.floor(Math.log(n)/Math.log(10));return t>=0?ct(Math.floor(t/n)*n,R):c===0||c===void 0?-ct(Math.ceil(Math.abs(t)/n)*n,R):-ct(Math.floor(Math.abs(t)/n)*n,R)},Oe.PRECISE=Oe.MATH;const He={CEILING:ot};function We(t,n){const c=me(t=P(t),n=P(n));if(c)return c;if(t===0&&n===0)return g;const w=Math.pow(t,n);return isNaN(w)?g:w}function ht(){const t=H(arguments).filter(w=>w!=null);if(t.length===0)return 0;const n=Ce(t);if(n instanceof Error)return n;let c=1;for(let w=0;w<n.length;w++)c*=n[w];return c}function ct(t,n){return me(t=P(t),n=P(n))||+(Math.round(+(t+"e"+n))+"e"+-1*n)}function ut(){let t=0;return M(F(arguments),n=>{if(t instanceof Error)return!1;if(n instanceof Error)t=n;else if(typeof n=="number")t+=n;else if(typeof n=="string"){const c=parseFloat(n);!isNaN(c)&&(t+=c)}else if(Array.isArray(n)){const c=ut.apply(null,n);c instanceof Error?t=c:t+=c}}),t}var yt=Object.freeze({__proto__:null,ADD:function(t,n){return arguments.length!==2?T:me(t=P(t),n=P(n))||t+n},DIVIDE:function(t,n){return arguments.length!==2?T:me(t=P(t),n=P(n))||(n===0?m:t/n)},EQ:function(t,n){return arguments.length!==2?T:t instanceof Error?t:n instanceof Error?n:(t===null&&(t=void 0),n===null&&(n=void 0),t===n)},GT:function(t,n){return arguments.length!==2?T:t instanceof Error?t:n instanceof Error?n:(et(t,n)?(t=Be(t),n=Be(n)):(t=P(t),n=P(n)),me(t,n)||t>n)},GTE:function(t,n){return arguments.length!==2?T:(et(t,n)?(t=Be(t),n=Be(n)):(t=P(t),n=P(n)),me(t,n)||t>=n)},LT:function(t,n){return arguments.length!==2?T:(et(t,n)?(t=Be(t),n=Be(n)):(t=P(t),n=P(n)),me(t,n)||t<n)},LTE:function(t,n){return arguments.length!==2?T:(et(t,n)?(t=Be(t),n=Be(n)):(t=P(t),n=P(n)),me(t,n)||t<=n)},MINUS:function(t,n){return arguments.length!==2?T:me(t=P(t),n=P(n))||t-n},MULTIPLY:function(t,n){return arguments.length!==2?T:me(t=P(t),n=P(n))||t*n},NE:function(t,n){return arguments.length!==2?T:t instanceof Error?t:n instanceof Error?n:(t===null&&(t=void 0),n===null&&(n=void 0),t!==n)},POW:function(t,n){return arguments.length!==2?T:We(t,n)}});const It=new Date(Date.UTC(1900,0,1)),hn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],gn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],qt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function _t(t,n,c){c=c.toUpperCase(),t=Fe(t),n=Fe(n);const w=t.getFullYear(),R=t.getMonth(),z=t.getDate(),Z=n.getFullYear(),de=n.getMonth(),we=n.getDate();let _e;switch(c){case"Y":_e=Math.floor(Kt(t,n));break;case"D":_e=Ft(n,t);break;case"M":_e=de-R+12*(Z-w),we<z&&_e--;break;case"MD":z<=we?_e=we-z:(de===0?(t.setFullYear(Z-1),t.setMonth(12)):(t.setFullYear(Z),t.setMonth(de-1)),_e=Ft(n,t));break;case"YM":_e=de-R+12*(Z-w),we<z&&_e--,_e%=12;break;case"YD":de>R||de===R&&we<z?t.setFullYear(Z):t.setFullYear(Z-1),_e=Ft(n,t)}return _e}function Ht(t){const n=new Date(t);return n.setHours(0,0,0,0),n}function Ft(t,n){return t=Fe(t),n=Fe(n),t instanceof Error?t:n instanceof Error?n:an(Ht(t))-an(Ht(n))}function Nt(t,n,c){if(c=Ne(c||"false"),t=Fe(t),n=Fe(n),t instanceof Error)return t;if(n instanceof Error)return n;if(c instanceof Error)return c;const w=t.getMonth();let R,z,Z=n.getMonth();if(c)R=t.getDate()===31?30:t.getDate(),z=n.getDate()===31?30:n.getDate();else{const de=new Date(t.getFullYear(),w+1,0).getDate(),we=new Date(n.getFullYear(),Z+1,0).getDate();R=t.getDate()===de?30:t.getDate(),n.getDate()===we?R<30?(Z++,z=1):z=30:z=n.getDate()}return 360*(n.getFullYear()-t.getFullYear())+30*(Z-w)+(z-R)}function rn(t){if((t=Fe(t))instanceof Error)return t;(t=Ht(t)).setDate(t.getDate()+4-(t.getDay()||7));const n=new Date(t.getFullYear(),0,1);return Math.ceil(((t-n)/864e5+1)/7)}function Vt(t,n,c){return Vt.INTL(t,n,1,c)}function zt(t,n,c){return zt.INTL(t,n,1,c)}function Yt(t){return new Date(t,1,29).getMonth()===1}function Ut(t,n){return Math.ceil((n-t)/1e3/60/60/24)}function Kt(t,n,c){if((t=Fe(t))instanceof Error)return t;if((n=Fe(n))instanceof Error)return n;c=c||0;let w=t.getDate();const R=t.getMonth()+1,z=t.getFullYear();let Z=n.getDate();const de=n.getMonth()+1,we=n.getFullYear();switch(c){case 0:return w===31&&Z===31?(w=30,Z=30):w===31?w=30:w===30&&Z===31&&(Z=30),(Z+30*de+360*we-(w+30*R+360*z))/360;case 1:{const _e=(it,st)=>{const dt=it.getFullYear(),Et=new Date(dt,2,1);if(Yt(dt)&&it<Et&&st>=Et)return!0;const xt=st.getFullYear(),Ot=new Date(xt,2,1);return Yt(xt)&&st>=Ot&&it<Ot};let Ke=365;if(z===we||z+1===we&&(R>de||R===de&&w>=Z))return(z===we&&Yt(z)||_e(t,n)||de===1&&Z===29)&&(Ke=366),Ut(t,n)/Ke;const Ze=we-z+1,Qe=(new Date(we+1,0,1)-new Date(z,0,1))/1e3/60/60/24/Ze;return Ut(t,n)/Qe}case 2:return Ut(t,n)/360;case 3:return Ut(t,n)/365;case 4:return(Z+30*de+360*we-(w+30*R+360*z))/360}}function an(t){const n=t>-22038912e5?2:1;return Math.ceil((t-It)/864e5)+n}function ln(t){return(t=P(t))===0?s:t instanceof Error?t:String.fromCharCode(t)}function sn(t){if(oe(t))return t;let n=(t=t||"").charCodeAt(0);return isNaN(n)&&(n=s),n}function un(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;let c=0;for(;(c=t.indexOf(!0))>-1;)t[c]="TRUE";let w=0;for(;(w=t.indexOf(!1))>-1;)t[w]="FALSE";return t.join("")}Vt.INTL=(t,n,c,w)=>{if((t=Fe(t))instanceof Error)return t;if((n=Fe(n))instanceof Error)return n;let R=!1;const z=[],Z=[1,2,3,4,5,6,0],de=new RegExp("^[0|1]{7}$");if(c===void 0)c=qt[1];else if(typeof c=="string"&&de.test(c)){R=!0,c=c.split("");for(let Ze=0;Ze<c.length;Ze++)c[Ze]==="1"&&z.push(Z[Ze])}else c=qt[c];if(!(c instanceof Array))return s;w===void 0?w=[]:w instanceof Array||(w=[w]);for(let Ze=0;Ze<w.length;Ze++){const Qe=Fe(w[Ze]);if(Qe instanceof Error)return Qe;w[Ze]=Qe}const we=Math.round((n-t)/864e5)+1;let _e=we;const Ke=t;for(let Ze=0;Ze<we;Ze++){const Qe=new Date().getTimezoneOffset()>0?Ke.getUTCDay():Ke.getDay();let it=R?z.includes(Qe):Qe===c[0]||Qe===c[1];for(let st=0;st<w.length;st++){const dt=w[st];if(dt.getDate()===Ke.getDate()&&dt.getMonth()===Ke.getMonth()&&dt.getFullYear()===Ke.getFullYear()){it=!0;break}}it&&_e--,Ke.setDate(Ke.getDate()+1)}return _e},zt.INTL=(t,n,c,w)=>{if((t=Fe(t))instanceof Error)return t;if((n=P(n))instanceof Error)return n;if(n<0)return g;if(!((c=c===void 0?qt[1]:qt[c])instanceof Array))return s;w===void 0?w=[]:w instanceof Array||(w=[w]);for(let z=0;z<w.length;z++){const Z=Fe(w[z]);if(Z instanceof Error)return Z;w[z]=Z}let R=0;for(;R<n;){t.setDate(t.getDate()+1);const z=t.getDay();if(z!==c[0]&&z!==c[1]){for(let Z=0;Z<w.length;Z++){const de=w[Z];if(de.getDate()===t.getDate()&&de.getMonth()===t.getMonth()&&de.getFullYear()===t.getFullYear()){R--;break}}R++}}return t};const mn=un;function cn(t,n=2,c=!1){if(t=P(t),isNaN(t)||(n=P(n),isNaN(n)))return s;if(n<0){const w=Math.pow(10,-n);t=Math.round(t/w)*w}else t=t.toFixed(n);if(c)t=t.toString().replace(/,/g,"");else{const w=t.toString().split(".");w[0]=w[0].replace(/\B(?=(\d{3})+$)/g,","),t=w.join(".")}return t}function Mt(t,n){return me(t,n)||(t=Be(t),(n=P(n))instanceof Error?n:new Array(n+1).join(t))}const vn=ln,bn=sn;function Xt(t){return/^[01]{1,10}$/.test(t)}function Ct(t,n,c){if(oe(t=P(t),n=P(n)))return t;if((c=c===void 0?"i":c)!=="i"&&c!=="j")return s;if(t===0&&n===0)return 0;if(t===0)return n===1?c:n.toString()+c;if(n===0)return t.toString();{const w=n>0?"+":"";return t.toString()+w+(n===1?c:n.toString()+c)}}function Qt(t,n){return n=n===void 0?0:n,oe(t=P(t),n=P(n))?s:f.erf(t)}function Gt(t){return isNaN(t)?s:f.erfc(t)}function Zt(t){const n=mt(t),c=gt(t);return oe(n,c)?s:Math.sqrt(Math.pow(n,2)+Math.pow(c,2))}function gt(t){if(t===void 0||t===!0||t===!1)return s;if(t===0||t==="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;let n=(t=(t+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),c=t.indexOf("-");n===0&&(n=t.indexOf("+",1)),c===0&&(c=t.indexOf("-",1));const w=t.substring(t.length-1,t.length),R=w==="i"||w==="j";return n>=0||c>=0?R?n>=0?isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?g:Number(t.substring(n+1,t.length-1)):isNaN(t.substring(0,c))||isNaN(t.substring(c+1,t.length-1))?g:-Number(t.substring(c+1,t.length-1)):g:R?isNaN(t.substring(0,t.length-1))?g:t.substring(0,t.length-1):isNaN(t)?g:0}function Jt(t){const n=mt(t),c=gt(t);return oe(n,c)?s:n===0&&c===0?m:n===0&&c>0?Math.PI/2:n===0&&c<0?-Math.PI/2:c===0&&n>0?0:c===0&&n<0?-Math.PI:n>0?Math.atan(c/n):n<0&&c>=0?Math.atan(c/n)+Math.PI:Math.atan(c/n)-Math.PI}function $t(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.cos(n)*(Math.exp(c)+Math.exp(-c))/2,-Math.sin(n)*(Math.exp(c)-Math.exp(-c))/2,w)}function dn(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.cos(c)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(c)*(Math.exp(n)-Math.exp(-n))/2,w)}function Rt(t,n){const c=mt(t),w=gt(t),R=mt(n),z=gt(n);if(oe(c,w,R,z))return s;const Z=t.substring(t.length-1),de=n.substring(n.length-1);let we="i";if((Z==="j"||de==="j")&&(we="j"),R===0&&z===0)return g;const _e=R*R+z*z;return Ct((c*R+w*z)/_e,(w*R-c*z)/_e,we)}function mt(t){if(t===void 0||t===!0||t===!1)return s;if(t===0||t==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;let n=(t+="").indexOf("+"),c=t.indexOf("-");n===0&&(n=t.indexOf("+",1)),c===0&&(c=t.indexOf("-",1));const w=t.substring(t.length-1,t.length),R=w==="i"||w==="j";return n>=0||c>=0?R?n>=0?isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?g:Number(t.substring(0,n)):isNaN(t.substring(0,c))||isNaN(t.substring(c+1,t.length-1))?g:Number(t.substring(0,c)):g:R?isNaN(t.substring(0,t.length-1))?g:0:isNaN(t)?g:t}function Wt(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.sin(n)*(Math.exp(c)+Math.exp(-c))/2,Math.cos(n)*(Math.exp(c)-Math.exp(-c))/2,w)}function fn(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.cos(c)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(c)*(Math.exp(n)+Math.exp(-n))/2,w)}Qt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=a.DIST,yn=a.INV,xn=W.DIST,wn=ot.MATH,Cn=ot.PRECISE,Sn=ae.DIST,En=ae.DIST.RT,Tn=ae.INV,An=ae.INV.RT,Mn=ae.TEST,Dn=ee.P,Ln=ee.P,kn=ee.S,In=W.INV,Nn=Gt.PRECISE,On=Qt.PRECISE,Fn=ce.DIST,Rn=Se.DIST,Pn=Se.DIST.RT,_n=Se.INV,Bn=Se.INV.RT,qn=Oe.MATH,Hn=Oe.PRECISE,Vn=Se.TEST,zn=xe.DIST,Un=xe.INV,$n=Re.PRECISE,Wn=ze.DIST,Yn=nt.INV,Kn=nt.DIST,Xn=nt.INV,Qn=U.MULT,Gn=U.SNGL,Zn=X.DIST,Jn=Vt.INTL,eo=C.DIST,to=C.INV,no=C.S.DIST,oo=C.S.INV,ro=G.EXC,io=G.INC,ao=ge.EXC,lo=ge.INC,so=J.DIST,uo=he.EXC,co=he.INC,fo=Te.AVG,po=Te.EQ,ho=qe.P,go=Ve.P,mo=Ve.S,vo=Ue.DIST,bo=Ue.DIST.RT,jo=Ue.INV,yo=Ue.TEST,xo=tt.P,wo=tt.S,Co=Le.DIST,So=zt.INTL,Eo=Xe.TEST;function en(t){const n=[];return M(t,c=>{c&&n.push(c)}),n}function kt(t,n){const c={};for(let z=1;z<t[0].length;++z)c[z]=!0;let w=n[0].length;for(let z=1;z<n.length;++z)n[z].length>w&&(w=n[z].length);for(let z=1;z<t.length;++z)for(let Z=1;Z<t[z].length;++Z){let de=!1,we=!1;for(let _e=0;_e<n.length;++_e){const Ke=n[_e];if(Ke.length<w)continue;const Ze=Ke[0];if(t[z][0]===Ze){we=!0;for(let Qe=1;Qe<Ke.length;++Qe)if(!de)if(Ke[Qe]===void 0||Ke[Qe]==="*")de=!0;else{const it=vt(Ke[Qe]+""),st=[ft(t[z][Z],at)].concat(it);de=jt(st)}}}we&&(c[Z]=c[Z]&&de)}const R=[];for(let z=0;z<t[0].length;++z)c[z]&&R.push(z-1);return R}function tn(t){return t&&t.getTime&&!isNaN(t.getTime())}function nn(t){return t instanceof Date?t:new Date(t)}function Pt(t,n,c,w,R){if(w=w||0,R=R||0,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R)))return s;let z;if(t===0)z=w+c*n;else{const Z=Math.pow(1+t,n);z=R===1?w*Z+c*(1+t)*(Z-1)/t:w*Z+c*(Z-1)/t}return-z}function pn(t,n,c,w,R,z){if(R=R||0,z=z||0,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R),z=P(z)))return s;const Z=Bt(t,c,w,R,z);return(n===1?z===1?0:-w:z===1?Pt(t,n-2,Z,w,1)-Z:Pt(t,n-1,Z,w,0))*t}function on(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=t[0];let c=0;for(let w=1;w<t.length;w++)c+=t[w]/Math.pow(1+n,w);return c}function Bt(t,n,c,w,R){if(w=w||0,R=R||0,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R)))return s;let z;if(t===0)z=(c+w)/n;else{const Z=Math.pow(1+t,n);z=R===1?(w*t/(Z-1)+c*t/(1-1/Z))/(1+t):w*t/(Z-1)+c*t/(1-1/Z)}return-z}const To={errors:_,symbols:yt};d.ABS=function(t){return(t=P(t))instanceof Error?t:Math.abs(t)},d.ACCRINT=function(t,n,c,w,R,z,Z){return t=nn(t),n=nn(n),c=nn(c),tn(t)&&tn(n)&&tn(c)?w<=0||R<=0||[1,2,4].indexOf(z)===-1||[0,1,2,3,4].indexOf(Z)===-1||c<=t?g:(R=R||0)*w*Kt(t,c,Z=Z||0):s},d.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},d.ACOS=function(t){if((t=P(t))instanceof Error)return t;let n=Math.acos(t);return isNaN(n)&&(n=g),n},d.ACOSH=function(t){if((t=P(t))instanceof Error)return t;let n=Math.log(t+Math.sqrt(t*t-1));return isNaN(n)&&(n=g),n},d.ACOT=function(t){return(t=P(t))instanceof Error?t:Math.atan(1/t)},d.ACOTH=function(t){if((t=P(t))instanceof Error)return t;let n=.5*Math.log((t+1)/(t-1));return isNaN(n)&&(n=g),n},d.AGGREGATE=function(t,n,c,w){if(oe(t=P(t),P(t)))return s;switch(t){case 1:return k(c);case 2:return V(c);case 3:return N(c);case 4:return re(c);case 5:return be(c);case 6:return ht(c);case 7:return Ve.S(c);case 8:return Ve.P(c);case 9:return ut(c);case 10:return tt.S(c);case 11:return tt.P(c);case 12:return ne(c);case 13:return U.SNGL(c);case 14:return $e(c,w);case 15:return Ie(c,w);case 16:return G.INC(c,w);case 17:return he.INC(c,w);case 18:return G.EXC(c,w);case 19:return he.EXC(c,w)}},d.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},d.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},d.AND=function(){const t=H(arguments);let n=s;for(let c=0;c<t.length;c++){if(t[c]instanceof Error)return t[c];t[c]!==void 0&&t[c]!==null&&typeof t[c]!="string"&&(n===s&&(n=!0),t[c]||(n=!1))}return n},d.ARABIC=function(t){if(t==null)return 0;if(t instanceof Error)return t;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return s;let n=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,c=>{n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[c]}),n},d.ASC=function(){throw new Error("ASC is not implemented")},d.ASIN=function(t){if((t=P(t))instanceof Error)return t;let n=Math.asin(t);return isNaN(n)&&(n=g),n},d.ASINH=function(t){return(t=P(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},d.ATAN=function(t){return(t=P(t))instanceof Error?t:Math.atan(t)},d.ATAN2=function(t,n){return me(t=P(t),n=P(n))||Math.atan2(t,n)},d.ATANH=function(t){if((t=P(t))instanceof Error)return t;let n=Math.log((1+t)/(1-t))/2;return isNaN(n)&&(n=g),n},d.AVEDEV=function(){const t=H(arguments).filter(Me);if(t.length===0)return g;const n=Ce(t);return n instanceof Error?n:f.sum(f(n).subtract(f.mean(n)).abs()[0])/n.length},d.AVERAGE=k,d.AVERAGEA=p,d.AVERAGEIF=function(t,n,c){if(arguments.length<=1)return T;if(c=Ce(H(c=c||t).filter(Me)),t=H(t),c instanceof Error)return c;let w=0,R=0;const z=n===void 0||n==="*",Z=z?null:vt(n+"");for(let de=0;de<t.length;de++){const we=t[de];if(z)R+=c[de],w++;else{const _e=[ft(we,at)].concat(Z);jt(_e)&&(R+=c[de],w++)}}return R/w},d.AVERAGEIFS=function(){const t=F(arguments),n=(t.length-1)/2,c=H(t[0]);let w=0,R=0;for(let Z=0;Z<c.length;Z++){let de=!1;for(let we=0;we<n;we++){const _e=t[2*we+1][Z],Ke=t[2*we+2];let Ze=!1;if(Ke===void 0||Ke==="*")Ze=!0;else{const Qe=vt(Ke+""),it=[ft(_e,at)].concat(Qe);Ze=jt(it)}if(!Ze){de=!1;break}de=!0}de&&(R+=c[Z],w++)}const z=R/w;return isNaN(z)?0:z},d.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},d.BASE=function(t,n,c){const w=me(t=P(t),n=P(n),c=P(c));if(w)return w;if(n===0)return g;const R=t.toString(n);return new Array(Math.max(c+1-R.length,0)).join("0")+R},d.BESSELI=function(t,n){return oe(t=P(t),n=P(n))?s:S.besseli(t,n)},d.BESSELJ=function(t,n){return oe(t=P(t),n=P(n))?s:S.besselj(t,n)},d.BESSELK=function(t,n){return oe(t=P(t),n=P(n))?s:S.besselk(t,n)},d.BESSELY=function(t,n){return oe(t=P(t),n=P(n))?s:S.bessely(t,n)},d.BETA=a,d.BETADIST=jn,d.BETAINV=yn,d.BIN2DEC=function(t){if(!Xt(t))return g;const n=parseInt(t,2),c=t.toString();return c.length===10&&c.substring(0,1)==="1"?parseInt(c.substring(1),2)-512:n},d.BIN2HEX=function(t,n){if(!Xt(t))return g;const c=t.toString();if(c.length===10&&c.substring(0,1)==="1")return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);const w=parseInt(t,2).toString(16);return n===void 0?w:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=w.length?Mt("0",n-w.length)+w:g},d.BIN2OCT=function(t,n){if(!Xt(t))return g;const c=t.toString();if(c.length===10&&c.substring(0,1)==="1")return(1073741312+parseInt(c.substring(1),2)).toString(8);const w=parseInt(t,2).toString(8);return n===void 0?w:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=w.length?Mt("0",n-w.length)+w:g},d.BINOM=W,d.BINOMDIST=xn,d.BITAND=function(t,n){return oe(t=P(t),n=P(n))?s:t<0||n<0||Math.floor(t)!==t||Math.floor(n)!==n||t>0xffffffffffff||n>0xffffffffffff?g:t&n},d.BITLSHIFT=function(t,n){return oe(t=P(t),n=P(n))?s:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(n)>53?g:n>=0?t<<n:t>>-n},d.BITOR=function(t,n){return oe(t=P(t),n=P(n))?s:t<0||n<0||Math.floor(t)!==t||Math.floor(n)!==n||t>0xffffffffffff||n>0xffffffffffff?g:t|n},d.BITRSHIFT=function(t,n){return oe(t=P(t),n=P(n))?s:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(n)>53?g:n>=0?t>>n:t<<-n},d.BITXOR=function(t,n){return oe(t=P(t),n=P(n))?s:t<0||n<0||Math.floor(t)!==t||Math.floor(n)!==n||t>0xffffffffffff||n>0xffffffffffff?g:t^n},d.CEILING=ot,d.CEILINGMATH=wn,d.CEILINGPRECISE=Cn,d.CELL=function(){throw new Error("CELL is not implemented")},d.CHAR=ln,d.CHIDIST=Sn,d.CHIDISTRT=En,d.CHIINV=Tn,d.CHIINVRT=An,d.CHISQ=ae,d.CHITEST=Mn,d.CHOOSE=function(){if(arguments.length<2)return T;const t=arguments[0];return t<1||t>254||arguments.length<t+1?s:arguments[t]},d.CLEAN=function(t){return oe(t)?t:(t=t||"").replace(/[\0-\x1F]/g,"")},d.CODE=sn,d.COLUMN=function(t,n){return arguments.length!==2?T:n<0?g:t instanceof Array&&typeof n=="number"?t.length!==0?f.col(t,n):void 0:s},d.COLUMNS=function(t){return arguments.length!==1?T:t instanceof Array?t.length===0?0:f.cols(t):s},d.COMBIN=rt,d.COMBINA=function(t,n){return me(t=P(t),n=P(n))||(t<n?g:t===0&&n===0?1:rt(t+n-1,t-1))},d.COMPLEX=Ct,d.CONCAT=mn,d.CONCATENATE=un,d.CONFIDENCE=ie,d.CONVERT=function(t,n,c){if((t=P(t))instanceof Error)return t;const w=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],R={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},z={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let Z,de=null,we=null,_e=n,Ke=c,Ze=1,Qe=1;for(let it=0;it<w.length;it++)Z=w[it][2]===null?[]:w[it][2],(w[it][1]===_e||Z.indexOf(_e)>=0)&&(de=w[it]),(w[it][1]===Ke||Z.indexOf(Ke)>=0)&&(we=w[it]);if(de===null){const it=R[n.substring(0,2)];let st=z[n.substring(0,1)];n.substring(0,2)==="da"&&(st=["dekao",10,"da"]),it?(Ze=it[2],_e=n.substring(2)):st&&(Ze=st[1],_e=n.substring(st[2].length));for(let dt=0;dt<w.length;dt++)Z=w[dt][2]===null?[]:w[dt][2],(w[dt][1]===_e||Z.indexOf(_e)>=0)&&(de=w[dt])}if(we===null){const it=R[c.substring(0,2)];let st=z[c.substring(0,1)];c.substring(0,2)==="da"&&(st=["dekao",10,"da"]),it?(Qe=it[2],Ke=c.substring(2)):st&&(Qe=st[1],Ke=c.substring(st[2].length));for(let dt=0;dt<w.length;dt++)Z=w[dt][2]===null?[]:w[dt][2],(w[dt][1]===Ke||Z.indexOf(Ke)>=0)&&(we=w[dt])}return de===null||we===null||de[3]!==we[3]?T:t*de[6]*Ze/(we[6]*Qe)},d.CORREL=function(t,n){return oe(t=Ce(H(t)),n=Ce(H(n)))?s:f.corrcoeff(t,n)},d.COS=function(t){return(t=P(t))instanceof Error?t:Math.cos(t)},d.COSH=function(t){return(t=P(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},d.COT=function(t){return(t=P(t))instanceof Error?t:t===0?m:1/Math.tan(t)},d.COTH=function(t){if((t=P(t))instanceof Error)return t;if(t===0)return m;const n=Math.exp(2*t);return(n+1)/(n-1)},d.COUNT=V,d.COUNTA=N,d.COUNTBLANK=Y,d.COUNTIF=function(t,n){if(t=H(t),n===void 0||n==="*")return t.length;let c=0;const w=vt(n+"");for(let R=0;R<t.length;R++){const z=[ft(t[R],at)].concat(w);jt(z)&&c++}return c},d.COUNTIFS=function(){const t=F(arguments),n=new Array(H(t[0]).length);for(let w=0;w<n.length;w++)n[w]=!0;for(let w=0;w<t.length;w+=2){const R=H(t[w]),z=t[w+1];if(z!==void 0&&z!=="*"){const Z=vt(z+"");for(let de=0;de<R.length;de++){const we=[ft(R[de],at)].concat(Z);n[de]=n[de]&&jt(we)}}}let c=0;for(let w=0;w<n.length;w++)n[w]&&c++;return c},d.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},d.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},d.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},d.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},d.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},d.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},d.COVAR=Dn,d.COVARIANCE=ee,d.COVARIANCEP=Ln,d.COVARIANCES=kn,d.CRITBINOM=In,d.CSC=function(t){return(t=P(t))instanceof Error?t:t===0?m:1/Math.sin(t)},d.CSCH=function(t){return(t=P(t))instanceof Error?t:t===0?m:2/(Math.exp(t)-Math.exp(-t))},d.CUMIPMT=function(t,n,c,w,R,z){if(oe(t=P(t),n=P(n),c=P(c)))return s;if(t<=0||n<=0||c<=0||w<1||R<1||w>R||z!==0&&z!==1)return g;const Z=Bt(t,n,c,0,z);let de=0;w===1&&(z===0&&(de=-c),w++);for(let we=w;we<=R;we++)de+=z===1?Pt(t,we-2,Z,c,1)-Z:Pt(t,we-1,Z,c,0);return de*=t,de},d.CUMPRINC=function(t,n,c,w,R,z){if(oe(t=P(t),n=P(n),c=P(c)))return s;if(t<=0||n<=0||c<=0||w<1||R<1||w>R||z!==0&&z!==1)return g;const Z=Bt(t,n,c,0,z);let de=0;w===1&&(de=z===0?Z+c*t:Z,w++);for(let we=w;we<=R;we++)de+=z>0?Z-(Pt(t,we-2,Z,c,1)-Z)*t:Z-Pt(t,we-1,Z,c,0)*t;return de},d.DATE=function(t,n,c){let w;return oe(t=P(t),n=P(n),c=P(c))?w=s:(w=new Date(t,n-1,c),w.getFullYear()<0&&(w=g)),w},d.DATEDIF=_t,d.DATEVALUE=function(t){if(typeof t!="string")return s;const n=Date.parse(t);return isNaN(n)?s:new Date(t)},d.DAVERAGE=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);let z=0;return M(w,Z=>{z+=R[Z]}),w.length===0?m:z/w.length},d.DAY=function(t){const n=Fe(t);return n instanceof Error?n:n.getDate()},d.DAYS=Ft,d.DAYS360=Nt,d.DB=function(t,n,c,w,R){if(R=R===void 0?12:R,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R)))return s;if(t<0||n<0||c<0||w<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(R)===-1||w>c)return g;if(n>=t)return 0;const z=(1-Math.pow(n/t,1/c)).toFixed(3),Z=t*z*R/12;let de=Z,we=0;const _e=w===c?c-1:w;for(let Ke=2;Ke<=_e;Ke++)we=(t-de)*z,de+=we;return w===1?Z:w===c?(t-de)*z:we},d.DBCS=function(){throw new Error("DBCS is not implemented")},d.DCOUNT=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);const z=[];return M(w,Z=>{z.push(R[Z])}),V(z)},d.DCOUNTA=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);const z=[];return M(w,Z=>{z.push(R[Z])}),N(z)},d.DDB=function(t,n,c,w,R){if(R=R===void 0?2:R,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R)))return s;if(t<0||n<0||c<0||w<0||R<=0||w>c)return g;if(n>=t)return 0;let z=0,Z=0;for(let de=1;de<=w;de++)Z=Math.min(R/c*(t-z),t-n-z),z+=Z;return Z},d.DEC2BIN=function(t,n){if((t=P(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return g;if(t<0)return"1"+Mt("0",9-(512+t).toString(2).length)+(512+t).toString(2);const c=parseInt(t,10).toString(2);return n===void 0?c:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=c.length?Mt("0",n-c.length)+c:g},d.DEC2HEX=function(t,n){if((t=P(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return g;if(t<0)return(1099511627776+t).toString(16);const c=parseInt(t,10).toString(16);return n===void 0?c:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=c.length?Mt("0",n-c.length)+c:g},d.DEC2OCT=function(t,n){if((t=P(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return g;if(t<0)return(1073741824+t).toString(8);const c=parseInt(t,10).toString(8);return n===void 0?c:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=c.length?Mt("0",n-c.length)+c:g},d.DECIMAL=function(t,n){return arguments.length<1?s:me(t=P(t),n=P(n))||(n===0?g:parseInt(t,n))},d.DEGREES=function(t){return(t=P(t))instanceof Error?t:180*t/Math.PI},d.DELTA=function(t,n){return n=n===void 0?0:n,oe(t=P(t),n=P(n))?s:t===n?1:0},d.DEVSQ=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=f.mean(t);let c=0;for(let w=0;w<t.length;w++)c+=Math.pow(t[w]-n,2);return c},d.DGET=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];return R=Q(typeof n=="string"?t[fe(t,n)]:t[n]),w.length===0?s:w.length>1?g:R[w[0]]},d.DISC=function(t,n,c,w,R){if(oe(t=Fe(t),n=Fe(n),c=P(c),w=P(w),R=(R=P(R))||0))return s;if(c<=0||w<=0)return g;if(t>=n)return s;let z,Z;switch(R){case 0:z=360,Z=Nt(t,n,!1);break;case 1:case 3:z=365,Z=_t(t,n,"D");break;case 2:z=360,Z=_t(t,n,"D");break;case 4:z=360,Z=Nt(t,n,!0);break;default:return g}return(w-c)/w*z/Z},d.DMAX=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);let z=R[w[0]];return M(w,Z=>{z<R[Z]&&(z=R[Z])}),z},d.DMIN=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);let z=R[w[0]];return M(w,Z=>{z>R[Z]&&(z=R[Z])}),z},d.DOLLAR=function(t,n=2){if(t=P(t),isNaN(t))return s;const c={style:"currency",currency:"USD",minimumFractionDigits:n>=0?n:0,maximumFractionDigits:n>=0?n:0},w=(t=ct(t,n)).toLocaleString("en-US",c);return t<0?"$("+w.slice(2)+")":w},d.DOLLARDE=function(t,n){if(oe(t=P(t),n=P(n)))return s;if(n<0)return g;if(n>=0&&n<1)return m;n=parseInt(n,10);let c=parseInt(t,10);c+=t%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;const w=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return c=Math.round(c*w)/w,c},d.DOLLARFR=function(t,n){if(oe(t=P(t),n=P(n)))return s;if(n<0)return g;if(n>=0&&n<1)return m;n=parseInt(n,10);let c=parseInt(t,10);return c+=t%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n,c},d.DPRODUCT=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const de=fe(t,n);R=Q(t[de])}else R=Q(t[n]);let z=[];M(w,de=>{z.push(R[de])}),z=en(z);let Z=1;return M(z,de=>{Z*=de}),Z},d.DSTDEV=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);let z=[];return M(w,Z=>{z.push(R[Z])}),z=en(z),Ve.S(z)},d.DSTDEVP=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);let z=[];return M(w,Z=>{z.push(R[Z])}),z=en(z),Ve.P(z)},d.DSUM=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);const z=[];return M(w,Z=>{z.push(R[Z])}),ut(z)},d.DURATION=function(){throw new Error("DURATION is not implemented")},d.DVAR=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);const z=[];return M(w,Z=>{z.push(R[Z])}),tt.S(z)},d.DVARP=function(t,n,c){if(isNaN(n)&&typeof n!="string")return s;const w=kt(t,c);let R=[];if(typeof n=="string"){const Z=fe(t,n);R=Q(t[Z])}else R=Q(t[n]);const z=[];return M(w,Z=>{z.push(R[Z])}),tt.P(z)},d.EDATE=function(t,n){return(t=Fe(t))instanceof Error?t:isNaN(n)?s:(n=parseInt(n,10),t.setMonth(t.getMonth()+n),t)},d.EFFECT=function(t,n){return oe(t=P(t),n=P(n))?s:t<=0||n<1?g:(n=parseInt(n,10),Math.pow(1+t/n,n)-1)},d.EOMONTH=function(t,n){return(t=Fe(t))instanceof Error?t:isNaN(n)?s:(n=parseInt(n,10),new Date(t.getFullYear(),t.getMonth()+n+1,0))},d.ERF=Qt,d.ERFC=Gt,d.ERFCPRECISE=Nn,d.ERFPRECISE=On,d.ERROR=Tt,d.EVEN=function(t){return(t=P(t))instanceof Error?t:ot(t,-2,-1)},d.EXACT=function(t,n){return arguments.length!==2?T:me(t,n)||(t=Be(t))===Be(n)},d.EXP=function(t){return arguments.length<1?T:arguments.length>1?D:(t=P(t))instanceof Error?t:t=Math.exp(t)},d.EXPON=ce,d.EXPONDIST=Fn,d.F=Se,d.FACT=ue,d.FACTDOUBLE=function t(n){if((n=P(n))instanceof Error)return n;const c=Math.floor(n);return c<=0?1:c*t(c-2)},d.FALSE=function(){return!1},d.FDIST=Rn,d.FDISTRT=Pn,d.FIND=function(t,n,c){if(arguments.length<2)return T;t=Be(t),c=c===void 0?0:c;const w=(n=Be(n)).indexOf(t,c-1);return w===-1?s:w+1},d.FINV=_n,d.FINVRT=Bn,d.FISHER=function(t){return(t=P(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},d.FISHERINV=function(t){if((t=P(t))instanceof Error)return t;const n=Math.exp(2*t);return(n-1)/(n+1)},d.FIXED=cn,d.FLOOR=Oe,d.FLOORMATH=qn,d.FLOORPRECISE=Hn,d.FORECAST=ve,d.FREQUENCY=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=t.length,w=n.length,R=[];for(let z=0;z<=w;z++){R[z]=0;for(let Z=0;Z<c;Z++)z===0?t[Z]<=n[0]&&(R[0]+=1):z<w?t[Z]>n[z-1]&&t[Z]<=n[z]&&(R[z]+=1):z===w&&t[Z]>n[w-1]&&(R[w]+=1)}return R},d.FTEST=Vn,d.FV=Pt,d.FVSCHEDULE=function(t,n){if(oe(t=P(t),n=Ce(H(n))))return s;const c=n.length;let w=t;for(let R=0;R<c;R++)w*=1+n[R];return w},d.GAMMA=xe,d.GAMMADIST=zn,d.GAMMAINV=Un,d.GAMMALN=Re,d.GAMMALNPRECISE=$n,d.GAUSS=function(t){return(t=P(t))instanceof Error?t:f.normal.cdf(t,0,1)-.5},d.GCD=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=t.length,c=t[0];let w=c<0?-c:c;for(let R=1;R<n;R++){const z=t[R];let Z=z<0?-z:z;for(;w&&Z;)w>Z?w%=Z:Z%=w;w+=Z}return w},d.GEOMEAN=function(){const t=Ce(H(arguments));return t instanceof Error?t:f.geomean(t)},d.GESTEP=function(t,n){return oe(n=n||0,t=P(t))?t:t>=n?1:0},d.GROWTH=function(t,n,c,w){if((t=Ce(t))instanceof Error)return t;let R;if(n===void 0)for(n=[],R=1;R<=t.length;R++)n.push(R);if(c===void 0)for(c=[],R=1;R<=t.length;R++)c.push(R);if(oe(n=Ce(n),c=Ce(c)))return s;w===void 0&&(w=!0);const z=t.length;let Z,de,we=0,_e=0,Ke=0,Ze=0;for(R=0;R<z;R++){const it=n[R],st=Math.log(t[R]);we+=it,_e+=st,Ke+=it*st,Ze+=it*it}we/=z,_e/=z,Ke/=z,Ze/=z,w?(Z=(Ke-we*_e)/(Ze-we*we),de=_e-Z*we):(Z=Ke/Ze,de=0);const Qe=[];for(R=0;R<c.length;R++)Qe.push(Math.exp(de+Z*c[R]));return Qe},d.HARMEAN=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=t.length;let c=0;for(let w=0;w<n;w++)c+=1/t[w];return n/c},d.HEX2BIN=function(t,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g;const c=!(t.length!==10||t.substring(0,1).toLowerCase()!=="f"),w=c?parseInt(t,16)-1099511627776:parseInt(t,16);if(w<-512||w>511)return g;if(c)return"1"+Mt("0",9-(512+w).toString(2).length)+(512+w).toString(2);const R=w.toString(2);return n===void 0?R:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=R.length?Mt("0",n-R.length)+R:g},d.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g;const n=parseInt(t,16);return n>=549755813888?n-1099511627776:n},d.HEX2OCT=function(t,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return g;const c=parseInt(t,16);if(c>536870911&&c<0xffe0000000)return g;if(c>=0xffe0000000)return(c-0xffc0000000).toString(8);const w=c.toString(8);return n===void 0?w:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=w.length?Mt("0",n-w.length)+w:g},d.HLOOKUP=function(t,n,c,w){return A(t,pe(n),c,w)},d.HOUR=function(t){return(t=Fe(t))instanceof Error?t:t.getHours()},d.HYPGEOM=ze,d.HYPGEOMDIST=Wn,d.IF=function(t,n,c){return t instanceof Error?t:((n=!(arguments.length>=2)||n)==null&&(n=0),(c=arguments.length===3&&c)==null&&(c=0),t?n:c)},d.IFERROR=function(t,n){return Dt(t)?n:t},d.IFNA=function(t,n){return t===T?n:t},d.IFS=function(){for(let t=0;t<arguments.length/2;t++)if(arguments[2*t])return arguments[2*t+1];return T},d.IMABS=Zt,d.IMAGINARY=gt,d.IMARGUMENT=Jt,d.IMCONJUGATE=function(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",c!==0?Ct(n,-c,w):t},d.IMCOS=$t,d.IMCOSH=dn,d.IMCOT=function(t){return oe(mt(t),gt(t))?s:Rt($t(t),Wt(t))},d.IMCSC=function(t){return t===!0||t===!1?s:oe(mt(t),gt(t))?g:Rt("1",Wt(t))},d.IMCSCH=function(t){return t===!0||t===!1?s:oe(mt(t),gt(t))?g:Rt("1",fn(t))},d.IMDIV=Rt,d.IMEXP=function(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);w=w==="i"||w==="j"?w:"i";const R=Math.exp(n);return Ct(R*Math.cos(c),R*Math.sin(c),w)},d.IMLN=function(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.log(Math.sqrt(n*n+c*c)),Math.atan(c/n),w)},d.IMLOG10=function(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.log(Math.sqrt(n*n+c*c))/Math.log(10),Math.atan(c/n)/Math.log(10),w)},d.IMLOG2=function(t){const n=mt(t),c=gt(t);if(oe(n,c))return s;let w=t.substring(t.length-1);return w=w==="i"||w==="j"?w:"i",Ct(Math.log(Math.sqrt(n*n+c*c))/Math.log(2),Math.atan(c/n)/Math.log(2),w)},d.IMPOWER=function(t,n){if(oe(n=P(n),mt(t),gt(t)))return s;let c=t.substring(t.length-1);c=c==="i"||c==="j"?c:"i";const w=Math.pow(Zt(t),n),R=Jt(t);return Ct(w*Math.cos(n*R),w*Math.sin(n*R),c)},d.IMPRODUCT=function(){let t=arguments[0];if(!arguments.length)return s;for(let n=1;n<arguments.length;n++){const c=mt(t),w=gt(t),R=mt(arguments[n]),z=gt(arguments[n]);if(oe(c,w,R,z))return s;t=Ct(c*R-w*z,c*z+w*R)}return t},d.IMREAL=mt,d.IMSEC=function(t){return t===!0||t===!1||oe(mt(t),gt(t))?s:Rt("1",$t(t))},d.IMSECH=function(t){return oe(mt(t),gt(t))?s:Rt("1",dn(t))},d.IMSIN=Wt,d.IMSINH=fn,d.IMSQRT=function(t){if(oe(mt(t),gt(t)))return s;let n=t.substring(t.length-1);n=n==="i"||n==="j"?n:"i";const c=Math.sqrt(Zt(t)),w=Jt(t);return Ct(c*Math.cos(w/2),c*Math.sin(w/2),n)},d.IMSUB=function(t,n){const c=mt(t),w=gt(t),R=mt(n),z=gt(n);if(oe(c,w,R,z))return s;const Z=t.substring(t.length-1),de=n.substring(n.length-1);let we="i";return(Z==="j"||de==="j")&&(we="j"),Ct(c-R,w-z,we)},d.IMSUM=function(){if(!arguments.length)return s;const t=H(arguments);let n=t[0];for(let c=1;c<t.length;c++){const w=mt(n),R=gt(n),z=mt(t[c]),Z=gt(t[c]);if(oe(w,R,z,Z))return s;n=Ct(w+z,R+Z)}return n},d.IMTAN=function(t){return t===!0||t===!1||oe(mt(t),gt(t))?s:Rt(Wt(t),$t(t))},d.INDEX=function(t,n,c){const w=me(t,n,c);if(w)return w;if(!Array.isArray(t))return s;const R=t.length>0&&!Array.isArray(t[0]);return R&&!c?(c=n,n=1):(c=c||1,n=n||1),c<0||n<0?s:R&&n===1&&c<=t.length?t[c-1]:n<=t.length&&c<=t[n-1].length?t[n-1][c-1]:v},d.INFO=function(){throw new Error("INFO is not implemented")},d.INT=function(t){return(t=P(t))instanceof Error?t:Math.floor(t)},d.INTERCEPT=function(t,n){return oe(t=Ce(t),n=Ce(n))?s:t.length!==n.length?T:ve(0,t,n)},d.INTRATE=function(){throw new Error("INTRATE is not implemented")},d.IPMT=pn,d.IRR=function(t,n){if(n=n||0,oe(t=Ce(H(t)),n=P(n)))return s;const c=(Qe,it,st)=>{const dt=st+1;let Et=Qe[0];for(let xt=1;xt<Qe.length;xt++)Et+=Qe[xt]/Math.pow(dt,(it[xt]-it[0])/365);return Et},w=(Qe,it,st)=>{const dt=st+1;let Et=0;for(let xt=1;xt<Qe.length;xt++){const Ot=(it[xt]-it[0])/365;Et-=Ot*Qe[xt]/Math.pow(dt,Ot+1)}return Et},R=[];let z=!1,Z=!1;for(let Qe=0;Qe<t.length;Qe++)R[Qe]=Qe===0?0:R[Qe-1]+365,t[Qe]>0&&(z=!0),t[Qe]<0&&(Z=!0);if(!z||!Z)return g;let de,we,_e,Ke=n=n===void 0?.1:n,Ze=!0;do _e=c(t,R,Ke),de=Ke-_e/w(t,R,Ke),we=Math.abs(de-Ke),Ke=de,Ze=we>1e-10&&Math.abs(_e)>1e-10;while(Ze);return Ke},d.ISBLANK=function(t){return t===null},d.ISERR=At,d.ISERROR=Dt,d.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},d.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},d.ISLOGICAL=Lt,d.ISNA=function(t){return t===T},d.ISNONTEXT=function(t){return typeof t!="string"},d.ISNUMBER=pt,d.ISO=He,d.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},d.ISOWEEKNUM=rn,d.ISPMT=function(t,n,c,w){return oe(t=P(t),n=P(n),c=P(c),w=P(w))?s:w*t*(n/c-1)},d.ISREF=function(){throw new Error("ISREF is not implemented")},d.ISTEXT=wt,d.KURT=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;const n=f.mean(t),c=t.length;let w=0;for(let R=0;R<c;R++)w+=Math.pow(t[R]-n,4);return w/=Math.pow(f.stdev(t,!0),4),c*(c+1)/((c-1)*(c-2)*(c-3))*w-3*(c-1)*(c-1)/((c-2)*(c-3))},d.LARGE=$e,d.LCM=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;for(var n,c,w,R,z=1;(w=t.pop())!==void 0;){if(w===0)return 0;for(;w>1;){if(w%2){for(n=3,c=Math.floor(Math.sqrt(w));n<=c&&w%n;n+=2);R=n<=c?n:w}else R=2;for(w/=R,z*=R,n=t.length;n;t[--n]%R==0&&(t[n]/=R)==1&&t.splice(n,1));}}return z},d.LEFT=function(t,n){return me(t,n)||(t=Be(t),(n=P(n=n===void 0?1:n))instanceof Error||typeof t!="string"?s:t.substring(0,n))},d.LEN=function(t){return arguments.length===0?D:t instanceof Error?t:Array.isArray(t)?s:Be(t).length},d.LINEST=Je,d.LN=function(t){return(t=P(t))instanceof Error?t:t===0?g:Math.log(t)},d.LOG=function(t,n){return me(t=P(t),n=P(n))||(t===0||n===0?g:Math.log(t)/Math.log(n))},d.LOG10=function(t){return(t=P(t))instanceof Error?t:t===0?g:Math.log(t)/Math.log(10)},d.LOGEST=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n)))||t.length!==n.length)return s;for(let w=0;w<t.length;w++)t[w]=Math.log(t[w]);const c=Je(t,n);return c[0]=Math.round(1e6*Math.exp(c[0]))/1e6,c[1]=Math.round(1e6*Math.exp(c[1]))/1e6,c},d.LOGINV=Yn,d.LOGNORM=nt,d.LOGNORMDIST=Kn,d.LOGNORMINV=Xn,d.LOOKUP=function(t,n,c){n=H(n),c=c?H(c):n;const w=typeof t=="number";let R=T;for(let z=0;z<n.length;z++){if(n[z]===t)return c[z];if(w&&n[z]<=t||typeof n[z]=="string"&&n[z].localeCompare(t)<0)R=c[z];else if(w&&n[z]>t)return R}return R},d.LOWER=function(t){return arguments.length!==1?s:oe(t=Be(t))?t:t.toLowerCase()},d.MATCH=function(t,n,c){if(!t||!n||(arguments.length===2&&(c=1),!((n=H(n))instanceof Array))||c!==-1&&c!==0&&c!==1)return T;let w,R;for(let z=0;z<n.length;z++)if(c===1){if(n[z]===t)return z+1;n[z]<t&&(R?n[z]>R&&(w=z+1,R=n[z]):(w=z+1,R=n[z]))}else if(c===0){if(typeof t=="string"&&typeof n[z]=="string"){const Z=t.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+Z+"$").test(n[z].toLowerCase()))return z+1}else if(n[z]===t)return z+1}else if(c===-1){if(n[z]===t)return z+1;n[z]>t&&(R?n[z]<R&&(w=z+1,R=n[z]):(w=z+1,R=n[z]))}return w||T},d.MAX=re,d.MAXA=function(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;let c=B(t);return c=c.map(w=>w??0),c.length===0?0:Math.max.apply(Math,c)},d.MDURATION=function(){throw new Error("MDURATION is not implemented")},d.MEDIAN=ne,d.MID=function(t,n,c){if(n==null)return s;if(oe(n=P(n),c=P(c))||typeof t!="string")return c;const w=n-1,R=w+c;return t.substring(w,R)},d.MIN=be,d.MINA=function(){const t=H(arguments),n=me.apply(void 0,t);if(n)return n;let c=B(t);return c=c.map(w=>w??0),c.length===0?0:Math.min.apply(Math,c)},d.MINUTE=function(t){return(t=Fe(t))instanceof Error?t:t.getMinutes()},d.MIRR=function(t,n,c){if(oe(t=Ce(H(t)),n=P(n),c=P(c)))return s;const w=t.length,R=[],z=[];for(let we=0;we<w;we++)t[we]<0?R.push(t[we]):z.push(t[we]);const Z=-on(c,z)*Math.pow(1+c,w-1),de=on(n,R)*(1+n);return Math.pow(Z/de,1/(w-1))-1},d.MMULT=function(t,n){return!Array.isArray(t)||!Array.isArray(n)||t.some(c=>!c.length)||n.some(c=>!c.length)||te(t).some(c=>typeof c!="number")||te(n).some(c=>typeof c!="number")||t[0].length!==n.length?s:Array(t.length).fill(0).map(()=>Array(n[0].length).fill(0)).map((c,w)=>c.map((R,z)=>t[w].reduce((Z,de,we)=>Z+de*n[we][z],0)))},d.MOD=function(t,n){const c=me(t=P(t),n=P(n));if(c)return c;if(n===0)return m;let w=Math.abs(t%n);return w=t<0?n-w:w,n>0?w:-w},d.MODE=U,d.MODEMULT=Qn,d.MODESNGL=Gn,d.MONTH=function(t){return(t=Fe(t))instanceof Error?t:t.getMonth()+1},d.MROUND=function(t,n){return me(t=P(t),n=P(n))||(t*n==0?0:t*n<0?g:Math.round(t/n)*n)},d.MULTINOMIAL=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;let n=0,c=1;for(let w=0;w<t.length;w++)n+=t[w],c*=ue(t[w]);return ue(n)/c},d.MUNIT=function(t){return arguments.length>1?T:!(t=parseInt(t))||t<=0?s:Array(t).fill(0).map(()=>Array(t).fill(0)).map((n,c)=>(n[c]=1,n))},d.N=function(t){return pt(t)?t:t instanceof Date?t.getTime():t===!0?1:t===!1?0:Dt(t)?t:0},d.NA=function(){return T},d.NEGBINOM=X,d.NEGBINOMDIST=Zn,d.NETWORKDAYS=Vt,d.NETWORKDAYSINTL=Jn,d.NOMINAL=function(t,n){return oe(t=P(t),n=P(n))?s:t<=0||n<1?g:(n=parseInt(n,10),(Math.pow(t+1,1/n)-1)*n)},d.NORM=C,d.NORMDIST=eo,d.NORMINV=to,d.NORMSDIST=no,d.NORMSINV=oo,d.NOT=function(t){return typeof t=="string"?s:t instanceof Error?t:!t},d.NOW=function(){return new Date},d.NPER=function(t,n,c,w,R){if(R=R===void 0?0:R,w=w===void 0?0:w,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R)))return s;if(t===0)return-(c+w)/n;{const z=n*(1+t*R)-w*t,Z=c*t+n*(1+t*R);return Math.log(z/Z)/Math.log(1+t)}},d.NPV=on,d.NUMBERVALUE=function(t,n,c){return typeof(t=Me(t)?t:"")=="number"?t:typeof t!="string"?T:(n=n===void 0?".":n,c=c===void 0?",":c,Number(t.replace(n,".").replace(c,"")))},d.OCT2BIN=function(t,n){if(!/^[0-7]{1,10}$/.test(t))return g;const c=!(t.length!==10||t.substring(0,1)!=="7"),w=c?parseInt(t,8)-1073741824:parseInt(t,8);if(w<-512||w>511)return g;if(c)return"1"+Mt("0",9-(512+w).toString(2).length)+(512+w).toString(2);const R=w.toString(2);return n===void 0?R:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=R.length?Mt("0",n-R.length)+R:g},d.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return g;const n=parseInt(t,8);return n>=536870912?n-1073741824:n},d.OCT2HEX=function(t,n){if(!/^[0-7]{1,10}$/.test(t))return g;const c=parseInt(t,8);if(c>=536870912)return"ff"+(c+3221225472).toString(16);const w=c.toString(16);return n===void 0?w:isNaN(n)?s:n<0?g:(n=Math.floor(n))>=w.length?Mt("0",n-w.length)+w:g},d.ODD=function(t){if((t=P(t))instanceof Error)return t;let n=Math.ceil(Math.abs(t));return n=1&n?n:n+1,t>=0?n:-n},d.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},d.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},d.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},d.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},d.OR=function(){const t=H(arguments);let n=s;for(let c=0;c<t.length;c++){if(t[c]instanceof Error)return t[c];t[c]!==void 0&&t[c]!==null&&typeof t[c]!="string"&&(n===s&&(n=!1),t[c]&&(n=!0))}return n},d.PDURATION=function(t,n,c){return oe(t=P(t),n=P(n),c=P(c))?s:t<=0?g:(Math.log(c)-Math.log(n))/Math.log(1+t)},d.PEARSON=q,d.PERCENTILE=G,d.PERCENTILEEXC=ro,d.PERCENTILEINC=io,d.PERCENTRANK=ge,d.PERCENTRANKEXC=ao,d.PERCENTRANKINC=lo,d.PERMUT=function(t,n){return oe(t=P(t),n=P(n))?s:ue(t)/ue(t-n)},d.PERMUTATIONA=function(t,n){return oe(t=P(t),n=P(n))?s:Math.pow(t,n)},d.PHI=function(t){return(t=P(t))instanceof Error?s:Math.exp(-.5*t*t)/2.5066282746310002},d.PI=function(){return Math.PI},d.PMT=Bt,d.POISSON=J,d.POISSONDIST=so,d.POWER=We,d.PPMT=function(t,n,c,w,R,z){return R=R||0,z=z||0,oe(t=P(t),c=P(c),w=P(w),R=P(R),z=P(z))?s:Bt(t,c,w,R,z)-pn(t,n,c,w,R,z)},d.PRICE=function(){throw new Error("PRICE is not implemented")},d.PRICEDISC=function(t,n,c,w,R){if(oe(t=Fe(t),n=Fe(n),c=P(c),w=P(w),R=(R=P(R))||0))return s;if(c<=0||w<=0)return g;if(t>=n)return s;let z,Z;switch(R){case 0:z=360,Z=Nt(t,n,!1);break;case 1:case 3:z=365,Z=_t(t,n,"D");break;case 2:z=360,Z=_t(t,n,"D");break;case 4:z=360,Z=Nt(t,n,!0);break;default:return g}return w-c*w*Z/z},d.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},d.PROB=function(t,n,c,w){if(c===void 0)return 0;if(w=w===void 0?c:w,oe(t=Ce(H(t)),n=Ce(H(n)),c=P(c),w=P(w)))return s;if(c===w)return t.indexOf(c)>=0?n[t.indexOf(c)]:0;const R=t.sort((de,we)=>de-we),z=R.length;let Z=0;for(let de=0;de<z;de++)R[de]>=c&&R[de]<=w&&(Z+=n[t.indexOf(R[de])]);return Z},d.PRODUCT=ht,d.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},d.PROPER=function(t){return oe(t)?t:isNaN(t)&&typeof t=="number"?s:(t=Be(t)).replace(/\w\S*/g,n=>n.charAt(0).toUpperCase()+n.substr(1).toLowerCase())},d.PV=function(t,n,c,w,R){return w=w||0,R=R||0,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R))?s:t===0?-c*n-w:((1-Math.pow(1+t,n))/t*c*(1+t*R)-w)/Math.pow(1+t,n)},d.QUARTILE=he,d.QUARTILEEXC=uo,d.QUARTILEINC=co,d.QUOTIENT=function(t,n){return me(t=P(t),n=P(n))||parseInt(t/n,10)},d.RADIANS=function(t){return(t=P(t))instanceof Error?t:t*Math.PI/180},d.RAND=function(){return Math.random()},d.RANDBETWEEN=function(t,n){return me(t=P(t),n=P(n))||t+Math.ceil((n-t+1)*Math.random())-1},d.RANK=Te,d.RANKAVG=fo,d.RANKEQ=po,d.RATE=function(t,n,c,w,R,z){if(z=z===void 0?.01:z,w=w===void 0?0:w,R=R===void 0?0:R,oe(t=P(t),n=P(n),c=P(c),w=P(w),R=P(R),z=P(z)))return s;const Z=1e-10;let de=z;R=R?1:0;for(let we=0;we<20;we++){if(de<=-1)return g;let _e,Ke,Ze;if(Math.abs(de)<Z?_e=c*(1+t*de)+n*(1+de*R)*t+w:(Ke=Math.pow(1+de,t),_e=c*Ke+n*(1/de+R)*(Ke-1)+w),Math.abs(_e)<Z)return de;if(Math.abs(de)<Z)Ze=c*t+n*R*t;else{Ke=Math.pow(1+de,t);const Qe=t*Math.pow(1+de,t-1);Ze=c*Qe+n*(1/de+R)*Qe+n*(-1/(de*de))*(Ke-1)}de-=_e/Ze}return de},d.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},d.REPLACE=function(t,n,c,w){return oe(n=P(n),c=P(c))||typeof t!="string"||typeof w!="string"?s:t.substr(0,n-1)+w+t.substr(n-1+c)},d.REPT=Mt,d.RIGHT=function(t,n){return me(t,n)||(t=Be(t),(n=P(n=n===void 0?1:n))instanceof Error?n:t.substring(t.length-n))},d.ROMAN=function(t){if((t=P(t))instanceof Error)return t;const n=String(t).split(""),c=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let w="",R=3;for(;R--;)w=(c[+n.pop()+10*R]||"")+w;return new Array(+n.join("")+1).join("M")+w},d.ROUND=ct,d.ROUNDDOWN=function(t,n){return me(t=P(t),n=P(n))||(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},d.ROUNDUP=function(t,n){return me(t=P(t),n=P(n))||(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},d.ROW=function(t,n){return arguments.length!==2?T:n<0?g:t instanceof Array&&typeof n=="number"?t.length!==0?f.row(t,n):void 0:s},d.ROWS=function(t){return arguments.length!==1?T:t instanceof Array?t.length===0?0:f.rows(t):s},d.RRI=function(t,n,c){return oe(t=P(t),n=P(n),c=P(c))?s:t===0||n===0?g:Math.pow(c/n,1/t)-1},d.RSQ=function(t,n){return oe(t=Ce(H(t)),n=Ce(H(n)))?s:Math.pow(q(t,n),2)},d.SEARCH=function(t,n,c){let w;return typeof t!="string"||typeof n!="string"?s:(c=c===void 0?0:c,w=n.toLowerCase().indexOf(t.toLowerCase(),c-1)+1,w===0?s:w)},d.SEC=function(t){return(t=P(t))instanceof Error?t:1/Math.cos(t)},d.SECH=function(t){return(t=P(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},d.SECOND=function(t){return(t=Fe(t))instanceof Error?t:t.getSeconds()},d.SERIESSUM=function(t,n,c,w){if(oe(t=P(t),n=P(n),c=P(c),w=Ce(w)))return s;let R=w[0]*Math.pow(t,n);for(let z=1;z<w.length;z++)R+=w[z]*Math.pow(t,n+z*c);return R},d.SHEET=function(){throw new Error("SHEET is not implemented")},d.SHEETS=function(){throw new Error("SHEETS is not implemented")},d.SIGN=function(t){return(t=P(t))instanceof Error?t:t<0?-1:t===0?0:1},d.SIN=function(t){return(t=P(t))instanceof Error?t:Math.sin(t)},d.SINH=function(t){return(t=P(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},d.SKEW=qe,d.SKEWP=ho,d.SLN=function(t,n,c){return oe(t=P(t),n=P(n),c=P(c))?s:c===0?g:(t-n)/c},d.SLOPE=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=f.mean(n),w=f.mean(t),R=n.length;let z=0,Z=0;for(let de=0;de<R;de++)z+=(n[de]-c)*(t[de]-w),Z+=Math.pow(n[de]-c,2);return z/Z},d.SMALL=Ie,d.SORT=function(t,n=1,c=1,w=!1){if(!t||!Array.isArray(t))return T;if(t.length===0)return 0;if(!(n=P(n))||n<1||(c=P(c))!==1&&c!==-1)return s;if(typeof(w=Ne(w))!="boolean")return j;const R=de=>de.sort((we,_e)=>(we=Be(we[n-1]),_e=Be(_e[n-1]),c===1?we<_e?-1*c:c:we>_e?c:-1*c)),z=K(t),Z=w?pe(z):z;return n>=1&&n<=Z[0].length?w?pe(R(Z)):R(Z):s},d.SQRT=function(t){return(t=P(t))instanceof Error?t:t<0?g:Math.sqrt(t)},d.SQRTPI=function(t){return(t=P(t))instanceof Error?t:Math.sqrt(t*Math.PI)},d.STANDARDIZE=function(t,n,c){return oe(t=P(t),n=P(n),c=P(c))?s:(t-n)/c},d.STDEV=Ve,d.STDEVA=function(){const t=le.apply(this,arguments);return Math.sqrt(t)},d.STDEVP=go,d.STDEVPA=function(){const t=De.apply(this,arguments);let n=Math.sqrt(t);return isNaN(n)&&(n=g),n},d.STDEVS=mo,d.STEYX=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;const c=f.mean(n),w=f.mean(t),R=n.length;let z=0,Z=0,de=0;for(let we=0;we<R;we++)z+=Math.pow(t[we]-w,2),Z+=(n[we]-c)*(t[we]-w),de+=Math.pow(n[we]-c,2);return Math.sqrt((z-Z*Z/de)/(R-2))},d.SUBSTITUTE=function(t,n,c,w){if(arguments.length<3)return T;if(t&&n){if(w===void 0)return t.split(n).join(c);{if(w=Math.floor(Number(w)),Number.isNaN(w)||w<=0)return s;let R=0,z=0;for(;R>-1&&t.indexOf(n,R)>-1;)if(R=t.indexOf(n,R+1),z++,R>-1&&z===w)return t.substring(0,R)+c+t.substring(R+n.length);return t}}return t},d.SUBTOTAL=function(t,n){if((t=P(t))instanceof Error)return t;switch(t){case 1:case 101:return k(n);case 2:case 102:return V(n);case 3:case 103:return N(n);case 4:case 104:return re(n);case 5:case 105:return be(n);case 6:case 106:return ht(n);case 7:case 107:return Ve.S(n);case 8:case 108:return Ve.P(n);case 9:case 109:return ut(n);case 10:case 110:return tt.S(n);case 11:case 111:return tt.P(n)}},d.SUM=ut,d.SUMIF=function(t,n,c){if(t=H(t),c=c?H(c):t,t instanceof Error)return t;if(n==null||n instanceof Error)return 0;let w=0;const R=n==="*",z=R?null:vt(n+"");for(let Z=0;Z<t.length;Z++){const de=t[Z],we=c[Z];if(R)w+=de;else{const _e=[ft(de,at)].concat(z);w+=jt(_e)?we:0}}return w},d.SUMIFS=function(){const t=F(arguments),n=Ce(H(t.shift()));if(n instanceof Error)return n;const c=t,w=c.length/2;for(let z=0;z<w;z++)c[2*z]=H(c[2*z]);let R=0;for(let z=0;z<n.length;z++){let Z=!1;for(let de=0;de<w;de++){const we=c[2*de][z],_e=c[2*de+1];let Ke=!1;if(_e===void 0||_e==="*")Ke=!0;else{const Ze=vt(_e+""),Qe=[ft(we,at)].concat(Ze);Ke=jt(Qe)}if(!Ke){Z=!1;break}Z=!0}Z&&(R+=n[z])}return R},d.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return s;const t=arguments.length+1;let n,c,w,R,z=0;for(let Z=0;Z<arguments[0].length;Z++)if(arguments[0][Z]instanceof Array)for(let de=0;de<arguments[0][Z].length;de++){for(n=1,c=1;c<t;c++){const we=arguments[c-1][Z][de];if(we instanceof Error)return we;if(R=P(we),R instanceof Error)return R;n*=R}z+=n}else{for(n=1,c=1;c<t;c++){const de=arguments[c-1][Z];if(de instanceof Error)return de;if(w=P(de),w instanceof Error)return w;n*=w}z+=n}return z},d.SUMSQ=function(){const t=Ce(H(arguments));if(t instanceof Error)return t;let n=0;const c=t.length;for(let w=0;w<c;w++)n+=pt(t[w])?t[w]*t[w]:0;return n},d.SUMX2MY2=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;let c=0;for(let w=0;w<t.length;w++)c+=t[w]*t[w]-n[w]*n[w];return c},d.SUMX2PY2=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;let c=0;t=Ce(H(t)),n=Ce(H(n));for(let w=0;w<t.length;w++)c+=t[w]*t[w]+n[w]*n[w];return c},d.SUMXMY2=function(t,n){if(oe(t=Ce(H(t)),n=Ce(H(n))))return s;let c=0;t=H(t),n=H(n);for(let w=0;w<t.length;w++)c+=Math.pow(t[w]-n[w],2);return c},d.SWITCH=function(){let t;if(arguments.length>0){const n=arguments[0],c=arguments.length-1,w=Math.floor(c/2);let R=!1;const z=c%2!=0,Z=c%2==0?null:arguments[arguments.length-1];if(w){for(let de=0;de<w;de++)if(n===arguments[2*de+1]){t=arguments[2*de+2],R=!0;break}}R||(t=z?Z:T)}else t=s;return t},d.SYD=function(t,n,c,w){return oe(t=P(t),n=P(n),c=P(c),w=P(w))?s:c===0||w<1||w>c?g:(t-n)*(c-(w=parseInt(w,10))+1)*2/(c*(c+1))},d.T=function(t){return t instanceof Error||typeof t=="string"?t:""},d.TAN=function(t){return(t=P(t))instanceof Error?t:Math.tan(t)},d.TANH=function(t){if((t=P(t))instanceof Error)return t;const n=Math.exp(2*t);return(n-1)/(n+1)},d.TBILLEQ=function(t,n,c){return oe(t=Fe(t),n=Fe(n),c=P(c))?s:c<=0||t>n||n-t>31536e6?g:365*c/(360-c*Nt(t,n,!1))},d.TBILLPRICE=function(t,n,c){return oe(t=Fe(t),n=Fe(n),c=P(c))?s:c<=0||t>n||n-t>31536e6?g:100*(1-c*Nt(t,n,!1)/360)},d.TBILLYIELD=function(t,n,c){return oe(t=Fe(t),n=Fe(n),c=P(c))?s:c<=0||t>n||n-t>31536e6?g:360*(100-c)/(c*Nt(t,n,!1))},d.TDIST=vo,d.TDISTRT=bo,d.TEXT=function(t,n){if(t===void 0||t instanceof Error||n instanceof Error)return T;if(n==null)return"";if(typeof n=="number")return String(n);if(typeof n!="string")return s;const c=n.startsWith("$")?"$":"",w=n.endsWith("%");return w&&(t*=100),t=(t=cn(t,(n=n.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!n.includes(","))).startsWith("-")?"-"+c+(t=t.replace("-","")):c+t,w&&(t+="%"),t},d.TEXTJOIN=function(t,n,...c){if(typeof n!="boolean"&&(n=Ne(n)),arguments.length<3)return T;t=t??"";let w=H(c),R=n?w.filter(z=>z):w;if(Array.isArray(t)){t=H(t);let z=R.map(de=>[de]),Z=0;for(let de=0;de<z.length-1;de++)z[de].push(t[Z]),Z++,Z===t.length&&(Z=0);return R=H(z),R.join("")}return R.join(t)},d.TIME=function(t,n,c){return oe(t=P(t),n=P(n),c=P(c))?s:t<0||n<0||c<0?g:(3600*t+60*n+c)/86400},d.TIMEVALUE=function(t){return(t=Fe(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},d.TINV=jo,d.TODAY=function(){return Ht(new Date)},d.TRANSPOSE=function(t){return t?pe(K(t)):T},d.TREND=function(t,n,c){if(oe(t=Ce(H(t)),n=Ce(H(n)),c=Ce(H(c))))return s;const w=Je(t,n),R=w[0],z=w[1],Z=[];return c.forEach(de=>{Z.push(R*de+z)}),Z},d.TRIM=function(t){return(t=Be(t))instanceof Error?t:t.replace(/\s+/g," ").trim()},d.TRIMMEAN=function(t,n){if(oe(t=Ce(H(t)),n=P(n)))return s;const c=Oe(t.length*n,2)/2;return f.mean((R=(R=c)||1,(w=Q(t.sort((z,Z)=>z-Z),c))&&typeof w.slice=="function"?w.slice(0,w.length-R):w));var w,R},d.TRUE=function(){return!0},d.TRUNC=function(t,n){return me(t=P(t),n=P(n))||(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,n))/Math.pow(10,n)},d.TTEST=yo,d.TYPE=function(t){return pt(t)?1:wt(t)?2:Lt(t)?4:Dt(t)?16:Array.isArray(t)?64:void 0},d.UNICHAR=vn,d.UNICODE=bn,d.UNIQUE=St,d.UPPER=function(t){return(t=Be(t))instanceof Error?t:t.toUpperCase()},d.VALUE=function(t){const n=me(t);if(n)return n;if(typeof t=="number")return t;if(Me(t)||(t=""),typeof t!="string")return s;const c=/(%)$/.test(t)||/^(%)/.test(t);if((t=(t=(t=t.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let w=Number(t);return isNaN(w)?s:(w=w||0,c&&(w*=.01),w)},d.VAR=tt,d.VARA=le,d.VARP=xo,d.VARPA=De,d.VARS=wo,d.VDB=function(){throw new Error("VDB is not implemented")},d.VLOOKUP=A,d.WEEKDAY=function(t,n){if((t=Fe(t))instanceof Error)return t;n===void 0&&(n=1);const c=t.getDay();return gn[n][c]},d.WEEKNUM=function(t,n){if((t=Fe(t))instanceof Error)return t;if(n===void 0&&(n=1),n===21)return rn(t);const c=hn[n];let w=new Date(t.getFullYear(),0,1);const R=w.getDay()<c?1:0;return w-=24*Math.abs(w.getDay()-c)*60*60*1e3,Math.floor((t-w)/864e5/7+1)+R},d.WEIBULL=Le,d.WEIBULLDIST=Co,d.WORKDAY=zt,d.WORKDAYINTL=So,d.XIRR=function(t,n,c){if(oe(t=Ce(H(t)),n=je(H(n)),c=P(c)))return s;const w=(Qe,it,st)=>{const dt=st+1;let Et=Qe[0];for(let xt=1;xt<Qe.length;xt++)Et+=Qe[xt]/Math.pow(dt,Ft(it[xt],it[0])/365);return Et},R=(Qe,it,st)=>{const dt=st+1;let Et=0;for(let xt=1;xt<Qe.length;xt++){const Ot=Ft(it[xt],it[0])/365;Et-=Ot*Qe[xt]/Math.pow(dt,Ot+1)}return Et};let z=!1,Z=!1;for(let Qe=0;Qe<t.length;Qe++)t[Qe]>0&&(z=!0),t[Qe]<0&&(Z=!0);if(!z||!Z)return g;let de,we,_e,Ke=c=c||.1,Ze=!0;do _e=w(t,n,Ke),de=Ke-_e/R(t,n,Ke),we=Math.abs(de-Ke),Ke=de,Ze=we>1e-10&&Math.abs(_e)>1e-10;while(Ze);return Ke},d.XNPV=function(t,n,c){if(oe(t=P(t),n=Ce(H(n)),c=je(H(c))))return s;let w=0;for(let R=0;R<n.length;R++)w+=n[R]/Math.pow(1+t,Ft(c[R],c[0])/365);return w},d.XOR=function(){const t=H(arguments);let n=s;for(let c=0;c<t.length;c++){if(t[c]instanceof Error)return t[c];t[c]!==void 0&&t[c]!==null&&typeof t[c]!="string"&&(n===s&&(n=0),t[c]&&n++)}return n===s?n:!!(1&Math.floor(Math.abs(n)))},d.YEAR=function(t){return(t=Fe(t))instanceof Error?t:t.getFullYear()},d.YEARFRAC=Kt,d.YIELD=function(){throw new Error("YIELD is not implemented")},d.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},d.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},d.Z=Xe,d.ZTEST=Eo,d.utils=To}},l={};function b(O){var d=l[O];if(d!==void 0)return d.exports;var u=l[O]={exports:{}};return r[O].call(u.exports,u,u.exports,b),u.exports}b.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var E=b(960);o=E}(),o)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(e){var o=(""+e)[0];return o=="="||o=="#"},getMask=function(e){if(e.format||e.mask||e.locale){var o={};return e.mask?o.mask=e.mask:e.format?o.mask=e.format:(o.locale=e.locale,o.options=e.options),e.decimal&&(o.options||(o.options={}),o.options={decimal:e.decimal}),o}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){e==null&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,e==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var o=obj.options.onevent.apply(this,arguments);typeof obj.options[e]=="function"&&(o=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if(e=="onafterchanges"&&obj.options.persistance){var r=obj.options.persistance==1?obj.options.url:obj.options.persistance,l=obj.prepareJson(arguments[2]);obj.save(r,l)}return o},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var o=Object.keys(obj.options.data[0]);o.length>e&&(e=o.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var r=[],l=0;l<e;l++)obj.options.colHeaders[l]||(obj.options.colHeaders[l]=""),obj.options.colWidths[l]||(obj.options.colWidths[l]=obj.options.defaultColWidth),obj.options.colAlignments[l]||(obj.options.colAlignments[l]=obj.options.defaultColAlign),obj.options.columns[l]?obj.options.columns[l].type||(obj.options.columns[l].type="text"):obj.options.columns[l]={type:"text"},obj.options.columns[l].name||(obj.options.columns[l].name=o&&o[l]?o[l]:l),obj.options.columns[l].source||(obj.options.columns[l].source=[]),obj.options.columns[l].options||(obj.options.columns[l].options=[]),obj.options.columns[l].editor||(obj.options.columns[l].editor=null),obj.options.columns[l].allowEmpty||(obj.options.columns[l].allowEmpty=!1),obj.options.columns[l].title||(obj.options.columns[l].title=obj.options.colHeaders[l]?obj.options.colHeaders[l]:""),obj.options.columns[l].width||(obj.options.columns[l].width=obj.options.colWidths[l]?obj.options.colWidths[l]:obj.options.defaultColWidth),obj.options.columns[l].align||(obj.options.columns[l].align=obj.options.colAlignments[l]?obj.options.colAlignments[l]:"center"),obj.options.columns[l].type=="autocomplete"||obj.options.columns[l].type=="dropdown"?obj.options.columns[l].url&&r.push({url:obj.options.columns[l].url,index:l,method:"GET",dataType:"json",success:function(b){for(var E=0;E<b.length;E++)obj.options.columns[this.index].source.push(b[E])}}):obj.options.columns[l].type=="calendar"&&(obj.options.columns[l].options.format||(obj.options.columns[l].options.format="DD/MM/YYYY"));r.length?jSuites.ajax(r,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),o=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(o),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var r=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var l=0;l<obj.options.paginationOptions.length;l++){var b=document.createElement("option");b.value=obj.options.paginationOptions[l],b.innerHTML=obj.options.paginationOptions[l],obj.paginationDropdown.appendChild(b)}obj.paginationDropdown.value=obj.options.pagination,r.appendChild(document.createTextNode(obj.options.text.show)),r.appendChild(obj.paginationDropdown),r.appendChild(document.createTextNode(obj.options.text.entries))}var E,O=document.createElement("div");if(O.classList.add("jexcel_filter"),O.appendChild(r),O.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(E=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(E),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var d=0;d<obj.options.nestedHeaders.length;d++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[d]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(E=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(E),l=0;l<obj.options.columns.length;l++)obj.createCellHeader(l),obj.headerContainer.appendChild(obj.headers[l]),obj.colgroupContainer.appendChild(obj.colgroup[l]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var u=document.createElement("td");for(obj.filter.appendChild(u),l=0;l<obj.options.columns.length;l++)(u=document.createElement("td")).innerHTML="&nbsp;",u.setAttribute("data-x",l),u.className="jexcel_column_filter",obj.options.columns[l].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var f=document.createElement("a");f.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var S=document.createElement("span");S.innerHTML="Jspreadsheet CE",f.appendChild(S),obj.ads.appendChild(f),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var I=document.createElement("div"),m=document.createElement("div");if(obj.pagination.appendChild(I),obj.pagination.appendChild(m),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(O),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var s=Object.keys(obj.options.classes);for(l=0;l<s.length;l++){var v=jexcel.getIdFromColumnName(s[l],!0);obj.records[v[1]][v[0]].classList.add(obj.options.classes[s[l]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&(typeof e=="string"&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var o=0;o<obj.options.data.length;o++){for(var r=[],l=0;l<obj.options.columns.length;l++)r[l]=obj.options.data[o][obj.options.columns[l].name];e.push(r)}obj.options.data=e}o=0,l=0;var b=obj.options.columns.length,E=obj.options.data.length,O=obj.options.minDimensions[0],d=obj.options.minDimensions[1],u=O>b?O:b,f=d>E?d:E;for(o=0;o<f;o++)for(l=0;l<u;l++)obj.options.data[o]==null&&(obj.options.data[o]=[]),obj.options.data[o][l]==null&&(obj.options.data[o][l]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var S=0,I=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,S=obj.options.pagination*obj.pageNumber,I=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<I&&(I=obj.options.data.length)):(S=0,I=obj.options.data.length);for(o=0;o<obj.options.data.length;o++){var m=obj.createRow(o,obj.options.data[o]);o>=S&&o<I&&obj.tbody.appendChild(m)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var s=Object.keys(obj.options.mergeCells);for(l=0;l<s.length;l++){var v=obj.options.mergeCells[s[l]];obj.setMerge(s[l],v[0],v[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,o){for(var r=[],l=0,b=0,E=o==1||obj.options.copyCompatibility==0,O=obj.options.columns.length,d=obj.options.data.length,u=0;u<d;u++){l=0;for(var f=0;f<O;f++)e&&!obj.records[u][f].classList.contains("highlight")||(r[b]||(r[b]=[]),r[b][l]=E?obj.options.data[u][f]:obj.records[u][f].innerHTML,l++);l>0&&b++}return r},obj.getJsonRow=function(e){for(var o=obj.options.data[e],r=obj.options.columns.length,l={},b=0;b<r;b++)obj.options.columns[b].name||(obj.options.columns[b].name=b),l[obj.options.columns[b].name]=o[b];return l},obj.getJson=function(e){for(var o=[],r=obj.options.columns.length,l=obj.options.data.length,b=0;b<l;b++){for(var E=null,O=0;O<r;O++)e&&!obj.records[b][O].classList.contains("highlight")||(E==null&&(E={}),obj.options.columns[O].name||(obj.options.columns[O].name=O),E[obj.options.columns[O].name]=obj.options.data[b][O]);E!=null&&o.push(E)}return o},obj.prepareJson=function(e){for(var o=[],r=0;r<e.length;r++){var l=e[r].x,b=e[r].y,E=obj.options.columns[l].name?obj.options.columns[l].name:l;o[b]||(o[b]={row:b,data:{}}),o[b].data[E]=e[r].newValue}return o.filter(function(O){return O!=null})},obj.save=function(e,o){var r=obj.dispatch("onbeforesave",el,obj,o);if(r)o=r;else if(r===!1)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(o)},success:function(l){obj.dispatch("onsave",el,obj,o)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,o){for(var r=0;r<obj.headers.length;r++){var l=jexcel.getColumnNameFromId([r,e]);o[r]!=null&&obj.setValue(l,o[r])}},obj.getColumnData=function(e){for(var o=[],r=0;r<obj.options.data.length;r++)o.push(obj.options.data[r][e]);return o},obj.setColumnData=function(e,o){for(var r=0;r<obj.rows.length;r++){var l=jexcel.getColumnNameFromId([e,r]);o[r]!=null&&obj.setValue(l,o[r])}},obj.createRow=function(e,o){obj.records[e]||(obj.records[e]=[]),o||(o=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var r=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(r=obj.options.rows[e].title)),r||(r=parseInt(e+1));var l=document.createElement("td");l.innerHTML=r,l.setAttribute("data-y",e),l.className="jexcel_row",obj.rows[e].appendChild(l);for(var b=0;b<obj.options.columns.length;b++)obj.records[e][b]=obj.createCell(b,e,o[b]),obj.rows[e].appendChild(obj.records[e][b]);return obj.rows[e]},obj.parseValue=function(e,o,r,l){(""+r).substr(0,1)=="="&&obj.options.parseFormulas==1&&(r=obj.executeFormula(r,e,o));var b=obj.options.columns[e];if(b&&!isFormula(r)){var E=null;if(E=getMask(b)){r&&r==Number(r)&&(r=Number(r));var O=jSuites.mask.render(r,E,!0);if(l&&E.mask){var d=E.mask.split(";");d[1]&&(d[1].match(new RegExp("\\[Red\\]","gi"))&&(r<0?l.classList.add("red"):l.classList.remove("red")),d[1].match(new RegExp("\\(","gi"))&&r<0&&(O="("+O+")"))}O&&(r=O)}}return r};var validDate=function(e){return(e=""+e).substr(4,1)=="-"&&e.substr(7,1)=="-"||(e=e.split("-"))[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1])};obj.createCell=function(e,o,r){var l=document.createElement("td");if(l.setAttribute("data-x",e),l.setAttribute("data-y",o),(""+r).substr(0,1)=="="&&obj.options.secureFormulas==1){var b=secureFormula(r);b!=r&&(r=b)}if(obj.options.columns[e].editor)obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?l.innerHTML=r:l.textContent=r,typeof obj.options.columns[e].editor.createCell=="function"&&(l=obj.options.columns[e].editor.createCell(l));else if(obj.options.columns[e].type=="hidden")l.style.display="none",l.textContent=r;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){var E=document.createElement("input");E.type=obj.options.columns[e].type,E.name="c"+e,E.checked=r==1||r==1||r=="true",E.onclick=function(){obj.setValue(l,this.checked)},obj.options.columns[e].readOnly!=1&&obj.options.editable!=0||E.setAttribute("disabled","disabled"),l.appendChild(E),obj.options.data[o][e]=E.checked}else if(obj.options.columns[e].type=="calendar"){var O=null;if(!validDate(r)){var d=jSuites.calendar.extractDateFromString(r,obj.options.columns[e].options.format);d&&(O=d)}l.textContent=jSuites.calendar.getDateString(O||r,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")l.classList.add("jexcel_dropdown"),l.textContent=obj.getDropDownValue(e,r);else if(obj.options.columns[e].type=="color")if(obj.options.columns[e].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=r,l.appendChild(u)}else l.style.color=r,l.textContent=r;else if(obj.options.columns[e].type=="image"){if(r&&r.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=r,l.appendChild(f)}}else obj.options.columns[e].type=="html"||obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?l.innerHTML=stripScript(obj.parseValue(e,o,r,l)):l.textContent=obj.parseValue(e,o,r,l);obj.options.columns[e].readOnly==1&&(l.className="readonly");var S=obj.options.columns[e].align?obj.options.columns[e].align:"center";return l.style.textAlign=S,obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||l.innerHTML.length>200)&&(l.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==1&&(r||l.innerHTML?obj.records[o][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(l.style.overflow="hidden")),l},obj.createCellHeader=function(e){var o=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,r=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=r,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",o),obj.options.columns[e].type=="hidden"&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,o,r){obj.options.nestedHeaders[o][e].title&&(obj.options.nestedHeaders[o][e].title=r,obj.options.nestedHeaders[o].element.children[e+1].textContent=r)},obj.createNestedHeader=function(e){var o=document.createElement("tr");o.classList.add("jexcel_nested");var r=document.createElement("td");o.appendChild(r),e.element=o;for(var l=0,b=0;b<e.length;b++){e[b].colspan||(e[b].colspan=1),e[b].align||(e[b].align="center"),e[b].title||(e[b].title=""),e[b].id||(e[b].id="");for(var E=e[b].colspan,O=[],d=0;d<E;d++)obj.options.columns[l]&&obj.options.columns[l].type=="hidden"&&E++,O.push(l),l++;(r=document.createElement("td")).setAttribute("data-column",O.join(",")),r.setAttribute("colspan",e[b].colspan),r.setAttribute("align",e[b].align),r.setAttribute("id",e[b].id),r.textContent=e[b].title,o.appendChild(r)}return o},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var o=0;o<e.length;o++)if(e[o].type=="i")(E=document.createElement("i")).classList.add("jexcel_toolbar_item"),E.classList.add("material-icons"),E.setAttribute("data-k",e[o].k),E.setAttribute("data-v",e[o].v),E.setAttribute("id",e[o].id),e[o].tooltip&&E.setAttribute("title",e[o].tooltip),e[o].onclick&&(e[o].onclick,1)?E.onclick=function(O){var d=O;return function(){e[d].onclick(el,obj,this)}}(o):E.onclick=function(){var O=this.getAttribute("data-k"),d=this.getAttribute("data-v");obj.setStyle(obj.highlighted,O,d)},E.textContent=e[o].content,obj.toolbar.appendChild(E);else if(e[o].type=="select"){var r=!1;(E=document.createElement("select")).classList.add("jexcel_toolbar_item"),E.setAttribute("data-k",e[o].k),e[o].tooltip&&E.setAttribute("title",e[o].tooltip),e[o].onchange&&(e[o].onchange,1)?(E.onchange=e[o].onchange,r=!0):E.onchange=function(){var O=this.getAttribute("data-k");obj.setStyle(obj.highlighted,O,this.value)};for(var l=0;l<e[o].v.length;l++){var b=document.createElement("option");b.value=e[o].v[l],b.textContent=e[o].v[l],e[o].selectedValue&&b.value===e[o].selectedValue&&(b.selected=!0),E.appendChild(b)}r&&E.dispatchEvent(new Event("change")),obj.toolbar.appendChild(E)}else if(e[o].type=="color"){var E;(E=document.createElement("i")).classList.add("jexcel_toolbar_item"),E.classList.add("material-icons"),E.setAttribute("data-k",e[o].k),E.setAttribute("data-v",""),e[o].tooltip&&E.setAttribute("title",e[o].tooltip),obj.toolbar.appendChild(E),E.textContent=e[o].content,jSuites.color(E,{onchange:function(O,d){var u=O.getAttribute("data-k");obj.setStyle(obj.highlighted,u,d)}})}},obj.setMerge=function(e,o,r,l){var b=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var E=parseInt(obj.highlighted[0].getAttribute("data-x")),O=parseInt(obj.highlighted[0].getAttribute("data-y")),d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([E,O]),o=d-E+1,r=u-O+1}var f=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[f[1]][f[0]].getAttribute("data-merged")&&(b=obj.options.text.cellAlreadyMerged);else if((!o||o<2)&&(!r||r<2))b=obj.options.text.invalidMergeProperties;else for(var S=f[1];S<f[1]+r;S++)for(var I=f[0];I<f[0]+o;I++)jexcel.getColumnNameFromId([I,S]),obj.records[S][I].getAttribute("data-merged")&&(b=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(b)alert(b);else{o>1?obj.records[f[1]][f[0]].setAttribute("colspan",o):o=1,r>1?obj.records[f[1]][f[0]].setAttribute("rowspan",r):r=1,obj.options.mergeCells[e]=[o,r,[]],obj.records[f[1]][f[0]].setAttribute("data-merged","true"),obj.records[f[1]][f[0]].style.overflow="hidden";for(var m=[],s=f[1];s<f[1]+r;s++)for(var v=f[0];v<f[0]+o;v++)f[0]==v&&f[1]==s||(m.push(obj.options.data[s][v]),obj.updateCell(v,s,"",!0),obj.options.mergeCells[e][2].push(obj.records[s][v]),obj.records[s][v].style.display="none",obj.records[s][v]=obj.records[f[1]][f[0]]);obj.updateSelection(obj.records[f[1]][f[0]]),l||(obj.setHistory({action:"setMerge",column:e,colspan:o,rowspan:r,data:m}),obj.dispatch("onmerge",el,e,o,r))}},obj.getMerge=function(e){var o={};if(e)o=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var r=Object.keys(obj.options.mergeCells),l=0;l<r.length;l++)o[r[l]]=[obj.options.mergeCells[r[l]][0],obj.options.mergeCells[r[l]][1]]}return o},obj.removeMerge=function(e,o,r){if(obj.options.mergeCells[e]){var l=jexcel.getIdFromColumnName(e,!0);obj.records[l[1]][l[0]].removeAttribute("colspan"),obj.records[l[1]][l[0]].removeAttribute("rowspan"),obj.records[l[1]][l[0]].removeAttribute("data-merged");for(var b=obj.options.mergeCells[e],E=0,O=0;O<b[1];O++)for(var d=0;d<b[0];d++)(O>0||d>0)&&(obj.records[l[1]+O][l[0]+d]=b[2][E],obj.records[l[1]+O][l[0]+d].style.display="",o&&o[E]&&obj.updateCell(l[0]+d,l[1]+O,o[E]),E++);obj.updateSelection(obj.records[l[1]][l[0]],obj.records[l[1]+O-1][l[0]+d-1]),r||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++)obj.removeMerge(o[r],null,e)}},obj.isColMerged=function(e,o){var r=[];if(obj.options.mergeCells)for(var l=Object.keys(obj.options.mergeCells),b=0;b<l.length;b++){var E=jexcel.getIdFromColumnName(l[b],!0),O=obj.options.mergeCells[l[b]][0],d=E[0],u=E[0]+(O>1?O-1:0);o==null?d<=e&&u>=e&&r.push(l[b]):o?d<e&&u>=e&&r.push(l[b]):d<=e&&u>e&&r.push(l[b])}return r},obj.isRowMerged=function(e,o){var r=[];if(obj.options.mergeCells)for(var l=Object.keys(obj.options.mergeCells),b=0;b<l.length;b++){var E=jexcel.getIdFromColumnName(l[b],!0),O=obj.options.mergeCells[l[b]][1],d=E[1],u=E[1]+(O>1?O-1:0);o==null?d<=e&&u>=e&&r.push(l[b]):o?d<e&&u>=e&&r.push(l[b]):d<=e&&u>e&&r.push(l[b])}return r},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var o=[];if(obj.options.columns[e].type=="checkbox")o.push({id:"true",name:"True"}),o.push({id:"false",name:"False"});else{for(var r=[],l=!1,b=0;b<obj.options.data.length;b++){var E=obj.options.data[b][e],O=obj.records[b][e].innerHTML;E&&O?r[E]=O:l=!0}var d=Object.keys(r);for(o=[],b=0;b<d.length;b++)o.push({id:d[b],name:r[d[b]]});l&&o.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(u),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var f={data:o,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]!==void 0?obj.filters[e]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(S){obj.resetFilters(),obj.filters[e]=S.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=S.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(u,f)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var o=0;o<obj.filter.children.length;o++)obj.filters[o]&&(e=o);var r=function(E,O,d){for(var u=0;u<E.length;u++){var f=""+obj.options.data[d][O],S=""+obj.records[d][O].innerHTML;if(E[u]==f||E[u]==S)return!0}return!1},l=obj.filters[e];obj.results=[];for(var b=0;b<obj.options.data.length;b++)r(l,e,b)&&obj.results.push(b);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,o,r){var l=e.getAttribute("data-y"),b=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,b,l),b>0&&(obj.records[l][b-1].style.overflow="hidden");var E=function(D){var L=e.getBoundingClientRect(),_=document.createElement(D);return _.style.width=L.width+"px",_.style.height=L.height-2+"px",_.style.minHeight=L.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(_),obj.dispatch("oncreateeditor",el,e,b,l,_),_};if(e.classList.contains("readonly")!=1){if(obj.edition=[obj.records[l][b],obj.records[l][b].innerHTML,b,l],obj.options.columns[b].editor)obj.options.columns[b].editor.openEditor(e,el,o,r);else if(obj.options.columns[b].type!="hidden")if(obj.options.columns[b].type=="checkbox"||obj.options.columns[b].type=="radio"){var O=!e.children[0].checked;obj.setValue(e,O),obj.edition=null}else if(obj.options.columns[b].type=="dropdown"||obj.options.columns[b].type=="autocomplete"){if(O=obj.options.data[l][b],obj.options.columns[b].multiple&&!Array.isArray(O)&&(O=O.split(";")),typeof obj.options.columns[b].filter=="function")var d=obj.options.columns[b].filter(el,e,b,l,obj.options.columns[b].source);else d=obj.options.columns[b].source;for(var u=[],f=0;f<d.length;f++)u.push(d[f]);var S=E("div"),I={data:u,multiple:!!obj.options.columns[b].multiple,autocomplete:!(!obj.options.columns[b].autocomplete&&obj.options.columns[b].type!="autocomplete"),opened:!0,value:O,width:"100%",height:S.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[b].options&&obj.options.columns[b].options.type&&(I.type=obj.options.columns[b].options.type),jSuites.dropdown(S,I)}else if(obj.options.columns[b].type=="calendar"||obj.options.columns[b].type=="color")O=obj.options.data[l][b],(S=E("input")).value=O,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[b].options.position=!0),obj.options.columns[b].options.value=obj.options.data[l][b],obj.options.columns[b].options.opened=!0,obj.options.columns[b].options.onclose=function(D,L){obj.closeEditor(e,!0)},obj.options.columns[b].type=="color"?jSuites.color(S,obj.options.columns[b].options):jSuites.calendar(S,obj.options.columns[b].options),S.focus();else if(obj.options.columns[b].type=="html"){O=obj.options.data[l][b],(S=E("div")).style.position="relative",(v=document.createElement("div")).classList.add("jexcel_richtext"),S.appendChild(v),jSuites.editor(v,{focus:!0,value:O});var m=e.getBoundingClientRect(),s=v.getBoundingClientRect();window.innerHeight<m.bottom+s.height?v.style.top=m.top-(s.height+2)+"px":v.style.top=m.top+"px"}else if(obj.options.columns[b].type=="image"){var v,j=e.children[0];(S=E("div")).style.position="relative",(v=document.createElement("div")).classList.add("jclose"),j&&j.src&&v.appendChild(j),S.appendChild(v),jSuites.image(v,obj.options.imageOptions),m=e.getBoundingClientRect(),s=v.getBoundingClientRect(),window.innerHeight<m.bottom+s.height?v.style.top=m.top-(s.height+2)+"px":v.style.top=m.top+"px"}else{O=o==1?"":obj.options.data[l][b],obj.options.columns[b].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[b].wordWrap!=1?S=E("input"):S=E("textarea"),S.focus(),S.value=O,I=obj.options.columns[b];var g=null;if(!isFormula(O)&&(g=getMask(I))){if(!I.disabledMaskOnEdition)if(I.mask){var T=I.mask.split(";");S.setAttribute("data-mask",T[0])}else I.locale&&S.setAttribute("data-locale",I.locale);g.input=S,S.mask=g,jSuites.mask.render(O,g,!1)}S.onblur=function(){obj.closeEditor(e,!0)},S.scrollLeft=S.scrollWidth}}},obj.closeEditor=function(e,o){var r=parseInt(e.getAttribute("data-x")),l=parseInt(e.getAttribute("data-y"));if(o==1){if(obj.options.columns[r].editor)var b=obj.options.columns[r].editor.closeEditor(e,o);else if(!(obj.options.columns[r].type=="checkbox"||obj.options.columns[r].type=="radio"||obj.options.columns[r].type=="hidden"))if(obj.options.columns[r].type=="dropdown"||obj.options.columns[r].type=="autocomplete")b=e.children[0].dropdown.close(!0);else if(obj.options.columns[r].type=="calendar")b=e.children[0].calendar.close(!0);else if(obj.options.columns[r].type=="color")b=e.children[0].color.close(!0);else if(obj.options.columns[r].type=="html")b=e.children[0].children[0].editor.getData();else if(obj.options.columns[r].type=="image"){var E=e.children[0].children[0].children[0];b=E&&E.tagName=="IMG"?E.src:""}else if(obj.options.columns[r].type=="numeric")(""+(b=e.children[0].value)).substr(0,1)!="="&&b==""&&(b=obj.options.columns[r].allowEmpty?"":0),e.children[0].onblur=null;else{b=e.children[0].value,e.children[0].onblur=null;var O,d=obj.options.columns[r];if((O=getMask(d))&&b!==""&&!isFormula(b)&&typeof b!="number"){var u=jSuites.mask.extract(b,O,!0);u&&u.value!==""&&(b=u.value)}}obj.options.data[l][r]==b?e.innerHTML=obj.edition[1]:obj.setValue(e,b)}else obj.options.columns[r].editor?obj.options.columns[r].editor.closeEditor(e,o):obj.options.columns[r].type=="dropdown"||obj.options.columns[r].type=="autocomplete"?e.children[0].dropdown.close(!0):obj.options.columns[r].type=="calendar"?e.children[0].calendar.close(!0):obj.options.columns[r].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,r,l,b,o),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var o=(e=jexcel.getIdFromColumnName(e,!0))[0],r=e[1];return obj.records[r][o]},obj.getColumnOptions=function(e,o){var r=obj.options.columns[e];return r||(r={type:"text"}),r},obj.getCellFromCoords=function(e,o){return obj.records[o][e]},obj.getLabel=function(e){var o=(e=jexcel.getIdFromColumnName(e,!0))[0],r=e[1];return obj.records[r][o].innerHTML},obj.getLabelFromCoords=function(e,o){return obj.records[o][e].innerHTML},obj.getValue=function(e,o){if(typeof e=="object")var r=e.getAttribute("data-x"),l=e.getAttribute("data-y");else r=(e=jexcel.getIdFromColumnName(e,!0))[0],l=e[1];var b=null;return r!=null&&l!=null&&(obj.records[l]&&obj.records[l][r]&&(o||obj.options.copyCompatibility==1)?b=obj.records[l][r].innerHTML:obj.options.data[l]&&obj.options.data[l][r]!="undefined"&&(b=obj.options.data[l][r])),b},obj.getValueFromCoords=function(e,o,r){var l=null;return e!=null&&o!=null&&(obj.records[o]&&obj.records[o][e]&&r||obj.options.copyCompatibility==1?l=obj.records[o][e].innerHTML:obj.options.data[o]&&obj.options.data[o][e]!="undefined"&&(l=obj.options.data[o][e])),l},obj.setValue=function(e,o,r){var l=[];if(typeof e=="string"){var b=(u=jexcel.getIdFromColumnName(e,!0))[0],E=u[1];l.push(obj.updateCell(b,E,o,r)),obj.updateFormulaChain(b,E,l)}else if(b=null,E=null,e&&e.getAttribute&&(b=e.getAttribute("data-x"),E=e.getAttribute("data-y")),b!=null&&E!=null)l.push(obj.updateCell(b,E,o,r)),obj.updateFormulaChain(b,E,l);else{var O=Object.keys(e);if(O.length>0)for(var d=0;d<O.length;d++){var u;typeof e[d]=="string"?(b=(u=jexcel.getIdFromColumnName(e[d],!0))[0],E=u[1]):e[d].x!=null&&e[d].y!=null?(b=e[d].x,E=e[d].y,e[d].newValue!=null?o=e[d].newValue:e[d].value!=null&&(o=e[d].value)):(b=e[d].getAttribute("data-x"),E=e[d].getAttribute("data-y")),b!=null&&E!=null&&(l.push(obj.updateCell(b,E,o,r)),obj.updateFormulaChain(b,E,l))}}obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,l)},obj.setValueFromCoords=function(e,o,r,l){var b=[];b.push(obj.updateCell(e,o,r,l)),obj.updateFormulaChain(e,o,b),obj.setHistory({action:"setValue",records:b,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,b)},obj.setCheckRadioValue=function(){for(var e=[],o=Object.keys(obj.highlighted),r=0;r<o.length;r++){var l=obj.highlighted[r].getAttribute("data-x"),b=obj.highlighted[r].getAttribute("data-y");obj.options.columns[l].type!="checkbox"&&obj.options.columns[l].type!="radio"||e.push(obj.updateCell(l,b,!obj.options.data[b][l]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var o=new Option;o.innerHTML=e;var r=null;for(e=o.getElementsByTagName("script");r=e[0];)r.parentNode.removeChild(r);return o.innerHTML};obj.updateCell=function(e,o,r,l){if(obj.records[o][e].classList.contains("readonly")!=1||l){var b;(""+r).substr(0,1)=="="&&obj.options.secureFormulas==1&&(b=secureFormula(r))!=r&&(r=b),(b=obj.dispatch("onbeforechange",el,obj.records[o][e],e,o,r))!=null&&(r=b),obj.options.columns[e].editor&&typeof obj.options.columns[e].editor.updateCell=="function"&&(r=obj.options.columns[e].editor.updateCell(obj.records[o][e],r,l)),S={x:e,y:o,col:e,row:o,newValue:r,oldValue:obj.options.data[o][e]};let I=obj.options.columns[e].editor;if(I)obj.options.data[o][e]=r,typeof I.setValue=="function"&&I.setValue(obj.records[o][e],r);else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){if(obj.options.columns[e].type=="radio")for(var E=0;E<obj.options.data.length;E++)obj.options.data[E][e]=!1;obj.records[o][e].children[0].checked=r==1||r==1||r=="true"||r=="TRUE",obj.options.data[o][e]=obj.records[o][e].children[0].checked}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")obj.options.data[o][e]=r,obj.records[o][e].textContent=obj.getDropDownValue(e,r);else if(obj.options.columns[e].type=="calendar"){var O=null;if(!validDate(r)){var d=jSuites.calendar.extractDateFromString(r,obj.options.columns[e].options.format);d&&(O=d)}obj.options.data[o][e]=r,obj.records[o][e].textContent=jSuites.calendar.getDateString(O||r,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="color")if(obj.options.data[o][e]=r,obj.options.columns[e].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=r,obj.records[o][e].textContent="",obj.records[o][e].appendChild(u)}else obj.records[o][e].style.color=r,obj.records[o][e].textContent=r;else if(obj.options.columns[e].type=="image"){if(r=""+r,obj.options.data[o][e]=r,obj.records[o][e].innerHTML="",r&&r.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=r,obj.records[o][e].appendChild(f)}}else obj.options.data[o][e]=r,obj.options.columns[e].type=="html"?obj.records[o][e].innerHTML=stripScript(obj.parseValue(e,o,r)):obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?obj.records[o][e].innerHTML=stripScript(obj.parseValue(e,o,r,obj.records[o][e])):obj.records[o][e].textContent=obj.parseValue(e,o,r,obj.records[o][e]),obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||obj.records[o][e].innerHTML.length>200)?obj.records[o][e].style.whiteSpace="pre-wrap":obj.records[o][e].style.whiteSpace="";e>0&&(obj.records[o][e-1].style.overflow=r?"hidden":""),obj.dispatch("onchange",el,obj.records[o]&&obj.records[o][e]?obj.records[o][e]:null,e,o,r,S.oldValue)}else var S={x:e,y:o,col:e,row:o};return S},obj.copyData=function(e,o){var r=obj.getData(!0,!0),l=obj.selectedContainer,b=parseInt(e.getAttribute("data-x")),E=parseInt(e.getAttribute("data-y")),O=parseInt(o.getAttribute("data-x")),d=parseInt(o.getAttribute("data-y")),u=[],f=!1;if(l[0]==b){if(E<l[1])var S=E-l[1];else S=1;var I=0}else I=b<l[0]?b-l[0]:1,S=0;for(var m=0,s=0,v=E;v<=d;v++)if(!obj.rows[v]||obj.rows[v].style.display!="none"){r[s]==null&&(s=0),m=0,l[0]!=b&&(I=b<l[0]?b-l[0]:1);for(var j=b;j<=O;j++){if(obj.records[v][j]&&!obj.records[v][j].classList.contains("readonly")&&obj.records[v][j].style.display!="none"&&f==0){if(!obj.selection.length&&obj.options.data[v][j]!=""){f=!0;continue}(r[s]==null||r[s][m]==null)&&(m=0);var g=r[s][m];if(g&&!r[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+g).substr(0,1)=="="){var T=g.match(/([A-Z]+[0-9]+)/g);if(T){for(var D=[],L=0;L<T.length;L++){var _=jexcel.getIdFromColumnName(T[L],1);_[0]+=I,_[1]+=S,_[1]<0&&(_[1]=0);var F=jexcel.getColumnNameFromId([_[0],_[1]]);F!=T[L]&&(D[T[L]]=F)}D&&(g=obj.updateFormula(g,D))}}else g==Number(g)&&(g=Number(g)+S);else if(obj.options.columns[j].type=="calendar"){var M=new Date(g);M.setDate(M.getDate()+S),g=M.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+jexcel.doubleDigitFormat(M.getDate())+" 00:00:00"}}u.push(obj.updateCell(j,v,g)),obj.updateFormulaChain(j,v,u)}m++,l[0]!=b&&I++}s++,S++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,o,r){if(e==1){if(obj.selectedCell&&(o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]||r>=obj.selectedCell[1]&&r<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]||r>=obj.selectedCell[0]&&r<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){f=1;for(var o=0;o<obj.highlighted.length;o++){obj.highlighted[o].classList.remove("highlight"),obj.highlighted[o].classList.remove("highlight-left"),obj.highlighted[o].classList.remove("highlight-right"),obj.highlighted[o].classList.remove("highlight-top"),obj.highlighted[o].classList.remove("highlight-bottom"),obj.highlighted[o].classList.remove("highlight-selected");var r=parseInt(obj.highlighted[o].getAttribute("data-x")),l=parseInt(obj.highlighted[o].getAttribute("data-y"));if(obj.highlighted[o].getAttribute("data-merged"))var b=parseInt(obj.highlighted[o].getAttribute("colspan")),E=parseInt(obj.highlighted[o].getAttribute("rowspan")),O=b>0?r+(b-1):r,d=E>0?l+(E-1):l;else O=r,d=l;for(var u=r;u<=O;u++)obj.headers[u]&&obj.headers[u].classList.remove("selected");for(u=l;u<=d;u++)obj.rows[u]&&obj.rows[u].classList.remove("selected")}}else var f=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",e==1&&f==1&&obj.dispatch("onblur",el),f},obj.updateSelection=function(e,o,r){var l=e.getAttribute("data-x"),b=e.getAttribute("data-y");if(o)var E=o.getAttribute("data-x"),O=o.getAttribute("data-y");else E=l,O=b;obj.updateSelectionFromCoords(l,b,E,O,r)},obj.updateSelectionFromCoords=function(e,o,r,l,b){var E=obj.resetSelection();if(o==null&&(o=0,l=obj.rows.length-1),r==null&&(r=e),l==null&&(l=o),e>=obj.headers.length&&(e=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),r>=obj.headers.length&&(r=obj.headers.length-1),l>=obj.rows.length&&(l=obj.rows.length-1),obj.selectedCell=[e,o,r,l],e!=null){if(obj.records[o][e]&&obj.records[o][e].classList.add("highlight-selected"),parseInt(e)<parseInt(r))var O=parseInt(e),d=parseInt(r);else O=parseInt(r),d=parseInt(e);if(parseInt(o)<parseInt(l))var u=parseInt(o),f=parseInt(l);else u=parseInt(l),f=parseInt(o);for(var S=O;S<=d;S++)for(var I=u;I<=f;I++)if(obj.records[I][S]&&obj.records[I][S].getAttribute("data-merged")){var m=parseInt(obj.records[I][S].getAttribute("data-x")),s=parseInt(obj.records[I][S].getAttribute("data-y")),v=parseInt(obj.records[I][S].getAttribute("colspan")),j=parseInt(obj.records[I][S].getAttribute("rowspan"));v>1&&(m<O&&(O=m),m+v>d&&(d=m+v-1)),j&&(s<u&&(u=s),s+j>f&&(f=s+j-1))}var g=null,T=null,D=null,L=null;for(I=u;I<=f;I++)obj.rows[I].style.display!="none"&&(D==null&&(D=I),L=I);for(S=O;S<=d;S++){for(I=u;I<=f;I++)obj.rows[I].style.display!="none"&&obj.records[I][S].style.display!="none"&&(obj.records[I][S].classList.add("highlight"),obj.highlighted.push(obj.records[I][S]));obj.options.columns[S].type!="hidden"&&(g==null&&(g=S),T=S)}for(g||(g=0),T||(T=0),S=g;S<=T;S++)obj.options.columns[S].type!="hidden"&&obj.colgroup[S].style&&obj.colgroup[S].style.display!="none"&&(obj.records[D]&&obj.records[D][S]&&obj.records[D][S].classList.add("highlight-top"),obj.records[L]&&obj.records[L][S]&&obj.records[L][S].classList.add("highlight-bottom"),obj.headers[S].classList.add("selected"));for(I=D;I<=L;I++)obj.rows[I]&&obj.rows[I].style.display!="none"&&(obj.records[I][g].classList.add("highlight-left"),obj.records[I][T].classList.add("highlight-right"),obj.rows[I].classList.add("selected"));obj.selectedContainer=[g,D,T,L]}E==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,g,D,T,L,b),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,o){obj.removeCopySelection();var r=obj.selectedContainer[0],l=obj.selectedContainer[1],b=obj.selectedContainer[2],E=obj.selectedContainer[3];if(e!=null&&o!=null){if(e-b>0)var O=parseInt(b)+1,d=parseInt(e);else O=parseInt(e),d=parseInt(r)-1;if(o-E>0)var u=parseInt(E)+1,f=parseInt(o);else u=parseInt(o),f=parseInt(l)-1;d-O<=f-u?(O=parseInt(r),d=parseInt(b)):(u=parseInt(l),f=parseInt(E));for(var S=u;S<=f;S++)for(var I=O;I<=d;I++)obj.records[S][I]&&obj.rows[S].style.display!="none"&&obj.records[S][I].style.display!="none"&&(obj.records[S][I].classList.add("selection"),obj.records[u][I].classList.add("selection-top"),obj.records[f][I].classList.add("selection-bottom"),obj.records[S][O].classList.add("selection-left"),obj.records[S][d].classList.add("selection-right"),obj.selection.push(obj.records[S][I]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],o=e.getAttribute("data-x"),r=obj.content.getBoundingClientRect(),l=r.left,b=r.top,E=e.getBoundingClientRect(),O=E.left,d=E.top,u=E.width,f=E.height,S=O-l+obj.content.scrollLeft+u-4,I=d-b+obj.content.scrollTop+f-4;if(obj.corner.style.top=I+"px",obj.corner.style.left=S+"px",obj.options.freezeColumns){var m=obj.getFreezeWidth();o>obj.options.freezeColumns-1&&O-l+u<m?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var o=obj.content.getBoundingClientRect(),r=o.left,l=o.top,b=o.width,E=o.height,O=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),d=O.left,u=O.top,f=O.width,S=O.height;if(e==0||e==1)var I=d-r+obj.content.scrollLeft,m=u-l+obj.content.scrollTop-2;else I=d-r+obj.content.scrollLeft+f,m=u-l+obj.content.scrollTop+S;m>obj.content.scrollTop+30&&m<obj.content.scrollTop+E||(m<obj.content.scrollTop+30?obj.content.scrollTop=m-S:obj.content.scrollTop=m-(E-2));var s=obj.getFreezeWidth();I>obj.content.scrollLeft+s&&I<obj.content.scrollLeft+b||(I<obj.content.scrollLeft+30?(obj.content.scrollLeft=I,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):I<obj.content.scrollLeft+s?obj.content.scrollLeft=I-s-1:obj.content.scrollLeft=I-(b-20))},obj.getWidth=function(e){if(e===void 0)for(var o=[],r=0;r<obj.headers.length;r++)o.push(obj.options.columns[r].width);else typeof e=="object"&&(e=e.getAttribute("data-x")),o=obj.colgroup[e].getAttribute("width");return o},obj.setWidth=function(e,o,r){if(o){if(Array.isArray(e)){r||(r=[]);for(var l=0;l<e.length;l++){r[l]||(r[l]=obj.colgroup[e[l]].getAttribute("width"));var b=Array.isArray(o)&&o[l]?o[l]:o;obj.colgroup[e[l]].setAttribute("width",b),obj.options.columns[e[l]].width=b}}else r||(r=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",o),obj.options.columns[e].width=o;obj.setHistory({action:"setWidth",column:e,oldValue:r,newValue:o}),obj.dispatch("onresizecolumn",el,e,o,r),obj.updateCornerPosition()}},obj.setHeight=function(e,o,r){o>0&&(typeof e=="object"&&(e=e.getAttribute("data-y")),r||(r=obj.rows[e].getAttribute("height"))||(r=obj.rows[e].getBoundingClientRect().height),o=parseInt(o),obj.rows[e].style.height=o+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=o,obj.setHistory({action:"setHeight",row:e,oldValue:r,newValue:o}),obj.dispatch("onresizerow",el,e,o,r),obj.updateCornerPosition())},obj.getHeight=function(e){if(e===void 0)for(var o=[],r=0;r<obj.rows.length;r++){var l=obj.rows[r].style.height;l&&(o[r]=l)}else typeof e=="object"&&(e=$(e).getAttribute("data-y")),o=obj.rows[e].style.height;return o},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var o=0;o<obj.options.footers.length;o++){if(obj.tfoot.children[o])var r=obj.tfoot.children[o];else{r=document.createElement("tr");var l=document.createElement("td");r.appendChild(l),obj.tfoot.appendChild(r)}for(var b=0;b<obj.headers.length;b++){if(obj.options.footers[o][b]||(obj.options.footers[o][b]=""),obj.tfoot.children[o].children[b+1])l=obj.tfoot.children[o].children[b+1];else{l=document.createElement("td"),r.appendChild(l);var E=obj.options.columns[b].align?obj.options.columns[b].align:"center";l.style.textAlign=E}l.textContent=obj.parseValue(+obj.records.length+b,o,obj.options.footers[o][b]),l.style.display=obj.colgroup[b].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,o){if(obj.headers[e]){var r=obj.headers[e].textContent;o||(o=prompt(obj.options.text.columnName,r)),o&&(obj.headers[e].textContent=o,obj.headers[e].setAttribute("title",o),obj.options.columns[e].title=o),obj.setHistory({action:"setHeader",column:e,oldValue:r,newValue:o}),obj.dispatch("onchangeheader",el,e,r,o)}},obj.getHeaders=function(e){for(var o=[],r=0;r<obj.headers.length;r++)o.push(obj.getHeader(r));return e?o:o.join(obj.options.csvDelimiter)},obj.getMeta=function(e,o){return e?o?obj.options.meta[e]&&obj.options.meta[e][o]?obj.options.meta[e][o]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,o,r){if(obj.options.meta||(obj.options.meta={}),o&&r)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][o]=r;else for(var l=Object.keys(e),b=0;b<l.length;b++){obj.options.meta[l[b]]||(obj.options.meta[l[b]]={});for(var E=Object.keys(e[l[b]]),O=0;O<E.length;O++)obj.options.meta[l[b]][E[O]]=e[l[b]][E[O]]}obj.dispatch("onchangemeta",el,e,o,r)},obj.updateMeta=function(e){if(obj.options.meta){for(var o={},r=Object.keys(obj.options.meta),l=0;l<r.length;l++)e[r[l]]?o[e[r[l]]]=obj.options.meta[r[l]]:o[r[l]]=obj.options.meta[r[l]];obj.options.meta=o}},obj.getStyle=function(e,o){if(e)return e=jexcel.getIdFromColumnName(e,!0),o?obj.records[e[1]][e[0]].style[o]:obj.records[e[1]][e[0]].getAttribute("style");for(var r={},l=obj.options.data[0].length,b=obj.options.data.length,E=0;E<b;E++)for(var O=0;O<l;O++){var d=o?obj.records[E][O].style[o]:obj.records[E][O].getAttribute("style");d&&(r[jexcel.getColumnNameFromId([O,E])]=d)}return r},obj.resetStyle=function(e,o){for(var r=Object.keys(e),l=0;l<r.length;l++){var b=jexcel.getIdFromColumnName(r[l],!0);obj.records[b[1]]&&obj.records[b[1]][b[0]]&&obj.records[b[1]][b[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,o)},obj.setStyle=function(e,o,r,l,b){var E={},O={},d=function(g,T,D){var L=jexcel.getIdFromColumnName(g,!0);if(obj.records[L[1]]&&obj.records[L[1]][L[0]]&&(obj.records[L[1]][L[0]].classList.contains("readonly")==0||l)){var _=obj.records[L[1]][L[0]].style[T];_!=D||l?obj.records[L[1]][L[0]].style[T]=D:(D="",obj.records[L[1]][L[0]].style[T]=""),O[g]||(O[g]=[]),E[g]||(E[g]=[]),O[g].push([T+":"+_]),E[g].push([T+":"+D])}};if(o&&r)if(typeof e=="string")d(e,o,r);else for(var u=[],f=0;f<e.length;f++){var S=e[f].getAttribute("data-x"),I=e[f].getAttribute("data-y"),m=jexcel.getColumnNameFromId([S,I]);u[m]||(d(m,o,r),u[m]=!0)}else{var s=Object.keys(e);for(f=0;f<s.length;f++){var v=e[s[f]];typeof v=="string"&&(v=v.split(";"));for(var j=0;j<v.length;j++)typeof v[j]=="string"&&(v[j]=v[j].split(":")),v[j][0].trim()&&d(s[f],v[j][0].trim(),v[j][1])}}for(s=Object.keys(O),f=0;f<s.length;f++)O[s[f]]=O[s[f]].join(";");for(s=Object.keys(E),f=0;f<s.length;f++)E[s[f]]=E[s[f]].join(";");b||obj.setHistory({action:"setStyle",oldValue:O,newValue:E}),obj.dispatch("onchangestyle",el,e,o,r)},obj.getComments=function(e,o){if(e)return typeof e=="string"&&(e=jexcel.getIdFromColumnName(e,!0)),o?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var r={},l=0;l<obj.options.data.length;l++)for(var b=0;b<obj.options.columns.length;b++){var E=obj.records[l][b].getAttribute("title");E&&(r[e=jexcel.getColumnNameFromId([b,l])]=E)}return r},obj.setComments=function(e,o,r){if(typeof e=="string")var l=jexcel.getIdFromColumnName(e,!0);else l=e;var b=obj.records[l[1]][l[0]].getAttribute("title"),E=[b,r=obj.records[l[1]][l[0]].getAttribute("data-author")];obj.records[l[1]][l[0]].setAttribute("title",o||""),obj.records[l[1]][l[0]].setAttribute("data-author",r||""),o?obj.records[l[1]][l[0]].classList.add("jexcel_comments"):obj.records[l[1]][l[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[o,r],oldValue:E}),obj.dispatch("oncomments",el,o,b,l,l[0],l[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,o){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}o=o==null?obj.headers[e].classList.contains("arrow-down")?1:0:o?1:0;var r=[];if(obj.options.columns[e].type=="number"||obj.options.columns[e].type=="numeric"||obj.options.columns[e].type=="percentage"||obj.options.columns[e].type=="autonumber"||obj.options.columns[e].type=="color")for(var l=0;l<obj.options.data.length;l++)r[l]=[l,Number(obj.options.data[l][e])];else if(obj.options.columns[e].type=="calendar"||obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio")for(l=0;l<obj.options.data.length;l++)r[l]=[l,obj.options.data[l][e]];else for(l=0;l<obj.options.data.length;l++)r[l]=[l,obj.records[l][e].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(E){return function(O,d){var u=O[1],f=d[1];return E?u===""&&f!==""?1:u!==""&&f===""||u>f?-1:u<f?1:0:u===""&&f!==""?1:u!==""&&f===""?-1:u>f?1:u<f?-1:0}}),r=r.sort(obj.options.sorting(o));var b=[];for(l=0;l<r.length;l++)b[l]=r[l][0];return obj.setHistory({action:"orderBy",rows:b,column:e,order:o}),obj.updateOrderArrow(e,o),obj.updateOrder(b),obj.dispatch("onsort",el,e,o),!0}},obj.updateOrderArrow=function(e,o){for(var r=0;r<obj.headers.length;r++)obj.headers[r].classList.remove("arrow-up"),obj.headers[r].classList.remove("arrow-down");o?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var o=[],r=0;r<e.length;r++)o[r]=obj.options.data[e[r]];for(obj.options.data=o,o=[],r=0;r<e.length;r++)o[r]=obj.records[e[r]];for(obj.records=o,o=[],r=0;r<e.length;r++)o[r]=obj.rows[e[r]];if(obj.rows=o,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(r=0;r<obj.rows.length;r++)obj.tbody.appendChild(obj.rows[r])},obj.moveRow=function(e,o,r){if(Object.keys(obj.options.mergeCells).length>0){if(e>o)var l=1;else l=0;if(obj.isRowMerged(e).length||obj.isRowMerged(o,l).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}r||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[o])>=0?e>o?obj.tbody.insertBefore(obj.rows[e],obj.rows[o]):obj.tbody.insertBefore(obj.rows[e],obj.rows[o].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(o,0,obj.rows.splice(e,1)[0]),obj.records.splice(o,0,obj.records.splice(e,1)[0]),obj.options.data.splice(o,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:o}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,o)},obj.insertRow=function(e,o,r){if(obj.options.allowInsertRow==1){var l=[];if(e>0)var b=e;else b=1,e&&(l=e);r=!!r;var E=obj.options.data.length-1;if((o==null||o>=parseInt(E)||o<0)&&(o=E),obj.dispatch("onbeforeinsertrow",el,o,b,r)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(o,r).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var O=r?o:o+1,d=obj.records.splice(O),u=obj.options.data.splice(O),f=obj.rows.splice(O),S=[],I=[],m=[],s=O;s<b+O;s++){obj.options.data[s]=[];for(var v=0;v<obj.options.columns.length;v++)obj.options.data[s][v]=l[v]?l[v]:"";var j=obj.createRow(s,obj.options.data[s]);f[0]?Array.prototype.indexOf.call(obj.tbody.children,f[0])>=0&&obj.tbody.insertBefore(j,f[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[o])>=0&&obj.tbody.appendChild(j),S.push(obj.records[s]),I.push(obj.options.data[s]),m.push(j)}Array.prototype.push.apply(obj.records,d),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,f),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:o,numOfRows:b,insertBefore:r,rowRecords:S,rowData:I,rowNode:m}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,o,b,S,r)}},obj.deleteRow=function(e,o){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(e==null){var r=obj.getSelectedRows();r[0]?(e=parseInt(r[0].getAttribute("data-y")),o=r.length):(e=obj.options.data.length-1,o=1)}var l=obj.options.data.length-1;if((e==null||e>l||e<0)&&(e=l),o||(o=1),e+o>=obj.options.data.length&&(o=obj.options.data.length-e),obj.dispatch("onbeforedeleterow",el,e,o)===!1)return!1;if(parseInt(e)>-1){var b=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var E=e;E<e+o;E++)obj.isRowMerged(E,!1).length&&(b=!0);if(b){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&l+1===o&&(o--,console.error("Jspreadsheet: It is not possible to delete the last row")),E=e;E<e+o;E++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[E])>=0&&(obj.rows[E].className="",obj.rows[E].parentNode.removeChild(obj.rows[E]));var O=obj.records.splice(e,o),d=obj.options.data.splice(e,o),u=obj.rows.splice(e,o);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+o-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:o,insertBefore:1,rowRecords:O,rowData:d,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,o,O)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,o){if(Object.keys(obj.options.mergeCells).length>0){if(e>o)var r=1;else r=0;if(obj.isColMerged(e).length||obj.isColMerged(o,r).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(o=parseInt(o))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[o]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[o]);for(var l=0;l<obj.rows.length;l++)obj.rows[l].insertBefore(obj.records[l][e],obj.records[l][o])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[o].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[o].nextSibling),l=0;l<obj.rows.length;l++)obj.rows[l].insertBefore(obj.records[l][e],obj.records[l][o].nextSibling);for(obj.options.columns.splice(o,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(o,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(o,0,obj.colgroup.splice(e,1)[0]),l=0;l<obj.rows.length;l++)obj.options.data[l].splice(o,0,obj.options.data[l].splice(e,1)[0]),obj.records[l].splice(o,0,obj.records[l].splice(e,1)[0]);if(obj.options.footers)for(l=0;l<obj.options.footers.length;l++)obj.options.footers[l].splice(o,0,obj.options.footers[l].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:o}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,o)},obj.insertColumn=function(e,o,r,l){if(obj.options.allowInsertColumn==1){var b=[];if(e>0)var E=e;else E=1,e&&(b=e);r=!!r;var O=obj.options.columns.length-1;if((o==null||o>=parseInt(O)||o<0)&&(o=O),obj.dispatch("onbeforeinsertcolumn",el,o,E,r)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(o,r).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}l||(l=[]);for(var d=0;d<E;d++)l[d]||(l[d]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=r?o:o+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,l);for(var f=obj.headers.splice(u),S=obj.colgroup.splice(u),I=[],m=[],s=[],v=[],j=[],g=u;g<E+u;g++)obj.createCellHeader(g),obj.headerContainer.insertBefore(obj.headers[g],obj.headerContainer.children[g+1]),obj.colgroupContainer.insertBefore(obj.colgroup[g],obj.colgroupContainer.children[g+1]),I.push(obj.headers[g]),m.push(obj.colgroup[g]);if(obj.options.footers)for(var T=0;T<obj.options.footers.length;T++){for(j[T]=[],d=0;d<E;d++)j[T].push("");obj.options.footers[T].splice(u,0,j[T])}for(var D=0;D<obj.options.data.length;D++){var L=obj.options.data[D].splice(u),_=obj.records[D].splice(u);for(v[D]=[],s[D]=[],g=u;g<E+u;g++){var F=b[D]?b[D]:"";obj.options.data[D][g]=F;var M=obj.createCell(g,D,obj.options.data[D][g]);obj.records[D][g]=M,obj.rows[D]&&obj.rows[D].insertBefore(M,obj.rows[D].children[g+1]),v[D].push(F),s[D].push(M)}Array.prototype.push.apply(obj.options.data[D],L),Array.prototype.push.apply(obj.records[D],_)}if(Array.prototype.push.apply(obj.headers,f),Array.prototype.push.apply(obj.colgroup,S),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(T=0;T<obj.options.nestedHeaders.length;T++){var B=parseInt(obj.options.nestedHeaders[T][obj.options.nestedHeaders[T].length-1].colspan)+E;obj.options.nestedHeaders[T][obj.options.nestedHeaders[T].length-1].colspan=B,obj.thead.children[T].children[obj.thead.children[T].children.length-1].setAttribute("colspan",B);var K=obj.thead.children[T].children[obj.thead.children[T].children.length-1].getAttribute("data-column");for(K=K.split(","),g=u;g<E+u;g++)K.push(g);obj.thead.children[T].children[obj.thead.children[T].children.length-1].setAttribute("data-column",K)}else B=parseInt(obj.options.nestedHeaders[0].colspan)+E,obj.options.nestedHeaders[0].colspan=B,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",B);obj.setHistory({action:"insertColumn",columnNumber:o,numOfColumns:E,insertBefore:r,columns:l,headers:I,colgroup:m,records:s,footers:j,data:v}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,o,E,s,r)}},obj.deleteColumn=function(e,o){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(e==null){var r=obj.getSelectedColumns(!0);r.length?(e=parseInt(r[0]),o=parseInt(r.length)):(e=obj.headers.length-1,o=1)}var l=obj.options.data[0].length-1;if((e==null||e>l||e<0)&&(e=l),o||(o=1),o>obj.options.data[0].length-e&&(o=obj.options.data[0].length-e),obj.dispatch("onbeforedeletecolumn",el,e,o)===!1)return!1;if(parseInt(e)>-1){var b=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var E=e;E<e+o;E++)obj.isColMerged(E,!1).length&&(b=!0);if(b){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var O=obj.options.columns.splice(e,o);for(E=e;E<e+o;E++)obj.colgroup[E].className="",obj.headers[E].className="",obj.colgroup[E].parentNode.removeChild(obj.colgroup[E]),obj.headers[E].parentNode.removeChild(obj.headers[E]);for(var d=obj.headers.splice(e,o),u=obj.colgroup.splice(e,o),f=[],S=[],I=[],m=0;m<obj.options.data.length;m++)for(E=e;E<e+o;E++)obj.records[m][E].className="",obj.records[m][E].parentNode.removeChild(obj.records[m][E]);for(m=0;m<obj.options.data.length;m++)S[m]=obj.options.data[m].splice(e,o),f[m]=obj.records[m].splice(e,o);if(obj.options.footers)for(m=0;m<obj.options.footers.length;m++)I[m]=obj.options.footers[m].splice(e,o);if(obj.conditionalSelectionUpdate(0,e,e+o-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var s=0;s<obj.options.nestedHeaders.length;s++){var v=parseInt(obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan)-o;obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan=v,obj.thead.children[s].children[obj.thead.children[s].children.length-1].setAttribute("colspan",v)}else v=parseInt(obj.options.nestedHeaders[0].colspan)-o,obj.options.nestedHeaders[0].colspan=v,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",v);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:o,insertBefore:1,columns:O,headers:d,colgroup:u,records:f,footers:I,data:S}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,o,f)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var o=[],r=0;r<obj.rows.length;r++)obj.rows[r].classList.contains("selected")&&(e?o.push(r):o.push(obj.rows[r]));return o},obj.getSelectedColumns=function(){for(var e=[],o=0;o<obj.headers.length;o++)obj.headers[o].classList.contains("selected")&&e.push(o);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(E=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var o=0;o<obj.rows.length;o++)obj.rows[o]&&(O=obj.rows[o].getAttribute("data-y"))!=o&&(obj.rows[o].setAttribute("data-y",o),obj.rows[o].children[0].setAttribute("data-y",o),obj.rows[o].children[0].innerHTML=o+1);var r=[],l=[],b=function(s,v,j,g){if(s!=j&&obj.records[g][j].setAttribute("data-x",j),v!=g&&obj.records[g][j].setAttribute("data-y",g),s!=j||v!=g){var T=jexcel.getColumnNameFromId([s,v]),D=jexcel.getColumnNameFromId([j,g]);r[T]=D}};for(o=0;o<obj.records.length;o++)for(e=0;e<obj.records[0].length;e++)if(obj.records[o][e]){var E=obj.records[o][e].getAttribute("data-x"),O=obj.records[o][e].getAttribute("data-y");if(obj.records[o][e].getAttribute("data-merged")){var d=jexcel.getColumnNameFromId([E,O]),u=jexcel.getColumnNameFromId([e,o]);if(l[d]==null)if(d==u)l[d]=!1;else{var f=parseInt(e-E),S=parseInt(o-O);l[d]=[u,f,S]}}else b(E,O,e,o)}var I=Object.keys(l);if(I.length){for(e=0;e<I.length;e++)if(l[I[e]]){var m=jexcel.getIdFromColumnName(I[e],!0);for(b(E=m[0],O=m[1],E+l[I[e]][1],O+l[I[e]][2]),d=I[e],u=l[I[e]][0],o=0;o<obj.options.mergeCells[d][2].length;o++)E=parseInt(obj.options.mergeCells[d][2][o].getAttribute("data-x")),O=parseInt(obj.options.mergeCells[d][2][o].getAttribute("data-y")),obj.options.mergeCells[d][2][o].setAttribute("data-x",E+l[I[e]][1]),obj.options.mergeCells[d][2][o].setAttribute("data-y",O+l[I[e]][2]);obj.options.mergeCells[u]=obj.options.mergeCells[d],delete obj.options.mergeCells[d]}}obj.updateFormulas(r),obj.updateMeta(r),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,o=obj.rows.length-1;o>=0;o--){for(var r=!1,l=0;l<obj.headers.length;l++)obj.options.data[o][l]&&(r=!0);if(r)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var b=0;for(l=obj.headers.length-1;l>=0;l--){for(r=!1,o=0;o<obj.rows.length;o++)obj.options.data[o][l]&&(r=!0);if(r)break;b++}obj.options.minSpareCols-b>0&&obj.insertColumn(obj.options.minSpareCols-b)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),o=0;o<obj.rows.length;o++)for(l=0;l<obj.headers.length;l++)obj.options.updateTable(el,obj.records[o][l],l,o,obj.options.data[o][l],obj.records[o][l].textContent,jexcel.getColumnNameFromId([l,o]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,o){(e=obj.getCell(e))&&(o?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var o=0;o<obj.options.data.length;o++)obj.records[o][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var o=0;o<obj.options.data.length;o++)obj.records[o][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,o,r){var l=jexcel.getColumnNameFromId([e,o]);if(obj.formula[l]&&obj.formula[l].length>0)if(chainLoopProtection[l])obj.records[o][e].innerHTML="#ERROR",obj.formula[l]="";else{chainLoopProtection[l]=!0;for(var b=0;b<obj.formula[l].length;b++){var E=jexcel.getIdFromColumnName(obj.formula[l][b],!0),O=""+obj.options.data[E[1]][E[0]];O.substr(0,1)=="="?r.push(obj.updateCell(E[0],E[1],O,!0)):Object.keys(obj.formula)[b]=null,obj.updateFormulaChain(E[0],E[1],r)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var o=0;o<obj.options.data.length;o++)for(var r=0;r<obj.options.data[0].length;r++)if((d=""+obj.options.data[o][r]).substr(0,1)=="="){var l=obj.updateFormula(d,e);l!=d&&(obj.options.data[o][r]=l)}var b=[],E=Object.keys(obj.formula);for(o=0;o<E.length;o++){var O=E[o],d=obj.formula[O];for(e[O]&&(O=e[O]),b[O]=[],r=0;r<d.length;r++){var u=d[r];e[u]&&(u=e[u]),b[O].push(u)}}obj.formula=b},obj.updateFormula=function(e,o){for(var r=/[A-Z]/,l=/[0-9]/,b="",E=null,O=null,d="",u=0;u<e.length;u++)r.exec(e[u])?(E=1,O=0,d+=e[u]):l.exec(e[u])?(O=E?1:0,d+=e[u]):(E&&O&&(d=o[d]?o[d]:d),b+=d,b+=e[u],E=0,O=0,d="");return d&&(E&&O&&(d=o[d]?o[d]:d),b+=d),b};var secureFormula=function(e){for(var o="",r=0,l=0;l<e.length;l++)e[l]=='"'&&(r=r==0?1:0),o+=r==1?e[l]:e[l].toUpperCase();return o};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var o=0;o<e.length;o++){var r=[],l=e[o].split(":"),b=jexcel.getIdFromColumnName(l[0],!0),E=jexcel.getIdFromColumnName(l[1],!0);if(b[0]<=E[0])var O=b[0],d=E[0];else O=E[0],d=b[0];if(b[1]<=E[1])var u=b[1],f=E[1];else u=E[1],f=b[1];for(var S=u;S<=f;S++)for(var I=O;I<=d;I++)r.push(jexcel.getColumnNameFromId([I,S]));expression=expression.replace(e[o],r.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,o){var r=o&&obj.options.columns[o].decimal?obj.options.columns[o].decimal:".",l=""+e;return(l=l.split(r))[0]=l[0].match(/[+-]?[0-9]/g),l[0]&&(l[0]=l[0].join("")),l[1]&&(l[1]=l[1].match(/[0-9]*/g).join("")),l[0]&&Number.isInteger(Number(l[0]))?l[1]?e=+(l[0]+"."+l[1]):e=+(l[0]+".00"):e=null,e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,o){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,o?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var r=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-r<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var l=obj.whichPage(obj.selectedCell[3]);l!=obj.pageNumber&&obj.page(l)}obj.updateScroll(1)},obj.up.visible=function(e,o){if(e==0)var r=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else r=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(o==0){for(var b=0;b<l;b++)if(obj.records[b][r].style.display!="none"&&obj.rows[b].style.display!="none"){l=b;break}}else l=obj.up.get(r,l);e==0?(obj.selectedCell[0]=r,obj.selectedCell[1]=l):(obj.selectedCell[2]=r,obj.selectedCell[3]=l)},obj.up.get=function(e,o){e=parseInt(e);for(var r=(o=parseInt(o))-1;r>=0;r--)if(obj.records[r][e].style.display!="none"&&obj.rows[r].style.display!="none"){if(obj.records[r][e].getAttribute("data-merged")&&obj.records[r][e]==obj.records[o][e])continue;o=r;break}return o},obj.down=function(e,o){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,o?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(3)},obj.down.visible=function(e,o){if(e==0)var r=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else r=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(o==0){for(var b=obj.rows.length-1;b>l;b--)if(obj.records[b][r].style.display!="none"&&obj.rows[b].style.display!="none"){l=b;break}}else l=obj.down.get(r,l);e==0?(obj.selectedCell[0]=r,obj.selectedCell[1]=l):(obj.selectedCell[2]=r,obj.selectedCell[3]=l)},obj.down.get=function(e,o){e=parseInt(e);for(var r=(o=parseInt(o))+1;r<obj.rows.length;r++)if(obj.records[r][e].style.display!="none"&&obj.rows[r].style.display!="none"){if(obj.records[r][e].getAttribute("data-merged")&&obj.records[r][e]==obj.records[o][e])continue;o=r;break}return o},obj.right=function(e,o){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,o?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,o){if(e==0)var r=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else r=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(o==0){for(var b=obj.headers.length-1;b>r;b--)if(obj.records[l][b].style.display!="none"){r=b;break}}else r=obj.right.get(r,l);e==0?(obj.selectedCell[0]=r,obj.selectedCell[1]=l):(obj.selectedCell[2]=r,obj.selectedCell[3]=l)},obj.right.get=function(e,o){e=parseInt(e),o=parseInt(o);for(var r=e+1;r<obj.headers.length;r++)if(obj.records[o][r].style.display!="none"){if(obj.records[o][r].getAttribute("data-merged")&&obj.records[o][r]==obj.records[o][e])continue;e=r;break}return e},obj.left=function(e,o){e?obj.selectedCell[2]>0&&obj.left.visible(1,o?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,o){if(e==0)var r=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else r=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(o==0){for(var b=0;b<r;b++)if(obj.records[l][b].style.display!="none"){r=b;break}}else r=obj.left.get(r,l);e==0?(obj.selectedCell[0]=r,obj.selectedCell[1]=l):(obj.selectedCell[2]=r,obj.selectedCell[3]=l)},obj.left.get=function(e,o){e=parseInt(e),o=parseInt(o);for(var r=e-1;r>=0;r--)if(obj.records[o][r].style.display!="none"){if(obj.records[o][r].getAttribute("data-merged")&&obj.records[o][r]==obj.records[o][e])continue;e=r;break}return e},obj.first=function(e,o){if(e?o?obj.selectedCell[3]=0:obj.left.visible(1,0):(o?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,o){if(e?o?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(o?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)o=obj.rows;else var o=obj.results;var r=100;e!=null&&e!=-1||(e=Math.ceil(o.length/r)-1);var l=e*r,b=e*r+r;b>o.length&&(b=o.length),(l=b-100)<0&&(l=0);for(var E=l;E<b;E++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[E]):obj.tbody.appendChild(obj.rows[o[E]]),obj.tbody.children.length>r&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var o=0;if(e.length>100){var r=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(r=e.indexOf(r)),r>0)for(var l=0;l<30;l++)(r-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[r],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[r]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),o=1))}return o},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var o=0;if(e.length>100){var r=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(r=e.indexOf(r)),r<obj.rows.length-1)for(var l=0;l<=30;l++)r<e.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[r]):obj.tbody.appendChild(obj.rows[e[r]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),o=1)),r+=1}return o},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,o=parseInt(obj.selectedCell[3]/100),r=parseInt(obj.rows.length/100);if(e!=o&&o<=r&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(o),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var o=function(l){obj.results.indexOf(l)==-1&&obj.results.push(l)},r=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");r=new RegExp(r,"i"),obj.options.data.forEach(function(l,b){if(function(f,S,I){for(var m=0;m<f.length;m++)if((""+f[m]).toLowerCase().search(S)>=0||(""+obj.records[I][m].innerHTML).toLowerCase().search(S)>=0)return!0;return!1}(l,r,b)){var E=obj.isRowMerged(b);if(E.length)for(var O=0;O<E.length;O++)for(var d=jexcel.getIdFromColumnName(E[O],!0),u=0;u<obj.options.mergeCells[E[O]][1];u++)o(d[1]+u);else o(b)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,o=0;for(e=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var r=0;r<obj.rows.length;r++)!obj.results||obj.results.indexOf(r)>-1?(o<e&&(obj.tbody.appendChild(obj.rows[r]),o++),obj.rows[r].style.display=""):obj.rows[r].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var o=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)r=obj.rows;else var r=obj.results;var l=parseInt(obj.options.pagination);e!=null&&e!=-1||(e=Math.ceil(r.length/l)-1),obj.pageNumber=e;var b=e*l,E=e*l+l;for(E>r.length&&(E=r.length),b<0&&(b=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var O=b;O<E;O++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[O]):obj.tbody.appendChild(obj.rows[r[O]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,o)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var o=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var r=1,l=o<10?o:10;else o-obj.pageNumber<5?(l=o,(r=o-9)<1&&(r=1)):(r=obj.pageNumber-4,l=obj.pageNumber+5);r>1&&((E=document.createElement("div")).className="jexcel_page",E.innerHTML="<",E.title=1,obj.pagination.children[1].appendChild(E));for(var b=r;b<=l;b++){var E;(E=document.createElement("div")).className="jexcel_page",E.innerHTML=b,obj.pagination.children[1].appendChild(E),obj.pageNumber==b-1&&E.classList.add("jexcel_page_selected")}l<o&&((E=document.createElement("div")).className="jexcel_page",E.innerHTML=">",E.title=o,obj.pagination.children[1].appendChild(E)),obj.pagination.children[0].innerHTML=function(O){var d=Array.prototype.slice.call(arguments,1);return O.replace(/{(\d+)}/g,function(u,f){return d[f]!==void 0?d[f]:u})}(obj.options.text.showingPage,obj.pageNumber+1,o)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(obj.options.allowExport==0)console.error("Export not allowed");else{var o="";o+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var r=new Blob(["\uFEFF"+o],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,obj.options.csvFileName+".csv");else{var l=document.createElement("a"),b=URL.createObjectURL(r);l.href=b,l.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(l),l.click(),l.parentNode.removeChild(l)}}},obj.setHistory=function(e){if(obj.ignoreHistory!=1){var o=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,o+1),obj.history[o]=e}},obj.copy=function(e,o,r,l,b){o||(o="	");for(var E=new RegExp(o,"ig"),O=[],d=[],u=[],f=[],S=[],I=obj.options.data[0].length,m=obj.options.data.length,s="",v=!1,j="",g="",T=0,D=0,L=0,_=0,F=!0,M=0;M<m;M++)for(var B=0;B<I;B++)e&&!obj.records[M][B].classList.contains("highlight")||(L<=B&&(L=B),_<=M&&(_=M));if(I===L+1&&m===_+1&&(F=!1),b&&obj.options.includeHeadersOnDownload==1||!b&&obj.options.includeHeadersOnCopy==1&&!F||l){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(s=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],M=0;M<s.length;M++){var K=[];for(B=0;B<s[M].length;B++){var H=parseInt(s[M][B].colspan);K.push(s[M][B].title);for(var te=0;te<H-1;te++)K.push("")}g+=K.join(o)+`\r
`}v=!0}for(obj.style=[],M=0;M<m;M++){for(d=[],u=[],B=0;B<I;B++)if(!e||obj.records[M][B].classList.contains("highlight")){v==1&&O.push(obj.headers[B].textContent);var se=obj.options.data[M][B];if(se.match&&(se.match(E)||se.match(/,/g)||se.match(/\n/)||se.match(/\"/))&&(se='"'+(se=se.replace(new RegExp('"',"g"),'""'))+'"'),d.push(se),obj.options.columns[B].type=="checkbox"||obj.options.columns[B].type=="radio")var Q=se;else(Q=obj.options.stripHTMLOnCopy==1?obj.records[M][B].textContent:obj.records[M][B].innerHTML).match&&(Q.match(E)||Q.match(/,/g)||Q.match(/\n/)||Q.match(/\"/))&&(Q='"'+(Q=Q.replace(new RegExp('"',"g"),'""'))+'"');u.push(Q),s=(s=obj.records[M][B].getAttribute("style")).replace("display: none;",""),obj.style.push(s||"")}d.length&&(v&&(T=d.length,f.push(O.join(o))),f.push(d.join(o))),u.length&&(D++,v&&(S.push(O.join(o)),v=!1),S.push(u.join(o)))}I==T&&m==D&&(j=g);var pe=j+f.join(`\r
`),fe=j+S.join(`\r
`);if(r||(obj.options.copyCompatibility==1?obj.textarea.value=fe:obj.textarea.value=pe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=fe:obj.data=pe,obj.hashString=obj.hash(obj.data),!r){if(obj.removeCopyingSelection(),obj.highlighted)for(B=0;B<obj.highlighted.length;B++)obj.highlighted[B].classList.add("copying"),obj.highlighted[B].classList.contains("highlight-left")&&obj.highlighted[B].classList.add("copying-left"),obj.highlighted[B].classList.contains("highlight-right")&&obj.highlighted[B].classList.add("copying-right"),obj.highlighted[B].classList.contains("highlight-top")&&obj.highlighted[B].classList.add("copying-top"),obj.highlighted[B].classList.contains("highlight-bottom")&&obj.highlighted[B].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?S:f,obj.hashString)}return obj.data},obj.paste=function(e,o,r){var l=parseInt(e),b=parseInt(o),E=parseInt(obj.selectedCell[2]),O=parseInt(obj.selectedCell[3]),d=E-l+1,u=O-b+1;E<l&&(e=E.toString(),d=l-E+1),O<b&&(o=O.toString(),u=b-O+1);var f=obj.dispatch("onbeforepaste",el,r,e,o);if(f===!1)return!1;f&&(r=f);var S=obj.hash(r),I=S==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&S==obj.hashString&&(r=obj.data),r=obj.parseCSV(r,"	"),d>1&Number.isInteger(d/r[0].length)){I=null,s=d/r[0].length;var m=r.map(function(H,te){var se=Array.apply(null,{length:s*H.length}).map(function(Q,pe){return H[pe%H.length]});return se});r=m}if(u>1&Number.isInteger(u/r.length)){I=null;var s=u/r.length;m=Array.apply(null,{length:s*r.length}).map(function(H,te){return r[te%r.length]}),r=m}if(e!=null&&o!=null&&r){for(var v=0,j=0,g=[],T={},D={},L=0,_=parseInt(e),F=parseInt(o),M=null;M=r[j];){for(v=0,_=parseInt(e);M[v]!=null;){var B=obj.updateCell(_,F,M[v]);if(g.push(B),obj.updateFormulaChain(_,F,g),I&&I[L]){var K=jexcel.getColumnNameFromId([_,F]);T[K]=I[L],D[K]=obj.getStyle(K),obj.records[F][_].setAttribute("style",I[L]),L++}if(M[++v]!=null){if(_>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}_=obj.right.get(_,F)}}if(j++,r[j]){if(F>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}F=obj.down.get(e,F)}}obj.updateSelectionFromCoords(e,o,_,F),obj.setHistory({action:"setValue",records:g,selection:obj.selectedCell,newStyle:T,oldStyle:D}),obj.updateTable(),obj.dispatch("onpaste",el,r),obj.onafterchanges(el,g)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),o=0;o<e.length;o++)e[o].classList.remove("copying"),e[o].classList.remove("copying-left"),e[o].classList.remove("copying-right"),e[o].classList.remove("copying-top"),e[o].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,o){var r=o.insertBefore?+o.rowNumber:o.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),e==1){for(var l=o.numOfRows,b=r;b<l+r;b++)obj.rows[b].parentNode.removeChild(obj.rows[b]);obj.records.splice(r,l),obj.options.data.splice(r,l),obj.rows.splice(r,l),obj.conditionalSelectionUpdate(1,r,l+r-1)}else{obj.records=jexcel.injectArray(obj.records,r,o.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,r,o.rowData),obj.rows=jexcel.injectArray(obj.rows,r,o.rowNode);var E=0;for(b=r;b<o.numOfRows+r;b++)obj.tbody.insertBefore(o.rowNode[E],obj.tbody.children[b]),E++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,o){var r=o.insertBefore?o.columnNumber:o.columnNumber+1;if(e==1){var l=o.numOfColumns;obj.options.columns.splice(r,l);for(var b=r;b<l+r;b++)obj.headers[b].parentNode.removeChild(obj.headers[b]),obj.colgroup[b].parentNode.removeChild(obj.colgroup[b]);obj.headers.splice(r,l),obj.colgroup.splice(r,l);for(var E=0;E<o.data.length;E++){for(b=r;b<l+r;b++)obj.records[E][b].parentNode.removeChild(obj.records[E][b]);obj.records[E].splice(r,l),obj.options.data[E].splice(r,l)}if(obj.options.footers)for(E=0;E<obj.options.footers.length;E++)obj.options.footers[E].splice(r,l)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,r,o.columns),obj.headers=jexcel.injectArray(obj.headers,r,o.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,r,o.colgroup);var O=0;for(b=r;b<o.numOfColumns+r;b++)obj.headerContainer.insertBefore(o.headers[O],obj.headerContainer.children[b+1]),obj.colgroupContainer.insertBefore(o.colgroup[O],obj.colgroupContainer.children[b+1]),O++;for(E=0;E<o.data.length;E++)for(obj.options.data[E]=jexcel.injectArray(obj.options.data[E],r,o.data[E]),obj.records[E]=jexcel.injectArray(obj.records[E],r,o.records[E]),O=0,b=r;b<o.numOfColumns+r;b++)obj.rows[E].insertBefore(o.records[E][O],obj.rows[E].children[b+1]),O++;if(obj.options.footers)for(E=0;E<obj.options.footers.length;E++)obj.options.footers[E]=jexcel.injectArray(obj.options.footers[E],r,o.footers[E])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(E=0;E<obj.options.nestedHeaders.length;E++){if(e==1)var d=parseInt(obj.options.nestedHeaders[E][obj.options.nestedHeaders[E].length-1].colspan)-o.numOfColumns;else d=parseInt(obj.options.nestedHeaders[E][obj.options.nestedHeaders[E].length-1].colspan)+o.numOfColumns;obj.options.nestedHeaders[E][obj.options.nestedHeaders[E].length-1].colspan=d,obj.thead.children[E].children[obj.thead.children[E].children.length-1].setAttribute("colspan",d)}else d=e==1?parseInt(obj.options.nestedHeaders[0].colspan)-o.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+o.numOfColumns,obj.options.nestedHeaders[0].colspan=d,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",d);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,o=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var r=[];if(obj.historyIndex>=0){var l=obj.history[obj.historyIndex--];if(l.action=="insertRow")obj.historyProcessRow(1,l);else if(l.action=="deleteRow")obj.historyProcessRow(0,l);else if(l.action=="insertColumn")obj.historyProcessColumn(1,l);else if(l.action=="deleteColumn")obj.historyProcessColumn(0,l);else if(l.action=="moveRow")obj.moveRow(l.newValue,l.oldValue);else if(l.action=="moveColumn")obj.moveColumn(l.newValue,l.oldValue);else if(l.action=="setMerge")obj.removeMerge(l.column,l.data);else if(l.action=="setStyle")obj.setStyle(l.oldValue,null,null,1);else if(l.action=="setWidth")obj.setWidth(l.column,l.oldValue);else if(l.action=="setHeight")obj.setHeight(l.row,l.oldValue);else if(l.action=="setHeader")obj.setHeader(l.column,l.oldValue);else if(l.action=="setComments")obj.setComments(l.column,l.oldValue[0],l.oldValue[1]);else if(l.action=="orderBy"){for(var b=[],E=0;E<l.rows.length;E++)b[l.rows[E]]=E;obj.updateOrderArrow(l.column,l.order?0:1),obj.updateOrder(b)}else if(l.action=="setValue"){for(var O=0;O<l.records.length;O++)r.push({x:l.records[O].x,y:l.records[O].y,newValue:l.records[O].oldValue}),l.oldStyle&&obj.resetStyle(l.oldStyle);obj.setValue(r),l.selection&&obj.updateSelectionFromCoords(l.selection[0],l.selection[1],l.selection[2],l.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=o,obj.dispatch("onundo",el,l)},obj.redo=function(){var e=!!obj.ignoreEvents,o=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var r=obj.history[++obj.historyIndex];if(r.action=="insertRow")obj.historyProcessRow(0,r);else if(r.action=="deleteRow")obj.historyProcessRow(1,r);else if(r.action=="insertColumn")obj.historyProcessColumn(0,r);else if(r.action=="deleteColumn")obj.historyProcessColumn(1,r);else if(r.action=="moveRow")obj.moveRow(r.oldValue,r.newValue);else if(r.action=="moveColumn")obj.moveColumn(r.oldValue,r.newValue);else if(r.action=="setMerge")obj.setMerge(r.column,r.colspan,r.rowspan,1);else if(r.action=="setStyle")obj.setStyle(r.newValue,null,null,1);else if(r.action=="setWidth")obj.setWidth(r.column,r.newValue);else if(r.action=="setHeight")obj.setHeight(r.row,r.newValue);else if(r.action=="setHeader")obj.setHeader(r.column,r.newValue);else if(r.action=="setComments")obj.setComments(r.column,r.newValue[0],r.newValue[1]);else if(r.action=="orderBy")obj.updateOrderArrow(r.column,r.order),obj.updateOrder(r.rows);else if(r.action=="setValue"){obj.setValue(r.records);for(var l=0;l<r.records.length;l++)r.oldStyle&&obj.resetStyle(r.newStyle);r.selection&&obj.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=o,obj.dispatch("onredo",el,r)},obj.getDropDownValue=function(e,o){var r=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var l=[],b=obj.options.columns[e].source,E=0;E<b.length;E++)typeof b[E]=="object"?l[b[E].id]=b[E].name:l[b[E]]=b[E];var O=Array.isArray(o)?o:(""+o).split(";");for(E=0;E<O.length;E++)typeof O[E]=="object"?r.push(l[O[E].id]):l[O[E]]&&r.push(l[O[E]])}else console.error("Invalid column");return r.length>0?r.join("; "):""},obj.parseCSV=function(e,o){(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)==9&&(e+="\0"),o=o||",";for(var r=[],l=!1,b=0,E=0,O=0;O<e.length;O++){var d=e[O],u=e[O+1];r[b]=r[b]||[],r[b][E]=r[b][E]||"",d=='"'&&l&&u=='"'?(r[b][E]+=d,++O):d!='"'?d!=o||l?d!="\r"||u!=`
`||l?d==`
`&&!l||d=="\r"&&!l?(++b,E=0):r[b][E]+=d:(++b,E=0,++O):++E:l=!l}return r},obj.hash=function(e){var o,r=0;if(e.length===0)return r;for(o=0;o<e.length;o++)r=(r<<5)-r+e.charCodeAt(o),r|=0;return r},obj.onafterchanges=function(e,o){obj.dispatch("onafterchanges",e,o)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var o=obj.parseCSV(e,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&o.length>0)for(var r=o.shift(),l=0;l<r.length;l++)obj.options.columns[l]||(obj.options.columns[l]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[l].title===void 0&&(obj.options.columns[l].title=r[l]);obj.options.data=o,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,o,r,l){var b=[];if(r==null)obj.options.allowInsertColumn==1&&b.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(o),1)}}),obj.options.allowInsertColumn==1&&b.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(o),0)}}),obj.options.allowDeleteColumn==1&&b.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(o))}}),obj.options.allowRenameColumn==1&&b.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(o)}}),obj.options.columnSorting==1&&(b.push({type:"line"}),b.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(o,0)}}),b.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(o,1)}}));else if(obj.options.allowInsertRow==1&&(b.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(r),1)}}),b.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(r))}})),obj.options.allowDeleteRow==1&&b.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(r))}}),o&&obj.options.allowComments==1){b.push({type:"line"});var E=obj.records[r][o].getAttribute("title")||"";b.push({title:E?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var O=prompt(obj.options.text.comments,E);O&&obj.setComments([o,r],O)}}),E&&b.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([o,r],"")}})}return b.push({type:"line"}),b.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&b.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(O){O&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],O)})}}),obj.options.allowExport&&b.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&b.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),b},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&e.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var o=0;o<obj.options.freezeColumns;o++)e+=parseInt(obj.options.columns[o].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var o=0;o<obj.options.freezeColumns;o++){o>0&&obj.options.columns[o-1].type!=="hidden"&&(e+=parseInt(obj.options.columns[o-1].width)),obj.headers[o].classList.add("jexcel_freezed"),obj.headers[o].style.left=e+"px";for(var r=0;r<obj.rows.length;r++)if(obj.rows[r]&&obj.records[r][o]){var l=scrollLeft+(o>0?obj.records[r][o-1].style.width:0)-51+"px";obj.records[r][o].classList.add("jexcel_freezed"),obj.records[r][o].style.left=l}}else for(o=0;o<obj.options.freezeColumns;o++)for(obj.headers[o].classList.remove("jexcel_freezed"),obj.headers[o].style.left="",r=0;r<obj.rows.length;r++)obj.records[r][o]&&(obj.records[r][o].classList.remove("jexcel_freezed"),obj.records[r][o].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var o=Object.keys(e),r=0;r<o.length;r++)typeof e[o[r]]=="function"&&(jexcel[o[r]]=e[o[r]],jexcel.license&&typeof e[o[r]].license=="function"&&e[o[r]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(e,o){if(e.jexcel){var r=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",o&&(destroyEvents(r),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(e.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var o=jexcel.current.edition[0].children[0],r=jexcel.current.edition[0].children[0].value,l=o.selectionStart;r=r.slice(0,l)+`
`+r.slice(l),o.value=r,o.focus(),o.selectionStart=l+1,o.selectionEnd=l+1}else jexcel.current.edition[0].children[0].blur()}else e.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(e.which==37)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==46||e.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(e.which==13)e.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(e.which==9)e.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var b=jexcel.current.selectedCell[1],E=jexcel.current.selectedCell[0];jexcel.current.options.columns[E].type!="readonly"&&(e.keyCode==32?(e.preventDefault(),jexcel.current.options.columns[E].type=="checkbox"||jexcel.current.options.columns[E].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[b][E],!0)):e.keyCode==113?jexcel.current.openEditor(jexcel.current.records[b][E],!1):(e.keyCode==8||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[b][E],!0),jexcel.current.options.columns[E].type=="calendar"&&e.preventDefault()))}}else e.which==65?(jexcel.current.selectAll(),e.preventDefault()):e.which==83?(jexcel.current.download(),e.preventDefault()):e.which==89?(jexcel.current.redo(),e.preventDefault()):e.which==90?(jexcel.current.undo(),e.preventDefault()):e.which==67?(jexcel.current.copy(!0),e.preventDefault()):e.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):e.which==86&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var o=e.buttons;else o=e.button?e.button:e.which;var r=jexcel.getElement(e.target);if(r[0]?jexcel.current!=r[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=r[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&o==1){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(r[1]==1){if(s=e.target.getAttribute("data-x")){var l=e.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&l.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:s,width:l.width},jexcel.current.headers[s].classList.add("resizing");for(var b=0;b<jexcel.current.records.length;b++)jexcel.current.records[b][s]&&jexcel.current.records[b][s].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&l.height-e.offsetY<6)if(jexcel.current.isColMerged(s).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:s,destination:s},jexcel.current.headers[s].classList.add("dragging"),b=0;b<jexcel.current.records.length;b++)jexcel.current.records[b][s]&&jexcel.current.records[b][s].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var E=jexcel.current.selectedHeader,O=s;else jexcel.current.selectedHeader==s&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(s)},800)),jexcel.current.selectedHeader=s,E=s,O=s;jexcel.current.updateSelectionFromCoords(E,0,O,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var d=e.target.getAttribute("data-column").split(","),u=parseInt(d[0]),f=parseInt(d[d.length-1]);else u=0,f=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,f,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(r[1]==2){var S=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))l=e.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&l.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:S,height:l.height},e.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&l.width-e.offsetX<6?jexcel.current.isRowMerged(S).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:S,destination:S},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(E=jexcel.current.selectedRow,O=S):(jexcel.current.selectedRow=S,E=S,O=S),jexcel.current.updateSelectionFromCoords(0,E,jexcel.current.options.data[0].length-1,O));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var I=function(v){var j=v.getAttribute("data-x"),g=v.getAttribute("data-y");return j&&g?[j,g]:v.parentNode?I(v.parentNode):void 0},m=I(e.target);if(m){var s=m[0];S=m[1],jexcel.current.edition&&(jexcel.current.edition[2]==s&&jexcel.current.edition[3]==S||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],s,S):jexcel.current.updateSelectionFromCoords(s,S)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&(e.target.textContent=="<"?jexcel.current.page(0):e.target.textContent==">"?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var o=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),r=jexcel.current.getSelectedColumns();if(r.length>1){for(var l=[],b=0;b<r.length;b++)l.push(parseInt(jexcel.current.colgroup[r[b]].getAttribute("width")));l[r.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(r,o,l)}else jexcel.current.setWidth(jexcel.current.resizing.column,o,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][jexcel.current.resizing.column]&&jexcel.current.records[E][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var O=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,O,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var d=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),E=0;E<jexcel.current.rows.length;E++)jexcel.current.records[E][jexcel.current.dragging.column]&&jexcel.current.records[E][jexcel.current.dragging.column].classList.remove("dragging");for(b=0;b<jexcel.current.headers.length;b++)jexcel.current.headers[b].classList.remove("dragging-left"),jexcel.current.headers[b].classList.remove("dragging-right");d&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var o=e.buttons;else o=e.button?e.button:e.which;if(o||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var r=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+r>0){var l=jexcel.current.resizing.width+r;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",l),jexcel.current.updateCornerPosition()}}else{var b=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+b>0){var E=jexcel.current.resizing.height+b;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",E),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var O=e.target.getAttribute("data-x");if(O)if(jexcel.current.isColMerged(O).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var d=0;d<jexcel.current.headers.length;d++)jexcel.current.headers[d].classList.remove("dragging-left"),jexcel.current.headers[d].classList.remove("dragging-right");jexcel.current.dragging.column==O?jexcel.current.dragging.destination=parseInt(O):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<O?jexcel.current.dragging.destination=parseInt(O)-1:jexcel.current.dragging.destination=parseInt(O),jexcel.current.headers[O].classList.add("dragging-left")):(jexcel.current.dragging.column<O?jexcel.current.dragging.destination=parseInt(O):jexcel.current.dragging.destination=parseInt(O)+1,jexcel.current.headers[O].classList.add("dragging-right"))}}else{var u=e.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var f=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=f&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,f),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var S=e.target.getAttribute("data-x"),I=e.target.getAttribute("data-y"),m=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&S&&!I&&m.width-(e.clientX-m.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!S&&I&&m.height-(e.clientY-m.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!S&&I&&m.width-(e.clientX-m.left)<6||e.target&&S&&!I&&m.height-(e.clientY-m.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var o=e.buttons;else o=e.button?e.button:e.which;if(o||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var r=jexcel.getElement(e.target);if(r[0]){if(jexcel.current!=r[0].jexcel&&jexcel.current)return!1;var l=e.target.getAttribute("data-x"),b=e.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(r[1]==1&&jexcel.current.selectedHeader){l=e.target.getAttribute("data-x");var E=jexcel.current.selectedHeader,O=l;jexcel.current.updateSelectionFromCoords(E,0,O,jexcel.current.options.data.length-1)}r[1]==2&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(E=jexcel.current.selectedRow,O=b,jexcel.current.updateSelectionFromCoords(0,E,jexcel.current.options.data[0].length-1,O)):jexcel.current.edition||l&&b&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(l,b):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],l,b)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var o=jexcel.current.highlighted[0].getAttribute("data-x"),r=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,l=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),b=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[r][o],jexcel.current.records[b][l])}}else if(e.target.classList.contains("jexcel_column_filter")){var E=e.target.getAttribute("data-x");jexcel.current.openFilter(E)}else{var O=jexcel.getElement(e.target);if(O[1]==1&&jexcel.current.options.columnSorting==1&&(E=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(E),O[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var d=function(f){if(f.parentNode){var S=f.getAttribute("data-x"),I=f.getAttribute("data-y");return S&&I?f:d(f.parentNode)}},u=d(e.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current){if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var o=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(o||r){(o<parseInt(jexcel.current.selectedCell[0])||o>parseInt(jexcel.current.selectedCell[2])||r<parseInt(jexcel.current.selectedCell[1])||r>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(o,r,o,r);var l=jexcel.current.options.contextMenu(jexcel.current,o,r,e);jexcel.current.contextMenu.contextmenu.open(e,l),e.preventDefault()}}}},jexcel.touchStartControls=function(e){var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var r=e.target.getAttribute("data-x"),l=e.target.getAttribute("data-y");r&&l&&(jexcel.current.updateSelectionFromCoords(r,l),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[r].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,o){var r=[];if(e.classList.contains("jexcel_tabs"))b=e.children[0],E=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var l=document.createElement("div"),b=e.appendChild(l),E=(l=document.createElement("div"),e.appendChild(l))}for(var O=[],d=[],u=0;u<o.length;u++){O[u]=document.createElement("div"),O[u].classList.add("jexcel_tab");var f=jexcel(O[u],o[u]);E.appendChild(O[u]),r[u]=e.jexcel.push(f),d[u]=document.createElement("div"),d[u].classList.add("jexcel_tab_link"),d[u].setAttribute("data-spreadsheet",e.jexcel.length-1),d[u].innerHTML=o[u].sheetName,d[u].onclick=function(){for(var I=0;I<b.children.length;I++)b.children[I].classList.remove("selected"),E.children[I].style.display="none";var m=this.getAttribute("data-spreadsheet");E.children[m].style.display="block",b.children[m].classList.add("selected")},b.appendChild(d[u])}for(var S=0;S<b.children.length;S++)b.children[S].classList.remove("selected"),E.children[S].style.display="none";return b.children[b.children.length-1].classList.add("selected"),E.children[b.children.length-1].style.display="block",r},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,o){var r,l=function(b){var E=[];return b.SheetNames.forEach(function(O){var d={rows:[],columns:[],data:[],style:{}};if(d.sheetName=O,(g=b.Sheets[O]["!cols"])&&g.length)for(var u=0;u<g.length;u++)d.columns[u]={},g[u]&&g[u].wpx&&(d.columns[u].width=g[u].wpx+"px");if((g=b.Sheets[O]["!rows"])&&g.length)for(u=0;u<g.length;u++)g[u]&&g[u].hpx&&(d.rows[u]={},d.rows[u].height=g[u].hpx+"px");if((g=b.Sheets[O]["!merges"])&&g.length>0)for(d.mergeCells=[],u=0;u<g.length;u++){var f=g[u].s.c,S=g[u].s.r,I=g[u].e.c,m=g[u].e.r,s=jexcel.getColumnNameFromId([f,S]);d.mergeCells[s]=[I-f+1,m-S+1]}var v=0,j=0,g=Object.keys(b.Sheets[O]);for(u=0;u<g.length;u++)if(g[u].substr(0,1)!="!"){var T=b.Sheets[O][g[u]],D=jexcel.getIdFromColumnName(g[u],!0);d.data[D[1]]||(d.data[D[1]]=[]),d.data[D[1]][D[0]]=T.f?"="+T.f:T.w,v<D[0]&&(v=D[0]),j<D[1]&&(j=D[1]),T.style&&Object.keys(T.style).length>0&&(d.style[g[u]]=T.style),T.s&&T.s.fgColor&&(d.style[g[u]]&&(d.style[g[u]]+=";"),d.style[g[u]]+="background-color:#"+T.s.fgColor.rgb)}for(var L=d.columns,_=0;_<=j;_++)for(u=0;u<=v;u++)d.data[_]||(d.data[_]=[]),d.data[_][u]||L<u&&(d.data[_][u]="");E.push(d)}),E};(r=new XMLHttpRequest).open("GET",e,!0),typeof Uint8Array<"u"?(r.responseType="arraybuffer",r.onload=function(b){var E=r.response,O=new Uint8Array(E),d=XLSX.read(O,{type:"array",cellFormula:!0,cellStyles:!0});o(l(d))}):(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){if(r.readyState==4&&r.status==200){var b=convertResponseBodyToText(r.responseBody),E=XLSX.read(b,{type:"binary",cellFormula:!0,cellStyles:!0});o(l(E))}}),r.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,o,r){return e.slice(0,o).concat(r).concat(e.slice(o))},jexcel.getColumnName=function(e){return jexcel.helpers.getColumnName(e)},jexcel.getIdFromColumnName=function(e,o){var r=/^[a-zA-Z]+/.exec(e);if(r){for(var l=0,b=0;b<r[0].length;b++)l+=parseInt(r[0].charCodeAt(b)-64)*Math.pow(26,r[0].length-1-b);--l<0&&(l=0);var E=parseInt(/[0-9]+$/.exec(e));E>0&&E--,e=o==1?[l,E]:l+"-"+E}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var o=0,r=0;return function l(b){b.className&&b.classList.contains("jexcel_container")&&(r=b),b.tagName=="THEAD"?o=1:b.tagName=="TBODY"&&(o=2),b.parentNode&&(r||l(b.parentNode))}(e),[r,o]},jexcel.doubleDigitFormat=function(e){return(e=""+e).length==1&&(e="0"+e),e},jexcel.createFromTable=function(e,o){if(e.tagName=="TABLE"){o||(o={}),o.columns=[],o.data=[];var r=e.querySelectorAll("colgroup > col");if(r.length)for(var l=0;l<r.length;l++){if(!(b=r[l].style.width))var b=r[l].getAttribute("width");b&&(o.columns[l]||(o.columns[l]={}),o.columns[l].width=b)}var E=function(pe){var fe=pe.getBoundingClientRect(),me=fe.width>50?fe.width:50;o.columns[l]||(o.columns[l]={}),pe.getAttribute("data-celltype")?o.columns[l].type=pe.getAttribute("data-celltype"):o.columns[l].type="text",o.columns[l].width=me+"px",o.columns[l].title=pe.innerHTML,o.columns[l].align=pe.style.textAlign||"center",(fe=pe.getAttribute("name"))&&(o.columns[l].name=fe),(fe=pe.getAttribute("id"))&&(o.columns[l].id=fe),(fe=pe.getAttribute("data-mask"))&&(o.columns[l].mask=fe)},O=[],d=e.querySelectorAll(":scope > thead > tr");if(d.length){for(var u=0;u<d.length-1;u++){var f=[];for(l=0;l<d[u].children.length;l++){var S={title:d[u].children[l].textContent,colspan:d[u].children[l].getAttribute("colspan")||1};f.push(S)}O.push(f)}for(d=d[d.length-1].children,l=0;l<d.length;l++)E(d[l])}var I=0,m={},s={},v={},j={},g=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<g.length;u++)if(o.data[I]=[],o.parseTableFirstRowAsHeader!=1||d.length||u!=0){for(l=0;l<g[u].children.length;l++){if(T=g[u].children[l].getAttribute("data-formula"))T.substr(0,1)!="="&&(T="="+T);else var T=g[u].children[l].innerHTML;o.data[I].push(T);var D=jexcel.getColumnNameFromId([l,u]),L=g[u].children[l].getAttribute("class");L&&(j[D]=L);var _=parseInt(g[u].children[l].getAttribute("colspan"))||0,F=parseInt(g[u].children[l].getAttribute("rowspan"))||0;(_||F)&&(m[D]=[_||1,F||1]),g[u].children[l].style&&g[u].children[l].style.display=="none"&&(g[u].children[l].style.display="");var M=g[u].children[l].getAttribute("style");M&&(v[D]=M),g[u].children[l].classList.contains("styleBold")&&(v[D]?v[D]+="; font-weight:bold;":v[D]="font-weight:bold;")}g[u].style&&g[u].style.height&&(s[u]={height:g[u].style.height}),I++}else for(l=0;l<g[u].children.length;l++)E(g[u].children[l]);if(Object.keys(O).length>0&&(o.nestedHeaders=O),Object.keys(v).length>0&&(o.style=v),Object.keys(m).length>0&&(o.mergeCells=m),Object.keys(s).length>0&&(o.rows=s),Object.keys(j).length>0&&(o.classes=j),(g=e.querySelectorAll("tfoot tr")).length){var B=[];for(u=0;u<g.length;u++){var K=[];for(l=0;l<g[u].children.length;l++)K.push(g[u].children[l].textContent);B.push(K)}Object.keys(B).length>0&&(o.footers=B)}if(o.parseTableAutoCellType==1){var H=[];for(l=0;l<o.columns.length;l++){var te=!0,se=!0;for(H[l]=[],u=0;u<o.data.length;u++)T=o.data[u][l],H[l][T]||(H[l][T]=0),H[l][T]++,T.length>25&&(te=!1),T.length==10&&T.substr(4,1)=="-"&&T.substr(7,1)=="-"||(se=!1);var Q=Object.keys(H[l]).length;se?o.columns[l].type="calendar":te==1&&Q>1&&Q<=parseInt(.1*o.data.length)&&(o.columns[l].type="dropdown",o.columns[l].source=Object.keys(H[l]))}}return o}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var o=this.config.root;else o=window;var r=0,l=o.getSelection();if(l&&l.rangeCount!==0){var b=l.getRangeAt(0),E=b.cloneRange();E.selectNodeContents(e),E.setEnd(b.endContainer,b.endOffset),r=E.toString().length}return r},invert:function(e){for(var o=[],r=Object.keys(e),l=0;l<r.length;l++)o[e[r[l]]]=r[l];return o},getColumnName:function(e){let o,r=e+1,l="";for(;r>0;)o=(r-1)%26,l=String.fromCharCode(65+o).toString()+l,r=parseInt((r-o)/26);return l},getColumnNameFromCoords:function(e,o){return component.getColumnName(parseInt(e))+(parseInt(o)+1)},getCoordsFromColumnName:function(e){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var r=0,l=0;l<o[0].length;l++)r+=parseInt(o[0].charCodeAt(l)-64)*Math.pow(26,o[0].length-1-l);--r<0&&(r=0);var b=parseInt(/[0-9]+$/.exec(e))||null;return b>0&&b--,[r,b]}},createFromTable:function(){},injectArray:function(e,o,r){return e.slice(0,o).concat(r).concat(e.slice(o))},parseCSV:function(e,o){o=o||",";for(var r=0,l=0,b=[[]],E=0,O=null,d=!1,u=!1,f=0;f<e.length;f++)if(b[l]||(b[l]=[]),b[l][r]||(b[l][r]=""),e[f]!="\r")if(e[f]!=`
`&&e[f]!=o||d!=0&&u!=1&&O){if(e[f]=='"'&&(d=!d),O===null){if((O=d)==1)continue}else if(O===!0&&!u&&e[f]=='"'){e[f+1]=='"'?(d=!0,b[l][r]+=e[f],f++):u=!0;continue}b[l][r]+=e[f]}else{if(O=null,d=!1,u=!1,b[l][r][0]=='"'){var S=b[l][r].trim();S[S.length-1]=='"'&&(b[l][r]=S.substr(1,S.length-2))}e[f]==`
`?(r=0,l++):++r>E&&(E=r)}for(var I=0;I<b.length;I++)for(f=0;f<=E;f++)b[I][f]===void 0&&(b[I][f]="");return b}},component),typeof jQuery<"u"&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(o){var r=e(this).get(0);return r.jexcel?Array.isArray(r.jexcel)?r.jexcel[o][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):r.jexcel[o].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(e){var o=__webpack_module_cache__[e];if(o!==void 0)return o.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})}(dist$1)),dist$1.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports),_sfc_main$1=defineComponent({__name:"MJspreadsheet",props:{options:{}},setup(e,{expose:o}){const r=e,l=ref(null),b=ref(null);let E;function O(u=[],f=10){const S=u.length;return Array.from({length:f},()=>Array(S).fill(""))}onMounted(()=>{if(l.value){E={...{allowComments:!0,allowDeleteColumn:!1,allowDeleteRow:!0,allowDeletingAllRows:!1,allowInsertColumn:!1,allowInsertRow:!0,allowManualInsertColumn:!1,allowManualInsertRow:!1,allowRenameColumn:!0,columnDrag:!0,columnResize:!0,columnSorting:!0,rowDrag:!0,rowResize:!0,editable:!0,search:!1,filters:!1,defaultColAlign:"center",defaultColWidth:100,defaultRowHeight:void 0,mergeCells:{},nestedHeaders:void 0,minDimensions:[0,0],minSpareCols:0,minSpareRows:0,freezeColumns:void 0,csvDelimiter:",",csvFileName:"jspreadsheet",csvHeaders:!0,parseTableAutoCellType:!1,parseTableFirstRowAsHeader:!1,tableOverflow:!0,tableHeight:"400px",tableWidth:"1000px",textOverflow:!1,wordWrap:!0,selectionCopy:!0,secureFormulas:!0,lazyLoading:!0,pagination:void 0,paginationOptions:void 0,classes:{},style:{},footers:void 0,meta:void 0,rows:[],columns:[],data:[],url:void 0,csv:void 0,root:void 0},...r.options},Array.isArray(E.data)&&E.data.length===0&&Array.isArray(E.columns)&&(E.data=O(E.columns));const f=jspreadsheet(l.value,E);b.value=f}});function d(){if(!b.value||!Array.isArray(E.columns))return[];const u=b.value.getData(),f=E.columns.map(S=>S.name??"");return console.log(f),u.map(S=>Object.fromEntries(S.map((I,m)=>[f[m],I]))).filter(S=>Object.values(S).some(I=>I!==""))}return o({sheet:b,getAllData:d}),(u,f)=>(openBlock(),createElementBlock("div",{class:"myPrefix",ref_key:"spreadsheetRef",ref:l},null,512))}}),ApplicationPermissionJson=[{ID:141,Application:"WebPortal",Type:"Authenticate",Name:"Office_Seat",Descr:"",TargetType:"0",TargetSymbol:"0",Privilege:"https://iec1-mes-ap.iec.inventec/OfficeSeat/#/",ConstraintDef:"Parent",PrivilegeDisplay:"座位預約系統",TargetDisplay:"https://iec1-mes-ap.iec.inventec/OfficeSeat/favicon.ico",Cdt:"2025-04-01T14:18:23.813",Udt:"2025-04-30T14:06:32.887",EditorId:941,TranslatedType:"Authenticate",TranslatedName:"Office_Seat",TranslatedDescr:"",TranslatedPrivilegeDisplay:"座位預約系統",ParentTargetSymbol:""},{ID:142,Application:"WebPortal",Type:"Authenticate",Name:"ETLManager",Descr:"",TargetType:"0",TargetSymbol:"0",Privilege:"https://iec1-mes-ap.iec.inventec/ETLManager/#/",ConstraintDef:"Parent",PrivilegeDisplay:"ETL管理系統",TargetDisplay:"https://iec1-mes-ap.iec.inventec/ETLManager/favicon.ico",Cdt:"2025-04-01T14:18:23.813",Udt:"2025-04-30T14:06:32.887",EditorId:941,TranslatedType:"Authenticate",TranslatedName:"ETLManager",TranslatedDescr:"",TranslatedPrivilegeDisplay:"ETL管理系統",ParentTargetSymbol:""},{ID:143,Application:"WebPortal",Type:"Identity",Name:"ESG",Descr:"",TargetType:"0",TargetSymbol:"0",Privilege:"https://iec1-dhbdws-e1.iec.inventec/ESG/",ConstraintDef:"Parent",PrivilegeDisplay:"ESG永續發展平台",TargetDisplay:"https://iec1-dhbdws-e1.iec.inventec/ESG/favicon.ico",Cdt:"2025-04-01T14:18:23.813",Udt:"2025-04-30T14:06:32.887",EditorId:941,TranslatedType:"Identity",TranslatedName:"ESG",TranslatedDescr:"",TranslatedPrivilegeDisplay:"ESG永續發展平台",ParentTargetSymbol:""},{ID:144,Application:"WebPortal",Type:"Permission",Name:"SubsystemAuthorize",Descr:"",TargetType:"0",TargetSymbol:"0",Privilege:"/Authorize",ConstraintDef:"Parent",PrivilegeDisplay:"子系統授權",TargetDisplay:"sym_o_encrypted",Cdt:"2025-04-11T16:43:21.933",Udt:"2025-04-30T14:06:32.887",EditorId:941,TranslatedType:"Permission",TranslatedName:"SubsystemAuthorize",TranslatedDescr:"",TranslatedPrivilegeDisplay:"子系統授權",ParentTargetSymbol:""},{ID:148,Application:"WebPortal",Type:"Permission",Name:"MaintainPermission",Descr:"",TargetType:"0",TargetSymbol:"0",Privilege:"/Authorize/MaintainPermission",ConstraintDef:"Parent",PrivilegeDisplay:"子系統菜單",TargetDisplay:"sym_o_encrypted",Cdt:"2025-04-30T14:06:32.887",Udt:"2025-04-30T14:06:32.887",EditorId:941,TranslatedType:"Permission",TranslatedName:"MaintainPermission",TranslatedDescr:"",TranslatedPrivilegeDisplay:"子系統菜單",ParentTargetSymbol:""}],OAJson=JSON.parse('[{"ID":1,"Application":"Office_Seat","Type":"Office_Seat","Name":"Office_Seat","Descr":"","TargetType":"0","TargetSymbol":"0001","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-05T10:09:03.753","Udt":"2024-07-05T10:09:03.753","EditorId":5426,"TranslatedType":"Office_Seat","TranslatedName":"Office_Seat","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":""},{"ID":2,"Application":"Office_Seat","Type":"Office_Seat|基礎資料","Name":"基礎資料","Descr":"","TargetType":"1","TargetSymbol":"0001.9000","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-05T10:09:03.753","Udt":"2024-07-05T10:09:03.753","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料","TranslatedName":"基礎資料","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001"},{"ID":3,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|國定假日維護","Name":"國定假日維護","Descr":"OSB9001","TargetType":"2","TargetSymbol":"0001.9000.9001","Privilege":"/Booking/HolidayCalendar","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-05T10:09:03.753","Udt":"2024-07-05T10:09:03.753","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|國定假日維護","TranslatedName":"國定假日維護","TranslatedDescr":"OSB9001","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":4,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|廠區辦公區維護","Name":"廠區辦公區維護","Descr":"OSB9002","TargetType":"2","TargetSymbol":"0001.9000.9002","Privilege":"/Booking/SiteArea","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:47.7","Udt":"2024-07-15T10:23:47.7","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|廠區辦公區維護","TranslatedName":"廠區辦公區維護","TranslatedDescr":"OSB9002","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":5,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|個人資料設置","Name":"個人資料設置","Descr":"OSB9004","TargetType":"2","TargetSymbol":"0001.9000.9004","Privilege":"/Booking/ProfileSetting","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:47.703","Udt":"2024-07-15T10:23:47.703","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|個人資料設置","TranslatedName":"個人資料設置","TranslatedDescr":"OSB9004","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":6,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|排程群組維護","Name":"排程群組維護","Descr":"OSB9003","TargetType":"2","TargetSymbol":"0001.9000.9003","Privilege":"/Booking/ScheduleGroupSetting","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:51.04","Udt":"2024-07-15T10:23:51.04","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|排程群組維護","TranslatedName":"排程群組維護","TranslatedDescr":"OSB9003","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":8,"Application":"Office_Seat","Type":"Office_Seat|系統設定","Name":"系統設定","Descr":"","TargetType":"1","TargetSymbol":"0001.9800","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-15T10:23:54.24","Udt":"2024-07-15T10:23:54.24","EditorId":5426,"TranslatedType":"Office_Seat|系統設定","TranslatedName":"系統設定","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001"},{"ID":9,"Application":"Office_Seat","Type":"Office_Seat|系統設定|維護ConstValueList","Name":"維護ConstValueList","Descr":"OSB9801","TargetType":"2","TargetSymbol":"0001.9800.9801","Privilege":"/Configuration/ConstValueList","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:54.24","Udt":"2024-07-15T10:23:54.24","EditorId":5426,"TranslatedType":"Office_Seat|系統設定|維護ConstValueList","TranslatedName":"維護ConstValueList","TranslatedDescr":"OSB9801","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9800"},{"ID":10,"Application":"Office_Seat","Type":"Office_Seat|系統設定|維護ConstValue","Name":"維護ConstValue","Descr":"OSB9802","TargetType":"2","TargetSymbol":"0001.9800.9802","Privilege":"/Configuration/ConstValue","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:54.24","Udt":"2024-07-15T10:23:54.24","EditorId":5426,"TranslatedType":"Office_Seat|系統設定|維護ConstValue","TranslatedName":"維護ConstValue","TranslatedDescr":"OSB9802","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9800"},{"ID":11,"Application":"Office_Seat","Type":"Office_Seat|系統設定|維護SysSetting","Name":"維護SysSetting","Descr":"OSB9803","TargetType":"2","TargetSymbol":"0001.9800.9803","Privilege":"/Configuration/SysSetting","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-15T10:23:54.24","Udt":"2024-07-15T10:23:54.24","EditorId":5426,"TranslatedType":"Office_Seat|系統設定|維護SysSetting","TranslatedName":"維護SysSetting","TranslatedDescr":"OSB9803","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9800"},{"ID":12,"Application":"Office_Seat","Type":"Office_Seat|排程作業","Name":"排程作業","Descr":"","TargetType":"1","TargetSymbol":"0001.0100","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-15T10:24:25.14","Udt":"2024-07-15T10:24:25.14","EditorId":5426,"TranslatedType":"Office_Seat|排程作業","TranslatedName":"排程作業","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001"},{"ID":13,"Application":"Office_Seat","Type":"Office_Seat|排程作業|居家辦公個人排程","Name":"居家辦公個人排程","Descr":"OSB0101","TargetType":"2","TargetSymbol":"0001.0100.0101","Privilege":"/Booking/PersonalSchedule","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Station.gif","Cdt":"2024-07-15T10:24:25.14","Udt":"2024-07-15T10:24:25.143","EditorId":5426,"TranslatedType":"Office_Seat|排程作業|居家辦公個人排程","TranslatedName":"居家辦公個人排程","TranslatedDescr":"OSB0101","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.0100"},{"ID":14,"Application":"Office_Seat","Type":"Office_Seat|排程作業|居家辦公主管核定","Name":"居家辦公主管核定","Descr":"OSB0102","TargetType":"2","TargetSymbol":"0001.0100.0102","Privilege":"/Booking/DepartmentSchedule","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Station.gif","Cdt":"2024-07-15T10:24:27.833","Udt":"2024-07-15T10:24:27.833","EditorId":5426,"TranslatedType":"Office_Seat|排程作業|居家辦公主管核定","TranslatedName":"居家辦公主管核定","TranslatedDescr":"OSB0102","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.0100"},{"ID":15,"Application":"Office_Seat","Type":"Office_Seat|排程作業|個人訂位與取消","Name":"個人訂位與取消","Descr":"OSB0103","TargetType":"2","TargetSymbol":"0001.0100.0103","Privilege":"/Booking/SeatReserve","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Station.gif","Cdt":"2024-07-15T10:24:27.833","Udt":"2024-07-15T10:24:27.833","EditorId":5426,"TranslatedType":"Office_Seat|排程作業|個人訂位與取消","TranslatedName":"個人訂位與取消","TranslatedDescr":"OSB0103","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.0100"},{"ID":16,"Application":"Office_Seat","Type":"Office_Seat|查詢","Name":"查詢","Descr":"","TargetType":"1","TargetSymbol":"0001.8000","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-15T10:24:30.937","Udt":"2024-07-15T10:24:30.937","EditorId":5426,"TranslatedType":"Office_Seat|查詢","TranslatedName":"查詢","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001"},{"ID":17,"Application":"Office_Seat","Type":"Office_Seat|查詢|居家辦公彙總查詢","Name":"居家辦公彙總查詢","Descr":"OSB8001","TargetType":"2","TargetSymbol":"0001.8000.8001","Privilege":"/Booking/QueryScheduleSummary","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Inspection.gif","Cdt":"2024-07-15T10:24:30.937","Udt":"2024-07-15T10:24:30.937","EditorId":5426,"TranslatedType":"Office_Seat|查詢|居家辦公彙總查詢","TranslatedName":"居家辦公彙總查詢","TranslatedDescr":"OSB8001","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.8000"},{"ID":18,"Application":"Office_Seat","Type":"Office_Seat|查詢|辦公區座位查詢","Name":"辦公區座位查詢","Descr":"OSB8002","TargetType":"2","TargetSymbol":"0001.8000.8002","Privilege":"/Booking/QueryBookSeat","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Inspection.gif","Cdt":"2024-07-15T10:24:34.573","Udt":"2024-07-15T10:24:34.573","EditorId":5426,"TranslatedType":"Office_Seat|查詢|辦公區座位查詢","TranslatedName":"辦公區座位查詢","TranslatedDescr":"OSB8002","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.8000"},{"ID":20,"Application":"Office_Seat","Type":"Office_Seat|用戶管理","Name":"用戶管理","Descr":"","TargetType":"1","TargetSymbol":"0001.9900","Privilege":"","ConstraintDef":"Parent","PrivilegeDisplay":"","TargetDisplay":"","Cdt":"2024-07-17T14:04:26.343","Udt":"2024-07-17T14:04:26.343","EditorId":5426,"TranslatedType":"Office_Seat|用戶管理","TranslatedName":"用戶管理","TranslatedDescr":"","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001"},{"ID":21,"Application":"Office_Seat","Type":"Office_Seat|用戶管理|用戶授權","Name":"用戶授權","Descr":"AU9901","TargetType":"2","TargetSymbol":"0001.9900.9901","Privilege":"/Authorize/AuthorityManage","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Authority.gif","Cdt":"2024-07-17T14:04:26.343","Udt":"2024-07-17T14:04:26.343","EditorId":5426,"TranslatedType":"Office_Seat|用戶管理|用戶授權","TranslatedName":"用戶授權","TranslatedDescr":"AU9901","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9900"},{"ID":22,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|座位基礎資料維護","Name":"座位基礎資料維護","Descr":"OSB9005","TargetType":"2","TargetSymbol":"0001.9000.9005","Privilege":"/Booking/SeatLayout","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-29T17:46:15.79","Udt":"2024-07-29T17:46:15.79","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|座位基礎資料維護","TranslatedName":"座位基礎資料維護","TranslatedDescr":"OSB9005","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":23,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|部門管理者維護","Name":"部門管理者維護","Descr":"OSB9006","TargetType":"2","TargetSymbol":"0001.9000.9006","Privilege":"/Booking/DepartmentManagerSetting","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-07-31T16:32:19.283","Udt":"2024-07-31T16:32:19.283","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|部門管理者維護","TranslatedName":"部門管理者維護","TranslatedDescr":"OSB9006","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":24,"Application":"Office_Seat","Type":"Office_Seat|排程作業|代理訂位與取消","Name":"代理訂位與取消","Descr":"OSB0104","TargetType":"2","TargetSymbol":"0001.0100.0104","Privilege":"/Booking/ManagerSeatReserve","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Station.gif","Cdt":"2024-08-07T14:00:41.137","Udt":"2024-08-07T14:00:41.137","EditorId":5426,"TranslatedType":"Office_Seat|排程作業|代理訂位與取消","TranslatedName":"代理訂位與取消","TranslatedDescr":"OSB0104","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.0100"},{"ID":25,"Application":"Office_Seat","Type":"Office_Seat|基礎資料|不參加居家辦公人員維護","Name":"不參加居家辦公人員維護","Descr":"OSB9007","TargetType":"2","TargetSymbol":"0001.9000.9007","Privilege":"/Configuration/ConstValueList?Type=NotAllowWFH","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Maintain.gif","Cdt":"2024-08-15T17:02:36.13","Udt":"2024-08-15T17:02:36.13","EditorId":5426,"TranslatedType":"Office_Seat|基礎資料|不參加居家辦公人員維護","TranslatedName":"不參加居家辦公人員維護","TranslatedDescr":"OSB9007","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.9000"},{"ID":26,"Application":"Office_Seat","Type":"Office_Seat|排程作業|代理居家辦公排程","Name":"代理居家辦公排程","Descr":"OSB0105","TargetType":"2","TargetSymbol":"0001.0100.0105","Privilege":"/Booking/ManagerSchedule","ConstraintDef":"Child","PrivilegeDisplay":"","TargetDisplay":"Station.gif","Cdt":"2024-08-15T17:03:02.573","Udt":"2024-08-15T17:03:02.573","EditorId":5426,"TranslatedType":"Office_Seat|排程作業|代理居家辦公排程","TranslatedName":"代理居家辦公排程","TranslatedDescr":"OSB0105","TranslatedPrivilegeDisplay":"","ParentTargetSymbol":"0001.0100"}]'),_hoisted_1={class:"row q-gutter-sm"},_hoisted_2={class:"full-width row flex-left q-gutter-sm"},_hoisted_3={class:"row q-gutter-xs"},_sfc_main=defineComponent({__name:"JspreadsheetTest",setup(e){const o=useQuasar(),{t:r}=useI18n();let l=reactive({application:"",applicationList:[],culture:"",cultureList:[],permissionTypeList:[]});const b=ref(!1);let E=ApplicationPermissionJson,O=OAJson;const d=reactive({filter:"",selected:[],rows:[],columns:[{name:"ID",label:"ID",field:"ID",align:"left",sortable:!0},{name:"Application",label:"Application",field:"Application",align:"left"},{name:"Type",label:"Type",field:"Type",align:"left"},{name:"Name",label:"Name",field:"Name",align:"left"},{name:"Descr",label:"Descr",field:"Descr",align:"left"},{name:"TargetType",label:"Target Type",field:"TargetType",align:"left"},{name:"TargetSymbol",label:"Target Symbol",field:"TargetSymbol",align:"left"},{name:"Privilege",label:"Privilege",field:"Privilege",align:"left"},{name:"ConstraintDef",label:"Constraint Def",field:"ConstraintDef",align:"left"},{name:"PrivilegeDisplay",label:"Privilege Display",field:"PrivilegeDisplay",align:"left"},{name:"TargetDisplay",label:"Target Display",field:"TargetDisplay",align:"left"},{name:"EditorId",label:"Editor Id",field:"EditorId",align:"left"},{name:"TranslatedType",label:"Translated Type",field:"TranslatedType",align:"left"},{name:"TranslatedName",label:"Translated Name",field:"TranslatedName",align:"left"},{name:"TranslatedDescr",label:"Translated Descr",field:"TranslatedDescr",align:"left"},{name:"TranslatedPrivilegeDisplay",label:"Translated Privilege Display",field:"TranslatedPrivilegeDisplay",align:"left"},{name:"ParentTargetSymbol",label:"Parent Target Symbol",field:"ParentTargetSymbol",align:"left"}]}),u=ref(null),f=reactive({minSpareRows:100,data:[],columns:[]});onMounted(async()=>{l.applicationList=["Office_Seat","WebPortal"],l.cultureList=["zh-TW","zh-CN","English"],l.permissionTypeList=["Authenticate","Permission","Identity"]});function S(){""+l.application,l.application=="WebPortal"?d.rows=E:d.rows=O}function I(){d.selected=[],S()}function m(){const L=l.application==="WebPortal";f.columns=[{type:"hidden",name:"ID",title:"ID",width:"60px",readOnly:!0},{type:"hidden",name:"Application",title:"Application",readOnly:!0},L?{type:"dropdown",name:"Type",title:"Type",source:l.permissionTypeList}:{type:"text",name:"Type",title:"Type",width:"250px"},{type:"text",name:"Name",title:"Name",width:"150px"},{type:"text",name:"Descr",title:"Descr"},{type:"text",name:"TargetType",title:"Target Type"},{type:"text",name:"TargetSymbol",title:"Target Symbol",width:"120px"},{type:"text",name:"Privilege",title:"Privilege",width:"240px"},{type:"text",name:"ConstraintDef",title:"Constraint Def"},{type:"text",name:"PrivilegeDisplay",title:"Privilege Display",width:"150px"},{type:"text",name:"TargetDisplay",title:"Target Display",width:"240px"}]}function s(){m(),b.value=!0}function v(){var _;const L=(_=u.value)==null?void 0:_.sheet;L&&d.rows.length&&L.setData(d.rows)}function j(){var _;((_=u.value)==null?void 0:_.getAllData()).forEach(F=>{F.ID||delete F.ID,F.Application=l.application})}function g(){var _;let L=(_=d.selected)==null?void 0:_.map(F=>F.ID);if(!(L!=null&&L.length)){r("MsgPleaseSelectItemToDelete");return}r("ID")+""+L}function T(){if(!l.application){r("MsgPleaseSelect",[r("Application")]);return}new URLSearchParams({application:l.application,culture:l.culture}).toString(),`${l.application}`}function D(){Object.assign(l,{application:"",culture:""}),d.selected=[],d.rows=[]}return(L,_)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(QCard,null,{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(QSelect,{dense:"",filled:"","emit-value":"",clearable:"",class:"col-4",label:unref(r)("Application"),modelValue:unref(l).application,"onUpdate:modelValue":[_[0]||(_[0]=F=>unref(l).application=F),I],options:unref(l).applicationList},null,8,["label","modelValue","options"]),createVNode(QSelect,{dense:"",filled:"","emit-value":"",clearable:"",class:"col-4",label:unref(r)("Culture"),modelValue:unref(l).culture,"onUpdate:modelValue":[_[1]||(_[1]=F=>unref(l).culture=F),I],options:unref(l).cultureList},null,8,["label","modelValue","options"]),createVNode(QBtn,{push:"",style:{height:"32px"},color:"secondary",label:unref(r)("Download"),onClick:T},null,8,["label"]),createVNode(QBtn,{push:"",style:{height:"32px"},color:"dark",label:unref(r)("Refresh"),onClick:D},null,8,["label"])])]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QTable,{flat:"",bordered:"",dense:"","row-key":"ID",selection:"multiple",style:normalizeStyle({height:unref(o).screen.height>900?"800px":unref(o).screen.height>700?"500px":"440px"}),"virtual-scroll":"",selected:d.selected,"onUpdate:selected":_[3]||(_[3]=F=>d.selected=F),rows:d.rows,columns:d.columns,filter:d.filter,"rows-per-page-options":[0]},{"no-data":withCtx(({icon:F,message:M})=>[createBaseVNode("div",_hoisted_2,[createVNode(QIcon,{size:"2em",name:d.filter?"filter_b_and_w":F},null,8,["name"]),createBaseVNode("span",null,toDisplayString(M),1)])]),"top-right":withCtx(()=>[createBaseVNode("template",_hoisted_3,[createVNode(QBtn,{push:"",color:"positive",style:{height:"32px"},label:unref(r)("Edit"),onClick:s},null,8,["label"]),createVNode(QBtn,{push:"",color:"negative",style:{height:"32px"},label:unref(r)("Delete"),onClick:g},null,8,["label"])]),createVNode(QInput,{modelValue:d.filter,"onUpdate:modelValue":_[2]||(_[2]=F=>d.filter=F),label:unref(r)("Search"),class:"q-pl-md",clearable:"",dense:"",debounce:"300"},{append:withCtx(()=>[createVNode(QIcon,{name:"search"})]),_:1},8,["modelValue","label"])]),_:1},8,["style","selected","rows","columns","filter"])]),_:1})]),_:1}),createVNode(QDialog,{modelValue:b.value,"onUpdate:modelValue":_[4]||(_[4]=F=>b.value=F),persistent:"",onShow:v},{default:withCtx(()=>[createVNode(QCard,{style:{"max-width":"90%"}},{default:withCtx(()=>[createVNode(QCardSection,{class:"q-pa-none"},{default:withCtx(()=>[createVNode(QToolbar,{class:"bg-primary text-white"},{default:withCtx(()=>[createVNode(QToolbarTitle,null,{default:withCtx(()=>[createTextVNode(toDisplayString(unref(r)("Edit"))+" - "+toDisplayString(unref(l).application),1)]),_:1}),withDirectives(createVNode(QBtn,{flat:"",round:"",dense:"",icon:"close"},null,512),[[ClosePopup]])]),_:1})]),_:1}),createVNode(QCardSection,{class:"q-pa-none",style:{height:"400px"},align:"center"},{default:withCtx(()=>[createVNode(_sfc_main$1,{ref_key:"spreadsheetRef",ref:u,options:f},null,8,["options"])]),_:1}),createVNode(QSeparator),createVNode(QCardActions,{align:"right"},{default:withCtx(()=>[createVNode(QBtn,{label:unref(r)("Confirm"),onClick:j,color:"primary"},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});export{_sfc_main as default};
